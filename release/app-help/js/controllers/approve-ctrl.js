define(["controllers/controllers","bootstrap-dialog"],function(o,n){"use strict";o.controller("approveCtrl",["$scope","userLoginUIService","resourceUIService","userEnterpriseService","userUIService","growl",function(r,a,t,o,e,s){r.protocols=[],r.protocolVersions=[],r.approveGridData={columns:[{title:"接入协议",data:"protocol"},{title:"协议版本",data:"protocolVersion"},{title:"用户名称",data:"accessName"},{title:"密码",data:"accessPassword"},{title:"操作",orderable:!1,data:"option"}],columnDefs:[{targets:0,data:"protocol",render:function(o,t,a){var e="";if(0<a.isEdit){for(var s in e+='<select style="border: 1px solid #F18282;" name="protocols" id="protocols" class="combobox form-control protocols">',e+='<option value="">请选择...</option>',r.protocols)r.protocols[s].protocol==o?e+='<option  value="'+r.protocols[s].protocol+'" selected = "selected" >'+r.protocols[s].protocol+"</option>":e+='<option  value="'+r.protocols[s].protocol+'">'+r.protocols[s].protocol+"</option>";e+="</select>"}else e+=o;return e}},{targets:1,data:"protocolVersion",render:function(o,t,a){var e="";if(0<a.isEdit){if(e+='<select style="border: 1px solid #F18282;" name="version" id="version" class="combobox form-control protocols">',e+='<option value="">请选择...</option>',""!=a.protocol&&null!=a.protocol)for(var s in r.protocolVersions)r.protocolVersions[s].protocol==a.protocol&&(r.protocolVersions[s].protocolVersion==o?e+='<option  value="'+r.protocolVersions[s].protocolVersion+'" selected = "selected" >'+r.protocolVersions[s].protocolVersion+"</option>":e+='<option  value="'+r.protocolVersions[s].protocolVersion+'">'+r.protocolVersions[s].protocolVersion+"</option>");e+="</select>"}else e+=o;return e}},{targets:2,data:"accessName",render:function(o,t,a){return 0<a.isEdit?"<input class='form-control col-xs-6' placeholder='不能为空、空格，最多20个字符' type='text'   maxlength='20' style='border: 1px solid #F18282;width:100%;' value='"+escape(o)+"'>":escape(o)}},{targets:3,data:"accessPassword",render:function(o,t,a){return 0<a.isEdit?"<input class='form-control col-xs-6' placeholder='不能为空、空格，最多20个字符' maxlength='20'  style='border: 1px solid #F18282;width:100%;' type='text'  value='"+escape(o)+"'>":"*********"}},{targets:4,data:"option",render:function(o,t,a){return 0<a.isEdit?"<a id='save-btn' class='btn btn-default btn-sm' style='margin-right: 10px;'>  <i class='fa fa-save  hidden-lg hidden-md hidden-sm'></i> <span class='hidden-xs'> 保存</span></a><a id='cancel-btn' class='btn btn-default btn-sm' > <i class='fa fa-times  hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 取消</span>  </a>":"<a id='edit-btn' class='btn btn-default btn-sm' style='margin-right: 10px;'>  <i class='fa fa-edit  hidden-lg hidden-md hidden-sm'></i> <span class='hidden-xs'> 编辑</span></a><a id='del-btn' class='btn btn-default btn-sm' > <i class='fa fa-times  hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 删除</span>  </a>"}}]};var i=function(){t.getAllCollectionPlugins(function(o){var t={};0==o.code&&(o.data.forEach(function(o){t[o.protocol]||(t[o.protocol]=o,r.protocols.push(o))}),r.protocolVersions=o.data)})};r.addProve=function(){var o={protocol:"",protocolVersion:"",accessName:"",accessPassword:"",domainPath:"",id:null,isEdit:3};for(var t in r.approveGridData.data)if(null==r.approveGridData.data[t].id)return r.approveGridData.data[t]=o,void r.$broadcast(Event.APPROVEINIT,r.approveGridData);r.approveGridData.data.unshift(o),r.$broadcast(Event.APPROVEINIT,r.approveGridData)},r.doAction=function(o,a){"save"==o?null==a.id?t.addEnterpriseAccessAccount(a,function(o){if(0==o.code){for(var t in r.approveGridData.data)if(null==r.approveGridData.data[t]){r.approveGridData.data[t]=o.data,r.approveGridData.data[t].isEdit=0;break}r.getDBdata(),s.success("新增认证用户成功",{})}}):t.updateEnterpriseAccessAccount(a,function(o){if(0==o.code){for(var t in r.approveGridData.data)if(a.id==r.approveGridData.data[t].id){r.approveGridData.data[t]=o.data,r.approveGridData.data[t].isEdit=0;break}r.$broadcast(Event.APPROVEINIT,r.approveGridData),s.success("修改认证用户成功",{})}}):"delete"==o?n.show({title:"提示",closable:!1,message:"确认要删除该认证用户",buttons:[{label:"确定",cssClass:"btn-success",action:function(o){t.deleteEnterpriseAccessAccount(a.id,function(o){0==o.code&&(s.warning("删除认证用户成功!",{}),r.getDBdata({}))}),o.close()}},{label:"取消",action:function(o){o.close()}}]}):"cancel"==o&&r.getDBdata()},r.getDBdata=function(){t.getEnterpriseAccessAccounts(function(o){0==o.code&&(r.approveGridData.data=o.data,r.$broadcast(Event.APPROVEINIT,r.approveGridData))})},a.user.isAuthenticated?(r.getDBdata(),i()):r.$on("loginStatusChanged",function(o,t){a.user.isAuthenticated&&(r.getDBdata(),i())})}])});
//# sourceMappingURL=../../../map/app-help/js/controllers/approve-ctrl.js.map
