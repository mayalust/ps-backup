define({on:{init:function(e){runtime("echart1 start!");var n,i,t,o=e.target,l=(e.global,o.getValue("global/resource")),c=o.getValue("global/kpi"),a=o.getValue("global/alertTime");a?(a=o.dateHandler(a),i=a.clone(),n=a.clone(),i.addHour(-2),n.addHour(1)):(n=o.dateHandler(),(i=n.clone()).addHour(-2)),i=i.getUTCDateString(),n=n.getUTCDateString();var u=function r(e){function a(){var e=o.getParameter("id"),a=e?[e]:[l.id],t={includeInstance:!0,isRealTimeData:!1};c&&c[0]&&(t.queryInstances=c[0].instance),i&&(t.startTime=i),n&&(t.endTime=n);o.show();var s=c&&c.map(function(e){return e.dataItemId})||[];runtime("echart start to load AJAX!"),o.getKpiValueList(a,s,null,function(a){if(runtime("echart AJAX loaded!"),o.hideLoading(),c&&console.warn("渲染上面的视图啦＝＝＝＝",c[0]),0<a.length){var g=a.reduce(function(e,a){var t=o.dateHandler(a.arisingTime);return e?t.before(e)?t:e:t},null),e=(a.reduce(function(e,a){var t=o.dateHandler(a.arisingTime);return e?t.after(e)?t:e:t},null),c.map(function(r){var e=a.filter(function(e){var a=e.kpiCode,t=e.instance;return r.dataItemId==a&&r.instance==t});return e.sort(function(e,a){var t=new Date(e.arisingTime),r=new Date(a.arisingTime);return t.getTime()-r.getTime()}),{name:r.kpiName,type:"line",symbolSize:0,data:e.map(function(e){var a=new Date(e.arisingTime),t=o.dateHandler(a);o.dateHandler("2017/01/01");return[t.minus(g),e.value]})}})),t={animation:!1,title:{textStyle:{color:"#fff"}},grid:{containLabel:"true",left:"23px",right:"50px"},tooltip:{trigger:"axis",formatter:function(e,a,t){var r="";for(var n in e){var i=e[n].value[0],o=e[n].value[1],l=e[n].marker,u=e[n].seriesIndex,d=g.clone().addTimeStamp(i);s&&(r+=l+c[u].kpiName,r+=":"+o+"["+d.getDateString("MM/dd,hh:mm:ss")+"]<br>")}return r}},legend:{data:c.map(function(e){return e.kpiName})},toolbox:{feature:{dataZoom:{},restore:{},saveAsImage:{type:"png",name:"综合趋势-测点图",backgroundColor:"#0b2232"}},iconStyle:{normal:{borderColor:"#fff"},emphasis:{borderColor:"#fff"}}},xAxis:{boundaryGap:!1,type:"value",max:"dataMax",axisLabel:{formatter:function(e){return g.clone().addTimeStamp(e).getDateString("MM/dd,hh:mm:ss")}}},yAxis:{type:"value"},series:e};o.render(t)}else o.showNoData();u=r,runtime("echart rendered!")},t)}u=function(){},o.showLoading(),o.hideNoData(),t?a():o.getKpiTypeByFilter({hasSingnal:!1},function(e){t=e,a()})};o.off("multiSelectValues.generalChart"),o.on("multiSelectValues.generalChart",function(e){c=e,l&&c&&u(1)}),o.off("tree_resourceChange.generalChart"),o.on("tree_resourceChange.generalChart",function(e){(l=e.resource)&&c&&u(2)}),o.off("drawDiagnoseFeatureEchart.generalChart"),o.on("drawDiagnoseFeatureEchart.generalChart",function(e){i=e[0].getUTCDateString(),n=e[1].getUTCDateString(),l&&c&&u(4)})}}});
//# sourceMappingURL=../../map/solution/customview/generalChart_echart.js.map
