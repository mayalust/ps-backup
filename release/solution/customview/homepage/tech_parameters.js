define({on:{init:function(t,e,i){var c=t.target;function o(t,e){return function(){return e.apply(t,arguments)}}function h(t,e){var i=0;for(var n in t){if(e==n)return i;i++}}function n(t){return t-0}function a(){this.valueListMap={},this.getKpiValueList(o(this,function(){this.setWebSocket()}))}function s(t){return{type:"label",value:t,composory:"none",style:{"white-space":"pre-wrap",borderBottom:"1px solid #666666",height:"41px"},class:"col-xs-4"}}function r(t){var e=null==t._value?"-":t._value;return e+=t.unit&&"NA"!=t.unit?t.unit:"",[t.kpiName,e,c.dateHandler(t.arisingTime).getDateString("yy/MM/dd hh:mm:ss")].map(function(t){return s(t)})}a.prototype.getDomainAreaLineTree_alertStatus=function(e){c.getDomainAreaLineTree_alertStatus(o(this,function(t){this.resource=t,e&&e.call(this,t)}))},a.prototype.getAttrsByResource=function(e){this.getDomainAreaLineTree_alertStatus(o(this,function(t){c.getAttrsByResource(t,o(this,function(t){this.attributes=t,e&&e.call(this,t)}))}))},a.prototype.getMeasureLocate=function(n){this.getAttrsByResource(o(this,function(t){this.resource.getMeasureLocate().then(o(this,function(t){var e=t.find(function(t){return"整体"==t.label.trim()}),i=e?e.kpis:[];this.dataItemsMap=i.reduce(function(t,e){return t[e.dataItemId]=e,0,t},{}),n&&n.call(this,this.dataItemsMap)}))}))},a.prototype.getKpis=function(i){this.getMeasureLocate(o(this,function(e){c.getKpisByModelId(this.resource.modelId,function(t){t.forEach(function(t){e[t.id]&&(e[t.id].unit=t.unit)}),i&&i.call(this,e)})}))},a.prototype.handValueList=function(t){if(t instanceof Array)t.forEach(o(this,function(t){this.dataItemsMap[t.kpiCode]._value=t.value,this.dataItemsMap[t.kpiCode].arisingTime=t.arisingTime}));else for(var e in t)this.dataItemsMap[e]._value=t[e].value,this.dataItemsMap[e].arisingTime=t[e].arisingTime},a.prototype.render=function(){var t=[["名称","数值","更新时间"].map(function(t){return s(t)})],e=Object.values(this.dataItemsMap);[].push.apply(t,e.map(r)),this.tableIns=c.render(t)},a.prototype.refresh=function(t){if(this.tableIns)for(var e in t)o(this,function(t,e){var i=h(this.dataItemsMap,t),n=this.dataItemsMap[t],a=null==e.value?"-":e.value,s=n.unit&&"NA"!=n.unit?n.unit:"",r=this.tableIns.find("tr")[i+1].getElementsByTagName("td"),o=r[1].getElementsByTagName("span")[2],u=r[2].getElementsByTagName("span")[2];o.innerText=a+s,u.innerText=c.dateHandler(e.arisingTime).getDateString("yy/MM/dd hh:mm:ss")})(e,t[e])},a.prototype.webSocket=function(t){var n,a,s,r;c.webSocket(this.resource.id,Object.keys(this.dataItemsMap),o(this,(n=t,a=3e3,r={},function(t){var e=this,i=(t.nodeId,t.kpiCode);t.instance,null==s?s=setTimeout(function(){n.call(e,r),s=null},a):r[i]=t})),"instance_parameter")},a.prototype.setWebSocket=function(){this.webSocket(o(this,function(t){this.refresh(t)}))},a.prototype.getKpiValueList=function(e){this.getKpis(o(this,function(t){c.getKpiValueCi([this.resource.id],Object.keys(t).map(n),o(this,function(t){this.handValueList(t),this.render(),e()}),{isRealTimeData:!0,includeInstance:!0})}))},new a,c.on("$destroy",function(t){})}}});
//# sourceMappingURL=../../../map/solution/customview/homepage/tech_parameters.js.map
