function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}define({on:{init:function(t,e,i){var o,r=t.target;function a(t){return void 0!==t}function n(t,e){return t[e.name]=e,t}function c(t){return t.dataItemId}function s(t,e){return function(){return e.apply(t,arguments)}}function u(t){var e=/(?:.*\:)*([^\:]*)/.exec(t);if("string"==typeof t||"number"==typeof t)return e?e[1]-0:t}function h(t,e,i){var o,r=e.split("/").filter(a);if(void 0===i){for(s=t;(o=r.shift())&&s;)s=s[o];return s}for(var n=r.pop(),s=t;(o=r.shift())&&s;)s=s[o];"object"===_typeof(s)&&(s[n]=i)}function f(t,e,i){var o,r=e.split("/").filter(a);if(void 0===i){for(s=t.attrs;(o=r.shift())&&s;)s=s[o];return s}for(var n=r.pop(),s=t.attrs;(o=r.shift())&&s;)s=s[o];"object"===_typeof(s)&&(s[n]=i)}function d(){this.hookToView(s(this,function(t,e){t.forEach(s(this,this.handleEachCell)),e(t)}))}d.prototype.handleEachCell=function(t){var i,e=f(t,"text/text"),o=u(h(t,"nodeId")),r=u(h(t,"kpiId")),n=this.resource.modelId,s=h(t,"extend");{if(f(t,"rect/visibility","hidden"),f(t,"circle/visibility","hidden"),f(t,"text/visibility","hidden"),f(t,".connection/stroke","#1f8fd8"),f(t,".connection/stroke-width",2),f(t,".marker-target/visibility","hidden"),!s)return void 0!==this.sensors[e]?(this.sensors[e].kpis.sort(function(t,e){var i=this.kpisMap[n][t.dataItemId]||{},o=this.kpisMap[n][e.dataItemId]||{};return(i.serial||0)-(o.serial||0)}),h(t,"extend","kpis"),h(t,"sensor",e),h(t,"currentdevice",1),void h(t,"dataItem",this.sensors[e].kpis.filter((i=4,function(t,e){return e<i})).map(c))):void(o&&(void 0!==this.children[o]?h(t,"extend","alert"):(h(t,"sensor","00"),h(t,"extend","dataItem"),h(t,"nodeId","number:"+this.resource.id),h(t,"currentdevice",1),h(t,"dataItem",[r]))));"kpis"==s&&1e3<n&&h(t,"currentdevice",1)}},d.prototype.hookToView=function(e){this.getView(s(this,function(t){r.hooks.tap("viewloaded",e),r.render(t),r.$on("$loadCiKpiComplete",s(this,this.loadCiKpiComplete))}))},d.prototype.loadCiKpiComplete=function(t){var e=r.createCurrentStatus(this.resource.label,{x:290,y:0},this.resource.getAlertState());this.clear=this.resource.$on("alertStateChange",function(t){e.setAlarmStatus(t)})},d.prototype.destroy=function(){this.clear&&this.clear.call(this)},d.prototype.getView=function(o){this.getBrothers(s(this,function(t){var e=t.find(function(t){return t.$attr("values/view/viewId")})||{},i=this.resource.$attr("view/viewId")||this.resource.$attr("values/view/viewId")||e.$attr("values/view/viewId");r.getViewById(i,function(t){o(function(t){var e;try{e=JSON.parse(t)}catch(t){return}return e}(t.content))})}))},d.prototype.getBrothers=function(e){this.getChildren(s(this,function(t){this.resource.getBrothers().then(s(this,function(t){this.brothers=t,e(t)}))}))},d.prototype.getChildren=function(e){this.getMeasureLocate(s(this,function(t){this.resource.getChildren(function(t,e,i){return!0}).then(s(this,function(t){this.children=t,e(t)}))}))},d.prototype.getMeasureLocate=function(e){this.getDataItemsByModelIdFromCache(s(this,function(t){this.resource.getMeasureLocate().then(s(this,function(t){this.sensors=t.reduce(n,{}),e(t)}))}))},d.prototype.getDataItemsByModelIdFromCache=function(e){this.getDomainAreaLineTree_alertStatus(function(t){r.getDataItemsByModelIdFromCache(t.modelId,function(t){this.kpisMap=t,e(t)})})},d.prototype.getDomainAreaLineTree_alertStatus=function(e){r.getDomainAreaLineTree_alertStatus(s(this,function(t){this.resource=t,e(t)}))},o=new d,r.on("$destroy",function(){o.destroy()})}}});
//# sourceMappingURL=../../../map/solution/customview/homepage/deviceDetail.js.map
