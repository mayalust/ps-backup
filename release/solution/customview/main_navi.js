define({on:{init:function(e){runtime("主导航TAB开始加载");var m=e.target,n=m.getCurrentUser(),i=n.currentRoleID?n.currentRoleID.split(",")[0]:n.roleID;m.getRoleByID(i,function(e){var d=JSON.parse(e.values)||[];d=d.map(function(e,n){return{id:n,label:e.name,alias:e.alias,viewId:e.viewId}});m.setValue("global/ROLE",-1),m.setValue("global/tabs",d),d&&0!=d.length||(d=[]).push({id:0,label:"我的首页",default:"baogang/alert/home"});var n="controlPanelLevel1Navigation",i="lv1viewchange";m.setScopeValue("CACHEDVALUENAME",n),m.setScopeValue("CHANGENAVEEVENT",i),m.setScopeValue("MOVETOEVENT","lv1moveTo");var r,s,t,o=m.getParameter("main");o instanceof Array?(r=o[0],-1!=(s=o[1]).indexOf("viewId:")&&(t={viewId:s.split("viewId:")[1]})):r=o;var f=!1,p=[],b=function(){var e={tabs:d,subTabs:p,editMode:f};m.saveEditorStatus(n,e)},h=function(e,n){e.viewId;t?m.setScopeValue("INITPARAMS",{item:t}):m.setScopeValue("INITPARAMS",{item:e,path:n}),m.trigger(i,m.getScopeValue("INITPARAMS"))},v=function(t,o){t.label;var e=t.viewId;if(e)m.updateView({viewId:e,viewTitle:t.label,viewType:"dashboard"},function(e){o(e)});else{var n=function(i){t.label,t.default;m.getAllMyViews(function(e){var n=e.find(function(e){e.viewTitle});n?(t.viewId=n.viewId,o(n)):m.addView({viewTitle:t.label+"("+(t.default||"自定义")+")",viewType:"dashboard",content:i||null},function(e){t.viewId=e.data.viewId,o(e)})})};t.default?m.Info("../../localdb/echartTemplate/"+t.default+".json",function(e){n(JSON.stringify(e))}):n()}},a=function o(e){var n=d.filter(function(e){return 0!=e.show||f}),i=n.map(function(i){var e=i.$clone();return e.on={click:function(e){m.navigateTo("index",{main:i.id},"self")}},f&&(e.addOn=[{icon:"glyphicon glyphicon-scale",on:{click:function(e){var n=function(){i.viewId;m.linkTo("../app-freeboard/index.html#/freeboard/view/dashboard/"+i.viewId+"/0")};i.viewId?n():v(i,function(){b(),n()})}}},{icon:"glyphicon glyphicon-edit",on:{click:function(e){m.createPopupBypath("info",{title:"工作台信息",theme:"system",width:500,on:{submit:function(e){}}},i)}}}]),e}),a=p.filter(function(e){return e.show||f}),t=a.map(function(t){var e=t.$clone();return e.on={click:function(e){m.tabInx=n.length+a.indexOf(t),o()}},f&&e.$extension({addOn:[{icon:"glyphicon glyphicon-edit",on:{click:function(){m.createPopupBypath("popup",{title:"编辑工作台",theme:"system",width:500,on:{submit:function(e){t.label=e.name,t.id=e.id,v(t,function(){b(),o()})}}},t)}}},{icon:"glyphicon glyphicon-scale",on:{click:function(e){m.linkTo("../app-freeboard/index.html#/freeboard/view/dashboard/"+t.viewId+"/0")}}},{icon:"proudsmart ps-delete-02",on:{click:function(e){var n,i=p.indexOf(t);p.splice(i,1),(n=t).viewId&&m.deleteView(n.viewId),b(),o()}}}]}),e}),c=n.concat(a);e&&(m.tabInx=c.indexOf(e));var l=c.find(function(e){return e.id==r});if(l&&(m.tabInx=c.indexOf(l)),m.tabInx>c.length-1&&(m.tabInx=c.length-1),h(c[m.tabInx],s),f)var u=i.concat(t).concat([{id:-1,label:"",icon:"glyphicon glyphicon-plus",on:{click:function(e){m.createPopupBypath("popup",{title:"新建工作台",theme:"system",width:500,on:{submit:function(e){e={id:e.id,label:e.name};v(e,function(){p.push(e),b(),o()})}}})}}},{id:-1,label:"",icon:"glyphicon glyphicon-cog",on:{click:function(e){m.createPopupBypath("setting",{title:"设置",theme:"system",width:500,on:{submit:function(e){d=e.tabs,f=e.editMode,p=e.subTabs,b(),o()}}},{editMode:f,tabs:d,subTabs:p})}}},{id:-2,label:"",icon:"glyphicon glyphicon-transfer",on:{click:function(e){m.createPopupBypath("viewpare",{title:"配置区域，产线，设备对应的组太视图",theme:"system",width:700,on:{submit:function(e){m.createPopupBypath("viewpare",{title:"配置视图",theme:"system",width:500,on:{submit:function(e){}}})}}})}}}]);else u=i.concat(t).concat([{id:-1,label:"",icon:"glyphicon glyphicon-cog",on:{click:function(e){m.createPopupBypath("setting",{title:"设置",theme:"system",width:500,on:{submit:function(e){d=e.tabs,f=e.editMode,p=e.subTabs,b(),o()}}},{editMode:f,tabs:d,subTabs:p})}}}]);setTimeout(function(){m.render(u,{class:"steelNavi"})}),runtime("主导航TAB加载完成!!")};m.on("navigateTo",function(n){var e=d.concat(p).find(function(e){return e.id==n});a(e),e&&h(e)}),a()})}},format:{id:"id",label:"label"}});
//# sourceMappingURL=../../map/solution/customview/main_navi.js.map
