define(["controllers/controllers"],function(e){"use strict";e.initController("ExpertCurveCtrl",["$scope","$rootScope","$route","resourceUIService","kpiDataService","SwSocket","Info","userLoginUIService","growl","$routeParams",function(a,e,t,r,i,o,n,c,s,l){var u;console.info("映泰专家曲线"),t.current?(u=t.current.params.nodeId,m()):e.$on("$locationChangeSuccess",function(e){t.current&&(u=t.current.params.nodeId,m())}),a.expertCurveHeader=[],a.MyceliaData=[];n.get("localdb/expertcurve.json",function(e){a.expertCurveHeader=e.expertCurveHeader,a.MyceliaData=e.MyceliaData});var d=function(e){r.getKpisByModelId(e,function(e){if(0==e.code)for(var t in e.data)"土壤湿度"==e.data[t].label?(a.soilTemKpi=e.data[t],p(4,e.data[t].id)):"土壤温度"==e.data[t].label?(a.soilTemKpi=e.data[t],p(3,e.data[t].id)):"空气湿度"==e.data[t].label?(a.airHumKpi=e.data[t],p(2,e.data[t].id)):"空气温度"==e.data[t].label&&(a.airTemKpi=e.data[t],p(1,e.data[t].id))})},f=function(e){return e&&(e=new Date(e).Format(GetDateCategoryStrByLabel())),e};function p(u,e){var t=["kpi",{statisticType:"",category:"time",nodeIds:a.nodeIds,kpiCodes:[e],isRealTimeData:!0,timePeriod:108e5,startTime:"",endTime:"",timeRange:"",queryInstances:null}];i.getKpiHierarchyValueList(t,function(e){if(0==e.code){var a,r=[],i=[],t=[],o=[];for(var n in $.each(e.data.fieldLabels,function(e,t){a=t}),e.data.recordList)$.each(e.data.recordList[n],function(e,t){"category"!=e?i.push(t):r.push(f(t))});if(1==u){for(var c=0;c<i.length;c++)t.push(30);for(var s=0;s<i.length;s++)o.push(20);var l=h(a,r,i,t,o);require(["echarts"],function(e){e.init($("#airTem")[0]).setOption(l)})}else if(2==u){for(c=0;c<r.length;c++)t.push(70);for(s=0;s<r.length;s++)o.push(60);l=h(a,r,i,t,o);require(["echarts"],function(e){e.init($("#airHum")[0]).setOption(l)})}else if(3==u){for(c=0;c<r.length;c++)t.push(25);for(s=0;s<r.length;s++)o.push(21);l=h(a,r,i,t,o);require(["echarts"],function(e){e.init($("#soilTem")[0]).setOption(l)})}else if(4==u){for(c=0;c<r.length;c++)t.push(60);for(s=0;s<r.length;s++)o.push(50);l=h(a,r,i,t,o);require(["echarts"],function(e){e.init($("#soilHum")[0]).setOption(l)})}}})}function h(e,t,a,r,i){return{title:{text:e},tooltip:{trigger:"axis"},legend:{data:[e]},toolbox:{show:!0,feature:{}},xAxis:{type:"category",boundaryGap:!1,data:t},yAxis:{type:"value",axisLabel:{formatter:"{value} °C"}},series:[{name:e,type:"line",data:a},{name:"参照曲线上",type:"line",lineStyle:{normal:{color:"#3C8DBC"}},data:r},{name:"参照曲线下",type:"line",lineStyle:{normal:{color:"#3C8DBC"}},data:i}]}}function m(){r.getResourceById(u,function(e){if(0==e.code){var t=e.data.modelId;a.nodeIds=[u],d(t)}})}require.config({paths:{echarts:"//cdn.bootcss.com/echarts/3.0.0/echarts"}})}])});
//# sourceMappingURL=../../../map/app-sc/js/controllers/yingtai-ctrl.js.map
