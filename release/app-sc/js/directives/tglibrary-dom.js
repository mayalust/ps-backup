define(["directives/directives","echarts","jquery-ui","slick","Array"],function(t,c,i){"use strict";function e(t,i,v,o){var e={restrict:"A",scope:{previewList:"=",mode:"@",click:"&"}};return e.link=function(d,f){function t(t,i,e){var n;0<(t instanceof Array?t.length:0)&&(!function(){for(var t=$(f).find(".slick-list [slickItem]").size()-1;-1<t;t--)$(f).slick("slickRemove",t)}(),n=t,o.units.getAll().then(function(p){for(var t in n)!function(t){var i,e,n,o,r,c,a,s,u;null!=d.previewList[t].kpi&&(u=d.previewList[t].kpi.unit);var l=p.find(function(t){return t.unitCode==u});i="previewList["+t+"].value + '"+(l?l.unitName:"")+"'",e="previewList["+t+"].kpi.icon",n="previewList["+t+"].label",o=$("<div></div>").attr("slickItem","").addClass("box-body"),r=$("<p></p>").addClass("text-muted text-center").attr("ng-bind",i),c=$("<div></div>").addClass("btn btn-ps-normal").css({width:"72px",height:"72px"}),a=$("<i></i>").addClass("ps-lg").attr("ng-class",e),s=$("<h5></h5>").addClass("text-center").attr("ng-bind",n),c.append(a),o.append(r).append(c).append(s),$(f).slick("slickAdd",v(o)(d)),o.on("click",function(){d.$apply(function(){d.click()})})}(t)}))}i(function(){$(f).slick({dots:!1,arrows:!0,draggable:!1,slidesToScroll:5,variableWidth:!0,infinite:!1}),d.$watch("previewList",t)})},e}function n(t,n){var i={restrict:"A",scope:{blk:"="},link:function(t,e,i){n(function(){var t=$(e).width();$(e).height(720*t/1024)}),$(window).on("resize",function(t){var i=$(e).width();$(e).height(720*i/1024)})}};return i}function o(t,i){var e={restrict:"A",scope:{ic:"="},link:function(o,r,t){var c;$(function(){$(document).tooltip({position:{my:"center bottom-20",at:"center top",using:function(t,i){$(this).css(t),$("<div>").addClass("arrow").addClass(i.vertical).addClass(i.horizontal).appendTo(this)}}})}),i(function(){o.$watch("ic",function(t,i,e){t&&(t.openCam=function(t){c&&$(r).find("#videoDiv").attr("src",c)},t.closeCam=function(t){c&&$(r).find("#videoDiv").removeAttr("src")})});var t,i={},e="",n="";$(r).find(".camWrap").resizable(),$(r).find(".camWrap").draggable({handle:$(r).find(".camWrap .camHeader"),containment:$(r).parent(),snap:!0,snapMode:"both"}),t="localdb/ipcam.json",$.ajax({url:t,type:"Get",contenttype:"application/json",success:function(t){null!=t&&""!=t&&(i="string"==typeof t?$.parseJSON(t):t,e="user="+i.username+"&pwd="+i.password+"&res=0",n="http://"+i.ip+":"+i.port,c=n+"/videostream.cgi?"+e+"&resolution=320*240&rate=12")}})})}};return e}function r(t,n){var i={restrict:"A",scope:{chart:"=",target:"="},link:function(i,t,e){n(function(){$(t).draggable({helper:function(){var t=$("<div class='tg-helper'></div>").css({width:i.target[i.target.type].width,height:i.target[i.target.type].height,border:"1px dashed #bbb"});return t},handle:$(t).find("#moveBtn"),revert:!1,cursor:"move",cursorAt:[50,50],appendTo:$("body")})})}};return i}function a(t,e){var i={restrict:"A",scope:{onDrop:"&"},link:function(n,t,i){e(function(){$(t).droppable({drop:function(t,i){function e(){"tg-drag"==$(i.draggable).attr("id")&&n.onDrop({ui:i})}n.$apply(e)}})})}};return i}function s(t,n){var i={restrict:"A",scope:{stopResize:"&",stopMove:"&",target:"="},link:function(e,t,i){n(function(){$(t).resizable({aspectRatio:e.target.scale,stop:function(t,i){e.$apply(function(){e.stopResize({ui:i})})}}),$(t).draggable({containment:$(".drawingArea"),stop:function(t,i){e.$apply(function(){e.stopMove({ui:i})})}})})}};return i}function u(t,r){var i={restrict:"C",scope:{chart:"="},link:function(i,e,n){var o;r(function(){i.$watch("chart",function(t,i,e){t&&(t.setOption=function(t){this._option_=t,o.setOption(this._option_)},t.pushData=function(t,i){this._option_&&(25<this._option_.series[0].data.length&&(this._option_.series[0].data.shift(),this._option_.xAxis.data.shift()),this._option_.series[0].data.push(parseFloat(t)),this._option_.xAxis.data.push(i),o.setOption(this._option_))})});i.chart.ci,i.chart.kpi;var t=i.chart.option;o=c.init(e[0],"macarons"),t&&o.setOption(t),$(window).on("resize."+n.id,function(t){o.resize()})})}};return i}function l(t,e){var i={restrict:"A",scope:{rotate:"="},link:function(t,n,i){e(function(){t.$watch("rotate",function(t,i,e){t&&(t.highLight=function(){$(n).stop(),$(n).css("opacity",1),clearTimeout(t.to),t.to=setTimeout(function(){.6<parseFloat($(n).css("opacity"))&&$(n).animate({opacity:.6},200)},1e3)})}),$(n).css("opacity",.8)})}};return i}function p(t,i){var e={restrict:"C",scope:{control:"="},link:function(e,n,t){i(function(){e.$watch("control",function(i,t,e){i&&(i.setValue=function(t){i.value=t,$(n).slider("value",t),i.onChange(t)})}),$(n).slider({range:"min",slide:function(t,i){e.$apply(function(){e.control.onSlide&&e.control.onSlide(i.value),e.control.value=i.value})},stop:function(t,i){e.$apply(function(){e.control.onChange&&e.control.onChange(i.value),"functioin"==typeof e.control.sendDeviceDirective&&e.control.sendDeviceDirective(i.value),e.control.value=i.value})}}),"-"==e.control.value?$(n).slider("value",0):$(n).slider("value",e.control.value?e.control.value:0)})}};return e}function d(t,o){var i={restrict:"A",scope:{blk:"="}};return i.link=function(t,n,i){t.$watch("blk",function(t,i,e){t&&(t.startBlink=function(){o(function(){$(function(){!function t(i){$(i).animate({opacity:1},{duration:300,complete:function(){$(i).animate({opacity:0},{duration:300,complete:function(){t($(i))}})}})}($(n))})})},t.stopBlink=function(){$(n).stop(),$(n).css({opacity:0})})}),o(function(){$(function(){$(n).css("opacity",0)})})},i}function f(t,e){var i={restrict:"C",template:"<div class='toggle-wrap'><div class='toggle-inner'></div></div>",scope:{tg:"="},link:function(t,n,i){t.$watch("tg",function(i,t,e){i&&(i.setValue=function(t){i.value=0<t,0<t?$(n).find(".toggle-wrap").addClass("active"):$(n).find(".toggle-wrap").removeClass("active"),i.onChange&&i.onChange(0<t)})}),e(function(){$(function(){0<("string"==typeof t.tg.value?parseInt(t.tg.value):t.tg.value)?$(n).find(".toggle-wrap").addClass("active"):$(n).find(".toggle-wrap").removeClass("active"),$(n).on("click",function(){t.$apply(function(){t.tg.value=0<parseInt(t.tg.value)?0:1,0<t.tg.value?$(n).find(".toggle-wrap").addClass("active"):$(n).find(".toggle-wrap").removeClass("active"),"function"==typeof t.tg.onChange&&t.tg.onChange(!t.tg.value),"functioin"==typeof t.tg.sendDeviceDirective&&t.tg.sendDeviceDirective(t.tg.value)})})})})}};return i}t.registerDirective("tgSlick",e),e.$inject=["$q","$timeout","$compile","serviceCenterService"],t.registerDirective("tgImage",n),n.$inject=["$q","$timeout"],t.registerDirective("ipcam",o),o.$inject=["$q","$timeout"],t.registerDirective("tgDrag",r),r.$inject=["$q","$timeout"],t.registerDirective("tgDrop",a),a.$inject=["$q","$timeout"],t.registerDirective("tgElement",s),s.$inject=["$q","$timeout"],t.registerDirective("tgEcharts",u),u.$inject=["$q","$timeout"],t.registerDirective("tgRotate",l),l.$inject=["$q","$timeout"],t.registerDirective("tgScrollbar",p),p.$inject=["$q","$timeout"],t.registerDirective("tgBlink",d),d.$inject=["$q","$timeout"],t.registerDirective("tgToggle",f),f.$inject=["$q","$timeout"]});
//# sourceMappingURL=../../../map/app-sc/js/directives/tglibrary-dom.js.map
