define(["controllers/controllers","bootstrap-dialog"],function(o,n){"use strict";o.initController("approveCtrl",["$scope","userLoginUIService","resourceUIService","userEnterpriseService","userUIService","growl",function(s,a,t,o,e,r){s.protocols=[],s.protocolVersions=[],s.approveGridData={columns:[{title:"接入协议",data:"protocol"},{title:"协议版本",data:"protocolVersion"},{title:"用户名称",data:"accessName"},{title:"密码",data:"accessPassword"},{title:"操作",orderable:!1,data:"option"}],columnDefs:[{targets:0,data:"protocol",render:function(o,t,a){var e="";if(0<a.isEdit){for(var r in e+='<select style="border: 1px solid #F18282;" name="protocols" id="protocols" class="combobox form-control protocols">',e+='<option value="">请选择...</option>',s.protocols)s.protocols[r].protocol==o?e+='<option  value="'+s.protocols[r].protocol+'" selected = "selected" >'+s.protocols[r].protocol+"</option>":e+='<option  value="'+s.protocols[r].protocol+'">'+s.protocols[r].protocol+"</option>";e+="</select>"}else e+=o;return e}},{targets:1,data:"protocolVersion",render:function(o,t,a){var e="";if(0<a.isEdit){if(e+='<select style="border: 1px solid #F18282;" name="version" id="version" class="combobox form-control protocols">',e+='<option value="">请选择...</option>',""!=a.protocol&&null!=a.protocol)for(var r in s.protocolVersions)s.protocolVersions[r].protocol==a.protocol&&(s.protocolVersions[r].protocolVersion==o?e+='<option  value="'+s.protocolVersions[r].protocolVersion+'" selected = "selected" >'+s.protocolVersions[r].protocolVersion+"</option>":e+='<option  value="'+s.protocolVersions[r].protocolVersion+'">'+s.protocolVersions[r].protocolVersion+"</option>");e+="</select>"}else e+=o;return e}},{targets:2,data:"accessName",render:function(o,t,a){return 0<a.isEdit?"<input class='form-control col-xs-6' placeholder='不能为空、空格，最多20个字符' type='text'   maxlength='20' style='border: 1px solid #F18282;width:100%;' value='"+escape(o)+"'>":escape(o)}},{targets:3,data:"accessPassword",render:function(o,t,a){return 0<a.isEdit?"<input class='form-control col-xs-6' placeholder='不能为空、空格，最多20个字符' maxlength='20'  style='border: 1px solid #F18282;width:100%;' type='text'  value='"+escape(o)+"'>":"*********"}},{targets:4,data:"option",render:function(o,t,a){return 0<a.isEdit?"<a id='save-btn' class='btn btn-default btn-sm' style='margin-right: 10px;'>  <i class='fa fa-save  hidden-lg hidden-md hidden-sm'></i> <span class='hidden-xs'> 保存</span></a><a id='cancel-btn' class='btn btn-default btn-sm' > <i class='fa fa-times  hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 取消</span>  </a>":"<a id='edit-btn' class='btn btn-default btn-sm' style='margin-right: 10px;'>  <i class='fa fa-edit  hidden-lg hidden-md hidden-sm'></i> <span class='hidden-xs'> 编辑</span></a><a id='del-btn' class='btn btn-default btn-sm' > <i class='fa fa-times  hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 删除</span>  </a>"}}]};var i=function(){t.getAllCollectionPlugins(function(o){var t={};0==o.code&&(o.data.forEach(function(o){t[o.protocol]||(t[o.protocol]=o,s.protocols.push(o))}),s.protocolVersions=o.data)})};s.addProve=function(){var o={protocol:"",protocolVersion:"",accessName:"",accessPassword:"",domainPath:"",id:null,isEdit:3};for(var t in s.approveGridData.data){if(null==s.approveGridData.data[t].id)return s.approveGridData.data[t]=o,void s.$broadcast(Event.APPROVEINIT,s.approveGridData);if(2==s.approveGridData.data[t].isEdit||3==s.approveGridData.data[t].isEdit)return void r.warning("请保存后再操作！",{})}s.approveGridData.data.unshift(o),s.$broadcast(Event.APPROVEINIT,s.approveGridData)},s.doAction=function(o,a){"save"==o?null==a.id?t.addEnterpriseAccessAccount(a,function(o){if(0==o.code){for(var t in s.approveGridData.data)if(null==s.approveGridData.data[t]){s.approveGridData.data[t]=o.data,s.approveGridData.data[t].isEdit=0;break}s.getDBdata(),r.success("新增认证用户成功",{})}}):t.updateEnterpriseAccessAccount(a,function(o){if(0==o.code){for(var t in s.approveGridData.data)if(a.id==s.approveGridData.data[t].id){s.approveGridData.data[t]=o.data,s.approveGridData.data[t].isEdit=0;break}s.$broadcast(Event.APPROVEINIT,s.approveGridData),r.success("修改认证用户成功",{})}}):"delete"==o?n.show({title:"提示",closable:!1,message:"确认要删除该认证用户",buttons:[{label:"确定",cssClass:"btn-success",action:function(o){t.deleteEnterpriseAccessAccount(a.id,function(o){if(0==o.code){for(var t in r.success("删除认证用户成功!",{}),s.approveGridData.data)s.approveGridData.data[t].id==a.id&&s.approveGridData.data.splice(t,1);s.$broadcast(Event.APPROVEINIT,s.approveGridData)}}),o.close()}},{label:"取消",action:function(o){o.close()}}]}):"cancel"==o&&s.getDBdata()},s.getDBdata=function(){t.getEnterpriseAccessAccounts(function(o){0==o.code&&(s.approveGridData.data=o.data,s.$broadcast(Event.APPROVEINIT,s.approveGridData))})},a.user.isAuthenticated?(s.getDBdata(),i()):s.$on("loginStatusChanged",function(o,t){a.user.isAuthenticated&&(s.getDBdata(),i())})}])});
//# sourceMappingURL=../../../map/app-uc/js/controllers/approve-ctrl.js.map
