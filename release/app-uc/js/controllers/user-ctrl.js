define(["controllers/controllers"],function(controllers){"use strict";controllers.initController("loginCtr",["$scope","$rootScope","Info","userLoginUIService",function(o,s,e,i){o.user={username:"",password:""},o.errorMsg="",o.slide="1",o.$watch("user.username",function(e,r){o.errorStatus=0}),o.$watch("user.password",function(e,r){o.errorStatus=0}),o.loginClick=function(e){var r=window.event?e.keyCode:e.which;if(13==r||null==r){if(""==o.user.username)return o.errorStatus=1,void(o.errorMsg="登录名不能为空");if(""==o.user.password)return o.errorStatus=2,void(o.errorMsg="密码不能为空");""!=o.user.username&&""!=o.user.password?i.login(o.user.username,o.user.password):(o.errorMsg="请输入用户名或密码",o.errorStatus=1)}},o.checkClick=function(){"checked"==$("#checkServe").attr("checked")?($("#checkServe").show(),$("#checkName").hide(),$("#checkServe").attr("checked",!1)):($("#checkServe").hide(),$("#checkName").show(),$("#checkServe").attr("checked",!0))},o.homeClick=function(){window.open("http://www.proudsmart.com")},s.indexShow=!1,s.personalShow=!0;var c=function(){var e=i.user.industry;e&&0!=e?0==i.user.loginTimes?window.location.href="../password.html":window.location.href="app/index.html":i.user.appData?0==i.user.loginTimes?window.location.href="../password.html":window.location.href="app/index.html":0==i.user.loginTimes?window.location.href="../password.html":window.location.href="apps.html"};i.user.isAuthenticated?c():o.$on("loginStatusChanged",function(e,r){i.user.isAuthenticated?(s.staffName=i.user.userName,o.userInfo=i.user,c()):(o.errorMsg=i.result.message,o.errorStatus=1)})}]),controllers.initController("personalController",["$scope","userEnterpriseService","growl","Info","userLoginUIService","$rootScope","userIdentifyService","modelDefinitionService","resourceUIService","userUIService","configUIService",function($scope,userEnterpriseService,growl,Info,userLoginUIService,$rootScope,userIdentifyService,modelDefinitionService,resourceUIService,userUIService,configUIService){$scope.userEdit="",$scope.provinces="",$scope.districts="",$scope.citys="",$scope.loginname="",$scope.selectLoginName="";var pro=function(){resourceUIService.getSimpleDistricts(function(e){if(0==e.code){for(var r in $scope.provinces=e.data,$scope.provinces)if($scope.provinces[r].label==$scope.userEdit.enterprise.province){if("北京市"==$scope.userEdit.enterprise.province||"天津市"==$scope.userEdit.enterprise.province||"上海市"==$scope.userEdit.enterprise.province||"重庆市"==$scope.userEdit.enterprise.province){var o=$scope.provinces[r].children;for(var s in o)o[s].label==$scope.userEdit.enterprise.province&&($scope.citys=o[s].children)}else $scope.citys=$scope.provinces[r].children;$scope.districts=[]}for(var i in $scope.citys)$scope.citys[i].label==$scope.userEdit.enterprise.city&&($scope.districts=$scope.citys[i].children)}})};$scope.configGroupsDic={},$scope.configGroups=[],$scope.userTypeAry={};var configList=function configList(){configUIService.getAllConfigs(function(returnObj){if(0==returnObj.code&&(returnObj.data.forEach(function(e){$scope.configGroupsDic[e.groupName]=e}),$scope.configGroups=returnObj.data,returnObj.data&&null!=$scope.configGroupsDic.UserType)){var userType=eval("("+$scope.configGroupsDic.UserType.value+")");userType.forEach(function(e){$scope.userTypeAry[e.typeCode]=e})}})};userLoginUIService.user.isAuthenticated?($rootScope.staffName=userLoginUIService.user.userName,$scope.userInfo=jQuery.extend(!0,{},userLoginUIService.user),$scope.userEdit=jQuery.extend(!0,{},userLoginUIService.user),$scope.selectLoginName=userLoginUIService.user.loginName,configList(),pro()):$scope.$on("loginStatusChanged",function(e,r){userLoginUIService.user.isAuthenticated&&($rootScope.staffName=userLoginUIService.user.userName,$scope.userInfo=jQuery.extend(!0,{},userLoginUIService.user),$scope.userEdit=jQuery.extend(!0,{},userLoginUIService.user),$scope.selectLoginName=userLoginUIService.user.loginName,configList(),pro())}),$scope.proChang=function(){pro()},$scope.$watch("loginname",function(){$scope.loginname=""}),$scope.userEdit=jQuery.extend(!0,{},userLoginUIService.user),$scope.editData={},modelDefinitionService.findAllIndustry(function(e){for(var r=e.data,o=e.data,s=[],i=0;i<r.length;i++)for(var c=0;c<o.length;c++)r[i].id==o[c].parentModelId&&s.push(o[c]);$scope.belongList=s});var info=Info.get("localdb/info.json",function(e){$scope.provinceList=e.cityList,$scope.durationArr=e.durationList,$scope.scaleArr=e.scaleList});$scope.editClick=function(){$scope.editData.officePhone=$scope.userEdit.officePhone,$scope.editData.userID=$scope.userEdit.userID,$scope.editData.userName=$scope.userEdit.userName,$scope.editData.loginName=$scope.selectLoginName,void 0!==$scope.userEdit.officePhone?""!=$scope.userEdit.userName?""!=$scope.selectLoginName&&null!=$scope.selectLoginName&&null!=$scope.selectLoginName?""!=$scope.selectLoginName&&null!=$scope.selectLoginName&&$scope.selectLoginName!=$scope.userInfo.loginName?userUIService.checkLoginName($scope.selectLoginName,function(e){if(0==e.code){if(0==e.data)return $scope.loginname="error",void growl.warning("该登录名已存在，请修改！",{});personSave($scope.editData)}}):personSave($scope.editData):growl.warning("登录名不能为空",{}):growl.warning("显示名称不能为空",{}):growl.warning("联系电话格式不对，请重新输入",{})};var personSave=function(e){userUIService.modifyUser(e,function(e){0==e.code?($scope.userInfo.loginName=$scope.selectLoginName,growl.success("保存成功",{})):growl.error("保存失败",{})})};$scope.editEnterpriseEClick=function(){var e={};e.enterpriseSize=$scope.userEdit.enterprise.enterpriseSize,e.duration=$scope.userEdit.enterprise.duration,e.name=$scope.userEdit.enterprise.name,e.enterpriseID=$scope.userEdit.enterpriseID,e.province=$scope.userEdit.enterprise.province,e.city=$scope.userEdit.enterprise.city,e.district=$scope.userEdit.enterprise.district,e.address=$scope.userEdit.enterprise.address,e.website=$scope.userEdit.enterprise.website,e.contact=$scope.userEdit.enterprise.contact,e.contactEmail=$scope.userEdit.enterprise.contactEmail?$scope.userEdit.enterprise.contactEmail:"",e.contactPhone=$scope.userEdit.enterprise.contactPhone?$scope.userEdit.enterprise.contactPhone:"",userEnterpriseService.modifyEnterpriseInfo(e,function(e){0==e.code?(userLoginUIService.user.enterprise=e.data,growl.success("保存成功",{})):growl.error("保存失败",{})})},$rootScope.indexShow=!1,$rootScope.personalShow=!0}])});
//# sourceMappingURL=../../../map/app-uc/js/controllers/user-ctrl.js.map
