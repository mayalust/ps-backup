define([],function(){return function(r){var n,a=r.global,i=(r.traverseRow,r.traverseColumn),s=r.element,o=(r.timeout,r.previewMode),c=s.$attr("parameters/col"),l=$("<div></div>").addClass("repeater"),d=s.children[0],p={},u=s.$attr("advance/getListTable");return $$.runExpression(s.$attr("advance/expression"),function(e){if("0"==e.code){var t=e.data;n=(n="function"==typeof t?t(r,system):t)||{}}else n={};!function(e){var t=e.$attr("on/init");d.col=[Math.floor(12/c),12%c];s.render=function(a){var e=[],t=function(t){var e=d.$clone();return e.traveseByChild(function(e){void 0===e.$repeatData?Object.defineProperty(e,"$repeatData",{value:t,enumerable:!1}):e.$repeatData=t}),e};for(var r in a)e.push(t(a[r]));p.children=e,p.traverse(function(){}),Object.defineProperty(p,"parent",{value:s.parent,enumerable:!1}),l.children().remove(),i(l,p.children,o,function(n){n.createCurrentStatusByItem=function(e,t){var r,n,a;$(".pupop").remove(),r=400<=t.screenWidth-t.clientX?t.clientX+5:t.clientX-405,n=$("<div class='pupop'></div>"),a=$('<i class="fa fa-times" ></i>'),n.css({"z-index":"99","min-width":"400px",height:"84px",position:"fixed","box-shadow":"1px 1px 10px 1px rgba(0,0,0,.5)",border:"1px solid #000",left:r+"px",top:t.clientY+"px",overflow:"auto","background-color":"rgba(30,65,93,.9)"}),a.css({position:"absolute",right:"2px","font-size":"16px"}),a.click(function(){$(".pupop").remove()}),n.append(a);var i=$("<table></table>"),o=$("<tr><td>基地</td><td>厂部</td><td>产线</td><td style='width: 150px'>设备名称</td></tr>");i.css({width:"100%","text-align":"center","margin-top":"15px"}),o.css({"border-bottom":"1px solid #eee",padding:"5px 6px 1px 6px"}),i.append(o);for(var c=0;c<e.length;c++){var d=s.getdomainNameHandler(e[c].domainPath,[]),p=$("<tr><td>"+d[0]+"</td><td>"+d[1]+"</td><td>"+d[2]+"</td><td>"+e[c].label+"</td></tr>>");i.append(p)}return n.append(i),l.append(n),l},$$.runExpression(n.$attr("advance/expression"),function(e){if("0"!=e.code)throw new Error(e.message);var t=e.data,r=(("function"==typeof t?t(a):t)||{}).$attr("on/repeat");setTimeout(function(){r&&r({target:n,data:n.$repeatData})},200)})})};if(o)if("function"==typeof t)try{t({target:s,global:a})}catch(e){console.warn(e)}else"newdevice"==u?s.getLatestDevices(function(e){s.render(e)}):"workorder"==u?s.getTicketsByStatus(function(e){s.render(e)}):"energyType"==u?s.energyTypeList(function(e){s.render(e)}):"allprojects"==u?s.getCurrentProjects(function(e){s.render(e)}):"alert"==u?s.getAlerts(function(e){s.render(e)}):"currentDirectiveByDevice"==u?s.currentDirective(function(e){s.render(e)}):"currentAlertByDevice"==u?s.getCurrentAlert(function(e){s.render(e)}):"currentAlertByProject"==u&&s.getCurrentAlertByProject(function(e){s.render(e)});else i(l,s.children,o)}(n)}),l}});
//# sourceMappingURL=../../map/toolkit/component/repeater.js.map
