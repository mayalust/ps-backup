define([],function(){return function(e,n,t){var i,r,u,a,l,o=n.nodesDes,f=n.kpisDes,p=n.format,s=n.frequency,c=n.aggregate_rule,h=n.autoFillBlank,m=n.simulate,g=function(e,n){var t=new Date(e);return t.setMilliseconds(0),6e4<=n&&(t.setSeconds(0),36e5<=n&&(t.setMinutes(0),864e5<=n&&t.setHours(0))),t.getTime()},v=function(){var e=[];if(0<s){var n=a%s==0||parseInt(a/s);l%s==0||parseInt(l/s);n=g(a,s);for(var t=g(l,s);n<t;t-=s)e.push(t);e.push(n),e=e.sort(function(e,n){return e-n})}else for(var t in i)e.push(i[t].time);return 0==e.length&&e.push("-"),e},d=function(n){return r.map(function(e){return"function"==typeof n?n({ci:e.ci.label,kpi:e.kpi.label}):e.ci.label+"-"+e.kpi.label})},k=function(){return o.map(function(e){return e.label})},b=function(){return f.map(function(e){return e.label})},D=function(){return r},y=function(){var e=[],n=function(e){return e.FormatByString(p)};if(0<s)e=v().map(function(e){return n(new Date(e))});else for(var t in i)e.push(n(new Date(i[t].time)));return 0==e.length&&e.push("-"),[e]},S=function(t){return r.map(function(e){var n;return n="function"==typeof t?t({ci:e.ci.label,kpi:e.kpi.label}):e.ci.label+"-"+e.kpi.label,0==e.data.length&&(e.data=[null]),{name:n,data:e.data}})},w=function(e){var n=e.ci.id,t=e.kpi.id;return i.filter(function(e){return n==e.nodeId&&t==e.kpiCode})},I=function(o){var f=[],t=function(e,n){var t,i,r=[];for(var u in o)t=o[u].timeStamp,i=o[u],n<=t&&t<n+s&&r.push(i.value);if(0==c)0<r.length?f.push(r[r.length-1]):h&&null!=f[f.length-1]?f.push(f[f.length-1]):f.push("-");else if(1==c)0<r.length?f.push(r[0]):h&&null!=f[f.length-1]?f.push(f[f.length-1]):f.push("-");else if(2==c)if(0<r.length){var a=0;for(var l in r)a+=r[l];f.push((a/r.length).toFixed(2))}else h&&f[f.length-1!=void 0]?f.push(f[f.length-1]):f.push("-")};return 0<s?function(){var e=v();for(var n in e)t(0,e[n])}():function(){for(var e in o)f.push(o[e].value)}(),f},M=function(e){for(var n in r=function(e,n){var t=[];for(var i in e)for(var r in n)t.push({ci:e[i],kpi:n[r]});return t}(o,f),i=e.map(function(e){var n=new Date(e.arisingTime).getTime();return{kpiCode:e.kpiCode,nodeId:e.nodeId,time:e.arisingTime,timeStamp:n,value:e.value,picked:!1}}),u=i.map(function(e){return e.timeStamp}),a=Math.min.apply(null,u),l=Math.max.apply(null,u),r)r[n].data=I(w(r[n]));t({rawData:e,getLegend:d,timestamps:v(),getResources:k,getKpis:b,getDataMap:D,getxAxis:y,getSeries:S})};m?require(["simulate_time"],function(e){M(e("time",o,f,m))}):M(e)}});
//# sourceMappingURL=../../../map/toolkit/component/explainer/time_natual.js.map
