define(["commonMethod"],function(){return function(data){var kpiQueryModel={},element=data.element,location=data.location,buttonEnabled=data.buttonEnabled,resourceUIService=data.resourceUIService,global=data.global,window=data.window,serviceCenterService=data.serviceCenterService,innerContent=$("<div class='small-box'></div>"),units=[],previewMode=data.previewMode,$controller=data.route.current.$$route.controller,expression;element.resource_applied=[],element.kpi_applied=[],Object.defineProperty(element,"resource_applied",{enumerable:!1}),Object.defineProperty(element,"kpi_applied",{enumerable:!1}),$$.runExpression(element.$attr("advance/expression"),function(e){if("0"==e.code){var t=e.data;expression=(expression="function"==typeof t?t(data):t)||{}}else expression={}});var clickFn=expression.$attr("on/click");element.setResource=function(e){element.resource_applied=e};var renderItem=function(t){var e=t.$attr("series/0/data/0")?t.$attr("series/0/data/0"):{},n=$("<div></div>").addClass("inner"),i=$("<span></span>").text(null==e.value||null==e.value?"-":e.value).css("color",element.parameters.fontcolor),r=$("<span></span>").css("font-size","20px").text(e.unit?e.unit:"").css("color",element.parameters.fontcolor),a=$("<h3></h3>"),o=$("<p></p>").text(e.name?e.name:"-").css("color",element.parameters.fontcolor),l=$("<div></div>").addClass("icon"),c=$("<i></i>").addClass(element.parameters.icon.perfix+" "+element.parameters.icon.css).css("font-size","70px").css("pointer-events","none");l.append(c),a.append(i).append(r).append(l),n.append(a),n.append(o),innerContent.css("color",element.parameters.fontColor),innerContent.css("background-color",element.parameters.bgcolor),innerContent.append(n),innerContent.append(l),previewMode&&clickFn&&"freeBoardCtrl"!=$controller&&(innerContent.css("cursor","pointer"),innerContent.on("click",function(e){try{clickFn({global:global,data:t,element:element})}catch(e){}}))},setTitle=function(e,t){e.title.text=t},setSubtitle=function(e,t){e.title.subtext=t},setUnit=function(e,t){e.title.unit=t},setSeries=function(e,t){e.series=t},setParameters=function(e,t,n){var i,r,a,o=element.data.applied?"bind":"manual";setTitle(e,t.title),setSubtitle(e,t.subtitle),setUnit(e,t.unit),setSeries(e,(i=element.data.series[o],r=n,$$.runExpression(i,function(e){if("0"!=e.code)throw new Error(e.message);var t=e.data;a="function"==typeof t?t(r):t}),"function"==typeof a?a(r):null==a?[]:a))},run=function run(){var getCiKpi_back=function getCiKpi_back(ci,kpi){var checkNoEmptyArray=function(e){return e instanceof Array&&0<e.length};checkNoEmptyArray(element.resource_applied)||(element.resource_applied=ci),element.resource_applied=element.resource_applied?element.resource_applied:ci,element.kpi_applied=kpi;var baseOption={title:{},series:[{}]};function getValueList(e){inrun(e)}function failure(e){inrun(e)}function inrun(e){var t={title:{},series:[{}]};setParameters(t,element.parameters,e),renderItem(t)}kpiQueryModel={category:"ci",isRealTimeData:!0,nodeIds:element.resource_applied.map(function(e){return e.id}),kpiCodes:element.kpi_applied.map(function(e){return e.id}),timeRange:"",statisticType:"psiot",includeInstance:!0,condList:[]},element.data.applied?serviceCenterService.units.getAll().then(function(data){units=data;var category=element.$attr("advance/category")?element.$attr("advance/category"):"time",condi=element.$attr("advance/condition"),condition;condi=condi||"";try{condition=eval(condi)}catch(e){}var method=element.$attr("advance/getfunction")?element.$attr("advance/getfunction"):"kpiDataService.getValueList",type=element.$attr("advance/paramtype")?element.$attr("advance/paramtype"):"kpi";serviceCenterService.getValueListBytime(element.resource_applied,element.kpi_applied,void 0,void 0,void 0,category,type,method,condition).then(getValueList,failure)}):inrun({})};element.getCiKpi(getCiKpi_back)};element.render=function(){run()};var initFn=expression.$attr("on/init");if(initFn)try{initFn({target:element,global:global})}catch(e){}else"function"==typeof element.data.defer?element.data.defer(function(){run()}):run();for(var i in element)element.hasOwnProperty(i)&&"function"==typeof element[i]&&Object.defineProperty(element,i,{enumerable:!1});return element.style&&innerContent.css(element.style),innerContent}});
//# sourceMappingURL=../../map/toolkit/component/totalItem.js.map
