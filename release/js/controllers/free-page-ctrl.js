function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}define(["controllers/controllers","Array"],function(e){"use strict";function t(v,b,m,w,I,n,e,h,t,S,r,C){var L,a,O=S.page?S.page:"index",x=S.parameter;a=S.viewId,v.naviClick=function(e,t){n.location.href="../app-free-style/index.html#/"+a+"/"+e+"/"+encodeURIComponent(JSON.stringify(t))},b.setCurrentTab=function(e){},v.bgColorFn=function(e){return{"background-color":e||"#eee"}},v.instance={};var o=function(o){if(v.setting=o.setting,o.setting&&(v.bgColor=o.setting.color),o.hasOwnProperty("groups")){var t,i,e=O.split("|");i=x?JSON.parse(x):[],0<e.length?t=e[e.length-1]:e=[t=O];var l="",s=[],n=function(e,t){var n=o.groups.find(function(e){return t==e.path});if(n){l=""==l?t:l+"|"+t;var r,a=i[e];"object"==_typeof(a)&&null!=a&&(r=a.tabLabel),s.push({label:r||n.label,link:l,param:i.slice(0,parseInt(e)+1)})}};for(var r in e)n(r,e[r]);v.navigation=s;var a={};if(S.parameter&&(a=(y=JSON.parse(S.parameter))[y.length-1]),b.parameter=a,"panel"==t){var u,c,d=a.modelId,f=a.resourceId;v.navigation=v.navigation.concat({label:a.tabLabel?a.tabLabel:"设备仪表板",link:l+"|panel"});m.getManagedViewsByTypeAndRole("dashboard",function(e){0==e.code?(u=e.data,m.getDefaultView(d,function(e){if("0"==e.code){var t=e.data.find(function(e){return!!e.template&&e.template.resourceId==d}),n=u.find(function(e){var t=e.viewId;return!!e.template&&e.template.resourceId==d&&C.user.roleResList.some(function(e){return e.resId==t&&21==e.resType})});n?c=n:t&&(c=t),c?m.getViewById(c.viewId,function(e){var a,o;if("0"==e.code){var i=e.data.content;w.getModelByIds([d],function(e){"0"==e.code&&(a=e.data[0]);var r=function(e){if("0"==e.code&&(o=e.data,null!=i)){var t=JSON.parse(i),n={layout:t.data?t.data:t.layout,setting:t.setting};delete t.data;var r=new h.replaceCiKpi(n,function(){I(function(){v.instance.setMode(!0),v.instance.renderLayout(r,null,v)})},{model:a,resource:o},t)}};f?w.getResourceById(f,r):w.getResources(function(e){0==e.code&&(v.resources=e.data,v.resource=v.resources[0],v.itemchange=function(e){var t=e.id.split("number:")[1],n=v.resources.find(function(e){return e.id==t});n&&r({code:0,data:n})},r({code:0,data:v.resources[0]}))})})}}):v.error="没有找到相应的设备仪表板视图，点击<a href='#/views/dashboard' style='cursor:pointer; text-decoration: underline;'>Dashboard管理</a>创建设备仪表板"}else v.error="视图列表为空，请联系系统管理员"})):v.error="获取视图列表发生错误，请联系系统管理员"})}else{var p=o.groups.find(function(e){return t==e.path});v.tabIndex=p?o.groups.indexOf(p):0,v.tabs=o.groups,L={layout:o.groups[v.tabIndex].layout,setting:o.setting};var g=new h.replaceCiKpi(L,function(){I(function(){v.instance.setMode(!0),v.instance.renderLayout(g,null,v)})},null,o)}}else if(o.hasOwnProperty("data")){v.navigation=[{label:"运营首页"}],L={layout:o.data,setting:o.setting};g=new h.replaceCiKpi(L,function(){I(function(){v.instance.setMode(!0),v.instance.renderLayout(g,null,v)})},null,o)}else if(o.hasOwnProperty("layout")){v.navigation=[{label:"运营首页"}],L={layout:o.layout,setting:o.setting};g=new h.replaceCiKpi(L,function(){I(function(){v.instance.setMode(!0),v.instance.renderLayout(g,null,v)})},null,o)}var y};if("help"==a){e.get("../localdb/help.json",function(e){o(e)})}else m.getViewById(a,function(e){if(0==e.code&&null!=e.data){var t=e.data.content,n=JSON.parse(t);o(n)}else v.error="此用户无配置首页视图"+(e.message?","+e.message:"")});v.selectEditDataGroup=function(e){v.tabIndex=e.id,L={layout:e.layout,setting:v.editData.setting},v.editData=new h.replaceCiKpi(L,function(){I(function(){v.editData.renderBoard(!0,!0)})})}}e.registerController("freePageCtrl",t),t.$inject=["$scope","$rootScope","viewFlexService","resourceUIService","$timeout","$window","Info","freeboardservice","growl","$routeParams","freeboardBaseService","userLoginUIService"]});
//# sourceMappingURL=../../map/js/controllers/free-page-ctrl.js.map
