define(["directives/directives"],function(e){"use strict";e.initDirective("renderHtml",["$timeout","$compile","$filter",function(e,t,n){return{restrict:"A",scope:{renderHtml:"="},link:function(e,i,t){e.$watch("renderHtml",function(e,t,n){e&&$(i).html(e)})}}}]),e.initDirective("advanceTab",["$timeout","$compile","$filter",function(e,t,n){return{restrict:"E",templateUrl:"../partials/advance_tab.html",replace:!0,scope:{toolbars:"="},link:function(a,e,t){a.tabLabelLists=[{id:"0",name:"工作台"}],a.toolbarHandler=function(n,e){var t={id:a.isShowContent=n,name:e},i=!0;a.tabLabelLists.forEach(function(e,t){e.id==n&&(i=!1)}),i&&a.tabLabelLists.push(t)},a.deleteItemTab=function(e,t){a.tabLabelLists.splice(e,1),a.isShowContent=a.tabLabelLists[e-1].id},a.isShowContent=0,a.selecItemTab=function(e,t){a.isShowContent=e}}}}]),e.initDirective("treeMenu",["$timeout","$compile","$filter",function(e,t,n){return{restrict:"AE",template:' <div class="tree-menu">\n                    <ul>\n                        <li ng-repeat="firstMenu in resetTreeData">\n                            <a href="" ng-class="{false:\'inactive\'}[firstMenu.children.length == 0]"\n                               ng-bind="firstMenu.name">\n                            </a>\n                            <ul style="display: none">\n                                <li ng-repeat="secondMenu  in firstMenu.children">\n                                    <a href="" ng-class="{false:\'inactive\',true:\'\'}[secondMenu.children.length == 0]"\n                                       ng-bind="secondMenu.name">\n                                    </a>\n                                    <ul>\n                                        <li ng-repeat="thirdMenu  in secondMenu.children">\n                                            <a href="" ng-class="{false:\'inactive\',true:\'\'}[secondMenu.children.length == 0]" ng-bind="thirdMenu.name"></a>\n                                            <ul>\n                                                <li ng-repeat="fourthMenu  in thirdMenu.children">\n                                                    <a href="" ng-class="{false:\'\',true:\'\'}[fourthMenu.children.length == 0]" ng-bind="fourthMenu.name"></a>\n                                                </li>\n                                            </ul>\n                                        </li>\n                                    </ul>\n                                </li>\n                            </ul>\n                        </li>\n                    </ul>\n                </div>',link:function(e,t,n){e.resetTreeData=function(e){var t;for(var n in e.push({id:0}),e)if(null!=e[n].parentID){var i=e[n].parentID,a=e.find(function(e){return e.id==i});null==a.children&&(a.children=[]),(e[n].parent=a).children.push(e[n])}else t=e[n];return t}([{id:0,name:"all"},{parentID:0,id:1,name:"韶关松山基地"},{parentID:0,id:2,name:"上海宝山基地"},{parentID:0,id:3,name:"湛江东山基地"},{parentID:0,id:4,name:"南京梅山基地"},{parentID:2,id:2001,name:"2250产线"},{parentID:2,id:2002,name:"1580产线"},{parentID:2001,id:3001,name:"风机电机"},{parentID:2001,id:3002,name:"风机叶轮"},{parentID:2001,id:3003,name:"主转动电机"},{parentID:2001,id:3004,name:"助燃风机"},{parentID:3001,id:4001,name:"冲击有效值"},{parentID:3001,id:4002,name:"冲击峰值"},{parentID:3001,id:4003,name:"速度有效值"},{parentID:3001,id:4004,name:"速度峰值"},{parentID:3002,id:4001,name:"冲击有效值"},{parentID:3002,id:4002,name:"冲击峰值"},{parentID:3002,id:4003,name:"速度有效值"},{parentID:3002,id:4004,name:"速度峰值"}]).children,setTimeout(function(){$(".inactive").click(function(){"none"==$(this).siblings("ul").css("display")?($(this).parent("li").siblings("li").removeClass("inactives"),$(this).addClass("inactives"),$(this).siblings("ul").slideDown(200).children("li"),"block"==$(this).parents("li").siblings("li").children("ul").css("display")&&($(this).parents("li").siblings("li").children("ul").parent("li").children("a").removeClass("inactives"),$(this).parents("li").siblings("li").children("ul").slideUp(200))):($(this).removeClass("inactives"),$(this).siblings("ul").slideUp(200),$(this).siblings("ul").children("li").children("ul").parent("li").children("a").addClass("inactives"),$(this).siblings("ul").children("li").children("ul").slideUp(200),$(this).siblings("ul").children("li").children("a").removeClass("inactives"))})})}}}]),e.initDirective("importBtn",function(){return{restrict:"A",link:function(c,e,d,t){var a={msg:"xlsx",rABS:"../node_modules/js-xlsx/xlsxworker2.js",norABS:"../node_modules/js-xlsx/xlsxworker1.js",noxfer:"../node_modules/js-xlsx/xlsxworker.js"},o="false"!=d.rabs,n="false"!=d.transferable,l="false"!=d.useworker,u=d.format?d.format:"json";function r(e){for(var t="",n=0,i=10240;n<e.byteLength/i;++n)t+=String.fromCharCode.apply(null,new Uint8Array(e.slice(n*i,n*i+i)));return t+=String.fromCharCode.apply(null,new Uint8Array(e.slice(n*i)))}function i(e,n){var t=new Worker(o?a.rABS:a.norABS);if(t.onmessage=function(e){switch(e.data.t){case"ready":break;case"e":console.error(e.data.d);break;default:var t=function(e){for(var t="",n=0,i=10240;n<e.byteLength/i;++n)t+=String.fromCharCode.apply(null,new Uint16Array(e.slice(n*i,n*i+i)));return t+=String.fromCharCode.apply(null,new Uint16Array(e.slice(n*i)))}(e.data).replace(/\n/g,"\\n").replace(/\r/g,"\\r");n(JSON.parse(t))}},o){var i=function(e){for(var t=new ArrayBuffer(2*e.length),n=new Uint16Array(t),i=0;i!=e.length;++i)n[i]=e.charCodeAt(i);return[n,t]}(e);t.postMessage(i[1],[i[1]])}else t.postMessage(e,[e])}function s(e,t){n?i(e,t):function(e,t){var n=new Worker(a.noxfer);n.onmessage=function(e){switch(e.data.t){case"ready":break;case"e":console.error(e.data.d);break;case a.msg:t(JSON.parse(e.data.d))}};var i=o?e:btoa(r(e));n.postMessage({d:i,b:o})}(e,t)}function p(e){var t=e.target.files;if(t&&0!=t.length){var n=t[0],i=new FileReader;n.name;i.onload=function(e){if("undefined"!=typeof console)var t=e.target.result;if(l)s(t,f);else{var n;if(o)n=XLSX.read(t,{type:"binary"});else{var i=r(t);n=XLSX.read(btoa(i),{type:"base64"})}f(n)}},o?i.readAsBinaryString(n):i.readAsArrayBuffer(n)}}function f(e){var t,n,i,a,o,l,r;switch(u){case"json":r={},(l=e).SheetNames.forEach(function(e){var t=XLSX.utils.sheet_to_row_object_array(l.Sheets[e]);0<t.length&&(r[e]=t)}),t=r;break;case"form":o=[],(a=e).SheetNames.forEach(function(e){var t=XLSX.utils.get_formulae(a.Sheets[e]);0<t.length&&(o.push("SHEET: "+e),o.push(""),o.push(t.join("\n")))}),t=o.join("\n");break;default:i=[],(n=e).SheetNames.forEach(function(e){var t=XLSX.utils.sheet_to_csv(n.Sheets[e]);0<t.length&&(i.push("SHEET: "+e),i.push(""),i.push(t))}),t=i.join("\n")}var s=c[d.loadcomplete];s?s(t):growl.warning("无法批量添加该数据",{})}require(["xlsx"],function(){e.parent().append('<input type="file" style="display:none" accept="application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet">'),e.on("click",function(){e.nextAll("input").click(),e.nextAll("input").on("change",p)})})}}}),e.initDirective("stringToNumber",function(){return{require:"ngModel",link:function(e,t,n,i){i.$parsers.push(function(e){return""+e}),i.$formatters.push(function(e){return parseFloat(e)})}}}),e.initDirective("slickSlide",["$timeout",function(l){var e={};return e.scope={options:"=",click:"&"},e.restrict="A",e.link=function(a,o,e){$(o).css("width","calc(100 - 30px)"),$(o).css("margin","0 15px");a.$watch("options",function(e,t,n){var i=function(e){$(o).children().remove();var t=function(e,t){var n=$("<div></div>").text(t.title);n.addClass("inner-item");var i=function(e){a.$apply(function(){a.click({item:t})})};return n.on("click",i),n};for(var n in e)$(o).append(t(n,e[n]));l(function(){var e=function(e){$(o).slick({slidesToShow:8,slidesToScroll:8,arrows:!0})};$$.loadExternalJs(["slick"],e)})};null!=e&&i(e)})},e}]),e.initDirective("maxlength",["$timeout",function(e){var t={};return t.scope={maxlength:"=",ngModel:"="},t.restrict="A",t.link=function(n,e,t){var i=n.maxlength;$(e).on("keyup",function(e){var t=$(this).val();n.$apply(function(){t.length>i&&(n.ngModel=t.slice(0,i))})})},t}]),e.initDirective("dropdowntree",["$timeout",function(a){var e={};return e.scope={ngModel:"=",disabled:"=",options:"=",label:"=",change:"&",fontsize:"=",width:"=",dtMark:"=",dtKey:"=",key:"@",placeholder:"@"},e.restrict="C",e.link=function(b,y,w){a(function(){var h,m,s=""==b.placeholder?"":b.placeholder?b.placeholder:"请选择...",c=b.label?b.label:"text",e=b.dtKey,t=b.dtMark;m=e||(w.key?w.key:"id"),h=t||(w.mark?w.mark:"children");var n="form-control";$(y).css("width",b.width),w.selectclass?n=w.selectclass:w.class&&(-1<w.class.search("input-sm")||-1<w.class.search("select-sm"))&&(n="form-control input-sm");var v=$("<select></select>").addClass(n),g=[];function i(e,t,n){if(e){var i,a=e,o=$("<div></div>").attr("id","container").addClass("noview").css("border-top","1px solid #ddd"),l=$("<div></div>").addClass("children");if(i=jQuery.isArray(a)?a:a[h],w.showclear){var r={key:null};r[c]=s,i=[r].concat(i)}v.find("[id*=selectlabel]").remove(),!a[m]||a[m]!=b.ngModel&&a[m]!=w.model?v.append($("<option id='selectlabel'>"+s+"</option>")):v.append($("<option id='selectlabel'>"+(a.label?a.label:"请选择...")+"</option>")),o.append(l),y.find("[id*=container]").remove(),y.append(o),i&&function u(e,p,f){e.forEach(function(t){var n=$("<div></div>").addClass("wrap"),i=$("<div></div>").addClass("glyphicon"),e=$("<span></span>").addClass("labeltxt"),a=$("<div></div>").addClass("children"),o=t[h],l=function t(e){if(e.viewId==b.ngModel)return!0;if(e.hasOwnProperty(h)){var n=function(e){return t(e)};for(var i in e[h])if(n(e[h][i]))return!0}return!1};i.data("children",o);var r,s,c=b.label?b.label:"label";t.label=t[c],e.text(t.label?t.label:t.text);for(var d=0;d<=f;d++)r=$("<div></div>").addClass("vline"),(s=d)==f-1&&r.addClass("last"),r.css("left",10+8*s+"px"),n.append(r);n.append(i),n.append(e),n.attr(m,t[m]),n.css("padding-left",8*f+"px"),g.push(n),p.append(n),t[m]!=b.ngModel&&t[m]!=w.model||(v.children().remove(),v.append($("<option id='selectlabel' value='selectlabel'>"+(t.label?t.label:"请选择...")+"</option>"))),n.on("click",function(e){b.$apply(function(){v.children().remove(),v.append($("<option id='selectlabel' value='selectlabel'>"+(t.label?t.label:"请选择...")+"</option>")),g.forEach(function(e){e.removeClass("active")}),n.addClass("active"),w.hasOwnProperty("model")?(w.model=t[m],$(y).attr("model",t[m])):b.ngModel=t[m],$("body").trigger("click.body"),w.hasOwnProperty("ngModel")&&w.ngModel||b.change({data:{value:t[m]}})})}),o?(0==l(t)?(a.addClass("hidechildren"),i.addClass("glyphicon-plus")):i.addClass("glyphicon-minus"),i.on("click",function(e){e.stopPropagation(),i.hasClass("glyphicon-minus")?(i.removeClass("glyphicon-minus").addClass("glyphicon-plus"),a.css("overflow","hidden"),a.animate({height:"100%",opacity:0},300,function(){a.css({display:"none"}).css("overflow","auto")})):(i.removeClass("glyphicon-plus").addClass("glyphicon-minus"),a.css("overflow","hidden").css("display","block"),a.animate({height:"100%",position:"absolute",opacity:1},300))}),p.append(a),u(o,a,f+1)):i.addClass("glyphicon glyphicon-duplicate").css("opacity",0)})}(i,l,1)}else y.find("[id*=container]").remove()}v.on("mousedown",function(e){e.preventDefault()}),1!=b.disabled?v.on("click",function(e){b.$apply(function(){var e=$(y).find("[id*=container]");function t(){e.addClass("noview"),$("body").off("click.body"),v.removeClass("extend")}e.hasClass("noview")&&(e.removeClass("noview"),v.addClass("extend"),a(function(){$("body").on("click.body",t)}))})}):v.attr("disabled","disabled"),y.append(v),w.hasOwnProperty("ngModel")&&w.ngModel&&b.$watch("ngModel",function(n,e,t){g.forEach(function(e){e.removeClass("active")}),n||(v.children().remove(),v.append($("<option id='selectlabel' value='selectlabel'>"+s+"</option>")));if(n&&b.options){var i;i=jQuery.isArray(b.options)?b.options:b.options[h];var a=function t(e){e.forEach(function(e){e[m]==n?(v.children().remove(),v.append($("<option id='selectlabel' value='selectlabel'>"+(e.label?e.label:"请选择...")+"</option>")),g.forEach(function(e){e.attr(m)==n&&e.addClass("active")})):e[h]&&t(e[h])})};a(i)}b.change&&n!=e&&b.change({data:n})}),w.hasOwnProperty("options")&&w.options&&(b.options&&(jQuery.isArray(b.options)&&0<b.options.length||b.options[h])?i(b.options):b.$watch("options",i))})},e}]),e.initDirective("daterangePicker2",["$timeout","$filter",function(e,b){return{restrict:"A",require:"?ngModel",link:function(r,o,s,l){var c,d="YYYY-MM-DD",t=!1,n=!0,i=!0,a=!0,u="right",p=!1,f=!1,h=30;s.intervaldays&&(h=Number(s.intervaldays)),s.iszero&&(p="true"==s.iszero),s.limitendtime&&(f="true"==s.limitendtime),s.opens&&(u=s.opens);var m="up";s.drops&&(m=s.drops),s.timepicker&&(t="true"==s.timepicker,d=t?"YYYY-MM-DD HH:mm:ss":"YYYY-MM-DD"),s.autoapply&&(n="true"==s.autoapply),s.timepicker24hour&&(i="true"==s.timepicker24hour),s.timepickerseconds&&(a="true"==s.timepickerseconds);var v=function(e){return b("date")(e?e.getTime():(new Date).getTime(),t&&!p?"yyyy-MM-dd HH:mm:ss":"yyyy-MM-dd")},g=0;o.on("show.daterangepicker",function(e,t){1==g&&(g++,o.trigger("click"))}),o.on("hide.daterangepicker",function(e,t){g=0}),o.on("showCalendar.daterangepicker",function(e,t){if(0==g){var n;if(g++,(n=r[s.model])||(n=r.$parent[s.model]),!n)return;var i=v(),a=v(new Date((new Date).getTime()-24*h*60*60*1e3)),o=n[s.startdate]?n[s.startdate]:a,l=n[s.enddate]?n[s.enddate]:i;t.setStartDate(o),t.setEndDate(l)}}),o.on("hideCalendar.daterangepicker",function(e,t){}),o.on("apply.daterangepicker",function(e,t){var n;if(c=t,(n=r[s.model])||(n=r.$parent[s.model]),n){var i=t.startDate.format(d),a=t.endDate.format(d);n[s.startdate]=i,n[s.enddate]=a,l.$modelValue=i+"到"+a,o.val(l.$modelValue),r.$apply()}}),o.on("cancel.daterangepicker",function(e,t){var n;if((n=r[s.model])||(n=r.$parent[s.model]),n){n[s.startdate]="",n[s.enddate]="",l.$modelValue="",o.val(l.$modelValue),g=0;var i=v(),a=v(new Date((new Date).getTime()-24*h*60*60*1e3));t?(t.setStartDate(a),t.setEndDate(i)):c&&(c.setStartDate(a),c.setEndDate(i))}}),r.$watch(s.ngModel,function(e,t){!e&&t&&o.trigger("cancel")}),r.clearSelectTime=function(){o.trigger("cancel")},e(function(){require(["bootstrap-daterangepicker"],function(e){o.daterangepicker({singleDatePicker:!1,showDropdowns:!0,timePicker:t,timePicker24Hour:i,timePickerSeconds:a,autoApply:n,autoUpdateInput:!1,minDate:t?"1980-01-01 00:00:00":"1980-01-01",maxDate:t?f?v():"2099-12-31 23:59:59":f?v():"2099-12-31",opens:u,drops:m,locale:{format:d,applyLabel:"确定",cancelLabel:"清除",daysOfWeek:["日","一","二","三","四","五","六"],monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],firstDay:1}})})},200)},controller:["$scope","$element","$attrs",function(e,t,n){}]}}]),e.initDirective("dateTimePicker",["$timeout","$compile","$filter",function(e,t,m){return{restrict:"A",require:"?ngModel",scope:{ngModel:"="},link:function(a,o,i,l){var r,s="YYYY-MM-DD",c=!1,t=!0,n=!0,d=!0,u=!1,p="right";i.opens&&(p=i.opens);var f="up";i.drops&&(f=i.drops),i.timepicker&&(c="true"==i.timepicker,s=c?"YYYY-MM-DD HH:mm:ss":"YYYY-MM-DD"),i.autoapply&&(t="true"==i.autoapply),i.timepicker24hour&&(n="true"==i.timepicker24hour),i.timepickerseconds&&(d="true"==i.timepickerseconds),i.iszero&&(u="true"==i.iszero);var h=0;o.on("show.daterangepicker",function(e,t){1==h&&(h++,o.trigger("click"))}),o.on("hide.daterangepicker",function(e,t){h=0}),o.on("showCalendar.daterangepicker",function(e,t){if(0==h&&!o.val()&&c){h++;var n=m("date")((new Date).getTime(),c&&!u?"yyyy-MM-dd HH:mm:ss":"yyyy-MM-dd");t.setStartDate(n),t.setEndDate(n)}else if(0==h&&a.ngModel){h++;var i=a.ngModel;t.setStartDate(i),t.setEndDate(i)}}),o.on("apply.daterangepicker",function(e,t){var n=(r=t).startDate.format(s);a.$apply(function(){if(o.val(n),l&&l.$setViewValue(t.startDate._d),i.ngClick){var e=a.$parent[i.ngClick];e&&e()}})}),o.on("cancel.daterangepicker",function(e,t){o.val(""),l&&l.$setViewValue("");var n=m("date")((new Date).getTime(),c&&!u?"yyyy-MM-dd HH:mm:ss":"yyyy-MM-dd");t?(t.setStartDate(n),t.setEndDate(n)):r&&(r.setStartDate(n),r.setEndDate(n))}),a.$watch("ngModel",function(e,t){!e&&t&&o.trigger("cancel"),e&&o.val(m("date")(new Date(e),c&&!u?"yyyy-MM-dd HH:mm:ss":"yyyy-MM-dd"))}),e(function(){require(["bootstrap-daterangepicker"],function(e){$(o).daterangepicker({singleDatePicker:!0,showDropdowns:!0,timePicker:c,timePicker24Hour:n,timePickerSeconds:d,autoApply:t,autoUpdateInput:!1,minDate:c?"1980-01-01 00:00:00":"1980-01-01",maxDate:c?"2025-12-31 23:59:59":"2025-12-31",opens:p,drops:f,locale:{format:s,applyLabel:"确定",cancelLabel:"清除",daysOfWeek:["日","一","二","三","四","五","六"],monthNames:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"]}},function(e,t,n){})})},200)}}}]),e.initDirective("domainPicker",["$compile","$timeout",function(n,e){return{restrict:"A",link:function(o,l,r,e){require(["bootstrap-treeview"],function(e){l.on("shown.bs.popover",function(){var e=$("#treeview1");n(e)(o);var t=function e(t){if(!r.gatewaydomainpath)return t;for(var n in t)return t[n].domainPath==r.gatewaydomainpath?[t[n]]:e(t[n].domains)}(o.domainListTree);e.treeview({data:t,onNodeSelected:function(e,t){if(""!=t.domainPath){if(l.attr("domainPath",t.domainPath),l.popover("hide"),r.model){var n=r.model.split("."),i=o;for(var a in n)if(i){if(a==n.length-1){i[n[a]]=t.domainPath;break}i=i[n[a]]}}l.val(t.name).change()}}})})})},controller:["$scope","$element","$attrs",function(e,t,n){t.attr("readonly",!0),t.data("content","<div id ='treeview1' slim-scroll height='220px'></div>"),t.popover({html:!0,trigger:"manual",placement:"auto bottom"}),t.on("click",function(){t.popover("show"),t.siblings(".popover").on("mouseleave",function(){t.popover("hide")})}),t.on("mouseleave",function(){setTimeout(function(){$(".popover:hover").length||t.popover("hide")},100)})}]}}]),e.initDirective("modelPicker",["$compile","$timeout",function(t,e){return{restrict:"A",link:function(o,l,r,e){require(["bootstrap-treeview"],function(e){r.userparent&&(o=o.$parent),l.on("shown.bs.popover",function(){var e=$("#treeview1");t(e)(o),e.treeview({data:o.rootModel.nodes,onNodeSelected:function(e,t){if(l.attr("modelId",t.id),l.popover("hide"),r.model){var n=r.model.split("."),i=o;for(var a in n)if(i){if(a==n.length-1){i[n[a]]=t.id;break}i=i[n[a]]}}l.val(t.label).change()}})})})},controller:["$scope","$element","$attrs",function(e,t,n){t.attr("readonly",!0),t.data("content","<div id ='treeview1' slim-scroll height='220px'></div>"),t.popover({html:!0,trigger:"manual",placement:"auto bottom"}),t.on("click",function(){t.popover("show"),t.siblings(".popover").on("mouseleave",function(){t.popover("hide")})}),t.on("mouseleave",function(){setTimeout(function(){$(".popover:hover").length||t.popover("hide")},100)})}]}}]),e.initDirective("sensorPopover",["$compile","$timeout",function(o,l){return{restrict:"A",require:"ngModel",link:function(i,t,a,n){l(function(){var e='<div class="box form-group" style="margin-bottom:0;border-top:0;width:400px;"><div class="box-header with-border"><h3 class="box-title">'+a.vlaue+"</h3>";n.$modelValue.directive&&(e+='<input type="checkbox" class="switch" data-size="mini" data-on-text="关闭" data-off-text="启动" bootstrap-switch ngvalue="'+n.$modelValue.kpiValue+'" ngid="'+n.$modelValue.directive.id+'">'),e+='<div class="box-tools pull-right"><a href="#/emcsView/'+n.$modelValue.id+'" class="btn btn-box-tool"><i class="fa fa-area-chart">报表</i></a><a href="#/configAlert/'+n.$modelValue.id+'/node" class="btn btn-box-tool"><i class="fa fa-warning">告警</i></a><a href="#/resource_type/'+n.$modelValue.modelId+'/alert" class="btn btn-box-tool"><i class="fa fa-cog">阈值</i></a></div></div><div class="box-body no-padding" ><div echarts3-dom name="sensorMain" style="height:170px"></div></div></div>',t.data("content",o(e)(i)),t.popover({html:!0,trigger:"manual",placement:"bottom"}).on("click",function(){t.popover("show"),t.siblings(".popover").on("mouseleave",function(){t.popover("hide")})}).on("mouseleave",function(){setTimeout(function(){$(".popover:hover").length||t.popover("hide")},100)});t.on("show.bs.popover",function(){var e=[];n.$modelValue.instance&&e.push(n.$modelValue.instance),i.getHierarchyValue([n.$modelValue.id],[n.$modelValue.kpiCode],e,function(e){var t,n;e&&(n={tooltip:{trigger:"axis"},grid:{x:55,y:10,x2:40,y2:25},toolbox:{show:!1,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["line","bar"]},restore:{show:!0},saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",boundaryGap:!1,data:(t=e).times}],yAxis:[{type:"value",scale:!0,interval:a.chartinterval?Number(a.chartinterval):null,min:a.min?Number(a.min):"auto",max:a.max?Number(a.max):"auto",axisLabel:{formatter:"{value}"}}],series:[{name:a.vlaue,type:"line",data:t.data,markLine:{data:[{type:"average",name:"平均值"}]}}]},l(function(){i.$broadcast(Event.ECHARTINFOSINIT,{name:"sensorMain",option:n})}))})}),t.on("shown.bs.popover",function(){}),t.on("hidden.bs.popover",function(){})})}}}]),e.initDirective("kpiSlick",["$timeout","$compile",function(t,s){return{restrict:"A",require:"ngModel",link:function(o,l,r,e){require(["slick"],function(e){t(function(){var i=r.fontsize?r.fontsize:"48px",a=0,n=(r.itemid,r.itemlabel,function(e){if(0<a)for(;0<a;a--)l.slick("slickRemove",a-1);for(var t in e){var n='<div ng-click="viewDetail(item)" class="box-body"><p class="text-muted text-center">'+("NA"!=e[t].value?e[t].value:"-")+("NA"==e[t].value||"NA"==e[t].unit?"":e[t].unit)+'</p><div style="width : 74px; height : 67px;" class="btn '+e[t].stateStyle+'"><i style="font-size:'+i+'" class="'+e[t].icon+'"></i></div><h5 class="text-center">'+e[t].label+"</h5></div>";l.slick("slickAdd",s(n)(o)),a++}});o.$watch(r.ngModel,function(e){n(e)}),o.$on("kpiSlickValue",function(e,t){r.itemid==t.id&&n(t.value)})})})},controller:["$scope","$element","$attrs",function(e,t,n){require(["slick"],function(e){t.slick({dots:!1,arrows:!0,draggable:!1,slidesToScroll:5,variableWidth:!0,infinite:!1})})}]}}]),e.initDirective("slick",["$timeout",function(g){return{restrict:"A",link:function(t,i,a){var o=!1,l=!1,r=!0;a.autorender&&(r="true"==a.autorender);var s=!1;a.autoplay&&(s="true"==a.autoplay);var c=3e3;a.autoplayspeed&&(c=a.autoplayspeed);var d=!1;a.arrows&&(d="true"==a.arrows);var u=!0;a.dots&&(u="true"==a.dots);var p=!1;a.variablesidth&&(p="true"==a.variablesidth);var f=!0;a.draggable&&(f="true"==a.draggable);var h=1;a.slidestoscroll&&(h=a.slidestoscroll);var m=1;a.slidestoshow&&(m=a.slidestoshow);var v=!1;a.infinite&&(v="true"==a.infinite),i.on("beforeChange",function(e,t,n,i){}),i.on("init",function(e,t){}),i.on("reInit",function(e,t){}),t.$on("ngRepeatFinished",function(e){o||(l=!0)}),require(["slick"],function(e){var n=function(){o?i.slick("unslick"):o=!0,i.slick({dots:u,arrows:d,draggable:f,swipeToSlide:!0,slidesToScroll:h,slidesToShow:m,infinite:v,autoplay:s,variableWidth:p,autoplaySpeed:c})};r||l?g(function(){n()}):t.$on("ngRepeatFinished",function(e){o||n()}),t.$on("ngRepeatDelFinished",function(e,t){g(function(){i.slick("slickRemove",!0,!0,!0),n()},100)}),t.$watch(a.ngModel,function(e,t){e!==t&&o&&(i.slick("slickRemove",!0,!0,!0),n())})})}}}]),e.initDirective("slimScroll",["$timeout","$parse",function(o,l){return{restrict:"A",link:function(t,n,i){var a=function(){var e=$(window).height()-(i.offseth?Number(i.offseth):200);o(function(){n.slimScroll({width:i.width?i.width:"auto",height:i.height?i.height:e})})};i.hasOwnProperty("ngHide")||i.hasOwnProperty("ngShow")?i.$observe("ngShow",function(e){t.$watch(function(){return l(e)(t)},function(e){e&&a()})}):a()}}}]),e.initDirective("iCheck",["$timeout","$parse",function(s,c){return{link:function(o,l,r){require(["iCheck"],function(e){var t=r.boxclass,n=r.radioclass;r.boxclass||(t="icheckbox_square-blue"),r.radioclass||(n="iradio_square-blue");var i=r.value,a=c(r.ngModel);return s(function(){o.$watch(r.ngModel,function(e){$(l).iCheck("update")}),$(l).iCheck({labelHover:!1,checkboxClass:t,increaseArea:"20%",radioClass:n}).on("ifChanged",function(e){if(r.change){var t=o[r.change];t&&t(o.item)}var n=$(l).attr("type");if("checkbox"===n&&r.ngModel)o.$apply(function(){return a.assign(o,e.target.checked)});else if("radio"===n&&r.ngModel)return o.$apply(function(){return a.assign(o,i)})})})})}}}]),e.initDirective("baiduWeather",["$timeout","$parse","$http","weatherService",function(c,e,t,n){return{restrict:"A",templateUrl:function(e,t){return t.templateurl?t.templateurl:"partials/weather.html"},link:function(s,e,t){return c(function(){s.$on("updateWeatherFinish",function(e,t){!function(e){var t=[],n=[],i=[];if(s.weathers.data&&0==s.weathers.data.error)for(var a=1;a<4;a++){var o=s.weathers.data.results[0].weather_data[a];t.push(o.date);var l=o.temperature.split(" ~ ");n.push(l[0]),i.push(l[1].split("℃")[0])}var r={tooltip:{trigger:"axis"},grid:{borderWidth:0,x:15,y:5,x2:15,y2:5},toolbox:{show:!1,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["line","bar"]},restore:{show:!0},saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",show:!1,boundaryGap:!1,data:t}],yAxis:[{type:"value",show:!1,axisLabel:{formatter:"{value} °C"}}],series:[{name:"最高气温",type:"line",data:n},{name:"最低气温",type:"line",data:i}]};c(function(){s.$broadcast(Event.ECHARTINFOSINIT,{name:"weatherMain",option:r})})}()}),s.updateWeather=function(e){n.getWeatherByCity(e,function(e){0==e.code&&(s.weathers={data:JSON.parse(e.data)},s.$broadcast("updateWeatherFinish"))})},s.$watch(t.ngModel,function(e){e||(e="北京"),s.updateWeather(e)})})}}}]),e.initDirective("dateLabel",["$compile","$timeout","$filter",function(e,t,o){return{restrict:"EA",link:function(e,t,n,i){var a=o("date")(n.value,n.format);t.context.innerHTML=a}}}]),e.initDirective("sglclick",["$parse",function(l){return{restrict:"A",link:function(t,e,n){var i=l(n.sglclick),a=0,o=null;e.on("click",function(e){1===++a?o=setTimeout(function(){t.$apply(function(){i(t,{$event:e})}),a=0},100):(clearTimeout(o),a=0)})}}}]),e.initDirective("bootstrapSwitch",function(){return{restrict:"A",link:function(n,i,a){require(["bootstrap-switch"],function(e){$(i).bootstrapSwitch({state:0!=a.ngvalue}),$(i).on("switchChange.bootstrapSwitch",function(e,t){n[a.model]!=t&&n.$emit("switchChange",{nodeId:"",id:a.ngid,itemDirValues:t?1:0})}),a.hasOwnProperty("model")&&n.$watch(a.model,function(e,t){e!=t&&$(i).bootstrapSwitch("state",e)})})}}}),e.initDirective("select2",["$parse",function(d){return{restrict:"A",require:"?ngModel",link:function(a,o,l,r){var s=!1,c=function(e){s&&(s=!1,$(o).data("select2")&&($(o).select2("destroy"),e&&$(o).empty()))},i=function n(i){require(["select2"],function(e){if($(o).hasClass("ng-hide"))l.$observe("ngShow",function(e){a.$watch(function(){return d(e)(a)},function(e){e?n(a[l.selectdata]):c(i)})});else{c(i);var t={multiple:!1,language:{noResults:function(){return l.noresults?l.noresults:"没有该匹配项"}},placeholder:l.placeholder?l.placeholder:"请选择..."};i&&(t.data=i),$(o).children("[value$='?']").remove(),$(o).select2(t),s=!0,a.select2init=function(e){$(o).val(e).trigger("change.select2")},$(o).on("select2:select",function(e){if(e.params){var t=a[l.itemchange];t&&t(e.params.data)}}),r.$modelValue||a.select2init()}})};a.$watch(l.ngModel,function(e,t){e&&!t?s&&i():i()}),a.$watch(l.selectdata,function(e,t,n){(e&&0<e.length||e!=t)&&a.$evalAsync(function(){i()})})}}}]),e.initDirective("bootstrapMultiselect",function(){return{restrict:"A",link:function(t,n,i){require(["bootstrap-multiselect"],function(e){n.multiselect({nonSelectedText:i.nonselectedtext?i.nonselectedtext:"请选择...",numberDisplayed:i.numberdisplayed?i.numberdisplayed:5,nSelectedText:"项被选中",allSelectedText:"全选中",enableFiltering:"true"==i.enablefiltering,filterPlaceholder:"搜索",templates:{filter:'<li class="multiselect-item multiselect-filter"><div class="input-group"><input class="form-control multiselect-search" type="text"></div></li>'},buttonWidth:i.buttonwidth?i.buttonwidth:"",buttonClass:i.buttonclass?i.buttonclass:"btn btn-default btn-sm",onDropdownShow:function(e,t){0==$(".multiselect-group select option").length&&($(".multiselect-group select").append("<option value='Value'>没有该匹配项</option>"),n.multiselect("rebuild"),$(".multiselect-group ul li:last-child").html('<label  style="cursor:default;text-align: center;display: inline-block;width: 100%;font-weight: 400;"> 没有该匹配项</label>'),$(".multiselect-group select").empty())},onChange:function(e,t){}}),t.$watch(function(){return n[0].length},function(){n.multiselect("rebuild")}),i.selectvalues?(n.multiselect("select",i.selectvalues.split(",")),i.selectvalues=""):t.$watch(i.ngModel,function(e,t){e&&(i.selectvalues?(n.multiselect("select",i.selectvalues.split(",")),i.selectvalues=""):n.multiselect("refresh"))})})}}}),e.initDirective("uploaderDiv",function(){return{restrict:"AE",template:'<div class="input-group"><input id="nv-file-select" style="display:none" class="form-control input-sm" type="file" nv-file-select uploader="uploader"><input type="text" disabled class="form-control input-sm" ng-model="uploader.queue[0].file.name" placeholder="请选择一个文件"><span class="input-group-btn"><button class="btn btn-default btn-sm" type="button" ng-click="toggle()"><i class="proudsmart ps-add"></i></button></span></div>',replace:!0,link:function(e,t,n){e.toggle=function(){$("#nv-file-select").click()}}}}),e.initDirective("uploaderDiv2",["$rootScope",function(i){return{restrict:"AE",scope:{},template:'<div class="input-group"><input id="nv-file-select" style="display:none" class="form-control input-sm" type="file" nv-file-select uploader="uploader"><input type="text" disabled class="form-control input-sm" ng-model="uploader.fileBelongDic[fileBelongId][0].file.name" placeholder="请选择一个文件"><span class="input-group-btn"><button class="btn btn-default btn-sm" type="button" ng-show="!uploader.fileBelongDic[fileBelongId] || uploader.fileBelongDic[fileBelongId].length == 0" title="添加文件" ng-click="toggle()"><i class="proudsmart ps-add"></i></button><button class="btn btn-default btn-sm" type="button" ng-show="uploader.fileBelongDic[fileBelongId].length > 0" title="上传" ng-click="uploader.uplaodHandler()"><i class="glyphicon glyphicon-upload"></i></button><button class="btn btn-default btn-sm" type="button" ng-show="uploader.fileBelongDic[fileBelongId].length > 0" title="清空" ng-click="uploader.clearHandler()"><i class="glyphicon glyphicon-trash"></i></button></span></div>',replace:!0,controller:["$scope","$element","$attrs",function(e,t,n){e.uploader=i.uploader}],link:function(e,t,n){e.fileBelongId=t[0].parentElement.id,e.toggle=function(){0<e.uploader.queue.length?e.uploader.growl("当前有未上传的文档，请上传或者清空"):(i.uploader.fileBelongId=e.fileBelongId,$("#nv-file-select").click())}}}}]),e.initDirective("sortable",["$timeout","$compile","$filter",function(e,t,n){return{restrict:"E",scope:{ngModel:"=",source:"=",target:"=",eventUpdate:"&",setting:"="},template:'<div ng-class="setting.boxClass"><ul ng-class = "setting.ulClass"><li ng-repeat="item in source" id="{{item.id}}" ng-class="setting.liClass">{{item.label}}</li></ul><ul ng-class = "setting.ulClass">  <li ng-repeat = "item in target" ng-class = "setting.liClass" id = "{{item.id}}" > {{item.label}} </li></ul></div>',link:function(s,c,e,t){s.setting.boxClass||$(c).css("height","300px");s.watch={},s.watch.source=s.source,s.watch.target=s.target,s.$watch("watch",function(e,t,n){var i,a,o,l,r;e&&(i=$(c).find("ul"),a=50,o=3,l="",r={},s.setting&&s.setting.placeholder&&(l=s.setting.placeholder),s.setting&&s.setting.delay&&(a=s.setting.delay),s.setting&&s.setting.distance&&(o=s.setting.distance),s.setting&&s.setting.type&&"connectWith"==s.setting.type&&(r={connectWith:"ul"}),require(["jquery-ui"],function(e){i.sortable($.extend(r,{delay:a,distance:o,dropOnEmpty:!0,placeholder:l,helper:"clone",items:">li",cursor:"move",revert:!0,scroll:!0,scrollSensitivity:10,update:function(e,t){var n=$(this).sortable("serialize",{key:"id"}),i=n.split("&").map(function(e){var t=e.split("=");return{id:parseInt(t[1])}});return s.$apply(function(){s.eventUpdate({as:n})}),i},remove:function(e,t){return{id:t.item.attr("id").split("_")[1],label:t.item.html()}},activate:function(e,t){}})).disableSelection()}))})}}}])});
//# sourceMappingURL=../../map/js/directives/tools-dom.js.map
