function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}define(["directives/directives"],function(t){"use strict";function e(t,P,z){return{restrict:"E",scope:{source:"="},replace:!0,templateUrl:"../partials/data-table-adv.html",link:function(a,t,e){var r,n=Object.prototype.toString,i=p("Array"),o=p("Object"),c=p("Function"),u=p("Number"),s=["label","type","bind","search","filter"],l=["label","on.click"],f="[object ";function h(t,e){for(var n in e)t[n]=e[n]}function p(e){return function(t){return n.call(t)==f+e+"]"}}function g(t,e){return i(e)?e[s.indexOf(t)]:o(e)?e[t]:c(e)?e[t]:null}function d(t,e){return i(e)?e[l.indexOf(t)]:o(e)?function(t,e){var n=e.split("."),r=t;for(var i in n)if(!(r=r[n[i]]))break;return r}(e,t):null}function y(){$("body").off("click.windClick"),a.$apply(function(){a.open=!1,a.searchTypeClick=b})}function b(){a.searchTypeClick=void 0,a.open=!0,P(function(){$("body").on("click.windClick",y)})}function v(t){return h((v.init=function(t){h(this,t)}).prototype,{getPageSize:function(){return t.pageSize||10},getData:function(){return t.data},push:function(t){this.data.unshift(t)},unshift:function(t){this.data.unshift(t)},remove:function(t){this.data.splice(t,1)},get:function(t){return this.data[t]},select:function(t){this.data[t].selected=!0},selectAll:function(){for(var t in a.currentPageData)a.currentPageData[t].selected=!0;a.allcheck=!0},deselectAll:function(){for(var t in a.currentPageData)a.currentPageData[t].selected=!1;a.allcheck=!1},hasButtons:function(){return i(this.bodyButtons)&&0<this.bodyButtons.length}}),new v.init(t)}function k(){P(function(){var t=a.currentPageData;i(t)&&0<t.length&&(a.allcheck=t.every(function(t){return 1==t.selected}))})}function S(t,e){return h((S.init=function(t,e){this.current=0,this.length=t,this.total=Math.ceil(t/e),this.size=e}).prototype,{setSize:function(t){this.size=t,this.total=Math.ceil(this.length/t),this.current=0,k()},setLength:function(t){this.length=t,this.total=Math.ceil(t/this.size),this.current=0,k()},getTotal:function(){return this.total},getCurrent:function(){return this.current},isFirst:function(){return 0==this.current},isLast:function(){return this.current==this.total.length-1},nextPage:function(){this.current<this.total&&this.current++,k()},prevPage:function(){0<this.current&&this.current--,k()},moveTo:function(t){this.current=t,k()},getSize:function(){return this.size},getStartPoint:function(){return this.current*this.size}}),new S.init(t,e)}a.filterResult,a.searchBy={searchFields:[]},a.sortBy={},a.buttonClass=function(t){var e=t.class;return e?"btn-"+e:"btn-default"},a.pageDescription=function(){var t=a.page.current*a.page.size+1,e=(a.page.current+1)*a.page.size;return"第 "+t+" 至 "+(e=e<a.page.length&&e||a.page.length)+" 项，共 "+a.page.length+" 项"},a.isPrevBtnDisabled=function(){return a.page.isFirst()?"disabled":""},a.isNextBtnDisabled=function(){return a.page.isLast()?"disabled":""},a.sizes=[5,10,15,20,25,50,100],a.getSize=function(){return a.page&&a.page.size||10},a.getStartPoint=function(){return a.page?a.page.getStartPoint():0},a.getData=function(t,e,n){var r=g("bind",e)||t[n];return"function"==typeof r?r(t):r},a.checkButtonShow=function(t,e){var n=d("show",t);return c(n)?n(e):!1!==n},a.getType=function(t){return g("type",t)||"text"},a.getlabel=function(t){return g("label",t)||t},a.sizeChange=function(t){a.page.setSize(t)},a.hasPages=function(){return a.page&&0<a.page.getTotal()||!1},a.ifBeforeMarkShow=function(){var t=a.page.current,e=a.page.total;return 2<t&&3<e},a.middleRange=function(){var t=[],e=a.page.current,n=a.page.total;return 1<e&&t.push(e-1),0<e&&e<n-1&&t.push(e),e<n-2&&t.push(e+1),t},a.ifAfterMarkShow=function(){var t=a.page.current,e=a.page.total;return t<e-3&&3<e},a.open=!1,a.renderClass=function(t,e){var n=_typeof(t);return"function"==n?t(e):"string"==n?t:"btn btn-default"},a.colClick=function(t,e,n,r){t.stopPropagation(),o(e)&&o(e.on)&&c(e.on.click)&&e.on.click(n,r)},a.sorting=function(t,e,n){var r="";return!1!==e.sortable&&(r+="sorting"),t.value==n&&(t.asc?r+="_desc":r+="_asc"),r},a.getButtonLabel=function(t){return d("label",t)},a.buttonClick=function(t,e){var n=d("on.click",t);if("function"==typeof n){var r=a.dataTable.data.indexOf(e);n.call(a.dataTable,e,r)}else"string"==typeof n&&z.path(n)},a.moreclick=function(t){a.open=!1;var e=!!t.open;for(var n in a.dataTable.data)a.dataTable.data[n].open=!1;t.open=!e},a.trClass=function(t,e){var n=[];if(t.selected&&n.push("selected"),"function"==typeof e){var r=e(t);r&&n.push(r)}return n.toString().replace(","," ")},a.searchTypeClick=b,a.conditionClick=function(t,e){delete a.querytype,delete a.key,delete a.keyinput,P(function(){a.key=e,a.querytype=function(t){if("string"==typeof t)return{label:t,type:"text"};if(i(t)){var e={};for(var n in t)e[s[n]]=t[n];return e}return o(t)?t:void 0}(t)})},a.goSearch=function(){h(a.searchBy,{key:a.key,keyinput:a.keyinput})},a.allClick=function(){for(var t in a.allcheck=!a.allcheck,a.currentPageData)a.key?"1"==a.currentPageData[t].queryStatus&&(a.currentPageData[t].selected=a.allcheck):a.currentPageData[t].selected=a.allcheck},a.pageChange=function(t){1!=a.wholeDisabled&&(null!=t&&(a.page=t),0<a.source.source.length?a.from=a.page*a.size+1:a.from=0,a.page<a.totalpage-1?a.to=(a.page+1)*a.size:a.to=a.total)},a.sortClick=function(t,e){(t.sortable,!0)&&(a.sortBy.value!=e?(a.sortBy.value=e,a.sortBy.asc=!0):a.sortBy.asc=!a.sortBy.asc)},a.trClick=function(t){1!=t.disabled&&0!=a.source.showSelector&&1!=a.wholeDisabled&&(t.selected=!t.selected,a.allcheck=a.currentPageData.every(function(t){return 1==t.selected}))};var D=a.$watch("source",function(t,e,n){t&&(a.dataTable=v(t),a.dataTable.getFullLength=function(){var t=a.source&&a.source.showIndex,e=a.source&&a.source.showSelector;return(a.source&&Object.keys(a.source.body).length)+(t?1:0)+(e?1:0)},a.searchBy.searchFields=function(t){var e=[];for(var n in t)!1!==t[n].search&&e.push(n);return e}(a.dataTable.body),r=a.$watch("filterResult.length",function(t,e,n){if(u(t)){var r=a.dataTable.getPageSize(),i=Math.ceil(t,r);a.page=S(i,r)}}))}),m=a.$watch("source.data",function(t,e,n){});a.$on("$destroy",function(){D&&D(),$("body").off("click.drop"),m&&m(),r&&r()})}}}t.registerDirective&&t.registerDirective("datTableDom",e)||t.directive("datTableDom",e),e.$inject=["$q","$timeout","$location"],t.filter("filtersort",function(){return function(t,e,n,r,i){var a=n.value,o=n.asc,c=r.key,u=r.keyinput,s=r.searchFields,l=(i=i||function(){},e&&e.sort);var f=function(t,e){var n=[];for(var r in t){for(var i=n.length-1;-1<i&&e(t[r],n[i]);)n[i+1]=n[i],i--;n[i+1]=t[r]}return n}(t||[],function(t,e){return"function"==typeof l?o&&l(t)>l(e)||l(t)<l(e):!1!==l?o&&t[a]>e[a]||t[a]<e[a]:void 0});function h(t,e){return"number"==typeof t&&(t+=""),-1!==(t="string"==typeof t?t:"").indexOf(e)}return f=f.filter(function(t,e){if(0==i(t,e))return!1;if(!u)return!0;if(c)return h(t[c],u);for(var e in s){if(h(t[s[e]],u))return!0}return!1})}})});
//# sourceMappingURL=../../map/js/directives/data-tables-adv-dom.js.map
