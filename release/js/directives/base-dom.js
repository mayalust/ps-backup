define(["directives/directives"],function(directives){"use strict";directives.directive("adminLiteToggle",["$timeout",function(t){var e={};return e.scope={},e.restrict="A",e.link=function(e,s,a){t(function(){$.AdminLTE.pushMenu.activate(s)})},e}]),directives.directive("viewDiv",function(){return{restrict:"AEC",templateUrl:"partials/chart.html",controller:["$scope","$element",function(e,s){console.info("进入viewDIv：controller")}],link:function(e,s,a){console.info("进入viewDIv：link")},compile:function(e,s){return{pre:function(e,s,a){console.info("进入viewDIv：preLink")},post:function(e,s,a){console.info("进入viewDIv：postLink")}}}}}),directives.directive("onFinishRenderFilters",["$timeout",function(t){return{restrict:"A",link:function(e,s,a){!0===e.$last&&t(function(){e.$emit("ngRepeatFinished")})}}}]),directives.directive("sparkline",["$timeout",function(e){return{restrict:"A",link:function(e,s,a){e.$on("ngRepeatFinished",function(e){$(".sparkbar").each(function(){var e=$(this);e.sparkline("html",{type:"bar",height:e.data("height")?e.data("height"):"30",barColor:e.data("color")})}),$(".sparkpie").each(function(){var e=$(this);e.sparkline("html",{type:"pie",height:e.data("height")?e.data("height"):"90",sliceColors:e.data("color")})}),$(".sparkline").each(function(){var e=$(this);e.sparkline("html",{type:"line",height:e.data("height")?e.data("height"):"90",width:"100%",lineColor:e.data("linecolor"),fillColor:e.data("fillcolor"),spotColor:e.data("spotcolor")})})})}}}]),directives.directive("showtab",function(){return{link:function(e,s,a){s.click(function(e){e.preventDefault(),$(s).tab("show")})}}}),directives.directive("menuMessages",["$compile","$timeout",function($compile,$timeout){return{restrict:"EA",template:'<li  ng-show="menuitems[&quot;F06&quot;]"  class="dropdown notifications-menu"><a  href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-bell-o"></i><span ng-class="{true:&quot;label label-warning&quot;,false:&quot; label btn-twinkle&quot;}[alertStatus==&quot;default&quot;]" ng-show="unread != 0" ng-bind="unread"></span></a><ul style="width: 300px;max-height: 327px;overflow: hidden;" class="dropdown-menu" ng-slimscroll ><li style="background-color:#cdcdcd;" class="header align-center info-box-number">消息通知</li><li ng-if="unread != 0" style="height: 260px;overflow: hidden;"><ul class="menu" style="max-height: 255px;overflow-y: auto;"><li class="msg-li" ng-repeat="msg in userMessage"><p style="margin: 0 0 0px;"><a href class="msg-title " ng-click="messageClick(msg);"  title="{{msg.message.title}}">{{msg.message.title}}</a><span class="pull-right msg-txt" ng-style="msg.msgSty"  ng-click="messageClick(msg);"  title="{{msg.senderTxt}}">{{msg.msgTxt}}</span></p><p style="margin: 0 0 0px;color: #cacaca;">{{msg.message.content}}</p><p style="margin: 0 0 0px;color: #cacaca;">{{msg.message.insertTime | date:"yyyy-MM-dd HH:mm:ss"}}</p></li></ul><li  ng-if="unread == 0"  style="height: 260px;text-align: center;line-height: 260px;">您暂时没有新的消息</li></li></ul><audio id="noticeAudio" preload="auto"><source src="../music/song.mp3" type="audio/mpeg"></audio></li>',replace:!0,link:function(e,s,a,t){},controller:["$scope","$location","SwSocket","growl","$element","$attrs","psMessageService","configUIService",function($scope,$location,SwSocket,growl,$element,$attrs,psMessageService,configUIService){$scope.msgSty,$scope.userMessage=[];var uuid=Math.uuid();$scope.messageTypeArr={},$scope.configGroupsArr={},$scope.alertStatus="default";var configList=function configList(){configUIService.getAllConfigs(function(returnObj){if(0==returnObj.code){if(returnObj.data.forEach(function(e){$scope.configGroupsArr[e.groupName]=e}),0<returnObj.data.length&&null!=$scope.configGroupsArr.messageType&&$scope.configGroupsArr.messageType.value){var messageType=eval("("+$scope.configGroupsArr.messageType.value+")");$scope.messageTypeArr=messageType}queryMessage()}})},messageTypeReturn=function(e){return e.message&&null!=$scope.messageTypeArr[e.message.msgType]&&(e.senderTxt=$scope.messageTypeArr[e.message.msgType].senderTxt,e.msgTxt=$scope.messageTypeArr[e.message.msgType].msgTxt,e.msgSty={"background-color":$scope.messageTypeArr[e.message.msgType].msgSty}),e},callback=function(e){var s=messageTypeReturn(e.data);if(s.message){"alert_message_insystem"==s.message.msgType||"gateway_message"==s.message.msgType||"payment_message"==s.message.msgType?("alert_message_insystem"==s.message.msgType&&$("#noticeAudio")[0].play(),growl.error("您有一条新的"+s.senderTxt,{})):"command_message"==s.message.msgType||"energyconsume_message"==s.message.msgType||"datareport_message"==s.message.msgType||"devicereport_message"==s.message.msgType?-1<s.message.title.search("失败")?growl.error(s.senderTxt+":"+s.message.title,{}):growl.info(s.senderTxt+":"+s.message.title,{}):growl.info("您有一条新的"+s.senderTxt,{});var a=e.data;taskShow(a,1)}},taskShow=function(e,s,a){var t=e;if(e){1==s&&(t=[e]);var i=[];for(var n in t){var o=messageTypeReturn(t[n]);i.push(o)}2==s?($scope.userMessage=i,$scope.unread=a):($scope.userMessage.unshift(e),0<$scope.unread?$scope.unread=$scope.unread+1:$scope.unread=1,$scope.$apply())}};$scope.messageClick=function(a){"ticket_message"==a.message.msgType||"alert_message_insystem"==a.message.msgType?psMessageService.modifyMsgStatus([a.message.messageId],function(e){if(0==e.code){for(var s in $scope.userMessage)$scope.userMessage[s].messageId==a.messageId&&$scope.userMessage.splice(s,1);$scope.unread=$scope.unread-1}}):psMessageService.modifyMsgStatus([a.message.messageId],function(e){if(0==e.code){queryMessage();$.trim(a.message.content);"ticket_message"==a.message.msgType||"ticket_maintenance_message"==a.message.msgType||("payment_message"==a.message.msgType?location.href="../app-uc/index.html#/expenses":"alert_message_insystem"==a.message.msgType||("maintenance_msg"==a.message.msgType?location.href="../app-oc/index.html#/maintenance/"+$.trim(a.message.content):location.href="../app-uc/index.html#/messageDetail/"+a.message.messageId))}})};var param={},operation="register";SwSocket.register(uuid,operation,callback),SwSocket.send(uuid,operation,"msg",param);var queryMessage=function(){psMessageService.queryMessageByStatusAndUserIDWithPage([0,{start:0,length:1e4,sortType:"DESC",sort:"_id"}],function(e){0==e.code&&taskShow(e.data.data,2,e.data.total)})};configList(),$scope.$on("$destroy",function(){SwSocket.unregister(uuid)})}]}}]),directives.directive("loading",["$timeout",function(e){return{replace:!0,restrict:"EA",link:function(e,s,a){s.append('<div id="warpShow" class="modal-backdrop fade in display-none"   style="z-index: 1040;"></div><div id="loadingShow" class="modal bootstrap-dialog type-primary fade size-normal in display-none"  role="dialog" aria-hidden="true" id="ad822433-1650-4880-8b58-ed07a2bae88f"aria-labelledby="ad822433-1650-4880-8b58-ed07a2bae88f_title"  tabindex="-1" style="z-index: 1050;  padding-left: 17px;  text-align: center;"><img style="width: 200px;margin-top: 10%;" src="../app-editor/images/loading_spinner.gif"> </div>')},controller:["$scope","$location","SwSocket","growl","$element","$attrs","psMessageService",function(e,s,a,t,i,n,o){e.$watch("loadingShow",function(e,s){e?($("#warpShow").addClass("menu-open").removeClass("display-none"),$("#loadingShow").addClass("menu-open").removeClass("display-none")):($("#warpShow").removeClass("menu-open").addClass("display-none"),$("#loadingShow").removeClass("menu-open").addClass("display-none"))})}]}}])});
//# sourceMappingURL=../../map/js/directives/base-dom.js.map
