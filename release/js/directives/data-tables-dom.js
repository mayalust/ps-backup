function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}define(["directives/directives"],function(e){"use strict";function t(e,u){return{restrict:"A",scope:{source:"="},templateUrl:"../partials/data-table.html",link:function(a,e,t){var n;a.open=!1,a.sortBy={},a.renderClass=function(e,t){var n=_typeof(e);return"function"==n?e(t):"string"==n?e:"btn btn-default"},a.colClick=function(e,t){"buttonGroup"!=t.type&&"status"!=t.type||e.stopPropagation()},a.sorting=function(e,t){var n="";return t.sortable&&(n+="sorting"),e.value==t.data&&(e.asc?n+="_desc":n+="_asc"),n},a.trClass=function(e,t){var n=[];if(e.selected&&n.push("selected"),"function"==typeof t){var o=t(e);o&&n.push(o)}return n.toString().replace(","," ")};var o=function(){$("body").off("click.windClick"),a.$apply(function(){a.open=!1,a.searchTypeClick=n})};n=function(){for(var e in a.searchTypeClick=void 0,a.open=!0,a.source.source)a.source.source[e].open=!1;u(function(){$("body").on("click.windClick",o)})},a.searchTypeClick=n;var c=function(){a.page>a.totalpage-1&&(a.page=a.totalpage-1),0<a.source.source.length?a.from=a.page*a.size+1:a.from=0,a.page<a.totalpage-1?a.to=(a.page+1)*a.size:a.to=a.total;for(var e=[],t=1;t<=a.totalpage;t++)e.push(t);a.totalpageArr=e},r=a.$watch("source",function(e,t,n){null!=e&&($("body").off("click.drop"),$("body").on("click.drop",function(e){a.$apply(function(){for(var e in a.source.source)a.source.source[e].open=!1})}),n.pageResize=0==e.pageResize,0!=e.page?n.size=10:n.size=1/0,e.setWholeDisabled=function(e){n.wholeDisabled=e})}),i=a.$watch("source.source",function(u,e,t){if(null!=u){a.totalpage=Math.ceil(u.length/a.size),a.totalpage=a.totalpage?a.totalpage:1,a.moreclick=function(e){a.open=!1;var t=!!e.open;for(var n in a.source.source)a.source.source[n].open=!1;e.open=!t};var s=function(){var n=this;u.$remove(function(e,t){return t==n}),0==u.length&&(a.allcheck=!1)},n=function e(t){var n=this,o=0,r=[];t.remove=s,t.insertAfter=e;var i,a,c=u;for(var l in c)a=c[i=l],r[parseInt(i)+o]=a,n==a&&(o=1,r[parseInt(i)+o]=t);for(var l in r)u[l]=r[l]};for(var o in u){(i=u)[r=o].remove=s,i[r].insertAfter=n}u.pushback=function(e){e.remove=s,e.insertAfter=n,u.push(e)},u.pushbefore=function(e){e.remove=s,e.insertAfter=n,u.unshift(e)},u.removeAllChecked=function(){for(var e in u)u[e].selected=!1;a.allcheck=!1},Object.defineProperty(u,"pushback",{enumerable:!1}),Object.defineProperty(u,"pushbefore",{enumerable:!1}),Object.defineProperty(u,"removeAllChecked",{enumerable:!1}),c(),a.total=u.length,a.pageChange()}var r,i}),l=a.$watch("source.source.length",function(e,t,n){null!=e&&(a.key=a.keyinput,a.total=a.source.source.filter(function(e){return null==a.querytype||""==a.querytype||null==a.key||""==a.key||-1!=e[a.querytype.data].indexOf(a.key)}).length,a.totalpage=Math.ceil(a.total/a.size),a.totalpage=a.totalpage?a.totalpage:1,c())});a.page=0,a.pagebefore=0,a.conditionClick=function(e){delete a.querytype,delete a.key,delete a.keyinput,u(function(){a.querytype=e})},a.goSearch=function(){null==a.keyinput?a.key="":a.key=a.keyinput,a.total=a.source.source.filter(function(t){if(t.selected=!1,t.queryStatus="0",void 0===a.key||""===a.key)return a.source.columnDefs.some(function(e){return!!e.filterable&&(a.key&&"object"!=_typeof(t[e.data])&&t[e.data]?(-1!=String(t[e.data]).indexOf(a.key)&&(t.queryStatus="1"),-1!=String(t[e.data]).indexOf(a.key)):!!t[e.data]&&(-1!=t[e.data].indexOf(a.key)&&(t.queryStatus="1"),-1!=t[e.data].indexOf(a.key)))});void 0!==a.querytype&&""!==a.querytype||(a.querytype=jQuery.extend(!0,{},a.source.columnDefs[0]),a.querytype.label="查询条件");var e=t[a.querytype.data];return"string"==typeof e||"number"==typeof e?"string"==typeof e?(-1!=t[a.querytype.data].indexOf(a.key)&&(t.queryStatus="1"),-1!=t[a.querytype.data].indexOf(a.key)):"number"==typeof e&&(t[a.querytype.data]==a.key&&(t.queryStatus="1"),t[a.querytype.data]==a.key):"[object Array]"===Object.prototype.toString.call(e)&&"object"==_typeof(a.key)?!!e.some(function(e){return e.roleID===a.key.roleID})&&(t.queryStatus="1",!0):void 0}).length,a.totalpage=Math.ceil(a.total/a.size),a.totalpage=a.totalpage?a.totalpage:1,c()},a.allClick=function(){for(var e in a.source.source)a.key?"1"==a.source.source[e].queryStatus&&(a.source.source[e].selected=a.allcheck):a.source.source[e].selected=a.allcheck},a.sizeChange=function(){a.totalpage=Math.ceil(a.total/a.size),a.totalpage=a.totalpage?a.totalpage:1,c()},a.pageChange=function(e){1!=a.wholeDisabled&&(null!=e&&(a.page=e),0<a.source.source.length?a.from=a.page*a.size+1:a.from=0,a.page<a.totalpage-1?a.to=(a.page+1)*a.size:a.to=a.total)},a.sortClick=function(e){if(e.sortable){var t=e.data;a.sortBy.value!=t?(a.sortBy.value=t,a.sortBy.asc=!0):a.sortBy.asc=!a.sortBy.asc}},a.trClick=function(e){if(1!=e.disabled&&0!=a.source.showSelector&&1!=a.wholeDisabled){e.selected?e.selected=!1:e.selected=!0;var t=a.source.source.every(function(e){return 1==e.selected});a.allcheck=!!t}},a.$on("$destroy",function(){r(),$("body").off("click.drop"),i(),l()})}}}function n(e,t){return{restrict:"A",scope:{ngModel:"=",columnDef:"="},link:function(o,i,e){var r=function(e,t,n){if($(i).children().remove(),"edit"==e){var o=$("<input />");o.val(n.ngModel),$(i).append(o)}else{var r=$("<span></span>").text(n.ngModel);$(i).append(r)}};o.$watch("ngModel",function(){}),o.$watch("columnDef",function(e,t,n){null!=e&&(null==e.isEdit&&(e.isEdit="default"),o.$watch("columnDef.isEdit",r))})}}}$$.isFunction(e.registerDirective)?e.registerDirective("tableDom",t):e.directive("tableDom",t),t.$inject=["$q","$timeout"],$$.isFunction(e.registerDirective)?e.registerDirective("tableSpan",n):e.directive("tableSpan",n),n.$inject=["$q","$timeout"],e.initDirective("multiSelect",["$q","$timeout",function(e,i){var t={restrict:"A",scope:{id:"=",mark:"=",options:"=",submit:"&"},link:function(a,t,e){var c=$("<select class='multiselect' multiple='multiple'></select>"),n=$("<div></div>").addClass("btn-group"),l=$("<button></button>").addClass("btn btn-primary"),o=$("<span></span>").text("添加"),r=$("<span></span>").addClass("glyphicon glyphicon-plus"),u=[];l.append(r).append(o),n.append(c).append(l),null==a.ngModel&&(a.ngModel=[]),i(function(){$$.loadExternalJs(["bootstrap-multiselect"],function(e){i(function(){$(t).append(n),a.$watch("options",function(e,t,n){function o(t,e){var n=a.options.find(function(e){return t.id==e.id});n&&e(t.id)}if(e){u=[],e.removeData=function(e){var t=[];for(var n in a.options)-1==e.indexOf(a.options[n])&&t.push(a.options[n]);a.options=t},e.appendData=function(e){var t=a.options.$clone();Array.prototype.push.apply(t,e),a.options=t},Object.defineProperty(e,"removeData",{enumerable:!1}),Object.defineProperty(e,"appendData",{enumerable:!1}),l.attr("disabled","disabled"),c.children().remove();var r=function(e){return $("<option value='"+e[a.id]+"'>"+e[a.mark]+"</option>")};if(0==a.options.length)c.multiselect("rebuild"),c.multiselect("disable");else{for(var i in a.options)c.append(r(a.options[i]));for(var i in c.multiselect("rebuild"),a.ngModel)o(a.ngModel[i],function(e){c.multiselect("select",e)})}}});l.on("click",function(e){a.$apply(function(){a.submit({data:u})})}),c.multiselect({enableFiltering:!0,buttonText:function(e){{if(0==e.length)return"没有选择";if(3<e.length)return"已选择"+e.length+"个";var t="";return e.each(function(){t+=$(this).text()+", "}),t.substr(0,t.length-2)}},onChange:function(t,o){a.$apply(function(){var n=$(t).val();if(o){var e=a.options.find(function(e){return e[a.id]==n});u.push(e)}else u.$remove(function(e,t){return t[a.id]==n});0<u.length?l.removeAttr("disabled"):l.prop("disabled","disabled")})}})})})})}};return t}])});
//# sourceMappingURL=../../map/js/directives/data-tables-dom.js.map
