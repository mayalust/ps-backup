{"version":3,"sources":["app-sc/js/directives/tglibrary-dom.js"],"names":["define","directives","echarts","slick","tgSlickDir","q","timeout","compile","serviceCenterService","directive","restrict","scope","previewList","mode","click","link","element","$previewList_watcher","n","o","s","data","Array","length","j","$","find","size","removeAllSlick","units","getAll","then","i","index","TOP_TEXT","BLOCK_IMAGE","BOTTOM_TEXT","$slickItem","$pdom","$block","$idom","$h5dom","unit","kpi","unitSymbol","ele","unitCode","unitName","attr","addClass","css","width","height","append","on","$apply","dots","arrows","draggable","slidesToScroll","variableWidth","infinite","$watch","tgImageDir","blk","window","event","ipcamDir","ic","url","document","tooltip","position","my","at","using","feedback","this","vertical","horizontal","appendTo","openCam","value","closeCam","removeAttr","requesturl","ipcaminfo","loginauth","goalurl","resizable","handle","containment","parent","snap","snapMode","ajax","type","contenttype","success","parseJSON","username","password","ip","port","tgDragDir","chart","target","helper","result","border","revert","cursor","cursorAt","tgDropDir","onDrop","droppable","drop","ui","ready","tgElementDir","stopResize","stopMove","aspectRatio","scale","stop","echartsDir","setOption","option","_option_","pushData","time","series","shift","xAxis","push","parseFloat","ci","init","id","resize","tgRotateDir","rotate","highLight","clearTimeout","to","setTimeout","animate","opacity","scrollbarDir","control","setValue","slider","onChange","range","slide","onSlide","sendDeviceDirective","blinkDir","startBlink","blinkFn","selector","duration","complete","stopBlink","toggleDir","template","tg","removeClass","parseInt","registerDirective","$inject"],"mappings":"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","file":"app-sc/js/directives/tglibrary-dom.js","sourcesContent":["define(['directives/directives', 'echarts', 'jquery-ui', 'slick', 'Array'], function (directives, echarts, slick) {\n  'use strict';\n\n  directives.registerDirective(\"tgSlick\", tgSlickDir);\n  tgSlickDir.$inject = ['$q', '$timeout', '$compile', 'serviceCenterService'];\n\n  function tgSlickDir(q, timeout, compile, serviceCenterService) {\n    var directive = {};\n    directive.restrict = \"A\";\n    directive.scope = {\n      previewList: \"=\",\n      mode: \"@\",\n      click: \"&\"\n    };\n\n    directive.link = function (scope, element) {\n      //use : 1. add a attribute 'tg-slick' to your tab (with or without a value);\n      timeout(domReady);\n\n      function domReady() {\n        initSlick();\n        scope.$watch(\"previewList\", $previewList_watcher);\n      }\n\n      function initSlick() {\n        $(element).slick({\n          dots: false,\n          arrows: true,\n          draggable: false,\n          slidesToScroll: 5,\n          variableWidth: true,\n          infinite: false\n        });\n      }\n\n      function $previewList_watcher(n, o, s) {\n        var newLength, oldLength;\n        newLength = n instanceof Array ? n.length : 0; //oldLength = o instanceof Array ? o.length : 0;\n\n        if (newLength > 0) {\n          removeAllSlick();\n          renderSlick(n);\n        }\n\n        function removeAllSlick() {\n          //remove all slick element one by one.\n          var length = $(element).find(\".slick-list [slickItem]\").size();\n\n          for (var j = length - 1; j > -1; j--) {\n            $(element).slick('slickRemove', j);\n          }\n        }\n\n        function renderSlick(data) {\n          serviceCenterService.units.getAll().then(function (units) {\n            for (var i in data) {\n              (function (index) {\n                var TOP_TEXT, BLOCK_IMAGE, BOTTOM_TEXT, $wrap, $slickItem, $pdom, $block, $idom, $h5dom;\n                var unit;\n\n                if (scope.previewList[index].kpi != null) {\n                  unit = scope.previewList[index].kpi.unit;\n                }\n\n                var unitSymbol = units.find(function (ele) {\n                  return ele.unitCode == unit;\n                }); //initialize 3 parameters used to display kpi information\n\n                TOP_TEXT = \"previewList[\" + index + \"].value + '\" + (unitSymbol ? unitSymbol.unitName : '') + \"'\";\n                BLOCK_IMAGE = \"previewList[\" + index + \"].kpi.icon\";\n                BOTTOM_TEXT = \"previewList[\" + index + \"].label\"; //prepare jquery dom object to compile.\n                //$wrap = $('<div>{{mode}}</div>');\n\n                $slickItem = $('<div></div>').attr(\"slickItem\", '').addClass(\"box-body\");\n                $pdom = $('<p></p>').addClass(\"text-muted text-center\").attr(\"ng-bind\", TOP_TEXT);\n                $block = $('<div></div>').addClass(\"btn btn-ps-normal\").css({\n                  width: \"72px\",\n                  height: \"72px\"\n                });\n                $idom = $('<i></i>').addClass(\"ps-lg\").attr(\"ng-class\", BLOCK_IMAGE);\n                $h5dom = $('<h5></h5>').addClass(\"text-center\").attr(\"ng-bind\", BOTTOM_TEXT);\n                $block.append($idom);\n                $slickItem.append($pdom).append($block).append($h5dom); //$wrap.append($slickItem);\n                //compile jquery object to angularjs.\n\n                $(element).slick('slickAdd', compile($slickItem)(scope));\n                $slickItem.on(\"click\", function () {\n                  scope.$apply(function () {\n                    scope.click();\n                  });\n                });\n              })(i);\n            }\n          }); //render slick in a clean and empty container.\n        }\n      }\n    };\n\n    return directive;\n  }\n\n  directives.registerDirective(\"tgImage\", tgImageDir);\n  tgImageDir.$inject = ['$q', '$timeout'];\n\n  function tgImageDir(q, timeout) {\n    var directive = {};\n    directive.restrict = \"A\";\n    directive.scope = {\n      blk: \"=\"\n    };\n\n    directive.link = function (scope, element, attr) {\n      timeout(function () {\n        var width = $(element).width();\n        $(element).height(width * 720 / 1024);\n      });\n      $(window).on(\"resize\", function (event) {\n        var width = $(element).width();\n        $(element).height(width * 720 / 1024);\n      });\n    };\n\n    return directive;\n  }\n\n  directives.registerDirective(\"ipcam\", ipcamDir);\n  ipcamDir.$inject = ['$q', '$timeout'];\n\n  function ipcamDir(q, timeout) {\n    var directive = {};\n    directive.restrict = \"A\";\n    directive.scope = {\n      ic: \"=\"\n    };\n\n    directive.link = function (scope, element, attr) {\n      var url;\n      $(function () {\n        $(document).tooltip({\n          position: {\n            my: \"center bottom-20\",\n            at: \"center top\",\n            using: function using(position, feedback) {\n              $(this).css(position);\n              $(\"<div>\").addClass(\"arrow\").addClass(feedback.vertical).addClass(feedback.horizontal).appendTo(this);\n            }\n          }\n        });\n      });\n      timeout(function () {\n        scope.$watch(\"ic\", function (n, o, s) {\n          if (n) {\n            n.openCam = function (value) {\n              if (url) {\n                $(element).find(\"#videoDiv\").attr(\"src\", url);\n              }\n            };\n\n            n.closeCam = function (value) {\n              if (url) {\n                $(element).find(\"#videoDiv\").removeAttr(\"src\");\n              }\n            };\n          }\n        });\n        var ipcaminfo = {},\n            loginauth = \"\",\n            goalurl = \"\";\n        $(element).find(\".camWrap\").resizable();\n        $(element).find(\".camWrap\").draggable({\n          handle: $(element).find(\".camWrap .camHeader\"),\n          containment: $(element).parent(),\n          snap: true,\n          snapMode: \"both\"\n        });\n        requestipcam(\"localdb/ipcam.json\", \"bigimg\");\n\n        function requestipcam(requesturl, imgId) {\n          $.ajax({\n            url: requesturl,\n            type: \"Get\",\n            contenttype: \"application/json\",\n            success: function success(data) {\n              if (null != data && data != \"\") {\n                if (typeof data == \"string\") ipcaminfo = $.parseJSON(data);else ipcaminfo = data;\n                loginauth = \"user=\" + ipcaminfo.username + \"&pwd=\" + ipcaminfo.password + \"&res=0\";\n                goalurl = \"http://\" + ipcaminfo.ip + \":\" + ipcaminfo.port;\n                url = goalurl + \"/videostream.cgi?\" + loginauth + \"&resolution=320*240&rate=12\"; //$(element).find(\"#videoDiv\").attr(\"src\", url);\n                //+ \"&resolution=320*240&rate=12\"\n              }\n            }\n          });\n        }\n      });\n    };\n\n    return directive;\n  }\n\n  directives.registerDirective(\"tgDrag\", tgDragDir);\n  tgDragDir.$inject = ['$q', '$timeout'];\n\n  function tgDragDir(q, timeout) {\n    var directive = {};\n    directive.restrict = \"A\";\n    directive.scope = {\n      chart: \"=\",\n      target: \"=\"\n    };\n\n    directive.link = function (scope, element, attr) {\n      timeout(domReady);\n\n      function domReady() {\n        $(element).draggable({\n          helper: function helper() {\n            var result = $(\"<div class='tg-helper'></div>\").css({\n              width: scope.target[scope.target.type].width,\n              height: scope.target[scope.target.type].height,\n              border: \"1px dashed #bbb\"\n            });\n            return result;\n          },\n          handle: $(element).find(\"#moveBtn\"),\n          revert: false,\n          cursor: \"move\",\n          cursorAt: [50, 50],\n          appendTo: $(\"body\")\n        });\n      }\n    };\n\n    return directive;\n  }\n\n  directives.registerDirective(\"tgDrop\", tgDropDir);\n  tgDropDir.$inject = ['$q', '$timeout'];\n\n  function tgDropDir(q, timeout) {\n    var directive = {};\n    directive.restrict = \"A\";\n    directive.scope = {\n      onDrop: \"&\"\n    };\n\n    directive.link = function (scope, element, attr) {\n      timeout(domReady);\n\n      function domReady() {\n        $(element).droppable({\n          drop: drop\n        });\n\n        function drop(event, ui) {\n          scope.$apply(ready);\n\n          function ready() {\n            if ($(ui.draggable).attr(\"id\") == \"tg-drag\") {\n              scope.onDrop({\n                ui: ui\n              });\n            }\n          }\n        }\n      }\n    };\n\n    return directive;\n  }\n\n  directives.registerDirective(\"tgElement\", tgElementDir);\n  tgElementDir.$inject = ['$q', '$timeout'];\n\n  function tgElementDir(q, timeout) {\n    var directive = {};\n    directive.restrict = \"A\";\n    directive.scope = {\n      stopResize: \"&\",\n      stopMove: \"&\",\n      target: \"=\"\n    };\n\n    directive.link = function (scope, element, attr) {\n      timeout(domReady);\n\n      function domReady() {\n        $(element).resizable({\n          aspectRatio: scope.target.scale,\n          stop: function stop(event, ui) {\n            scope.$apply(ready);\n\n            function ready() {\n              scope.stopResize({\n                ui: ui\n              });\n            }\n          }\n        });\n        $(element).draggable({\n          containment: $(\".drawingArea\"),\n          stop: function stop(event, ui) {\n            scope.$apply(ready);\n\n            function ready() {\n              scope.stopMove({\n                ui: ui\n              });\n            }\n          }\n        });\n      }\n    };\n\n    return directive;\n  }\n\n  directives.registerDirective(\"tgEcharts\", echartsDir);\n  echartsDir.$inject = ['$q', '$timeout'];\n\n  function echartsDir(q, timeout) {\n    var directive = {};\n    directive.restrict = \"C\";\n    directive.scope = {\n      chart: \"=\"\n    };\n\n    directive.link = function (scope, element, attr) {\n      var target;\n\n      var _option_;\n\n      timeout(function () {\n        scope.$watch(\"chart\", function (n, o, s) {\n          if (n) {\n            n.setOption = function (option) {\n              this._option_ = option;\n              target.setOption(this._option_);\n            };\n\n            n.pushData = function (value, time) {\n              if (this._option_) {\n                if (this._option_.series[0].data.length > 25) {\n                  this._option_.series[0].data.shift();\n\n                  this._option_.xAxis.data.shift();\n                }\n\n                this._option_.series[0].data.push(parseFloat(value));\n\n                this._option_.xAxis.data.push(time);\n\n                target.setOption(this._option_);\n              }\n            };\n          }\n        });\n        var ci = scope.chart.ci;\n        var kpi = scope.chart.kpi;\n        var option = scope.chart.option;\n        target = echarts.init(element[0], \"macarons\");\n\n        if (option) {\n          target.setOption(option);\n        }\n\n        $(window).on(\"resize.\" + attr.id, function (event) {\n          target.resize();\n        });\n      });\n    };\n\n    return directive;\n  }\n\n  directives.registerDirective(\"tgRotate\", tgRotateDir);\n  tgRotateDir.$inject = ['$q', '$timeout'];\n\n  function tgRotateDir(q, timeout) {\n    var directive = {};\n    directive.restrict = \"A\";\n    directive.scope = {\n      rotate: \"=\"\n    };\n\n    directive.link = function (scope, element, attr) {\n      timeout(function () {\n        scope.$watch(\"rotate\", function (n, o, s) {\n          if (n) {\n            n.highLight = function () {\n              $(element).stop();\n              $(element).css(\"opacity\", 1);\n              clearTimeout(n.to);\n              n.to = setTimeout(function () {\n                if (parseFloat($(element).css(\"opacity\")) > 0.6) {\n                  $(element).animate({\n                    \"opacity\": .6\n                  }, 200);\n                }\n              }, 1000);\n            };\n          }\n        });\n        $(element).css(\"opacity\", .8);\n      });\n    };\n\n    return directive;\n  }\n\n  directives.registerDirective(\"tgScrollbar\", scrollbarDir);\n  scrollbarDir.$inject = ['$q', '$timeout'];\n\n  function scrollbarDir(q, timeout) {\n    var directive = {};\n    directive.restrict = \"C\";\n    directive.scope = {\n      control: \"=\"\n    };\n\n    directive.link = function (scope, element, attr) {\n      timeout(function () {\n        scope.$watch(\"control\", function (n, o, s) {\n          if (n) {\n            n.setValue = function (value) {\n              n.value = value;\n              $(element).slider(\"value\", value);\n              n.onChange(value);\n            };\n          }\n        });\n        $(element).slider({\n          range: \"min\",\n          slide: function slide(event, ui) {\n            scope.$apply(function () {\n              if (scope.control.onSlide) {\n                scope.control.onSlide(ui.value);\n              }\n\n              scope.control.value = ui.value;\n            });\n          },\n          stop: function stop(event, ui) {\n            scope.$apply(function () {\n              if (scope.control.onChange) {\n                scope.control.onChange(ui.value);\n              }\n\n              if (typeof scope.control.sendDeviceDirective == 'functioin') {\n                scope.control.sendDeviceDirective(ui.value);\n              }\n\n              scope.control.value = ui.value;\n            });\n          }\n        });\n\n        if (scope.control.value == '-') {\n          $(element).slider(\"value\", 0);\n        } else {\n          $(element).slider(\"value\", scope.control.value ? scope.control.value : 0);\n        }\n      });\n    };\n\n    return directive;\n  }\n\n  directives.registerDirective(\"tgBlink\", blinkDir);\n  blinkDir.$inject = ['$q', '$timeout'];\n\n  function blinkDir(q, timeout) {\n    var directive = {};\n    directive.restrict = \"A\";\n    directive.scope = {\n      blk: \"=\"\n    };\n\n    directive.link = function (scope, element, attr) {\n      scope.$watch(\"blk\", function (n, o, s) {\n        if (n) {\n          n.startBlink = function () {\n            timeout(function () {\n              $(function () {\n                blinkFn($(element));\n              });\n            });\n          };\n\n          n.stopBlink = function () {\n            $(element).stop();\n            $(element).css({\n              opacity: 0\n            });\n          };\n        }\n      });\n      timeout(function () {\n        $(function () {\n          $(element).css(\"opacity\", 0);\n        });\n      });\n\n      function blinkFn(selector) {\n        $(selector).animate({\n          'opacity': 1\n        }, {\n          duration: 300,\n          complete: function complete() {\n            $(selector).animate({\n              'opacity': 0\n            }, {\n              duration: 300,\n              complete: function complete() {\n                blinkFn($(selector));\n              }\n            });\n          }\n        });\n      }\n    };\n\n    return directive;\n  }\n\n  directives.registerDirective(\"tgToggle\", toggleDir);\n  toggleDir.$inject = ['$q', '$timeout'];\n\n  function toggleDir(q, timeout) {\n    var directive = {};\n    directive.restrict = \"C\";\n    directive.template = \"<div class='toggle-wrap'><div class='toggle-inner'></div></div>\";\n    directive.scope = {\n      tg: \"=\"\n    };\n\n    directive.link = function (scope, element, attr) {\n      scope.$watch(\"tg\", function (n, o, s) {\n        if (n) {\n          n.setValue = function (value) {\n            n.value = value > 0;\n\n            if (value > 0) {\n              $(element).find('.toggle-wrap').addClass(\"active\");\n            } else {\n              $(element).find('.toggle-wrap').removeClass(\"active\");\n            }\n\n            if (n.onChange) {\n              n.onChange(value > 0);\n            }\n          };\n        }\n      });\n      timeout(function () {\n        $(function () {\n          var val;\n\n          if (typeof scope.tg.value == 'string') {\n            val = parseInt(scope.tg.value);\n          } else {\n            val = scope.tg.value;\n          }\n\n          if (val > 0) {\n            $(element).find('.toggle-wrap').addClass(\"active\");\n          } else {\n            $(element).find('.toggle-wrap').removeClass(\"active\");\n          }\n\n          $(element).on(\"click\", function () {\n            scope.$apply(function () {\n              scope.tg.value = parseInt(scope.tg.value) > 0 ? 0 : 1;\n\n              if (scope.tg.value > 0) {\n                $(element).find('.toggle-wrap').addClass(\"active\");\n              } else {\n                $(element).find('.toggle-wrap').removeClass(\"active\");\n              }\n\n              if (typeof scope.tg.onChange == \"function\") {\n                scope.tg.onChange(!scope.tg.value);\n              }\n\n              if (typeof scope.tg.sendDeviceDirective == 'functioin') {\n                scope.tg.sendDeviceDirective(scope.tg.value);\n              }\n            });\n          });\n        });\n      });\n    };\n\n    return directive;\n  }\n});"],"sourceRoot":"/source/"}