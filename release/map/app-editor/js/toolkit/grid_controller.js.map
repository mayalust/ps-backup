{"version":3,"sources":["app-editor/js/toolkit/grid_controller.js"],"names":["define","$","grid","callback","rearrangeEmpty","current","remove","gridReceiver","addDefaultItem","inner_li","li_handler","li_close","li_content","resizeOption","containment","minWidth","create","event","ui","find","css","addClass","resize","totalWidth","target","parent","width","lis","fixwidth","currentWidth","inx","needToResize","each","index","element","attr","result","undefined","resizable","maxWidth","append","randomString","on","stopPropagation","calculateBlockPos","add","outerli","verticalMoveColor","inner_ul","id","outerUl","out_close","div_handler","div_wrap","push","sortable","scroll","cursor","handle","connectWith","placeholder","tolerance","cursorAt","top","left","start","linum","length","pers","helper","update","parents","height","len","over","background-color","border","out","elem","stop","deactivate","activate","receive","opacity","minHeight","widthAll","col","row","innerli_list","clone","source","after","removeClass","$chars","maxPos","pwd","i","charAt","Math","floor","random","fn","extend","connect","gridCreator","param1","param2","param3","this","eval","draggable","connectToSortable","param4","change","delete","lineCreator","boxCreator"],"mappings":"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","file":"app-editor/js/toolkit/grid_controller.js","sourcesContent":["define([\"jquery\", \"jquery-ui\"], function ($) {\n  var grid = {};\n  var callback = [];\n  $.fn.extend({\n    connect: '',\n    id: 0,\n    gridCreator: function gridCreator(param1, param2, param3) {\n      var current = this;\n\n      if (param1 == \"option\") {\n        if (param3) {\n          eval(param2)(current, param3);\n        } else {\n          eval(param2 + \"(current)\");\n        }\n      } else {\n        $.each(current.find(\".toolBox\"), function (index, element) {\n          $(element).draggable({\n            tolerance: \"pointer\",\n            helper: \"clone\",\n            connectToSortable: \".inner_ul\"\n          });\n        });\n      }\n    },\n    gridReceiver: function gridReceiver(param1, param2, param3, param4) {\n      var current = this;\n      current.attr(\"gridReceiver\", \"gr_\" + randomString(32));\n      var current = this;\n\n      if (param1 == \"option\") {\n        if (param4) {\n          return eval(param2)(current, param3, param4);\n        } else if (param3) {\n          eval(param2)(current, param3);\n        } else {\n          return eval(param2 + \"(current)\");\n        }\n      } else {\n        add(current);\n        $(\"ul#all\").sortable({\n          scroll: false,\n          tolerance: \"pointer\",\n          placeholder: \"inner_placeholder\",\n          handle: \".inner_handler\",\n          stop: function stop(event, ui) {\n            calculateBlockPos(current);\n          }\n        });\n        callback[0] = param1.stop;\n        callback[1] = param1.change;\n        callback[2] = param1.delete;\n      }\n    },\n    lineCreator: function lineCreator(param1, param2, param3) {\n      var current = this;\n\n      if (param1 == \"option\") {\n        if (param3) {\n          eval(param2 + \"(current,\" + param3 + \")\");\n        } else {\n          eval(param2 + \"(current)\");\n        }\n      } else {}\n    },\n    boxCreator: function boxCreator(param1, param2, param3) {\n      var current = this;\n\n      if (param1 == \"option\") {\n        if (param3) {\n          eval(param2 + \"(current,\" + param3 + \")\");\n        } else {\n          eval(param2 + \"(current)\");\n        }\n      } else {}\n    }\n  });\n\n  function rearrangeEmpty(current) {\n    $(\"li.inner.empty\").remove();\n    current.gridReceiver(\"option\", \"add\");\n  }\n\n  function addDefaultItem(current) {\n    var inner_li = $(\"<li class='inner_li'></li>\");\n    var li_handler = $(\"<div class='li_handler'></div>\");\n    var li_close = $(\"<div class='li_close'><span class='glyphicon glyphicon-remove'></span></div>\");\n    var li_content = $(\"<div class='li_content'></div>\");\n    var resizeOption = {\n      containment: \"#grid_receiver\",\n      minWidth: 50,\n      create: function create(event, ui) {\n        inner_li.find(\".ui-resizable-e\").css(\"background-color\", \"rgba(0,0,0,.1)\");\n        inner_li.find(\".ui-resizable-e\").addClass(\"cursorMove\");\n        inner_li.find(\".ui-resizable-s\").css(\"display\", \"block\");\n        inner_li.find(\".ui-resizable-se\").css(\"display\", \"none\");\n      },\n      resize: resize\n    };\n    li_handler.append(li_close);\n    inner_li.append(li_handler);\n    inner_li.append(li_content);\n    inner_li.attr(\"id\", \"li_\" + randomString(32));\n    li_close.on(\"mousedown\", function (event) {\n      event.stopPropagation();\n    });\n    li_close.on(\"click\", function (event) {\n      event.stopPropagation();\n      callback[2]([inner_li]);\n      inner_li.remove();\n      calculateBlockPos(current);\n      callback[1]();\n    });\n    inner_li.resizable(resizeOption);\n\n    function resize(event, ui) {\n      var totalWidth = $(event.target).parent().width() - 5;\n      var lis = $(event.target).parent().find(\"li.inner_li\");\n      var fixwidth = 0;\n      var nextwidth = 0;\n      var currentWidth = $(event.target).width();\n      var inx = 0;\n\n      var needToResize = function () {\n        var result;\n        $.each(lis, function (index, element) {\n          if ($(element).attr(\"id\") == $(event.target).attr(\"id\")) {\n            result = '';\n          } else {\n            if (result == undefined) {\n              fixwidth += $(element).width();\n            } else if (result == '') {\n              result = $(element);\n              inx++;\n            } else {\n              fixwidth += $(element).width();\n              inx++;\n            }\n          }\n\n          ;\n        });\n        return result;\n      }();\n\n      inner_li.resizable({\n        maxWidth: inx > 0 ? totalWidth - fixwidth - 50 : undefined\n      });\n\n      if (needToResize) {\n        if (totalWidth - fixwidth > 50) {\n          needToResize.width(totalWidth - (fixwidth + currentWidth));\n        }\n      }\n\n      callback[1]();\n    }\n\n    return inner_li;\n  }\n\n  function add(current, outerli, inner_li) {\n    var verticalMoveColor;\n    var inner_ul;\n    current.id++;\n\n    if (outerli) {\n      outerUl = outerli;\n      inner_ul = $(outerUl).find(\".inner_ul\");\n    } else {\n      if (inner_li) {\n        var outerUl = $(\"<li class='inner'></li>\");\n      } else {\n        var outerUl = $(\"<li class='inner empty'></li>\");\n      }\n\n      var out_close = $(\"<div class='out_close'><span class='glyphicon glyphicon-remove'></span></div>\");\n      var div_handler = $(\"<div class='inner_handler'></div>\");\n      var div_wrap = $(\"<div class='inner_content_wrap'></div>\");\n      inner_ul = $(\"<ul class='inner_ul'></ul>\");\n      inner_ul.attr(\"id\", \"ul_\" + randomString(32));\n      outerUl.append(div_handler).append(div_wrap);\n      div_wrap.append(inner_ul);\n      div_handler.append(out_close);\n      current.find(\"ul.all\").append(outerUl);\n      out_close.on(\"mousedown\", function (event) {\n        event.stopPropagation();\n      });\n      out_close.on(\"click\", function (event) {\n        event.stopPropagation();\n        var result = [];\n        outerUl.find(\"li.inner_li\").each(function (index, element) {\n          result.push($(element));\n        });\n        callback[2](result);\n        outerUl.remove();\n      });\n      inner_ul.sortable({\n        scroll: false,\n        cursor: \"move\",\n        handle: \".li_handler\",\n        connectWith: \".inner_ul\",\n        placeholder: \"li_placeholder\",\n        tolerance: \"pointer\",\n        cursorAt: {\n          top: 20,\n          left: 0\n        },\n        start: start,\n        update: update,\n        over: over,\n        out: out,\n        stop: stop,\n        create: create,\n        deactivate: deactivate,\n        activate: active,\n        receive: receive,\n        opacity: .8\n      });\n      outerUl.resizable({\n        containment: \"#grid_receiver\",\n        minHeight: 50,\n        create: function create(event, ui) {\n          outerUl.find(\".ui-resizable-s\").css(\"background-color\", verticalMoveColor);\n          outerUl.find(\".ui-resizable-s\").addClass(\"cursorMove_s\");\n          outerUl.find(\".ui-resizable-e\").css(\"display\", \"block\");\n          outerUl.find(\".ui-resizable-se\").css(\"display\", \"block\");\n        },\n        resize: function resize() {\n          callback[1]();\n        }\n      });\n    }\n\n    if (inner_li) {\n      inner_ul.append(inner_li);\n      verticalMoveColor = \"rgba(0,0,0,.1)\";\n    } else {\n      verticalMoveColor = \"transparent\";\n    }\n\n    function change(event, ui) {\n      var linum = 0;\n      $.each($(event.target).find(\"li.inner_li:not(.ui-sortable-helper)\"), function (index, element) {\n        if ($(element).css(\"display\") != \"none\") {\n          linum++;\n        }\n\n        ;\n      });\n      var placeholder = $(event.target).find(\"li.li_placeholder\").length;\n      var len = linum + placeholder;\n      var pers = 100 / len;\n      $(event.target).find(\".inner_li\").css(\"width\", inner_ul.width() * pers / 100 + \"px\");\n      $(ui.helper).css(\"width\", outerli.width() * pers / 100 + \"px\");\n      $(event.target).find(\"li.li_placeholder\").css(\"width\", inner_ul.width() * pers / 100 - 2 + \"px)\");\n    }\n\n    function sort(event, ui) {}\n\n    function receive(event, ui) {\n      $(event.target).find(\"div.toolBox\").remove();\n    }\n\n    function deactivate(event, ui) {}\n\n    function active(event, ui) {}\n\n    function receive(event, ui) {}\n\n    function update(event, ui) {\n      callback[1]();\n    }\n\n    function start(event, ui) {\n      var linum = 0;\n      $.each($(event.target).find(\"li.inner_li:not(.ui-sortable-helper)\"), function (index, element) {\n        if ($(element).css(\"display\") != \"none\") {\n          linum++;\n        }\n\n        ;\n      }); //$(\".ui-resizable-handle\").css(\"pointer-events\", \"none\");\n\n      var placeholder = $(event.target).find(\"li.li_placeholder\").length;\n      var len = linum + placeholder - 1;\n      var pers = 100 / len;\n      $(event.target).find(\".inner_li\").css(\"width\", inner_ul.width() * pers / 100 + \"px\");\n      $(ui.helper).css(\"width\", inner_ul.width() * pers / 100 + \"px\");\n      $(event.target).find(\"li.li_placeholder\").css(\"width\", inner_ul.width() * pers / 100 - 2 + \"px)\");\n    }\n\n    function create(event, ui) {}\n\n    function over(event, ui) {\n      var linum = 0;\n      var parent = $(event.target).parents();\n      var height = parent.height();\n      $.each($(event.target).find(\"li.inner_li:not(.ui-sortable-helper)\"), function (index, element) {\n        if ($(element).css(\"display\") != \"none\") {\n          linum++;\n        }\n\n        ;\n      });\n      var placeholder = $(event.target).find(\"li.li_placeholder\").length;\n      var len = linum + placeholder;\n      var pers = 100 / len;\n      event.stopPropagation();\n      $(event.target).find(\".inner_li\").css(\"width\", inner_ul.width() * pers / 100 + \"px\");\n      $(ui.helper).css({\n        \"width\": inner_ul.width() * pers / 100 + \"px\",\n        \"height\": inner_ul.height() + \"px\",\n        \"background-color\": \"transparent\",\n        \"border\": \"1px dashed #444\"\n      });\n      $(event.target).find(\"li.li_placeholder\").css(\"display\", \"block\");\n      $(event.target).find(\"li.li_placeholder\").css(\"width\", inner_ul.width() * pers / 100 - 2 + \"px\");\n      $(event.target).find(\"li.li_placeholder\").height(height);\n      callback[1]();\n    }\n\n    function out(event, ui) {\n      $.each($(\".inner_ul\"), function (index, element) {\n        var linum = 0;\n        var len;\n        $.each($(element).find(\"li.inner_li:not(.ui-sortable-helper)\"), function (index, elem) {\n          if ($(elem).css(\"display\") != \"none\") {\n            linum++;\n          }\n\n          ;\n        });\n        len = linum;\n        var pers = 100 / len;\n        $(element).find(\".inner_li\").css(\"width\", inner_ul.width() * pers / 100 + \"px\");\n        $(element).find(\"li.li_placeholder\").css(\"width\", inner_ul.width() * pers / 100 + \"px\");\n        $(ui.helper).css(\"width\", inner_ul.width() * pers / 100 + \"px\");\n      });\n      $(event.target).find(\"li.li_placeholder\").css(\"display\", \"none\");\n      callback[1]();\n    }\n\n    function stop(event, ui) {\n      calculateBlockPos(current);\n      callback[1]();\n    }\n\n    function update(event, ui) {\n      $(event.target).find(\".ui-sortable-helper\").remove();\n      var parent = $(event.target).parents();\n      var height = parent.height();\n      var len = $(event.target).find(\".inner_li:not(.ui-sortable-helper)\").length;\n\n      if (len) {\n        var pers = 100 / len;\n        $(event.target).find(\".inner_li\").css({\n          \"width\": inner_ul.width() * pers / 100 + \"px\"\n        });\n      } else {}\n    }\n\n    return outerUl;\n  }\n\n  function calculateBlockPos(current) {\n    var widthAll = $(\"ul.all\").width() - 20;\n    $(\"ul.all\").find(\"li.inner\").each(function (index, element) {\n      var row = index;\n      var col;\n      var innerli_list = [];\n      $(element).find(\"ul.inner_ul\").find(\".toolBox\").each(function (index, element) {\n        var clone = addDefaultItem(current);\n        var source = $(element);\n        $(element).after(clone);\n        $(element).remove();\n        callback[0](source, clone);\n      });\n      $(element).find(\"ul.inner_ul\").find(\".inner_li.ui-sortable-helper\").remove();\n      $(element).find(\"ul.inner_ul\").find(\".inner_li:not(.ui-sortable-helper)\").each(function (index, element) {\n        col = index;\n\n        if ($(element).css(\"display\") != \"none\") {\n          $(element).attr({\n            row: row,\n            col: col\n          });\n          innerli_list.push(element);\n        }\n      });\n      var len = innerli_list.length;\n\n      if (len > 0) {\n        var pers = 100 / len;\n        $(element).find(\"ul.inner_ul\").find(\".inner_li\").css(\"width\", widthAll * pers / 100 - 1 + \"px\");\n      } else {\n        $(element).remove();\n      }\n\n      var height = $(element).height();\n      $(element).css(\"height\", height + \"px\");\n      $(element).removeClass(\"empty\");\n    });\n    add(current);\n    $(\".all\").find();\n  }\n\n  function randomString(len) {\n    len = len || 32;\n    var $chars = 'ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678';\n    var maxPos = $chars.length;\n    var pwd = '';\n\n    for (i = 0; i < len; i++) {\n      pwd += $chars.charAt(Math.floor(Math.random() * maxPos));\n    }\n\n    return pwd;\n  }\n\n  return grid;\n});"],"sourceRoot":"/source/"}