{"version":3,"sources":["solution/customview/deviceAreaPreview/arealevel1.js"],"names":["define","on","init","event","target","getParameter","getValue","getDomainAreaLineTree_alertStatus","find","getChildren","n","i","l","then","children","viewId","$attr","getViewById","view","content","json","JSON","parse","render","cells","attr","createMarker","index","node","position","cell","text","label","indexOf","attributes","x","Math","floor","random","y","ins","setAlarmStatus","state","setPos","getPathLocation","path","navigateToTab","id"],"mappings":"AAAAA,OAAO,CACLC,GAAM,CACJC,KAAQ,SAAcC,GACpB,IAAIC,EAASD,EAAMC,OACVA,EAAOC,aAAa,OAASD,EAAOE,SAAS,aAC3CF,EAAOC,aAAa,QAC/BD,EAAOG,kCAAkC,SAAUC,GACjDA,EAAKC,YAAY,SAAUC,EAAGC,EAAGC,GAC/B,OAAY,GAALA,IACNC,KAAK,SAAUC,GAChB,IAAIC,EAASP,EAAKQ,MAAM,sBACxBZ,EAAOa,YAAYF,EAAQ,SAAUG,GACnC,IAAIC,EAAUD,EAAKC,QACfC,EAAOC,KAAKC,MAAMH,GACtBf,EAAOmB,OAAOH,GACdhB,EAAOH,GAAG,qBAAsB,SAAUuB,GACxC,IAAK,IAAIb,KAAKa,EACZA,EAAMb,GAAGc,KAAK,iBAAkB,GAChCD,EAAMb,GAAGc,KAAK,eAAgB,GAGhC,IAAIC,EAAe,SAAsBC,EAAOC,GAC9C,IAAIC,EACAC,EAAON,EAAMhB,KAAK,SAAUsB,GAC9B,IAAIC,EAAOD,EAAKL,KAAK,aAErB,OAAoC,GAA7BG,EAAKI,MAAMC,QAAQF,MACtBP,EAAMG,IAAU,GAGpBE,EADEC,GAAQA,EAAKI,YAAcJ,EAAKI,WAAWL,SAClCC,EAAKI,WAAWL,SAEhB,CACTM,EAAGC,KAAKC,MAAM,IAAsB,IAAhBD,KAAKE,UACzBC,EAAGH,KAAKC,MAAM,IAAsB,IAAhBD,KAAKE,WAK7BlC,EAAOsB,aAAaE,EAAKI,MAAO,SAAUQ,GAUxCA,EAAIC,eAAeb,EAAKc,OACxBF,EAAIG,OAAOd,GACXW,EAAIvC,GAAG,QAAS,SAAUE,GACxByB,EAAKgB,kBAAkB/B,KAAK,SAAUgC,GACpCzC,EAAO0C,cAAc,CACnBnB,MAAOkB,EACPE,GAAInB,EAAKmB,YAOnB,IAAK,IAAIpC,KAAKG,EACZY,EAAaf,EAAGG,EAASH","file":"solution/customview/deviceAreaPreview/arealevel1.js","sourcesContent":["define({\n  \"on\": {\n    \"init\": function init(event) {\n      var target = event.target;\n      var id = target.getParameter(\"id\") || target.getValue(\"device/id\");\n      var main = target.getParameter(\"main\");\n      target.getDomainAreaLineTree_alertStatus(function (find) {\n        find.getChildren(function (n, i, l) {\n          return l == 1;\n        }).then(function (children) {\n          var viewId = find.$attr(\"values/view/viewId\");\n          target.getViewById(viewId, function (view) {\n            var content = view.content;\n            var json = JSON.parse(content);\n            target.render(json);\n            target.on(\"$loadCiKpiComplete\", function (cells) {\n              for (var i in cells) {\n                cells[i].attr(\"circle/opacity\", 0);\n                cells[i].attr(\"text/opacity\", 0);\n              }\n\n              var createMarker = function createMarker(index, node) {\n                var position;\n                var cell = cells.find(function (cell) {\n                  var text = cell.attr(\"text/text\"); // \n\n                  return node.label.indexOf(text) != -1;\n                }) || cells[index] || {};\n\n                if (cell && cell.attributes && cell.attributes.position) {\n                  position = cell.attributes.position;\n                } else {\n                  position = {\n                    x: Math.floor(100 + Math.random() * 300),\n                    y: Math.floor(100 + Math.random() * 200)\n                  };\n                }\n\n                ;\n                target.createMarker(node.label, function (ins) {\n                  //  \n                  //  \n                  //设置状态\n\n                  /**\n                  node.$on(\"statusChanged\", function(nd){\n                    ins.setAlarmStatus(node.status);\n                  });\n                   **/\n                  ins.setAlarmStatus(node.state);\n                  ins.setPos(position);\n                  ins.on(\"click\", function (event) {\n                    node.getPathLocation().then(function (path) {\n                      target.navigateToTab({\n                        index: path,\n                        id: node.id\n                      });\n                    });\n                  });\n                });\n              };\n\n              for (var i in children) {\n                createMarker(i, children[i]);\n              }\n            });\n          });\n        });\n      });\n    }\n  }\n});"],"sourceRoot":"/source/"}