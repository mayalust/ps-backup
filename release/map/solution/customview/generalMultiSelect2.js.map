{"version":3,"sources":["solution/customview/generalMultiSelect2.js"],"names":["define","on","init","event","target","global","dItem","kpi","duration","resource","getValue","sensorId","getParameter","multiSelectValues","success","ci","id","modelId","accessConfigValues","physicalConfig","accessConfigs","getAttrsByResource","attrs","MeasurePointLocate","sourceValue","eval","sourceValueArr","i","j","k","ins","configValues","find","accessConfigValue","name","instance","push","whole","elem","test","label","options","filter","length","op","dataItemId","inx","indexOf","splice","unshift","trigger","render","nextTick","ctrlGroups","type","value","map","source","kpiId","style","padding","change","format","runtime","off","node"],"mappings":"AAAAA,OAAO,CACLC,GAAI,CACFC,KAAM,SAASA,KAAKC,OAClB,IAAIC,OAASD,MAAMC,OACfC,OAASF,MAAME,OACfC,MAAOC,IACPC,SAAW,KACXC,SAAWL,OAAOM,SAAS,mBAC3BC,SAAWP,OAAOQ,aAAa,YAC/BC,kBAAoB,GAEpBC,QAAU,SAASA,QAAQL,UAC7BI,kBAAoB,GACpB,IAAIE,GAAK,CAACN,SAASO,IAEfC,QAAU,CAACR,SAASQ,SAEpBC,mBAAqBT,SAASU,eAAeC,cACjDhB,OAAOiB,mBAAmBZ,SAAU,SAAUa,OAC5C,IAAIC,mBAAqBD,MAAM,mBAC3BE,YAAcC,KAAKF,qBAAuB,GAC1CG,eAAiB,GAErB,IAAK,IAAIC,KAAKH,YACZ,IAAK,IAAII,KAAKJ,YAAYG,GACxB,IAAK,IAAIE,KAAKL,YAAYG,GAAGC,GAAI,CAC/B,IAAIE,IAAMN,YAAYG,GAAGC,GAAGC,GAC5BC,IAAIC,aAAeb,mBAAmBc,KAAK,SAAUC,GACnD,OAAOH,IAAII,MAAQD,EAAkBE,WAEvCT,eAAeU,KAAKN,KAM1B,IAAIO,MAAQX,eAAeM,KAAK,SAAUM,GAExC,MADa,YACCC,KAAKD,EAAKE,UACpB,GACFC,QAAUvB,mBAAmBwB,OAAO,SAAUJ,GAChD,OAAOA,EAAKH,UAAYE,MAAMH,OAIhC,GAFArB,kBAAoB,GAEC,EAAjB4B,QAAQE,OAAY,CACtB,IAAIX,KAAOS,QAAQT,KAAK,SAAUY,GAChC,OAAOA,EAAGC,YAAclC,WAG1B,GAAIqB,KAAM,CACR,IAAIc,IAAML,QAAQM,QAAQf,MAC1BS,QAAQO,OAAOF,IAAK,GACpBL,QAAQQ,QAAQjB,MAGlBnB,kBAAkBuB,KAAKK,QAAQ,IAGjCrC,OAAO8C,QAAQ,oBAAgD,EAA3BrC,kBAAkB8B,QAEtD,IAAIQ,OAAS,SAASA,IACpB/C,OAAOgD,SAAS,WACdhD,OAAO8C,QAAQ,qBAAsBrC,qBAEvC,IAAIwC,EAAa,CAAC,CAAC,CACjBC,KAAM,QACNC,MAAO,WACL,CAAC,CACHD,KAAM,eACNC,MAAO1C,kBAAkB2C,IAAI,SAAUC,GACrC,OAAOA,EAAOC,QAEhBC,MAAO,CACLC,QAAS,OAEX3D,GAAI,CACF4D,OAAQ,SAAgBvB,GACLA,EAAKiB,MACtB1C,kBAAoByB,EAAKiB,MACzBJ,MAGJV,QAASA,QACTqB,OAAQ,CACN9C,GAAM,QACNwB,MAAS,cAGbpC,OAAO+C,OAAOE,GACdU,QAAQ,mBAGVZ,YAIA1C,UACFK,QAAQL,UAGVL,OAAO4D,IAAI,0CACX5D,OAAOH,GAAG,wCAAyC,SAA0CgE,GAE3FnD,QAAQmD,EAAKxD","file":"solution/customview/generalMultiSelect2.js","sourcesContent":["define({\n  on: {\n    init: function init(event) {\n      var target = event.target;\n      var global = event.global;\n      var dItem, kpi;\n      var duration = null;\n      var resource = target.getValue(\"global/resource\");\n      var sensorId = target.getParameter(\"sensorId\");\n      var multiSelectValues = [];\n\n      var success = function success(resource) {\n        multiSelectValues = [];\n        var ci = [resource.id]; // 设备 526443915616079\n\n        var modelId = [resource.modelId]; // 获取modelId\n\n        var accessConfigValues = resource.physicalConfig.accessConfigs;\n        target.getAttrsByResource(resource, function (attrs) {\n          var MeasurePointLocate = attrs['MeasurePointLocate'];\n          var sourceValue = eval(MeasurePointLocate) || \"\";\n          var sourceValueArr = [];\n\n          for (var i in sourceValue) {\n            for (var j in sourceValue[i]) {\n              for (var k in sourceValue[i][j]) {\n                var ins = sourceValue[i][j][k];\n                ins.configValues = accessConfigValues.find(function (accessConfigValue) {\n                  return ins.name == accessConfigValue.instance;\n                });\n                sourceValueArr.push(ins);\n              }\n            }\n          }\n\n          ;\n          var whole = sourceValueArr.find(function (elem) {\n            var regExp = /\\s*整体\\s*/g;\n            return regExp.test(elem.label);\n          }) || {};\n          var options = accessConfigValues.filter(function (elem) {\n            return elem.instance == whole.name;\n          });\n          multiSelectValues = [];\n\n          if (options.length > 0) {\n            var find = options.find(function (op) {\n              return op.dataItemId == sensorId;\n            });\n\n            if (find) {\n              var inx = options.indexOf(find);\n              options.splice(inx, 1);\n              options.unshift(find);\n            }\n\n            multiSelectValues.push(options[0]);\n          }\n\n          target.trigger(\"showGeneralChart2\", multiSelectValues.length > 0);\n\n          var render = function render() {\n            target.nextTick(function () {\n              target.trigger(\"multiSelectValues2\", multiSelectValues);\n            });\n            var ctrlGroups = [[{\n              type: \"label\",\n              value: \"工艺类数据项\"\n            }], [{\n              type: \"checkboxlist\",\n              value: multiSelectValues.map(function (source) {\n                return source.kpiId;\n              }),\n              style: {\n                padding: \"0px\"\n              },\n              on: {\n                change: function change(elem) {\n                  var elemValues = elem.value;\n                  multiSelectValues = elem.value;\n                  render();\n                }\n              },\n              options: options,\n              format: {\n                \"id\": \"kpiId\",\n                \"label\": \"kpiName\"\n              }\n            }]];\n            target.render(ctrlGroups);\n            runtime(\"下免checkbox渲染完成\");\n          };\n\n          render();\n        });\n      };\n\n      if (resource) {\n        success(resource);\n      }\n\n      target.off(\"tree_resourceChange.generalChartMulti2\");\n      target.on(\"tree_resourceChange.generalChartMult2\", function tree_resourceChange_multiSelect2(node) {\n        debugger;\n        success(node.resource);\n      });\n    }\n  }\n});"],"sourceRoot":"/source/"}