{"version":3,"sources":["app-ac/js/controllers/user-ctrl.js"],"names":["define","controllers","initController","$scope","$rootScope","Info","userLoginUIService","user","username","password","errorMsg","slide","$watch","newValue","oldValue","errorStatus","loginClick","e","keycode","window","event","keyCode","which","undefined","login","checkClick","$","attr","show","hide","homeClick","open","indexShow","personalShow","redirectHandler","industry","loginTimes","location","href","appData","isAuthenticated","$on","evt","d","staffName","userName","userInfo","result","message"],"mappings":"AAAAA,OAAO,CAAC,2BAA4B,SAAUC,GAC5C,aAGAA,EAAYC,eAAe,WAAY,CAAC,SAAU,aAAc,OAAQ,qBAAsB,SAAUC,EAAQC,EAAYC,EAAMC,GAChIH,EAAOI,KAAO,CACZC,SAAU,GACVC,SAAU,IAEZN,EAAOO,SAAW,GAClBP,EAAOQ,MAAQ,IACfR,EAAOS,OAAO,gBAAiB,SAAUC,EAAUC,GACjDX,EAAOY,YAAc,IAEvBZ,EAAOS,OAAO,gBAAiB,SAAUC,EAAUC,GACjDX,EAAOY,YAAc,IAGvBZ,EAAOa,WAAa,SAAUC,GAC5B,IAAIC,EAAUC,OAAOC,MAAQH,EAAEI,QAAUJ,EAAEK,MAE3C,GAAe,IAAXJ,GAA4BK,MAAXL,EAAsB,CACzC,GAA4B,IAAxBf,EAAOI,KAAKC,SAGd,OAFAL,EAAOY,YAAc,OACrBZ,EAAOO,SAAW,WAIpB,GAA4B,IAAxBP,EAAOI,KAAKE,SAGd,OAFAN,EAAOY,YAAc,OACrBZ,EAAOO,SAAW,UAIQ,IAAxBP,EAAOI,KAAKC,UAA0C,IAAxBL,EAAOI,KAAKE,SAE5CH,EAAmBkB,MAAMrB,EAAOI,KAAKC,SAAUL,EAAOI,KAAKE,WAI3DN,EAAOO,SAAW,YAClBP,EAAOY,YAAc,KAK3BZ,EAAOsB,WAAa,WACsB,WAApCC,EAAE,eAAeC,KAAK,YACxBD,EAAE,eAAeE,OACjBF,EAAE,cAAcG,OAChBH,EAAE,eAAeC,KAAK,WAAW,KAEjCD,EAAE,eAAeG,OACjBH,EAAE,cAAcE,OAChBF,EAAE,eAAeC,KAAK,WAAW,KAIrCxB,EAAO2B,UAAY,WACjBX,OAAOY,KAAK,8BAGd3B,EAAW4B,WAAY,EACvB5B,EAAW6B,cAAe,EAE1B,IAAIC,EAAkB,WACpB,IAAIC,EAAW7B,EAAmBC,KAAK4B,SAElCA,GAAwB,GAAZA,EAe2B,GAAtC7B,EAAmBC,KAAK6B,WAC1BjB,OAAOkB,SAASC,KAAO,0BAEvBnB,OAAOkB,SAASC,KAAO,iBAjBpBhC,EAAmBC,KAAKgC,QAOe,GAAtCjC,EAAmBC,KAAK6B,WAC1BjB,OAAOkB,SAASC,KAAO,0BAEvBnB,OAAOkB,SAASC,KAAO,iBATiB,GAAtChC,EAAmBC,KAAK6B,WAC1BjB,OAAOkB,SAASC,KAAO,0BAEvBnB,OAAOkB,SAASC,KAAO,aAkB1BhC,EAAmBC,KAAKiC,gBAY3BN,IAXA/B,EAAOsC,IAAI,qBAAsB,SAAUC,EAAKC,GAC1CrC,EAAmBC,KAAKiC,iBAC1BpC,EAAWwC,UAAYtC,EAAmBC,KAAKsC,SAC/C1C,EAAO2C,SAAWxC,EAAmBC,KACrC2B,MAEA/B,EAAOO,SAAWJ,EAAmByC,OAAOC,QAC5C7C,EAAOY,YAAc","file":"app-ac/js/controllers/user-ctrl.js","sourcesContent":["define(['controllers/controllers'], function (controllers) {\n  'use strict'; //根据接口调用自定义视图获取\n  //用户登录userLoginUIService\n\n  controllers.initController('loginCtr', ['$scope', '$rootScope', 'Info', 'userLoginUIService', function ($scope, $rootScope, Info, userLoginUIService) {\n    $scope.user = {\n      username: \"\",\n      password: \"\"\n    };\n    $scope.errorMsg = \"\";\n    $scope.slide = \"1\";\n    $scope.$watch(\"user.username\", function (newValue, oldValue) {\n      $scope.errorStatus = 0;\n    });\n    $scope.$watch(\"user.password\", function (newValue, oldValue) {\n      $scope.errorStatus = 0;\n    });\n\n    $scope.loginClick = function (e) {\n      var keycode = window.event ? e.keyCode : e.which;\n\n      if (keycode == 13 || keycode == undefined) {\n        if ($scope.user.username == \"\") {\n          $scope.errorStatus = 1;\n          $scope.errorMsg = \"登录名不能为空\";\n          return;\n        }\n\n        if ($scope.user.password == \"\") {\n          $scope.errorStatus = 2;\n          $scope.errorMsg = \"密码不能为空\";\n          return;\n        }\n\n        if ($scope.user.username != \"\" && $scope.user.password != \"\") {\n          // if ($(\"#checkServe\").attr(\"checked\") == \"checked\") {\n          userLoginUIService.login($scope.user.username, $scope.user.password); // } else {\n          //     $scope.errorMsg = \"请勾选《普奥云网站服务协议》\";\n          // }\n        } else {\n          $scope.errorMsg = \"请输入用户名或密码\";\n          $scope.errorStatus = 1;\n        }\n      }\n    };\n\n    $scope.checkClick = function () {\n      if ($(\"#checkServe\").attr(\"checked\") == \"checked\") {\n        $(\"#checkServe\").show();\n        $(\"#checkName\").hide();\n        $(\"#checkServe\").attr(\"checked\", false);\n      } else {\n        $(\"#checkServe\").hide();\n        $(\"#checkName\").show();\n        $(\"#checkServe\").attr(\"checked\", true);\n      }\n    };\n\n    $scope.homeClick = function () {\n      window.open(\"http://www.proudsmart.com\");\n    };\n\n    $rootScope.indexShow = false;\n    $rootScope.personalShow = true;\n\n    var redirectHandler = function redirectHandler() {\n      var industry = userLoginUIService.user.industry;\n\n      if (!industry || industry == 0) {\n        if (!userLoginUIService.user.appData) {\n          if (userLoginUIService.user.loginTimes == 0) {\n            window.location.href = \"../app-uc/password.html\";\n          } else {\n            window.location.href = \"apps.html\";\n          }\n        } else {\n          if (userLoginUIService.user.loginTimes == 0) {\n            window.location.href = \"../app-uc/password.html\";\n          } else {\n            window.location.href = \"app/index.html\";\n          }\n        }\n      } else {\n        if (userLoginUIService.user.loginTimes == 0) {\n          window.location.href = \"../app-uc/password.html\";\n        } else {\n          window.location.href = \"app/index.html\";\n        }\n      }\n    };\n\n    if (!userLoginUIService.user.isAuthenticated) {\n      $scope.$on('loginStatusChanged', function (evt, d) {\n        if (userLoginUIService.user.isAuthenticated) {\n          $rootScope.staffName = userLoginUIService.user.userName;\n          $scope.userInfo = userLoginUIService.user;\n          redirectHandler();\n        } else {\n          $scope.errorMsg = userLoginUIService.result.message;\n          $scope.errorStatus = 1;\n        }\n      });\n    } else {\n      redirectHandler();\n    }\n  }]);\n});"],"sourceRoot":"/source/"}