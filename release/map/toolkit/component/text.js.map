{"version":3,"sources":["toolkit/component/text.js"],"names":["define","data","serviceCenterService","expression","element","text","global","previewMode","$","$attr","style","css","$$","runExpression","funRes","code","fnResult","system","setText","value","initFn","repeatFn","target","e","runExpressionSuccess"],"mappings":"AAGAA,OAAO,GAAI,WACT,OAAO,SAAUC,GACYA,EAAKC,qBAAhC,IAsBIC,EArBAC,EAAUH,EAAKG,QAGfC,GAFSJ,EAAKK,OACAL,EAAKM,YACZC,EAAE,gBAiEb,OA/DIJ,EAAQK,MAAM,eAChBL,EAAQK,MAAM,cAAeL,EAAQK,MAAM,qBACpCL,EAAQH,KAAKI,MAGlBD,EAAQM,OACVL,EAAKM,IAAIP,EAAQM,OAWnBE,GAAGC,cAAcT,EAAQK,MAAM,sBAAuB,SAAUK,GAC9D,GAAmB,KAAfA,EAAOC,KAAa,CACtB,IAAIC,EAAWF,EAAOb,KAQtBE,GALEA,EADqB,mBAAZa,EACIA,EAASf,EAAMgB,QAEfD,IAGwB,QAEvCb,EAAa,IAOjB,SAA8BA,GAC5BC,EAAQc,QAAU,SAAUC,GAC1Bd,EAAKA,KAAKc,IAGZ,IAAIC,EAASjB,EAAWM,MAAM,WAC1BY,EAAWlB,EAAWM,MAAM,aAEhC,GAAqB,mBAAVW,EACT,IACEA,EAAO,CACLE,OAAQlB,IAEV,MAAOmB,SAGJ,GAAqB,mBAAVH,EAChB,IACEC,EAAS,CACPC,OAAQlB,IAEV,MAAOmB,KAxBXC,CAAqBrB,KA8BhBE","file":"toolkit/component/text.js","sourcesContent":["/**\n * Created by leonlin on 16/11/3.\n */\ndefine([], function () {\n  return function (data) {\n    var serviceCenterService = data.serviceCenterService;\n    var element = data.element;\n    var global = data.global;\n    var previewMode = data.previewMode;\n    var text = $(\"<div></div>\");\n\n    if (element.$attr(\"data/text\")) {\n      element.$attr(\"data/series\", element.$attr(\"data/text\"));\n      delete element.data.text;\n    }\n\n    if (element.style) {\n      text.css(element.style);\n    }\n    /**\n    if(element.data.applied) {\n      text.text(element.data.series.value);\n    } else {\n      text.text(element.data.$attr(\"series/0/data/0\"));\n    }*/\n\n\n    var expression;\n    $$.runExpression(element.$attr(\"advance/expression\"), function (funRes) {\n      if (funRes.code == \"0\") {\n        var fnResult = funRes.data;\n\n        if (typeof fnResult == 'function') {\n          expression = fnResult(data, system);\n        } else {\n          expression = fnResult;\n        }\n\n        expression = expression ? expression : {};\n      } else {\n        expression = {};\n        ; //throw new Error(funRes.message);\n      }\n\n      runExpressionSuccess(expression);\n    });\n\n    function runExpressionSuccess(expression) {\n      element.setText = function (value) {\n        text.text(value);\n      };\n\n      var initFn = expression.$attr(\"on/init\");\n      var repeatFn = expression.$attr(\"on/repeat\");\n\n      if (typeof initFn == \"function\") {\n        try {\n          initFn({\n            target: element\n          });\n        } catch (e) {\n          ;\n        }\n      } else if (typeof initFn == \"function\") {\n        try {\n          repeatFn({\n            target: element\n          });\n        } catch (e) {\n          ;\n        }\n      }\n    }\n\n    return text;\n  };\n});"],"sourceRoot":"/source/"}