{"version":3,"sources":["toolkit/component/navitree.js"],"names":["define","data","navitree","$","addClass","target","element","getParameter","getValue","getDomainAreaLineTree","node","empty","getParents","then","navigators","push","createDom","inx","navigator","level","overlay","span","a","attr","css","append","getBrothers","brothers","str","lb","externalDevId","category","toLowerCase","label","text","on","event","stopPropagation","getPathLocation","path","navigateToTab","showTree","index","id","length","mouseEnter","mouseLeave","remove","off","createPopup","wrap","replace","renderBrothers","brother","div","i"],"mappings":"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","file":"toolkit/component/navitree.js","sourcesContent":["/**\n * Created by leonlin on 16/11/3.\n */\ndefine([], function () {\n  return function (data) {\n    var elemData = data;\n    var navitree = $(\"<div></div>\");\n    navitree.addClass(\"navigate-tree\");\n    var target = data.element;\n    var DIC = ['index', 'navigate', 'factory', 'production', 'devicegroup'];\n    var oldOverlay;\n    var main = target.getParameter(\"main\");\n    var ROLE = target.getValue(\"global/ROLE\");\n    target.getDomainAreaLineTree(function (node) {\n      navitree.empty();\n      var id = target.getParameter(\"id\");\n      node.getParents().then(function (navigators) {\n        navigators.push(node);\n\n        var createDom = function createDom(inx, navigator) {\n          var layer = navigator.level;\n          var span = $(\"<span></span>\");\n          var a = $(\"<a></a>\");\n          a.attr(\"id\", \"id_\" + inx);\n          span.css(\"dispaly\", \"inline-block\");\n          span.css(\"position\", \"relative\");\n          span.css(\"cursor\", \"pointer\");\n          span.css(\"font-weight\", \"bold\");\n          span.append(a);\n          var overlay;\n\n          function toLowercCase(str) {\n            return typeof str == 'string' ? str.toLowerCase() : str;\n          }\n\n          navigator.getBrothers().then(function (brothers) {\n            var lb = navigator.externalDevId && toLowercCase(navigator.category) == 'device' ? navigator.label + \"(\" + navigator.externalDevId + \")\" : navigator.label;\n            a.text(lb);\n            a.on(\"click\", function (event) {\n              event.stopPropagation();\n              navigator.getPathLocation().then(function (path) {\n                target.navigateToTab({\n                  showTree: navigator.showTree(),\n                  index: path,\n                  id: navigator.id\n                });\n              });\n            });\n\n            if (brothers.length > 0\n            /**&& typeof main != \"number\"*/\n            ) {\n                var mouseEnter;\n\n                var mouseLeave = function mouseLeave(event) {\n                  overlay.remove();\n                  span.off(\"mouseleave\");\n                  span.on(\"mouseenter\", mouseEnter);\n                };\n\n                mouseEnter = function mouseEnter(event) {\n                  overlay = createPopup();\n                  span.append(overlay);\n                  span.off(\"mouseenter\");\n                  span.on(\"mouseleave\", mouseLeave);\n                };\n\n                span.on(\"mouseenter\", mouseEnter);\n              }\n\n            ;\n\n            var createPopup = function createPopup() {\n              var wrap = $(\"<div></div>\");\n              var overlay = $(\"<div></div>\");\n              var replace = $(\"<div></div>\");\n              overlay.attr(\"id\", \"overlay\");\n              replace.css(\"width\", \"100%\");\n              replace.css(\"height\", \"25px\");\n              wrap.css(\"max-height\", \"200px\");\n              wrap.css(\"overflow\", \"auto\");\n              wrap.css(\"padding\", \"5px 0\");\n              wrap.css(\"background-color\", \"#fff\");\n\n              var renderBrothers = function renderBrothers(brother) {\n                var div = $(\"<div></div>\");\n                div.addClass(\"link\");\n                div.css(\"white-space\", \"nowrap\");\n                div.text(brother.label);\n                div.css(\"padding\", \"3px 10px\");\n                div.css(\"cursor\", \"pointer\");\n                div.on(\"click\", function (event) {\n                  brother.getPathLocation().then(function (path) {\n                    target.navigateToTab({\n                      showTree: brother.showTree(),\n                      index: path,\n                      id: brother.id\n                    });\n                  });\n                });\n                return div;\n              };\n\n              replace.on(\"click\", function (event) {\n                event.stopPropagation();\n                navigator.getPathLocation().then(function (path) {\n                  target.navigateToTab({\n                    showTree: navigator.showTree(),\n                    index: path,\n                    id: navigator.id\n                  });\n                });\n              });\n              overlay.append(replace);\n\n              for (var i in brothers) {\n                wrap.append(renderBrothers(brothers[i]));\n              }\n\n              ;\n              overlay.css(\"position\", \"absolute\");\n              overlay.css(\"z-index\", 99999);\n              overlay.css(\"left\", 0);\n              overlay.css(\"top\", 0);\n              overlay.append(wrap);\n              return overlay;\n            };\n          });\n          return span;\n        };\n\n        for (var i in navigators) {\n          navitree.append(createDom(i, navigators[i]));\n\n          if (i != navigators.length - 1) {\n            var span = $(\"<span> > </span>\");\n            span.css(\"margin\", \"0 10px\");\n            navitree.append(span);\n          }\n\n          ;\n        }\n\n        ;\n      });\n    });\n    return navitree;\n  };\n});"],"sourceRoot":"/source/"}