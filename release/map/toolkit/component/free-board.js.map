{"version":3,"sources":["toolkit/component/free-board.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","define","target","inject","comp","attr","val","i","$","fn","freeboard","cur","this","instance","previewMode","buttonEnabled","_DROPCONFIG_","greedy","drop","setMode","bool","renderLayout","inData","settingData","setting","undefined","color","padding","layout","children","remove","wrap","variable","variableName","find","window","traveseByChild","element","$attr","traverse","hasOwnProperty","oldValue","value","id","droppable","require","traverseRow","append","traverseColumn","targetDom","data","coldom","type","tabId","display","css","parent","parameters","align","col","coldomInner","length","endDom","hasBox","index","tElement","rowDom","instruct","move","dataBtn","emptyDom","delBtn","copyBtn","pasteBtn","cutBtn","tool","tabWrap","titleDom","minbutton","headerDom","style","text","dom","placeholder","title","$$","loadExternalJs","dataSwitch","el","path","method","Info","global","location","serviceCenterService","chartOptionService","projectUIService","angularStyle","timeout","resourceUIService","ticketTaskService","alertService","routeParam","q","imageslist","getParameters","options","map","onTabClick","after","draggable","cursor","revert","handle","start","stop","cursorAt","right","helper","ui","result","appendTo","containment","revertDuration","zIndex","contextMenu","bindings","paste","t","targetId","scope","onInsert","on","event","$apply","onDelete","onCut","onCopy","onSetting","onDataChange","dropConfig","$clone","over","out","dropBefore","onPaste","run","arguments","Error","param","eval","addClass","removeClass","onDrop","before","overBefore","outBefore"],"mappings":"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","file":"toolkit/component/free-board.js","sourcesContent":["function _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\n/**\n * Created by leonlin on 16/11/3.\n */\ndefine([], function () {\n  /**\n   * $(d).freeboard(data)\n   * $(d).freeboard(\"option\", \"renderLayout\", layout);\n   **/\n  var target = {\n    inject: function inject(comp) {\n      var loop = function loop(attr, val) {\n        target[attr] = val;\n      };\n\n      for (var i in comp) {\n        loop(i, comp[i]);\n      }\n    }\n  };\n\n  $.fn.freeboard = function () {\n    var cur = this;\n    var instance = {};\n    var previewMode = false;\n    var buttonEnabled = true;\n    var _DROPCONFIG_ = {\n      greedy: true,\n      drop: drop\n    };\n\n    var setMode = function setMode(bool) {\n      previewMode = bool;\n    };\n\n    var renderLayout = function renderLayout(inData) {\n      var settingData = inData.setting;\n\n      if (settingData == undefined) {\n        settingData = {\n          color: \"transparent\",\n          padding: 15\n        };\n      }\n\n      run(inData.layout);\n\n      function run(layout) {\n        $(cur).children().remove();\n        var wrap = $(\"<div class='wrap'></div>\");\n\n        layout.variable = function (variableName) {\n          var find = null;\n\n          if (window.variable == undefined) {\n            window.variable = {};\n          }\n\n          if (window[\"variable\"][variableName]) {\n            find = window[\"variable\"][variableName];\n          } else {\n            layout.traveseByChild(function (element) {\n              if (element.$attr(\"advance/variable\") == variableName) {\n                find = element;\n                window[\"variable\"][variableName] = element;\n              }\n            });\n          }\n\n          return find;\n        };\n\n        layout.traverse(function (attr, element) {\n          if (element.hasOwnProperty(\"__onChange__\")) {\n            element.oldValue = element.value;\n          }\n        });\n\n        if (!previewMode) {\n          $(cur).attr(\"id\", layout.id);\n\n          if (typeof wrap.droppable == 'function') {\n            wrap.droppable({\n              greedy: true\n            });\n          } else {\n            require(['jquery-ui'], function () {\n              wrap.droppable({\n                greedy: true\n              });\n            });\n          }\n        }\n\n        if (!previewMode) {\n          $(cur).append(wrap);\n          traverseRow(wrap, layout.children);\n        } else {\n          traverseRow($(cur), layout.children);\n        }\n\n        function traverseColumn(targetDom, data) {\n          for (var i in data) {\n            var coldom;\n\n            if (!previewMode) {\n              if (data[i].type == \"tabItem\") {\n                coldom = $(\"<div tabId='tabId_\" + data[i].tabId + \"' style='display:\" + data[i].display + \"' class='col-md-12'></div>\");\n                coldom.css(\"background-color\", \"#fff\");\n              } else {\n                coldom = $(\"<div class='col-md-\" + data[i].col + \" column'></div>\");\n              }\n            } else {\n              if (data[i].type == \"tabItem\") {\n                coldom = $(\"<div tabId='tabId_\" + data[i].tabId + \"' style='display:\" + data[i].display + \"' class='col-md-12'></div>\");\n                coldom.css(\"background-color\", \"#fff\");\n                coldom.css(\"min-height\", \"300px\");\n\n                if (data[i].parent.parent.parameters.align == \"vertical\") {\n                  coldom.css(\"float\", \"left\");\n                  coldom.css(\"width\", \"calc(100% - 100px)\");\n                }\n              } else {\n                coldom = $(\"<div class='col-md-\" + data[i].col + \"'></div>\");\n              }\n            }\n\n            if (data[i].$attr(\"parent/parent/source\") == \"ROW\") {\n              if (data[i].$attr(\"parent/parent/parameters/alignment\") == \"float\") {\n                coldom.css(\"width\", \"auto\");\n              }\n            }\n\n            if (settingData) {\n              if (settingData.padding) {//coldom.css(\"padding\", \"0 \" + settingData.padding + \"px\");\n              }\n            }\n\n            var coldomInner = $(\"<div class='wrap'></div>\");\n            targetDom.append(coldom);\n\n            if (!previewMode) {\n              coldom.attr(\"id\", data[i].id);\n            }\n\n            if (!previewMode) {\n              coldom.append(coldomInner);\n              traverseRow(coldomInner, data[i].children);\n            } else {\n              if (data[i].children) {\n                if (data[i].children.length > 0) {\n                  traverseRow(coldom, data[i].children);\n                }\n              }\n            }\n          }\n\n          ;\n        }\n\n        function traverseRow(targetDom, data) {\n          var endDom = $(\"<div id='endDom' class='emptyEnd'></div>\");\n          var hasBox = false;\n          endDom.attr(\"id\", $(targetDom).parent().attr(\"id\"));\n\n          for (var i in data) {\n            (function (index, element) {\n              var tElement;\n              var rowDom, instruct;\n              var coldomInner = $(\"<div class='wrap'></div>\");\n              var setting = $(\"<div class='btn'><span class='proudsmart ps-edit'></span></div>\");\n              var move = $(\"<div id='move' class='btn move'><span class='proudsmart ps-move'></span></div>\");\n              var dataBtn = $(\"<div id='data' class='btn'><span class='proudsmart ps-linked-data'></span></div>\");\n              var emptyDom = $(\"<div id='beforeDom' class='empty'></div>\");\n              var delBtn = $(\"<div class='btn'><span class='proudsmart ps-delete'></span></div>\");\n              var copyBtn = $(\"<div class='btn'><span class='glyphicon glyphicon-duplicate'></span></div>\");\n              var pasteBtn = $(\"<div class='btn'><span class='glyphicon glyphicon-duplicate'></span></div>\");\n              var cutBtn = $(\"<div class='btn'><span class='glyphicon glyphicon-scissors'></span></div>\");\n              var tool = $(\"<div class='tool'></div>\");\n              var tabWrap = $(\"<div class='tabWrap'></div>\");\n              var titleDom = $(\"<h3 class='box-title'>标题标题</h3>\");\n              var minbutton = $('<div class=\"box-tools pull-right\">\\\n\t\t\t\t\t\t\t\t\t\t<button class=\"btn btn-box-tool\" data-widget=\"collapse\"><i class=\"fa fa-minus\"></i></button>\\\n\t\t\t\t\t\t\t\t\t<button class=\"btn btn-box-tool\" data-widget=\"remove\"><i class=\"fa fa-times\"></i></button>\\\n\t\t\t\t\t\t\t\t\t</div>');\n              tool.append(delBtn);\n              tool.append(copyBtn);\n              tool.append(cutBtn);\n\n              if (element.type == \"box\") {\n                titleDom.css(\"width\", \"100%\");\n                tool.append(setting);\n                var headerDom = $(\"<div class='box-header with-border'></div>\");\n                headerDom.append(titleDom);\n                rowDom = $(\"<div class='row column'></div>\");\n\n                if (element.style) {\n                  rowDom.css(element.style);\n                }\n\n                rowDom.append(headerDom);\n\n                if (!previewMode) {\n                  rowDom.append(tool);\n                } else {\n                  headerDom.append(minbutton);\n                }\n              } else if (element.type == \"box-body\") {\n                instruct = $(\"<div class='instruct'></div>\");\n                instruct.text(\"内容区\");\n\n                if (!previewMode) {\n                  rowDom = $(\"<div class='row column'></div>\");\n                  rowDom.append(instruct);\n                } else {\n                  rowDom = $(\"<div></div>\");\n                }\n              } else if (element.type == \"box-footer\") {\n                instruct = $(\"<div class='instruct'></div>\");\n                instruct.text(\"注释区\");\n\n                if (!previewMode) {\n                  rowDom = $(\"<div class='row column'></div>\");\n                  rowDom.append(instruct);\n                } else {\n                  rowDom = $(\"<div></div>\");\n                }\n              } else if (element.type == \"block\") {\n                if (!previewMode) {\n                  rowDom = $(\"<div class='row column'></div>\");\n                  rowDom.append(tool);\n                } else {\n                  rowDom = $(\"<div class='row'></div>\");\n\n                  if (settingData) {\n                    rowDom.css(\"margin-right\", \"-\" + 0 + \"px\");\n                    rowDom.css(\"margin-left\", \"-\" + 0 + \"px\");\n                  }\n                }\n              } else if (element.type == \"tab\") {\n                if (!previewMode) {\n                  rowDom = $(\"<div class='row column'></div>\");\n                  rowDom.append(tool);\n                } else {\n                  rowDom = $(\"<div class='row'></div>\");\n                }\n\n                if (element.style) {\n                  rowDom.css(element.style);\n                }\n\n                rowDom.append(tabWrap);\n              } else {\n                if (!previewMode) {\n                  rowDom = $(\"<div class='row column'></div>\")\n                  /**.css(\"overflow\", \"hidden)*/\n                  ;\n                  rowDom.append(tool);\n                } else {\n                  rowDom = $(\"<div class='row'></div>\");\n                }\n              }\n\n              var addDom = function addDom(target, dom) {\n                if (dom) {\n                  target.append(dom);\n                }\n              };\n\n              var placeholder = $(\"<div></div>\");\n              addDom(previewMode ? targetDom : coldomInner, placeholder);\n              tElement = $(\"<div></div>\");\n\n              if (element.parameters) {\n                titleDom.text(element.parameters.title);\n              }\n\n              $$.loadExternalJs(['../toolkit/component/data-switch.js'], function (dataSwitch) {\n                var el = dataSwitch(element);\n                var path = '../../toolkit/component/' + el.type;\n                $$.loadExternalJs([path], callback);\n\n                function callback(method) {\n                  var dom = method({\n                    Info: target.Info,\n                    global: inData.layout,\n                    location: location,\n                    window: window,\n                    index: index,\n                    element: element,\n                    serviceCenterService: target.serviceCenterService,\n                    chartOptionService: target.chartOptionService,\n                    projectUIService: target.projectUIService,\n                    angularStyle: target.angularStyle,\n                    timeout: target.timeout,\n                    target: previewMode ? rowDom : coldomInner,\n                    tabWrap: tabWrap,\n                    targetDom: targetDom,\n                    coldomInner: coldomInner,\n                    rowDom: rowDom,\n                    previewMode: previewMode,\n                    resourceUIService: target.resourceUIService,\n                    ticketTaskService: target.ticketTaskService,\n                    buttonEnabled: buttonEnabled,\n                    alertService: target.alertService,\n                    routeParam: target.routeParam,\n                    q: target.q,\n                    imageslist: target.angularStyle.getParameters()[\"imgSrc\"].options.map(function (element) {\n                      return element.value;\n                    }),\n                    traverseColumn: traverseColumn,\n                    onTabClick: target.onTabClick\n                  });\n                  placeholder.after(dom);\n                  placeholder.remove();\n                }\n              });\n              tool.append(setting);\n              tool.append(move);\n\n              if (!previewMode) {\n                rowDom.append(coldomInner);\n                rowDom.attr(\"id\", element.id);\n                rowDom.draggable({\n                  cursor: 'move',\n                  revert: true,\n                  handle: move,\n                  start: start,\n                  stop: stop,\n                  cursorAt: {\n                    right: 30\n                  },\n                  helper: function helper(ui) {\n                    var result = $(\"<div class='colDrag row'>\" + \"<div class='col-xs-12'>\" + \"<div class='row title'>\" + \"移动一个区块去其它位置\" + \"</div>\" + \"<div class='row' id='grid'>\" + \"</div>\" + \"</div>\" + \"</div>\");\n                    return result;\n                  },\n                  appendTo: $(\".drawarea\"),\n                  containment: $(\".drawarea\"),\n                  revertDuration: 0,\n                  zIndex: 999\n                });\n              }\n\n              if (targetDom.attr(\"id\") != \"whole\" && data.length > 0) {\n                emptyDom.attr({\n                  id: element.id\n                });\n              }\n\n              if (!previewMode) {\n                if (typeof emptyDom.contextMenu == 'function') {\n                  emptyDom.contextMenu(\"myMenu1\", {\n                    'bindings': {\n                      'paste': function paste(t) {\n                        var targetId = $(t).attr(\"id\");\n                        scope.onInsert({\n                          id: targetId\n                        });\n                      }\n                    }\n                  });\n                }\n\n                delBtn.attr({\n                  id: element.id\n                });\n                delBtn.on(\"click\", function (event, ui) {\n                  scope.$apply(function () {\n                    scope.onDelete({\n                      event: event,\n                      ui: ui\n                    });\n                  });\n                });\n                cutBtn.attr({\n                  id: element.id\n                });\n                cutBtn.on(\"click\", function (event, ui) {\n                  scope.$apply(function () {\n                    scope.onCut({\n                      event: event,\n                      ui: ui\n                    });\n                  });\n                });\n                copyBtn.attr({\n                  id: element.id\n                });\n                copyBtn.on(\"click\", function (event, ui) {\n                  scope.$apply(function () {\n                    scope.onCopy({\n                      event: event,\n                      ui: ui\n                    });\n                  });\n                });\n                pasteBtn.attr({\n                  id: element.id\n                });\n                setting.attr({\n                  id: element.id\n                });\n                dataBtn.attr({\n                  id: element.id\n                });\n                setting.on(\"click\", function (event, ui) {\n                  scope.$apply(function () {\n                    scope.onSetting({\n                      event: event,\n                      ui: {\n                        element: tElement\n                      }\n                    });\n                  });\n                });\n                dataBtn.on(\"click\", function (event, ui) {\n                  scope.$apply(function () {\n                    scope.onDataChange({\n                      event: event,\n                      ui: ui\n                    });\n                  });\n                });\n              }\n\n              var hideEndBlank = false;\n\n              if (element.type != 'box-body' && element.type != 'box-footer') {\n                if (!previewMode) {\n                  targetDom.append(emptyDom);\n                }\n              } else {\n                hasBox = true;\n              }\n\n              if (!previewMode) {\n                targetDom.append(rowDom);\n              } else {\n                if (element.type == 'col' || element.type == 'row' || element.type == 'box' || element.type == 'box-body' || element.type == 'box-footer' || element.type == 'block' || element.type == 'tab') {\n                  targetDom.append(rowDom);\n                }\n              }\n\n              var dropConfig = _DROPCONFIG_.$clone();\n\n              dropConfig.over = over;\n              dropConfig.out = out;\n              dropConfig.drop = dropBefore;\n\n              if (typeof emptyDom.droppable == 'function') {\n                emptyDom.droppable(dropConfig);\n              } else {\n                require(['jquery-ui'], function () {\n                  emptyDom.droppable(dropConfig);\n                });\n              }\n\n              if (!previewMode) {\n                if (element.type == \"box\") {\n                  traverseRow(coldomInner, element.children);\n                } else {\n                  if (element.children) {\n                    if (element.children.length > 0) {\n                      traverseColumn(coldomInner, element.children);\n                    }\n                  }\n                }\n              } else {\n                if (element.type == \"box\") {\n                  traverseRow(rowDom, element.children);\n                } else {\n                  if (element.children) {\n                    if (element.children.length > 0) {\n                      traverseColumn(rowDom, element.children);\n                    }\n                  }\n                }\n              }\n            })(i, data[i]);\n          }\n\n          var dropConfig = _DROPCONFIG_.$clone();\n\n          dropConfig.over = over;\n          dropConfig.out = out;\n\n          if (typeof endDom.droppable == 'function') {\n            endDom.droppable(dropConfig);\n          } else {\n            require(['jquery-ui'], function () {\n              endDom.droppable(dropConfig);\n            });\n          }\n\n          if (!hasBox) {\n            if (!previewMode) {\n              targetDom.append(endDom);\n\n              if (typeof endDom.contextMenu == 'function') {\n                endDom.contextMenu(\"myMenu1\", {\n                  'bindings': {\n                    'paste': function paste(t) {\n                      var targetId = $(t).attr(\"id\");\n                      scope.onPaste({\n                        id: targetId\n                      });\n                    }\n                  }\n                });\n              } else {\n                require(['contextMenu'], function () {\n                  endDom.contextMenu(\"myMenu1\", {\n                    'bindings': {\n                      'paste': function paste(t) {\n                        var targetId = $(t).attr(\"id\");\n                        scope.onPaste({\n                          id: targetId\n                        });\n                      }\n                    }\n                  });\n                });\n              }\n            }\n          }\n        }\n      }\n\n      ;\n    };\n\n    if (typeof arguments.length == 0) {\n      if (_typeof(arguments[0]) == \"object\") {\n        renderLayout(arguments[0]);\n      } else {\n        throw new Error(\"parameter is not a object\");\n      }\n    } else {\n      if (arguments[0] == \"option\") {\n        var method = arguments[1];\n        var param = arguments[2];\n        eval(method)(param);\n      }\n    }\n\n    function start(event, ui) {\n      $(\"#drawarea\").css(\"overflow-y\", \"hidden\");\n      var targetId = $(event.target).attr(\"id\");\n      $(\"#\" + targetId + \".empty\").addClass(\"hideElement\");\n      $(\"#\" + targetId + \".row\").addClass(\"hideElement\");\n    }\n\n    function stop(event, ui) {\n      $(\"#drawarea\").css(\"overflow-y\", \"auto\");\n      var targetId = $(event.target).attr(\"id\");\n      $(\"#\" + targetId + \".empty\").removeClass(\"hideElement\");\n      $(\"#\" + targetId + \".row\").removeClass(\"hideElement\");\n    }\n\n    function dropBefore(event, ui) {\n      scope.onDrop({\n        event: event,\n        ui: ui,\n        before: true\n      });\n    }\n\n    function over(event, ui) {\n      var targetId = $(event.target).attr(\"id\");\n      var dragId = ui.draggable.attr(\"id\");\n\n      if (targetId != dragId) {\n        var target = $(event.target);\n        target.addClass(\"hover\");\n      }\n    }\n\n    function out(event, ui) {\n      var target = $(event.target);\n      target.removeClass(\"hover\");\n    }\n\n    function overBefore(event, ui) {\n      var target = $(event.target);\n      target.children(\".wrap\").addClass(\"hover\");\n    }\n\n    function outBefore(event, ui) {\n      var target = $(event.target);\n      target.children(\".wrap\").removeClass(\"hover\");\n    }\n\n    function drop(event, ui) {\n      scope.onDrop({\n        event: event,\n        ui: ui,\n        before: false\n      });\n    }\n\n    instance.renderLayout = renderLayout;\n    instance.setMode = setMode;\n    return instance;\n  };\n\n  return target;\n});"],"sourceRoot":"/source/"}