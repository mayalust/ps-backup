{"version":3,"sources":["toolkit/component/tabshow.js"],"names":["define","data","element","tabWrap","coldomInner","previewMode","traverseColumn","onTabClick","rowDom","undefined","tabInx","fd","children","find","elem","default","indexOf","ulDom","$","liAdd","$attr","addClass","css","append","renderTab","i","remove","index","child","liDom","label","editBtn","removeBtn","display","tabId","attr","text","tabName","before","on","event","ui","stopPropagation","target","parent","length","$remove","inx","j","removeClass","push","id","$randomString","type"],"mappings":"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","file":"toolkit/component/tabshow.js","sourcesContent":["/**\n * Created by leonlin on 16/11/3.\n */\ndefine([], function () {\n  return function (data) {\n    var element = data.element;\n    var tabWrap = data.tabWrap;\n    var coldomInner = data.coldomInner;\n    var previewMode = data.previewMode;\n    var traverseColumn = data.traverseColumn;\n    var onTabClick = data.onTabClick;\n    var rowDom = data.rowDom;\n\n    if (element.tabInx == undefined) {\n      var fd = element.children.find(function (elem) {\n        return elem.default == true;\n      });\n\n      if (fd) {\n        element.tabInx = element.children.indexOf(fd);\n      } else {\n        element.tabInx = 0;\n      }\n    }\n\n    var ulDom = $(\"<div class='nav nav-tabs'></div>\");\n    var liAdd = $(\"<li style='cursor : pointer;'><a><span class='glyphicon glyphicon-plus'></span><span class=''>创建标签</span></a></li>\");\n\n    if (element.$attr(\"parameters/align\") == \"vertical\") {\n      ulDom.addClass(\"vertical\");\n      tabWrap.css(\"float\", \"left\");\n      tabWrap.css(\"width\", \"100px\");\n\n      if (!previewMode) {\n        coldomInner.css(\"float\", \"left\");\n        coldomInner.css(\"width\", \"calc( 100% - 100px )\");\n      }\n    } //coldomInner.addClass(\"tab-content\");\n\n\n    tabWrap.append(ulDom);\n\n    var renderTab = function renderTab() {\n      ulDom.children().remove();\n\n      if (!previewMode) {\n        ulDom.append(liAdd);\n      }\n\n      ;\n\n      for (var i in element.children) {\n        (function (index, child) {\n          var liDom = $(\"<li style='cursor:pointer;'><a></a></li>\");\n          var label = $(\"<span></span>\");\n          var editBtn = $(\"<span class='proudsmart ps-edit' style='cursor:pointer;'></span>\");\n          var removeBtn = $(\"<span class='glyphicon glyphicon-remove' style='cursor:pointer;'></span>\");\n          label.css(\"padding-right\", \"5px\");\n          editBtn.css(\"padding-right\", \"5px\");\n\n          if (element.tabInx == index) {\n            child.display = \"block\";\n            liDom.addClass(\"active\");\n          } else {\n            child.display = \"none\";\n          }\n\n          ;\n          child.tabId = index;\n          liDom.attr(\"id\", index);\n          label.text(child.tabName);\n          liDom.find(\"a\").append(label);\n\n          if (!previewMode) {\n            liDom.find(\"a\").append(editBtn);\n            liDom.find(\"a\").append(removeBtn);\n            liAdd.before(liDom);\n            editBtn.on(\"click\", function (event, ui) {\n              event.stopPropagation();\n              onTabClick({\n                event: event,\n                ui: ui,\n                target: child,\n                parent: element\n              });\n            });\n            removeBtn.on(\"click\", function (event) {\n              event.stopPropagation();\n\n              if (element.children.length > 1) {\n                element.children.$remove(function (inx, elem) {\n                  return index == inx;\n                });\n\n                if (element.tabInx >= index) {\n                  if (element.tabInx > 0) {\n                    element.tabInx--;\n                  }\n                }\n\n                if (!previewMode) {\n                  coldomInner.children().remove();\n                  renderTab();\n                  traverseColumn(coldomInner, element.children, previewMode);\n                } else {\n                  rowDom.children(\"[tabId]\").remove();\n                  renderTab();\n                  traverseColumn(rowDom, element.children, previewMode);\n                }\n              }\n            });\n          } else {\n            ulDom.append(liDom);\n          }\n\n          ;\n          liDom.on(\"click\", function () {\n            ulDom.find(\".active\").removeClass(\"active\");\n            liDom.addClass(\"active\");\n            element.tabInx = index;\n\n            for (var j in element.children) {\n              element.children[j].display = \"none\";\n            }\n\n            child.display = \"block\";\n\n            if (!previewMode) {\n              coldomInner.children().remove();\n              renderTab();\n              traverseColumn(coldomInner, element.children, previewMode);\n            } else {\n              rowDom.children(\"[tabId]\").remove();\n              renderTab();\n              traverseColumn(rowDom, element.children, previewMode);\n            }\n          });\n        })(i, element.children[i]);\n      }\n\n      liAdd.on(\"click\", function () {\n        element.children.push({\n          \"id\": $randomString(32),\n          \"tabName\": \"新建标签页\",\n          \"tabId\": element.children.length - 1,\n          \"type\": \"tabShowItem\",\n          \"display\": \"none\",\n          \"children\": []\n        });\n\n        if (!previewMode) {\n          coldomInner.children().remove();\n          renderTab();\n          traverseColumn(coldomInner, element.children, previewMode);\n        } else {\n          rowDom.children(\"[tabId]\").remove();\n          renderTab();\n          traverseColumn(rowDom, element.children, previewMode);\n        }\n      });\n    };\n\n    renderTab();\n  };\n});"],"sourceRoot":"/source/"}