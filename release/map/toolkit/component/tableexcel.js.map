{"version":3,"sources":["toolkit/component/tableexcel.js"],"names":["define","echarts","data","expression","dom","$","element","global","target","route","style","css","$$","runExpression","$attr","funRes","code","fnResult","system","render","children","remove","Info","thm","createCell","type","text","col","row","cell","attr","line-height","text-align","border","text-overflow","white-space","overflow","cursor","createEchart","seriesData","legendData","yAxisName","title","xAxisData","header","j","body","push","item","name","option","tooltip","trigger","formatter","legend","left","xAxis","splitLine","show","grid","right","bottom","containLabel","yAxis","series","div","setTimeout","height","HEIGH","init","setOption","i","append","d","table","thead","tr","length","tr1","createHeader","tbody","createTr","createBody","initFn","e","growl","message"],"mappings":"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","file":"toolkit/component/tableexcel.js","sourcesContent":["/**\n * Created by leonlin on 16/11/3.\n */\ndefine(['echarts'], function (echarts) {\n  return function (data) {\n    var dom = $(\"<div></div>\");\n    var element = data.element;\n    var global = data.global;\n    var target = data.target;\n    var route = data.route;\n\n    if (element.style) {\n      target.css(element.style);\n    }\n\n    var expression;\n    $$.runExpression(element.$attr(\"advance/expression\"), function (funRes) {\n      if (funRes.code == \"0\") {\n        var fnResult = funRes.data;\n\n        if (typeof fnResult == 'function') {\n          expression = fnResult(data, system);\n        } else {\n          expression = fnResult;\n        }\n\n        expression = expression ? expression : {};\n      } else {\n        expression = {};\n        ;\n      }\n    });\n\n    element.render = function (data) {\n      dom.children().remove();\n      element.Info(\"../localdb/echartTheme/baogang.json\", function (thm) {\n        function createCell(type, text, col, row) {\n          var cell = $(\"<\" + type + \"></\" + type + \">\");\n          cell.text(text);\n          cell.attr(\"colspan\", col);\n          cell.attr(\"rowspan\", row); // cell.css(\"line-height\", \"30px\");\n          // cell.css(\"text-align\", \"center\");\n          // cell.css(\"border\", \"1px solid #35657d\");\n\n          cell.css({\n            \"line-height\": \"30px\",\n            \"text-align\": \"center\",\n            \"border\": \"1px solid #7FB5D3\",\n            \"text-overflow\": \"ellipsis\",\n            \"white-space\": \"nowrap\",\n            \"overflow\": \"hidden\",\n            \"cursor\": \"pointer\"\n          });\n          cell.attr(\"title\", text);\n\n          if (type == \"th\") {\n            cell.css(\"color\", \"#9AC9EA \");\n            cell.css(\"background-color\", \"#163855\");\n          } else {\n            cell.css(\"color\", \"#BBBBBB\");\n          }\n\n          cell.css(\"font-weight\", \"bold\");\n          return cell;\n        }\n\n        function createTable(d) {\n          var table = $(\"<table></table>\");\n          table.css(\"table-layout\", \"fixed\");\n          table.css(\"border\", \"2px solid #107489\");\n          table.css(\"width\", \"calc(100% - 20px)\");\n          table.css(\"margin\", \"20px 10px\");\n\n          function createHeader(title, text, header) {\n            var thead = $(\"<thead></thead>\");\n            var tr = $(\"<tr></tr>\");\n            var left;\n            tr.append(createCell(\"th\", text, 1, 2));\n            tr.append(createCell(\"th\", title, header.length, 1));\n            var tr1 = $(\"<tr></tr>\");\n\n            for (var i in header) {\n              tr1.append(createCell(\"th\", header[i]));\n            }\n\n            thead.append(tr);\n            thead.append(tr1);\n            return thead;\n          }\n\n          function createBody(body) {\n            var tbody = $(\"<tbody></tbody>\");\n\n            function createTr(d, attr) {\n              var tr = $(\"<tr></tr>\");\n              tr.append(createCell(\"td\", attr));\n\n              for (var i in d) {\n                tr.append(createCell(\"td\", d[i]));\n              }\n\n              return tr;\n            }\n\n            for (var i in body) {\n              tbody.append(createTr(body[i], i));\n            }\n\n            return tbody;\n          }\n\n          table.append(createHeader(d.title, d.text, d.header));\n          table.append(createBody(d.body));\n          return table;\n        }\n\n        function createEchart(data) {\n          var HEIGH = 300;\n          var seriesData = [];\n          var legendData = [];\n          var yAxisName = data.title;\n          var xAxisData = data.header;\n\n          for (var j in data.body) {\n            legendData.push(j);\n            var item = {\n              name: j,\n              type: 'line',\n              data: data.body[j]\n            };\n            seriesData.push(item);\n          }\n\n          var option = {\n            tooltip: {\n              trigger: 'axis',\n              formatter: '{a} <br/>{b} : {c}'\n            },\n            legend: {\n              left: 'center',\n              data: legendData\n            },\n            xAxis: {\n              type: 'category',\n              name: 'x',\n              splitLine: {\n                show: false\n              },\n              data: xAxisData\n            },\n            grid: {\n              left: '3%',\n              right: '4%',\n              bottom: '3%',\n              containLabel: true\n            },\n            yAxis: {\n              name: yAxisName,\n              type: 'value'\n            },\n            series: seriesData\n          };\n\n          function echart(dom) {\n            dom.style.height = HEIGH + \"px\";\n            return echarts.init(dom, thm);\n          }\n\n          var div = $(\"<div></div>\");\n          setTimeout(function () {\n            var ins = echart(div[0]);\n            ins.setOption(option);\n          });\n          return div;\n        }\n\n        for (var i in data) {\n          dom.append(createTable(data[i]));\n        }\n\n        for (var i in data) {\n          dom.append(createEchart(data[i]));\n        }\n      });\n    };\n\n    function createEchart() {\n      var div = $(\"<div></div>\");\n      div.css(\"height\", \"300px\");\n      dom.append(div);\n      var option = {\n        xAxis: {\n          type: 'category',\n          boundaryGap: false,\n          data: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']\n        },\n        yAxis: {\n          type: 'value'\n        },\n        series: [{\n          data: [820, 932, 901, 934, 1290, 1330, 1320],\n          type: 'line',\n          areaStyle: {}\n        }]\n      };\n      var ins = echart.init(div[0], options);\n    }\n\n    var initFn = expression.$attr(\"on/init\");\n\n    if (initFn) {\n      try {\n        initFn({\n          target: element,\n          global: global\n        });\n      } catch (e) {\n        element.growl(e.message, \"warning\");\n      }\n    }\n\n    return dom;\n  };\n});"],"sourceRoot":"/source/"}