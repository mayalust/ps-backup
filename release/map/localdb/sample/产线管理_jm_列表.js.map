{"version":3,"sources":["localdb/sample/产线管理_jm_列表.js"],"names":["expression","theme","on","init","event","target","scope","getRootScope","resource","getValue","taskStatusAry","id","label","format","name","composory","index","render","data","type","full","item","myDicts","specialtyProps","find","valueCode","popuptype","selectId","selectLabel","broadcast","options","analyzeItem","parentName","parentKey","executionCycle","content","icon","click","row","columnIndex","popupHandler","deleteTask","returnObj","growl","readerData","inputparam","status","obj","filter","fmt","undefined","colnum","createSystemPopupByLocalPath","width","title","submit","destroy","statuc","addOfflineStandard","extendParam","paras4list","deviceId","ticketCategory","getTaskBySimpleConditionAndPage","workArray","tablefmt","hide","map","elem","value","popupaddclick","$on","listsearchclick","param","args"],"mappings":"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","file":"localdb/sample/产线管理_jm_列表.js","sourcesContent":["expression = {\n  \"theme\": \"dark\",\n  \"on\": {\n    \"init\": function init(event) {\n      var target = event.target;\n      var scope = target.getRootScope();\n      var resource = target.getValue(\"global/resource\");\n      var taskStatusAry = [{\n        id: 0,\n        label: \"启用\"\n      }, {\n        id: 1,\n        label: \"停用\"\n      }];\n      var format = [{\n        name: \"standardName\",\n        label: \"项目名称\",\n        composory: true,\n        index: 0\n      }, {\n        name: \"specialtyProps\",\n        label: \"检测专业\",\n        composory: true,\n        render: function render(data, type, full) {\n          var item;\n\n          if (scope.myDicts.specialtyProps) {\n            item = scope.myDicts.specialtyProps.find(function (item) {\n              if (item.valueCode == data) return item;\n            });\n          }\n\n          if (item) {\n            return item.label;\n          }\n\n          return data;\n        },\n        popuptype: \"select\",\n        selectId: \"valueCode\",\n        selectLabel: \"label\",\n        broadcast: true,\n        options: scope.myDicts.specialtyProps,\n        index: 1\n      }, {\n        name: \"analyzeItem\",\n        label: \"分析项目\",\n        composory: true,\n        render: function render(data, type, full) {\n          var item;\n\n          if (scope.myDicts.analyzeItem) {\n            item = scope.myDicts.analyzeItem.find(function (item) {\n              if (item.valueCode == data) return item;\n            });\n          }\n\n          if (item) {\n            return item.label;\n          }\n\n          return data;\n        },\n        popuptype: \"select\",\n        selectId: \"valueCode\",\n        selectLabel: \"label\",\n        parentName: \"specialtyProps\",\n        parentKey: \"parentCode\",\n        options: scope.myDicts.analyzeItem,\n        index: 2\n      }, {\n        name: \"executionCycle\",\n        label: \"周期单位\",\n        composory: true,\n        popuptype: \"select\",\n        selectId: \"valueCode\",\n        selectLabel: \"label\",\n        options: scope.myDicts.executionCycle,\n        render: function render(data, type, full) {\n          var item;\n\n          if (scope.myDicts.executionCycle) {\n            item = scope.myDicts.executionCycle.find(function (item) {\n              if (item.valueCode == data) return item;\n            });\n          }\n\n          if (item) {\n            return item.label;\n          }\n\n          return data;\n        },\n        index: 3\n      }, {\n        name: \"cycleNum\",\n        label: \"周期间隔\",\n        composory: true,\n        index: 4\n      }, {\n        name: \"firstExecutionTime\",\n        label: \"开始时间\",\n        composory: true,\n        type: \"date\",\n        popuptype: \"datePicker\",\n        index: 5\n      }, {\n        name: \"taskStatus\",\n        label: \"是否启用\",\n        popuptype: \"select\",\n        selectId: \"id\",\n        selectLabel: \"label\",\n        options: taskStatusAry,\n        render: function render(data, type, full) {\n          var item = taskStatusAry.find(function (item) {\n            if (item.id == data) return item;\n          });\n\n          if (item) {\n            return item.label;\n          }\n\n          return data;\n        },\n        index: 6\n      }, {\n        label: \"操作\",\n        type: \"buttonGroup\",\n        content: [{\n          label: \"详情\",\n          icon: \"null\",\n          on: {\n            click: function click(index, row, columnIndex) {\n              popupHandler(index.row, 0);\n            }\n          }\n        }, {\n          label: \"编辑\",\n          icon: \"null\",\n          on: {\n            click: function click(index, row, columnIndex) {\n              popupHandler(index.row, 1);\n            }\n          }\n        }, {\n          label: \"删除\",\n          icon: \"null\",\n          on: {\n            click: function click(index, row, columnIndex) {\n              target.deleteTask(index.row.id, function (returnObj) {\n                if (returnObj) {\n                  target.growl(\"删除成功\");\n                  readerData();\n                }\n              });\n            }\n          }\n        }]\n      }];\n\n      var popupHandler = function popupHandler(inputparam, status) {\n        //只有让有index的传递到popup\n        var objfmt = format.filter(function (fmt) {\n          if (fmt.index != undefined) return fmt;\n        });\n        var obj = {\n          resource: inputparam,\n          format: objfmt,\n          status: status,\n          colnum: 1\n        };\n        target.createSystemPopupByLocalPath(\"popup\", {\n          width: \"50%\",\n          title: \"精密检测标准\",\n          on: {\n            submit: function submit(data, destroy) {\n              if (data.statuc == \"success\" && data.data) {\n                target.addOfflineStandard(data.data, function (returnObj) {\n                  if (returnObj) {\n                    target.growl(\"保存成功\");\n                    readerData();\n                    if (destroy) destroy();\n                  }\n                });\n              }\n            }\n          }\n        }, obj);\n      };\n\n      var render = function render(workArray) {\n        //只有让有hide=false的传递到datatable\n        var tablefmt = format.filter(function (fmt) {\n          if (!fmt.hide) return fmt;\n        });\n        target.render({\n          data: workArray,\n          format: tablefmt.map(function (elem) {\n            return {\n              \"name\": elem.label,\n              \"value\": elem.name,\n              \"type\": elem.type || \"text\",\n              \"content\": elem.content,\n              \"render\": elem.render\n            };\n          })\n        });\n      };\n\n      var extendParam = {};\n\n      var readerData = function readerData() {\n        var paras4list = {\n          deviceId: resource.id,\n          ticketCategory: \"110\"\n        };\n\n        if (extendParam) {\n          paras4list.analyzeItem = extendParam.analyzeItem;\n          paras4list.specialtyProps = extendParam.specialtyProps;\n        }\n\n        target.getTaskBySimpleConditionAndPage(paras4list, function (returnObj) {\n          render(returnObj.data);\n        });\n      }; //监听别的地方告诉我添加\n\n\n      if (scope.popupaddclick) {\n        scope.popupaddclick();\n        scope.popupaddclick = null;\n      }\n\n      scope.popupaddclick = scope.$on(\"POPUPADDCLICK\", function () {\n        popupHandler({\n          deviceId: resource.id\n        }, 1);\n      });\n\n      if (scope.listsearchclick) {\n        scope.listsearchclick();\n        scope.listsearchclick = null;\n      }\n\n      scope.listsearchclick = scope.$on(\"LISTSEARCHCLICK\", function (param, args) {\n        extendParam = args;\n        readerData();\n      });\n\n      if (resource) {\n        readerData();\n      }\n\n      target.on(\"tree_resourceChange\", function (obj) {\n        resource = obj.resource;\n        readerData();\n      });\n    }\n  }\n};"],"sourceRoot":"/source/"}