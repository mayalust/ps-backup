{"version":3,"sources":["localdb/sample/POPUP标准.js"],"names":["expression","on","init","event","target","scope","global","getRootScope","params","getPopupData","resource","format","colnum","status","sort","a","b","index","ctrlGroups","subGroups","count","i","length","fmt","fmtnameAry","name","split","n1","n2","valueObj","labelObj","type","composory","value","label","popuptype","undefined","change","elem","current","id","broadcast","$broadcast","$emit","options","selectId","selectLabel","parentName","parentKey","Math","uuid","attrs","disabled","getUTCDateString","group","manual","multiple","btnstatus","text","path","submit","returnObj","fileDom","download","forEach","window","open","del","render","find","Number","stretch","push","colSpan"],"mappings":"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","file":"localdb/sample/POPUP标准.js","sourcesContent":["/**\n * 注意：在使用时，删除该注释的内容\n * POPUP标准，适用于有弹出的各级视图，绝大部分情况下请勿修改\n * 版本：1.0.3\n * 多个下载的路径修改\n * 1.0.2 download和del支持了下载和清空\n * 1.0.1 上传增加了multiple属性\n */\nexpression = {\n  on: {\n    init: function init(event) {\n      var target = event.target;\n      var global = event.global;\n      var scope = target.getRootScope(); //获得显示数据\n\n      var params = target.getPopupData().resource; //获得form表单格式,这里可以修改format，比如format2\n\n      var format = target.getPopupData().format; //获得分列数\n\n      var colnum = target.getPopupData().colnum ? target.getPopupData().colnum : 2; //获得编辑状态：0表示查看，1表示编辑\n\n      var status = target.getPopupData().status;\n\n      if (!params || !format) {\n        return;\n      } //按照显示格式排序\n\n\n      format.sort(function (a, b) {\n        return a.index - b.index;\n      }); //控制form的显示\n\n      var ctrlGroups = [];\n      var subGroups = [];\n      var count = 0;\n\n      for (var i = 0; i < format.length; i++) {\n        count++; //计数器开始计数，用于%\n\n        var fmt = format[i]; //如果名字有.的话，拆分\n\n        var fmtnameAry = fmt.name.split(\".\");\n\n        if (fmtnameAry.length > 1) {\n          fmt.n1 = fmtnameAry[0];\n          fmt.n2 = fmtnameAry[1];\n        } //设置label的内容\n\n\n        var labelObj = {\n          type: \"label\",\n          composory: fmt.composory,\n          value: fmt.label + \":\" //设置value的内容，可以扩展下面的类型\n\n        };\n        var valueObj;\n\n        if (fmt.popuptype == \"select\") {\n          valueObj = {\n            type: \"select\",\n            value: fmtnameAry.length > 1 ? params[fmt.n1][fmt.n2] != undefined ? params[fmt.n1][fmt.n2] : \"请选择\" : params[fmt.name] != undefined ? params[fmt.name] : \"请选择\",\n            on: {\n              change: function change(elem) {\n                if (elem.current.n1) {\n                  params[elem.current.n1][elem.current.n2] = elem.value[elem.current.format.id];\n                } else {\n                  params[elem.current.name] = elem.value[elem.current.format.id];\n                } //  如果有broadcast为true的时候，发布自己的选中值\n\n\n                if (elem.current.format.broadcast) {\n                  scope.$broadcast(elem.current.name, {\n                    value: elem.value[elem.current.format.id]\n                  });\n                  scope.$emit(elem.current.name, {\n                    value: elem.value[elem.current.format.id]\n                  });\n                }\n              }\n            },\n            options: fmt.options,\n            format: {\n              id: fmt.selectId,\n              label: fmt.selectLabel,\n              broadcast: fmt.broadcast,\n              parentName: fmt.parentName,\n              parentKey: fmt.parentKey\n            },\n            name: fmt.name,\n            n1: fmt.n1,\n            n2: fmt.n2\n          };\n        } else if (fmt.popuptype == \"dateTimePicker\" || fmt.popuptype == \"datePicker\") {\n          valueObj = {\n            id: Math.uuid(),\n            type: fmt.popuptype,\n            attrs: fmt.attrs,\n            value: fmtnameAry.length > 1 ? params[fmt.n1][fmt.n2] : params[fmt.name],\n            disabled: status == 0 ? \"disabled\" : false,\n            on: {\n              change: function change(elem) {\n                if (elem.current.n1) {\n                  params[elem.current.n1][elem.current.n2] = elem.value.getUTCDateString;\n                } else {\n                  params[elem.current.name] = elem.value.getUTCDateString;\n                }\n              }\n            },\n            name: fmt.name,\n            n1: fmt.n1,\n            n2: fmt.n2\n          };\n        } else if (fmt.popuptype == \"uploadFile\" || fmt.popuptype == \"uploadFile2\") {\n          valueObj = {\n            type: fmt.popuptype,\n            attrs: fmt.attrs,\n            group: fmt.group,\n            manual: fmt.manual,\n            multiple: fmt.multiple,\n            btnstatus: fmt.btnstatus,\n            text: fmt.text,\n            path: fmt.path,\n            disabled: status == 0 ? \"disabled\" : false,\n            on: {\n              submit: function submit(returnObj, fileDom, elem) {\n                if (elem.n1) {\n                  params[elem.n1][elem.n2] = returnObj;\n                } else {\n                  params[elem.name] = returnObj;\n                }\n              },\n              download: function download(returnObj, fileDom, elem) {\n                //支持多个路径用,分割\n                var pathary = elem.path.split(\",\");\n                pathary.forEach(function (path) {\n                  if (path) {\n                    window.open(path, '_blank');\n                  }\n                });\n              },\n              del: function del(returnObj, fileDom, elem) {\n                if (elem.n1) {\n                  params[elem.n1][elem.n2] = null;\n                } else {\n                  params[elem.name] = null;\n                }\n              }\n            },\n            name: fmt.name,\n            n1: fmt.n1,\n            n2: fmt.n2\n          };\n        } else if (fmt.popuptype == \"customHtml\") {\n          valueObj = {\n            type: fmt.popuptype,\n            attrs: fmt.attrs,\n            value: fmtnameAry.length > 1 ? fmt.render ? fmt.render(params[fmt.n1][fmt.n2]) : params[fmt.n1][fmt.n2] : fmt.render ? fmt.render(params[fmt.name]) : params[fmt.name]\n          };\n        } else if (fmt.popuptype == \"textarea\") {\n          valueObj = {\n            type: \"textarea\",\n            attrs: fmt.attrs,\n            value: fmtnameAry.length > 1 ? fmt.render ? fmt.render(params[fmt.n1][fmt.n2]) : params[fmt.n1][fmt.n2] : fmt.render ? fmt.render(params[fmt.name]) : params[fmt.name],\n            disabled: status == 0 ? \"disabled\" : false,\n            on: {\n              change: function change(elem) {\n                if (elem.current.n1) {\n                  params[elem.current.n1][elem.current.n2] = elem.value;\n                } else {\n                  params[elem.current.name] = elem.value;\n                }\n              }\n            },\n            name: fmt.name,\n            n1: fmt.n1,\n            n2: fmt.n2\n          };\n        } else {\n          valueObj = {\n            type: \"input\",\n            attrs: fmt.attrs,\n            value: fmtnameAry.length > 1 ? fmt.render ? fmt.render(params[fmt.n1][fmt.n2]) : params[fmt.n1][fmt.n2] : fmt.render ? fmt.render(params[fmt.name]) : params[fmt.name],\n            disabled: status == 0 ? \"disabled\" : false,\n            on: {\n              change: function change(elem) {\n                var find = elem.current.attrs && elem.current.attrs.type == \"number\";\n\n                if (elem.current.n1) {\n                  params[elem.current.n1][elem.current.n2] = find ? Number(elem.value) : elem.value;\n                } else {\n                  params[elem.current.name] = find ? Number(elem.value) : elem.value;\n                }\n              }\n            },\n            name: fmt.name,\n            n1: fmt.n1,\n            n2: fmt.n2\n          };\n        } //如果拉伸的话，那么就另起一行，之前的都要存起来\n\n\n        if (fmt.stretch) {\n          if (subGroups.length > 0) {\n            ctrlGroups.push(subGroups); //把以前的存起来\n\n            subGroups = [];\n          }\n\n          valueObj.colSpan = colnum * 2; //设置colSpan为colnum的两倍\n\n          subGroups.push(labelObj);\n          subGroups.push(valueObj);\n          ctrlGroups.push(subGroups); //把现在的存起来\n\n          count = 0; //计数器重置\n\n          subGroups = [];\n        } else {\n          subGroups.push(labelObj);\n          subGroups.push(valueObj);\n\n          if (count % colnum == 0) {\n            count = 0; //计数器重置\n\n            ctrlGroups.push(subGroups);\n            subGroups = [];\n          }\n        }\n      } //最后如果还有没配对的，那么就再次放入\n\n\n      if (subGroups.length > 0) {\n        ctrlGroups.push(subGroups);\n      }\n\n      target.render(ctrlGroups);\n    }\n  }\n};"],"sourceRoot":"/source/"}