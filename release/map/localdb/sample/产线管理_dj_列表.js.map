{"version":3,"sources":["localdb/sample/产线管理_dj_列表.js"],"names":["expression","theme","on","init","event","target","scope","getRootScope","resource","getValue","taskStatusAry","id","label","format","name","composory","index","hide","popuptype","selectId","selectLabel","options","myDicts","pcsDeviceState","pcsActionUser","pcsSafetyPoint","executionCycle","render","data","type","full","item","find","valueCode","content","icon","click","row","columnIndex","popupHandler","deleteTask","returnObj","code","growl","readerData","inputparam","status","obj","filter","fmt","undefined","colnum","createSystemPopupByLocalPath","width","title","submit","destroy","statuc","addPointCheckStanard","extendParam","paras4list","deviceId","ticketCategory","standardNo","modifyTime","getTaskBySimpleConditionAndPage","workArray","tablefmt","map","elem","value","popupaddclick","$on","pointCheckItemList","listsearchclick","param","args"],"mappings":"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","file":"localdb/sample/产线管理_dj_列表.js","sourcesContent":["expression = {\n  \"theme\": \"dark\",\n  \"on\": {\n    \"init\": function init(event) {\n      var target = event.target;\n      var scope = target.getRootScope();\n      var resource = target.getValue(\"global/resource\");\n      var taskStatusAry = [{\n        id: 0,\n        label: \"启用\"\n      }, {\n        id: 1,\n        label: \"停用\"\n      }];\n      var format = [{\n        name: \"standardNo\",\n        label: \"点检标准编号\",\n        composory: true,\n        index: 0\n      }, {\n        name: \"standardName\",\n        label: \"点检项目名称\",\n        composory: true,\n        index: 1\n      }, {\n        name: \"fatNumber\",\n        label: \"油脂料号\",\n        composory: true,\n        hide: true,\n        index: 2\n      }, {\n        name: \"deviceState\",\n        label: \"设备状态\",\n        composory: true,\n        hide: true,\n        popuptype: \"select\",\n        selectId: \"valueCode\",\n        selectLabel: \"label\",\n        options: scope.myDicts.pcsDeviceState,\n        index: 3\n      }, {\n        name: \"actionUser\",\n        label: \"实施方\",\n        composory: true,\n        hide: true,\n        popuptype: \"select\",\n        selectId: \"valueCode\",\n        selectLabel: \"label\",\n        options: scope.myDicts.pcsActionUser,\n        index: 4\n      }, {\n        name: \"safetyPoint\",\n        label: \"安全挂牌\",\n        composory: true,\n        hide: true,\n        popuptype: \"select\",\n        selectId: \"valueCode\",\n        selectLabel: \"label\",\n        options: scope.myDicts.pcsSafetyPoint,\n        index: 5\n      }, {\n        name: \"executionCycle\",\n        label: \"周期单位\",\n        composory: true,\n        popuptype: \"select\",\n        selectId: \"valueCode\",\n        selectLabel: \"label\",\n        options: scope.myDicts.executionCycle,\n        render: function render(data, type, full) {\n          var item;\n\n          if (scope.myDicts.executionCycle) {\n            item = scope.myDicts.executionCycle.find(function (item) {\n              if (item.valueCode == data) return item;\n            });\n          }\n\n          if (item) {\n            return item.label;\n          }\n\n          return data;\n        },\n        index: 6\n      }, {\n        name: \"cycleNum\",\n        label: \"周期间隔\",\n        composory: true,\n        index: 7\n      }, {\n        name: \"firstExecutionTime\",\n        hide: true,\n        composory: true,\n        label: \"开始时间\",\n        type: \"date\",\n        popuptype: \"datePicker\",\n        index: 8\n      }, {\n        name: \"taskStatus\",\n        label: \"是否启用\",\n        popuptype: \"select\",\n        selectId: \"id\",\n        selectLabel: \"label\",\n        options: taskStatusAry,\n        render: function render(data, type, full) {\n          var item = taskStatusAry.find(function (item) {\n            if (item.id == data) return item;\n          });\n\n          if (item) {\n            return item.label;\n          }\n\n          return data;\n        },\n        index: 9\n      }, {\n        name: \"createTime\",\n        label: \"制定日期\",\n        type: \"date\",\n        popuptype: \"datePicker\"\n      }, {\n        name: \"createUserName\",\n        label: \"制定人\"\n      }, {\n        label: \"操作\",\n        type: \"buttonGroup\",\n        content: [{\n          label: \"详情\",\n          icon: \"null\",\n          on: {\n            click: function click(index, row, columnIndex) {\n              popupHandler(index.row, 0);\n            }\n          }\n        }, {\n          label: \"编辑\",\n          icon: \"null\",\n          on: {\n            click: function click(index, row, columnIndex) {\n              popupHandler(index.row, 1);\n            }\n          }\n        }, {\n          label: \"删除\",\n          icon: \"null\",\n          on: {\n            click: function click(index, row, columnIndex) {\n              target.deleteTask(index.row.id, function (returnObj) {\n                if (returnObj.code == 0) {\n                  target.growl(\"删除成功\");\n                  readerData();\n                }\n              });\n            }\n          }\n        }]\n      }];\n\n      var render = function render(workArray) {\n        //只有让有hide=false的传递到datatable\n        var tablefmt = format.filter(function (fmt) {\n          if (!fmt.hide) return fmt;\n        });\n        target.render({\n          data: workArray,\n          format: tablefmt.map(function (elem) {\n            return {\n              \"name\": elem.label,\n              \"value\": elem.name,\n              \"type\": elem.type || \"text\",\n              \"content\": elem.content,\n              \"render\": elem.render\n            };\n          })\n        });\n      };\n\n      var popupHandler = function popupHandler(inputparam, status) {\n        //只有让有index的传递到popup\n        var objfmt = format.filter(function (fmt) {\n          if (fmt.index != undefined) return fmt;\n        });\n        var obj = {\n          resource: inputparam,\n          format: objfmt,\n          status: status,\n          colnum: 3\n        };\n        target.createSystemPopupByLocalPath(\"popup\", {\n          width: \"80%\",\n          title: \"点检信息\",\n          on: {\n            submit: function submit(data, destroy) {\n              if (data.statuc == \"success\" && data.data) {\n                target.addPointCheckStanard(data.data, function (returnObj) {\n                  if (returnObj) {\n                    target.growl(\"保存成功\");\n                    readerData();\n                    if (destroy) destroy();\n                  }\n                });\n              }\n            }\n          }\n        }, obj);\n      };\n\n      var extendParam = {};\n\n      var readerData = function readerData() {\n        var paras4list = {\n          deviceId: resource.id,\n          ticketCategory: \"100\"\n        };\n\n        if (extendParam) {\n          paras4list.standardNo = extendParam.standardNo;\n          paras4list.modifyTime = extendParam.modifyTime;\n        }\n\n        target.getTaskBySimpleConditionAndPage(paras4list, function (returnObj) {\n          render(returnObj.data);\n        });\n      }; //监听别的地方告诉我添加\n\n\n      if (scope.popupaddclick) {\n        scope.popupaddclick();\n        scope.popupaddclick = null;\n      }\n\n      scope.popupaddclick = scope.$on(\"POPUPADDCLICK\", function () {\n        popupHandler({\n          pointCheckItemList: [],\n          deviceId: resource.id\n        }, 1);\n      });\n\n      if (scope.listsearchclick) {\n        scope.listsearchclick();\n        scope.listsearchclick = null;\n      }\n\n      scope.listsearchclick = scope.$on(\"LISTSEARCHCLICK\", function (param, args) {\n        extendParam = args;\n        readerData();\n      });\n\n      if (resource) {\n        readerData();\n      }\n\n      target.on(\"tree_resourceChange\", function (obj) {\n        resource = obj.resource;\n        readerData();\n      });\n    }\n  }\n};"],"sourceRoot":"/source/"}