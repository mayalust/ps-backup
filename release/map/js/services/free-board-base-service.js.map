{"version":3,"sources":["js/services/free-board-base-service.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","define","services","factory","rootScope","serviceProxy","SwSocket","userDomainService","weatherService","kqiManagerUIService","customMethodService","dictionaryService","energyConsumeUIService","serviceCenterService","userLoginUIService","viewFlexService","q","timeout","route","routeParam","resourceUIService","Info","growl","chartOptionService","angularStyle","ticketTaskService","alertService","kpiDataService","ngDialog","projectUIService","thridPartyApiService","compile","controller","FileUploader","ajax","psTopo","targetDom","cur","events","instance","previewMode","buttonEnabled","_DROPCONFIG_","greedy","drop","event","ui","onDrop","before","promiseInx","start","$","css","targetId","target","attr","addClass","stop","removeClass","dropBefore","over","draggable","out","fileFormat","fileMaxSize","serviceOrigin","$scope","renderLayout","inData","config","scope","settingData","find","remove","rootTarget","$$","runExpression","setting","funRes","code","fnResult","data","system","theme","size","linkDom","append","style","padding","layout","children","wrap","traverseColumn","pMode","renderFinish_callback","i","coldom","c","col","val","allNum","maxNum","styles","num","Math","floor","updown","type","$attr","coldomInner","renderRow","tg","id","traverseRow","parent","undefined","tabInx","length","default","insertCssFile","str","callback","cssFile","document","createElement","setAttribute","innerHTML","body","appendChild","onload","e","json2Str","uuid","backgroundColor","promises","endDom","hasBox","index","element","tElement","rowDom","instruct","move","dataBtn","emptyDom","delBtn","copyBtn","pasteBtn","cutBtn","tool","title","text","label","tabWrap","titleDom","minbutton","headerDom","titleStyle","font-size","parameters","text-align","font-weight","background-color","dom","placeholder","defer","inx","promise","loadExternalJs","dataSwitch","el","path","method","console","assert","global","location","window","wholeJSON","onTabClick","imageslist","getParameters","options","map","value","underWatch","resolve","after","$$state","push","cursor","revert","handle","cursorAt","right","helper","result","appendTo","containment","revertDuration","zIndex","contextMenu","bindings","paste","t","onInsert","json","onInsertJSON","on","$apply","onDelete","onCut","clone","$clone","$index","template","hasOwnProperty","url","data-clipboard-text","JSON","stringify","Clipboard","clipboard","onCopy","success","clearSelection","error","action","trigger","onSetting","onDataChange","dropConfig","droppable","require","onPaste","onPasteJSON","fire","eventName","param","traveseByChild","expression","advance","source","customeEvent","params","variable","variableName","traverse","oldValue","run","setMode","bool","setButtonDisable","addEvents"],"mappings":"AAAA,SAASA,QAAQC,GAAwT,OAAtOD,QAArD,mBAAXE,QAAoD,iBAApBA,OAAOC,SAAmC,SAAiBF,GAAO,cAAcA,GAA2B,SAAiBA,GAAO,OAAOA,GAAyB,mBAAXC,QAAyBD,EAAIG,cAAgBF,QAAUD,IAAQC,OAAOG,UAAY,gBAAkBJ,IAAyBA,GAExVK,OAAO,CAAC,2BAA4B,SAAUC,GAC5C,aAEAA,EAASC,QAAQ,uBAAwB,CAAC,aAAc,eAAgB,WAAY,oBAAqB,iBAAkB,sBAAuB,sBAAuB,oBAAqB,yBAA0B,uBAAwB,qBAAsB,kBAAmB,KAAM,WAAY,SAAU,eAAgB,oBAAqB,OAAQ,QAAS,qBAAsB,gBAAiB,oBAAqB,eAAgB,iBAAkB,WAAY,mBAAoB,uBAAwB,WAAY,cAAe,eAAgB,OAAQ,SAAU,SAAUC,EAAWC,GAAcC,GAAUC,GAAmBC,GAAgBC,GAAqBC,GAAqBC,GAAmBC,GAAwBC,GAAsBC,GAAoBC,GAAiBC,GAAGC,GAASC,GAAOC,GAAYC,GAAmBC,GAAMC,GAAOC,GAAoBC,GAAcC,GAAmBC,GAAcC,GAAgBC,GAAUC,GAAkBC,GAAsBC,GAASC,EAAYC,EAAcC,GAAMC,IACzgC,OAAO,SAAUC,GACf,IAAIC,EAAMD,EACNE,EAAS,GACTC,EAAW,GACXC,GAAc,EACdC,GAAgB,EAChBC,EAAe,CACjBC,QAAQ,EACRC,KA8zBF,SAAcC,EAAOC,GACnBR,EAAOS,OAAO,CACZF,MAAOA,EACPC,GAAIA,EACJE,QAAQ,MAh0BRC,EAAa,EA6wBjB,SAASC,EAAML,EAAOC,GACpBK,EAAE,aAAaC,IAAI,aAAc,UACjC,IAAIC,EAAWF,EAAEN,EAAMS,QAAQC,KAAK,MACpCJ,EAAE,IAAME,EAAW,UAAUG,SAAS,eACtCL,EAAE,IAAME,EAAW,QAAQG,SAAS,eAGtC,SAASC,EAAKZ,EAAOC,GACnBK,EAAE,aAAaC,IAAI,aAAc,QACjC,IAAIC,EAAWF,EAAEN,EAAMS,QAAQC,KAAK,MACpCJ,EAAE,IAAME,EAAW,UAAUK,YAAY,eACzCP,EAAE,IAAME,EAAW,QAAQK,YAAY,eAGzC,SAASC,EAAWd,EAAOC,GACzBR,EAAOS,OAAO,CACZF,MAAOA,EACPC,GAAIA,EACJE,QAAQ,IAIZ,SAASY,EAAKf,EAAOC,GACJK,EAAEN,EAAMS,QAAQC,KAAK,OACvBT,EAAGe,UAAUN,KAAK,OAGhBJ,EAAEN,EAAMS,QACdE,SAAS,SAIpB,SAASM,EAAIjB,EAAOC,GACLK,EAAEN,EAAMS,QACdI,YAAY,SAkCrB,OAZAtD,EAAU2D,WAAa,yFACvB3D,EAAU4D,YAAc,GACxB5D,EAAU6D,cAAgB,4DAC1BjC,EAAW,gBAAiB,CAC1BkC,OAAQ9D,EACRkB,MAAOA,GACPW,aAAcA,IAEhBM,EAAS4B,aA3zBU,SAAsBC,EAAQC,EAAQC,GAIvD,IAAIC,EAkBJ,GArBApB,EAAE,QAAQqB,KAAK,qBAAqBC,SACpClC,EAASmC,WAAaN,EAGtBO,GAAGC,cAAcR,EAAOS,QAAS,SAAUC,GACzC,GAAmB,KAAfA,EAAOC,KAAa,CACtB,IAAIC,EAAWF,EAAOG,KAQtBV,GALEA,EADqB,mBAAZS,EACKA,EAASC,KAAMC,QAEfF,IAG0B,QAE1CT,EAAc,KAKC,GAFRpB,EAAE,sCAAwCoB,EAAYY,OAAS,WAAa,WAE9EC,OAAa,CACpB,IAAIC,EAAUlC,EAAE,YAChBkC,EAAQ9B,KAAK,OAAQ,iBAAmBgB,EAAYY,OAAS,WAAa,QAC1EE,EAAQ9B,KAAK,MAAO,cACTJ,EAAE,QACRmC,OAAOD,GAGdlC,EAAE,aAAaC,IAAImB,EAAYgB,OAAS,CACtCC,QAAS,SAYX,SAAaC,GACXtC,EAAEd,GAAKqD,WAAWjB,SAClB,IAAIkB,EAAOxC,EAAE,4BAwFb,SAASyC,EAAexD,EAAW6C,EAAMY,EAAOC,GAC9C,IAAK,IAAIC,KAAKd,EAAM,CAClB,IAAIe,EACAC,EAAIhB,EAAKc,GAAGG,IAEZC,GADJF,EAAkB,UAAdtG,QAAQsG,GAAiBA,EAAI,CAACA,EAAG,IACzB,IAAMA,EAAE,GAAK,IAAMA,EAAE,GAAK,IAEtC,GAAIhB,EAAKc,GAAGK,OAASnB,EAAKc,GAAGM,OAAQ,CACnC,IAAIC,EAAS,GACTC,EAAMtB,EAAKc,GAAGK,OAASnB,EAAKc,GAAGM,OACpBG,KAAKC,MAAMxB,EAAKc,GAAGK,OAASnB,EAAKc,GAAGM,QAE7B,MAAlBpB,EAAKc,GAAGW,QACNX,GAAKQ,EAAM,IAEJ,GAALR,EACFO,EAAS,mBACK,GAALP,IACTO,EAAS,sBAWZT,EAQiB,WAAhBZ,EAAKc,GAAGY,MACVX,EAAS7C,EAAE,qBAAuB4C,EAAI,+BAC/BvC,SAAS,eAEZyC,IACFD,EAAS7C,EAAE,eAAiBmD,EAAS,mBAAqBH,EAAM,aAZhD,WAAhBlB,EAAKc,GAAGY,MACVX,EAAS7C,EAAE,qBAAuB4C,EAAI,+BAC/BvC,SAAS,eAEhBwC,EAAS7C,EAAE,sBAAwB8B,EAAKc,GAAGG,IAAM,mBAaR,OAAzCjB,EAAKc,GAAGa,MAAM,yBAC2C,SAAvD3B,EAAKc,GAAGa,MAAM,uCAChBZ,EAAO5C,IAAI,QAAS,QAIxB,IAAIyD,EAAc1D,EAAE,4BAEhB2D,EAAY,SAAmBC,GAC7Bf,IACF5D,EAAUkD,OAAOU,GAEZH,IACHG,EAAOV,OAAOuB,GACdb,EAAOzC,KAAK,KAAM0B,EAAKc,GAAGiB,KAG5BC,EAAYF,EAAI9B,EAAKc,GAAGL,SAAUG,EAAOC,KAIxCD,EAiBiB,WAAhBZ,EAAKc,GAAGY,KACN1B,EAAKiC,SACmBC,MAAtBlC,EAAKiC,OAAOE,OACVrB,GAAKd,EAAKiC,OAAOE,QACfnC,EAAKc,GAAGL,UACoB,EAA1BT,EAAKc,GAAGL,SAAS2B,QACnBP,EAAUd,GAKZf,EAAKc,GAAGuB,SACVR,EAAUd,IAKZf,EAAKc,GAAGL,UACoB,EAA1BT,EAAKc,GAAGL,SAAS2B,QACnBP,EAAUd,GAnCI,WAAhBf,EAAKc,GAAGY,KACN1B,EAAKiC,SACmBC,MAAtBlC,EAAKiC,OAAOE,OACVrB,GAAKd,EAAKiC,OAAOE,QACnBN,EAAUd,GAGRf,EAAKc,GAAGuB,SACVR,EAAUd,IAKhBc,EAAUD,IA8BlB,SAASU,EAAcC,EAAKC,GAC1B,GAAKD,EAAL,CAIA,IAAIE,EAAUC,SAASC,cAAc,SASrC,OARAF,EAAQG,aAAa,OAAQ,YAC7BH,EAAQI,UAAYN,EACpBG,SAASI,KAAKC,YAAYN,GAC1BzG,GAAQ,WACNyG,IAAUA,EAAQO,OAAS,SAAUC,GACnCT,GAAYA,EAASS,OAGlB,WACLR,EAAQjD,SACRiD,EAAU,OAId,SAASS,EAASC,EAAMxI,GACtB,IAAIyI,EAAkB,GAClBb,EAAM,SAAWY,EAAO,2BAE5B,IAAK,IAAIrC,KAAKnG,EACH,oBAALmG,EAKJyB,GAAOzB,EAAI,IAAMnG,EAAImG,GAAK,IAJxBsC,EAAkBtC,EAAI,IAAMnG,EAAImG,GAAK,IAYzC,OALAyB,GAAO,KACPA,GAAO,SAAWY,EAAO,gBACzBZ,GAAOa,EACPb,GAAO,KACPjF,EAAS6F,GAAQZ,EACVjF,EAAS6F,GAGlB,SAASnB,EAAY7E,EAAW6C,EAAMY,EAAOC,GAC3CmB,EAAYqB,SAAWrB,EAAYqB,UAAY,GAC/C,IAAIC,EAASpF,EAAE,gCACXqF,GAAS,EAQb,IAAK,IAAIzC,KANL5C,EAAEf,GAAWmB,KAAK,MACpBgF,EAAOhF,KAAK,KAAMJ,EAAEf,GAAWmB,KAAK,OAEpCgF,EAAOhF,KAAK,KAAMJ,EAAEf,GAAW8E,SAAS3D,KAAK,OAGjC0B,GACZ,SAAWwD,EAAOC,GAChB,IAAIC,EAEAC,EAAQC,EADRT,EAAOM,EAAQ1B,GAEfH,EAAc1D,EAAE,4BAChB0B,EAAU1B,EAAE,mEACZ2F,EAAO3F,EAAE,kFACT4F,EAAU5F,EAAE,oFACZ6F,EAAW7F,EAAE,4CACb8F,EAAS9F,EAAE,qEACX+F,EAAU/F,EAAE,oFACZgG,EAAWhG,EAAE,8EACbiG,EAASjG,EAAE,6EACXkG,EAAOlG,EAAE,4BACTmG,EAAQnG,EAAE,eAAeoG,KAAKb,EAAQc,OAAOpG,IAAI,UAAW,UAAUA,IAAI,QAAS,QAAQA,IAAI,mBAAoB,WAAWA,IAAI,QAAS,QAAQA,IAAI,cAAe,QACtKqG,EAAUtG,EAAE,+BACZuG,EAAWvG,EAAE,mCACbwG,EAAYxG,EAAE,8KAQlB,GALAkG,EAAK/D,OAAOgE,GACZD,EAAK/D,OAAO2D,GACZI,EAAK/D,OAAO4D,GACZG,EAAK/D,OAAO8D,GAEQ,OAAhBV,EAAQ/B,KAAe,CACzB+C,EAAStG,IAAI,QAAS,QACtBiG,EAAK/D,OAAOT,GACZ,IAAI+E,EAAYzG,EAAE,iBAAmBiF,EAAO,2CAC5CwB,EAAUtE,OAAOoE,GACjBnH,EAAS6F,IAAS7F,EAAS6F,KAC3B,IAAIyB,EAAa,CACfC,YAAapB,EAAQqB,WAAW,cAAgB,OAChDC,aAActB,EAAQqB,WAAW,eAAiB,OAClDE,cAAevB,EAAQqB,WAAW,gBAAkB,OAEpDG,mBAAoBxB,EAAQqB,WAAW,qBAAuB,eAEhExH,EAAS6F,GAAQb,EAAcY,EAASC,EAAMyB,KAE9CjB,EAASzF,EAAE,mCAMJmC,OAAOsE,GAET/D,EAGH+D,EAAUtE,OAAOqE,GAFjBf,EAAOtD,OAAO+D,OAIS,YAAhBX,EAAQ/B,OACjBkC,EAAW1F,EAAE,iCACJoG,KAAK,OAET1D,EAIH+C,EAASzF,EAAE,gBAHXyF,EAASzF,EAAE,mCACJmC,OAAOuD,IAIS,cAAhBH,EAAQ/B,OACjBkC,EAAW1F,EAAE,iCACJoG,KAAK,OAET1D,EAIH+C,EAASzF,EAAE,gBAHXyF,EAASzF,EAAE,mCACJmC,OAAOuD,IAIS,SAAhBH,EAAQ/B,KACZd,EAIH+C,EAASzF,EAAE,kCAHXyF,EAASzF,EAAE,yCACJmC,OAAO+D,GASS,OAAhBX,EAAQ/B,MACZd,EAIH+C,EAASzF,EAAE,4BAHXyF,EAASzF,EAAE,mCACJmC,OAAO+D,GAKZX,EAAQnD,OACVqD,EAAOxF,IAAIsF,EAAQnD,OAGrBqD,EAAOtD,OAAOmE,IAET5D,EAMH+C,EAASzF,EAAE,4BALXyF,EAASzF,EAAE,mCAGJmC,OAAO+D,GAMlB,IAA6B/F,EAAQ6G,EAMjCC,EAAcjH,EAAE,eANSG,EAOtBuC,EAAQzD,EAAYyE,GAPUsD,EAOGC,IALpC9G,EAAOgC,OAAO6E,GAMlBxB,EAAWxF,EAAE,eAETuF,EAAQqB,YACVL,EAASH,KAAKb,EAAQqB,WAAWT,OAGnC,IAAwBe,EAAOC,EAA3BC,GAAoBF,EAqFtBrJ,GAAEqJ,QArF2BC,EAqFlBrH,EApFXoH,EAAMrD,GAAKsD,EACX3F,GAAG6F,eAAe,CAAC,uCAAwC,SAAUC,GACnE,IAAIC,EAAKD,EAAW/B,GAChBiC,EAAO,qBAAuBD,EAAG/D,KAEtB,UAAX+D,EAAG/D,MAA+B,WAAX+D,EAAG/D,MAC5BhC,GAAG6F,eAAe,CAACG,GAGrB,SAAkBC,GAEhBC,QAAQC,OAAwB,mBAAVF,EAAsBD,EAAO,QAAUhL,QAAQiL,IACrE,IAAIT,EAAMS,EAAO,CACfvJ,KAAMA,GACN0J,OAAQ3G,EAAOqB,OACfuF,SAAUA,SACVC,OAAQA,OACRxC,MAAOA,EACPC,QAASA,EACTpE,MAAOA,GAASlE,EAChBA,UAAWA,EACX2B,QAASA,GACTH,SAAUA,GACVsJ,UAAW9G,EACXvD,qBAAsBA,GACtBU,mBAAoBA,GACpBM,iBAAkBA,GAClBC,qBAAsBA,GACtBhB,mBAAoBA,GACpBU,aAAcA,GACdyF,YAAaA,EACbhG,QAASA,GACTqC,OAAQuC,EAAQ+C,EAAS/B,EACzB4C,QAASA,EACT/I,oBAAqBA,GACrBE,uBAAwBA,GACxBD,kBAAmBA,GACnByB,UAAWA,EACXyE,YAAaA,EACbpG,oBAAqBA,GACrBa,MAAOA,GACP+I,MAAOA,EACP1B,SAAUA,EACVC,OAAQA,EACR1G,KAAMA,GACNC,OAAQA,GACR5B,kBAAmBA,GACnBC,eAAgBA,GAChBH,aAAcA,GACdU,gBAAiBA,GACjByB,YAAaqD,EACbzE,kBAAmBA,GACnBK,kBAAmBA,GACnBgB,cAAeA,EACff,aAAcA,GACdyJ,WAAY7I,EAAO6I,WACnB7K,SAAUA,GACVqB,eAAgBA,GAChBT,MAAOA,GACPC,WAAYA,GACZH,EAAGA,GACHoK,WAAY5J,GAAa6J,gBAAgB,OAAUC,QAAQC,IAAI,SAAU7C,GACvE,OAAOA,EAAQ8C,QAEjB5F,eAAgBA,KAEZ,GAE8B,mBAAzBE,GACTA,EAAsB4C,EAASyB,GAG5BA,EAAIsB,YACPpB,EAAMqB,QAAQ,qBAGhBtB,EAAYuB,MAAMxB,GAClBC,EAAY3F,aAGhB4F,EAAME,QAAQqB,QAAQzB,IAAMzB,EAC5B2B,EAAME,QAAQvD,GAAKsD,EACnBrH,IACOoH,EAAME,SAoCf,GAjCAtD,EAAYqB,SAASuD,KAAKtB,GAC1BlB,EAAK/D,OAAOT,GACZwE,EAAK/D,OAAOwD,GAEPjD,IACH+C,EAAOtD,OAAOuB,GACd+B,EAAOrF,KAAK,KAAMmF,EAAQ1B,IAC1B4B,EAAO/E,UAAU,CACfiI,OAAQ,OACRC,QAAQ,EACRC,OAAQlD,EACR5F,MAAOA,EACPO,KAAMA,EACNwI,SAAU,CACRC,MAAO,IAETC,OAAQ,SAAgBrJ,GACtB,IAAIsJ,EAASjJ,EAAE,yIACf,OAAOiJ,GAETC,SAAUlJ,EAAE,aACZmJ,YAAanJ,EAAE,aACfoJ,eAAgB,EAChBC,OAAQ,OAIgB,SAAxBpK,EAAUmB,KAAK,OAAkC,EAAd0B,EAAKoC,QAC1C2B,EAASzF,KAAK,CACZyD,GAAI0B,EAAQ1B,MAIXxE,EAAa,CACmB,mBAAxBwG,EAASyD,aAClBzD,EAASyD,YAAY,UAAW,CAC9BC,SAAY,CACVC,MAAS,SAAeC,GACtB,IAAIvJ,EAAWF,EAAEyJ,GAAGrJ,KAAK,MACzBjB,EAAOuK,SAAS,CACd7F,GAAI3D,KAGRyJ,KAAQ,SAAcF,GACpB,IAAIvJ,EAAWF,EAAEyJ,GAAGrJ,KAAK,MACzBjB,EAAOyK,aAAa,CAClB/F,GAAI3D,QAOd4F,EAAO1F,KAAK,CACVyD,GAAI0B,EAAQ1B,KAEdiC,EAAO+D,GAAG,QAAS,SAAUnK,EAAOC,GAClC1C,EAAU6M,OAAO,WACf3K,EAAO4K,SAAS,CACdrK,MAAOA,EACPC,GAAIA,QAIVsG,EAAO7F,KAAK,CACVyD,GAAI0B,EAAQ1B,KAEdoC,EAAO4D,GAAG,QAAS,SAAUnK,EAAOC,GAClC1C,EAAU6M,OAAO,WACf3K,EAAO6K,MAAM,CACXtK,MAAOA,EACPC,GAAIA,QAIV,IAAIsK,EAAQ1E,EAAQ2E,gBACbD,EAAME,cACNF,EAAMpG,UACNoG,EAAMG,SAERH,EAAMI,eAAe,SACxBJ,EAAMK,IAAM,uBAGdvE,EAAQ3F,KAAK,CACXyD,GAAM0B,EAAQ1B,GACd0G,sBAAuBC,KAAKC,UAAUR,EAAO,KAAM,KAErDzI,GAAG6F,eAAe,CAAC,aAAc,SAAUqD,GACzC,IAAIC,EAAY,IAAID,EAAU3E,EAAQ,IACtC4E,EAAUd,GAAG,UAAW,SAAU9E,GAChC9H,EAAU6M,OAAO,WACf/E,EAAElB,GAAK0B,EAAQ1B,GACf1E,EAAOyL,OAAO,CACZlL,MAAOqF,MAGX5G,GAAM0M,QAAQ,YACd9F,EAAE+F,mBAEJH,EAAUd,GAAG,QAAS,SAAU9E,GAC9B2C,QAAQqD,MAAM,UAAWhG,EAAEiG,QAC3BtD,QAAQqD,MAAM,WAAYhG,EAAEkG,aAwBhCjF,EAAS5F,KAAK,CACZyD,GAAI0B,EAAQ1B,KAEdnC,EAAQtB,KAAK,CACXyD,GAAI0B,EAAQ1B,KAEd+B,EAAQxF,KAAK,CACXyD,GAAI0B,EAAQ1B,KAEdnC,EAAQmI,GAAG,QAAS,SAAUnK,EAAOC,GACnC1C,EAAU6M,OAAO,WACf3K,EAAO+L,UAAU,CACfxL,MAAOA,EACPC,GAAI,CACF4F,QAASC,SAKjBI,EAAQiE,GAAG,QAAS,SAAUnK,EAAOC,GACnC1C,EAAU6M,OAAO,WACf3K,EAAOgM,aAAa,CAClBzL,MAAOA,EACPC,GAAIA,QAQQ,YAAhB4F,EAAQ/B,MAAsC,cAAhB+B,EAAQ/B,KACnCd,GACHzD,EAAUkD,OAAO0D,GAGnBR,GAAS,EAGN3C,GAGiB,OAAhB6C,EAAQ/B,MAAiC,OAAhB+B,EAAQ/B,MAAiC,OAAhB+B,EAAQ/B,MAAiC,YAAhB+B,EAAQ/B,MAAsC,cAAhB+B,EAAQ/B,MAAwC,SAAhB+B,EAAQ/B,MAAmC,OAAhB+B,EAAQ/B,MAFhLvE,EAAUkD,OAAOsD,GAOnB,IAAI2F,EAAa7L,EAAa2K,SAE9BkB,EAAW3K,KAAOA,EAClB2K,EAAWzK,IAAMA,EACjByK,EAAW3L,KAAOe,EAEe,mBAAtBqF,EAASwF,UAClBxF,EAASwF,UAAUD,GAEnBE,QAAQ,CAAC,aAAc,WACrBzF,EAASwF,UAAUD,KAIlB1I,EAWiB,OAAhB6C,EAAQ/B,KACVM,EAAY2B,EAAQF,EAAQhD,SAAUG,EAAOC,GACpB,YAAhB4C,EAAQ/B,MAAsC,YAAhB+B,EAAQ/B,MAC3C+B,EAAQhD,UACoB,EAA1BgD,EAAQhD,SAAS2B,QACnBzB,EAAegD,EAAQF,EAAQhD,SAAUG,EAAOC,GAflC,OAAhB4C,EAAQ/B,KACVM,EAAYJ,EAAa6B,EAAQhD,SAAUG,EAAOC,GACzB,YAAhB4C,EAAQ/B,MAAsC,YAAhB+B,EAAQ/B,MAC3C+B,EAAQhD,UACoB,EAA1BgD,EAAQhD,SAAS2B,QACnBzB,EAAeiB,EAAa6B,EAAQhD,SAAUG,EAAOC,GAnZ/D,CAkaGC,EAAGd,EAAKc,IAGb,IAAIwI,EAAa7L,EAAa2K,SAqC9B,OAnCAkB,EAAW3K,KAAOA,EAClB2K,EAAWzK,IAAMA,EAEc,mBAApByE,EAAOiG,UAChBjG,EAAOiG,UAAUD,GAEjBE,QAAQ,CAAC,aAAc,WACrBlG,EAAOiG,UAAUD,KAIhB/F,GACE3C,IACHzD,EAAUkD,OAAOiD,GACjB5D,GAAG6F,eAAe,CAAC,eAAgB,WACjCjC,EAAOkE,YAAY,UAAW,CAC5BC,SAAY,CACVC,MAAS,SAAeC,GACtB,IAAIvJ,EAAWF,EAAEyJ,GAAGrJ,KAAK,MACzBjB,EAAOoM,QAAQ,CACb1H,GAAI3D,KAGRyJ,KAAQ,SAAcF,GACpB,IAAIvJ,EAAWF,EAAEyJ,GAAGrJ,KAAK,MACzBjB,EAAOqM,YAAY,CACjB3H,GAAI3D,WASX4D,EAAYqB,SArsBrB7C,EAAOmJ,KAAO,SAAUC,EAAWC,GACjC7N,GAAQ,WACNwE,EAAOsJ,eAAe,SAAUrG,GAC9B,IAAIsG,EAiBJ,GAfItG,GACEA,EAAQuG,SACNvG,EAAQuG,QAAQD,YAClBrK,GAAGC,cAAc8D,EAAQuG,QAAQD,WAAY,SAAUlK,GAClC,GAAfA,EAAOC,OACL2D,EAAQwG,OAGZF,GADAA,EAAalK,EAAOG,OACmB,MAO7C+J,EAAY,CACd,IAAIG,EAAeH,EAAWpI,MAAM,MAAQiI,GAExCM,GACFA,EAAa,CACX7L,OAAQoF,EACRA,QAASA,EACTqC,OAAQ3G,EAAOqB,OACf2J,OAAQN,UAQpBrJ,EAAO4J,SAAW,SAAUC,GAC1B,IAAI9K,EAAO,KAiBX,OAfuB2C,MAAnB8D,OAAOoE,WACTpE,OAAOoE,SAAW,IAGhBpE,OAAO,SAAYqE,GACrB9K,EAAOyG,OAAO,SAAYqE,GAE1B7J,EAAOsJ,eAAe,SAAUrG,GAC1BA,EAAQ9B,MAAM,qBAAuB0I,IACvC9K,EAAOkE,EACPuC,OAAO,SAAYqE,GAAgB5G,KAKlClE,GAGTiB,EAAO8J,SAAS,SAAUhM,EAAMmF,GAC1BA,EAAQ8E,eAAe,kBACzB9E,EAAQ8G,SAAW9G,EAAQ8C,SAI1BhJ,IACHW,EAAEd,GAAKkB,KAAK,KAAMkC,EAAOuB,IAEI,mBAAlBrB,EAAK6I,UACd7I,EAAK6I,UAAU,CACb7L,QAAQ,IAGV8L,QAAQ,CAAC,aAAc,WACrB9I,EAAK6I,UAAU,CACb7L,QAAQ,OAMXH,EAIHyE,EAAY9D,EAAEd,GAAMoD,EAAOC,SAAUlD,IAHrCW,EAAEd,GAAKiD,OAAOK,GACdsB,EAAYtB,EAAMF,EAAOC,SAAUlD,IAvFvCiN,CAAIrL,EAAOqB,SAmxBblD,EAASmN,QAp0BK,SAAiBC,GAC7BnN,EAAcmN,GAo0BhBpN,EAASqN,iBAj0Bc,SAA0BD,GAC/ClN,GAAgB,GAi0BlBF,EAASsN,UA90BO,SAAmB5K,GACjC,IAAK,IAAIc,KAAKd,EACKkB,EAEXlB,EAFK1B,EAERwC,GADDzD,EAAOiB,GAAQ4C,EADjB,IAAW5C,EAAM4C,GA60Bd5D","file":"js/services/free-board-base-service.js","sourcesContent":["function _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\ndefine(['../services/services.js'], function (services) {\n  'use strict';\n\n  services.factory('freeboardBaseService', ['$rootScope', 'serviceProxy', 'SwSocket', 'userDomainService', 'weatherService', 'kqiManagerUIService', 'customMethodService', 'dictionaryService', 'energyConsumeUIService', 'serviceCenterService', 'userLoginUIService', 'viewFlexService', '$q', '$timeout', '$route', '$routeParams', 'resourceUIService', 'Info', 'growl', 'chartOptionService', 'angular-style', 'ticketTaskService', 'alertService', 'kpiDataService', 'ngDialog', 'projectUIService', 'thridPartyApiService', '$compile', '$controller', 'FileUploader', 'ajax', 'psTopo', function (rootScope, serviceProxy, SwSocket, userDomainService, weatherService, kqiManagerUIService, customMethodService, dictionaryService, energyConsumeUIService, serviceCenterService, userLoginUIService, viewFlexService, q, timeout, route, routeParam, resourceUIService, Info, growl, chartOptionService, angularStyle, ticketTaskService, alertService, kpiDataService, ngDialog, projectUIService, thridPartyApiService, compile, controller, FileUploader, ajax, psTopo) {\n    return function (targetDom) {\n      var cur = targetDom;\n      var events = {};\n      var instance = {};\n      var previewMode = false;\n      var buttonEnabled = true;\n      var _DROPCONFIG_ = {\n        greedy: true,\n        drop: drop\n      };\n      var promiseInx = 0;\n\n      var addEvents = function addEvents(data) {\n        for (var i in data) {\n          (function (attr, val) {\n            events[attr] = val;\n          })(i, data[i]);\n        }\n      };\n\n      var setMode = function setMode(bool) {\n        previewMode = bool;\n      };\n\n      var setButtonDisable = function setButtonDisable(bool) {\n        buttonEnabled = false;\n      };\n\n      var renderLayout = function renderLayout(inData, config, scope) {\n        $(\"body\").find(\"#popup_background\").remove();\n        instance.rootTarget = inData; //var settingData = inData.setting;\n\n        var settingData;\n        $$.runExpression(inData.setting, function (funRes) {\n          if (funRes.code == \"0\") {\n            var fnResult = funRes.data;\n\n            if (typeof fnResult == 'function') {\n              settingData = fnResult(data, system);\n            } else {\n              settingData = fnResult;\n            }\n\n            settingData = settingData ? settingData : {};\n          } else {\n            settingData = {}; //throw new Error(funRes.message);\n          }\n        });\n        var link = $(\"link[href*=\\\\.\\\\.\\\\/css\\\\/theme\\\\/\" + (settingData.theme || \"default\") + \"\\\\.css]\");\n\n        if (link.size() == 0) {\n          var linkDom = $(\"<link />\");\n          linkDom.attr(\"href\", \"../css/theme/\" + (settingData.theme || \"default\") + \".css\");\n          linkDom.attr(\"rel\", \"stylesheet\");\n          var head = $(\"head\");\n          head.append(linkDom);\n        }\n\n        $(\".drawarea\").css(settingData.style || {\n          padding: \"15px\"\n        });\n        /**\n         if(settingData == undefined) {\n          settingData = {\n            color : \"transparent\",\n            padding : 15\n          }\n        }*/\n\n        run(inData.layout);\n\n        function run(layout) {\n          $(cur).children().remove();\n          var wrap = $(\"<div class='wrap'></div>\");\n\n          layout.fire = function (eventName, param) {\n            timeout(function () {\n              layout.traveseByChild(function (element) {\n                var expression;\n\n                if (element) {\n                  if (element.advance) {\n                    if (element.advance.expression) {\n                      $$.runExpression(element.advance.expression, function (funRes) {\n                        if (funRes.code == 0) {\n                          if (element.source == \"BARCHART\") {}\n\n                          expression = funRes.data;\n                          expression = expression ? expression : {};\n                        }\n                      });\n                    }\n                  }\n                }\n\n                if (expression) {\n                  var customeEvent = expression.$attr(\"on/\" + eventName);\n\n                  if (customeEvent) {\n                    customeEvent({\n                      target: element,\n                      element: element,\n                      global: inData.layout,\n                      params: param\n                    });\n                  }\n                }\n              });\n            });\n          };\n\n          layout.variable = function (variableName) {\n            var find = null;\n\n            if (window.variable == undefined) {\n              window.variable = {};\n            }\n\n            if (window[\"variable\"][variableName]) {\n              find = window[\"variable\"][variableName];\n            } else {\n              layout.traveseByChild(function (element) {\n                if (element.$attr(\"advance/variable\") == variableName) {\n                  find = element;\n                  window[\"variable\"][variableName] = element;\n                }\n              });\n            }\n\n            return find;\n          };\n\n          layout.traverse(function (attr, element) {\n            if (element.hasOwnProperty(\"__onChange__\")) {\n              element.oldValue = element.value;\n            }\n          });\n\n          if (!previewMode) {\n            $(cur).attr(\"id\", layout.id);\n\n            if (typeof wrap.droppable == 'function') {\n              wrap.droppable({\n                greedy: true\n              });\n            } else {\n              require(['jquery-ui'], function () {\n                wrap.droppable({\n                  greedy: true\n                });\n              });\n            }\n          }\n\n          if (!previewMode) {\n            $(cur).append(wrap);\n            traverseRow(wrap, layout.children, previewMode);\n          } else {\n            traverseRow($(cur), layout.children, previewMode);\n          }\n\n          function traverseColumn(targetDom, data, pMode, renderFinish_callback) {\n            for (var i in data) {\n              var coldom;\n              var c = data[i].col;\n              c = _typeof(c) == \"object\" ? c : [c, 0];\n              var val = c[0] + (c[1] ? \"-\" + c[1] : \"\");\n\n              if (data[i].allNum > data[i].maxNum) {\n                var styles = \"\";\n                var num = data[i].allNum % data[i].maxNum;\n                var numFloor = Math.floor(data[i].allNum / data[i].maxNum);\n\n                if (data[i].updown == \"up\") {\n                  if (i == num - 1) {\n                    // val = 12 / num\n                    if (i == 0) {\n                      styles = \"margin-right:40%\";\n                    } else if (i == 1) {\n                      styles = \"margin-right:20px\";\n                    }\n                  }\n                } // else {\n                //   if(i >= numFloor * data[i].maxNum){\n                //       val = 12 / num;\n                //   }\n                // }\n\n              }\n\n              if (!pMode) {\n                if (data[i].type == \"tabItem\") {\n                  coldom = $(\"<div tabId='tabId_\" + i + \"' class='col-md-12'></div>\");\n                  coldom.addClass(\"tab-content\");\n                } else {\n                  coldom = $(\"<div class='col-md-\" + data[i].col + \" column'></div>\");\n                }\n              } else {\n                if (data[i].type == \"tabItem\") {\n                  coldom = $(\"<div tabId='tabId_\" + i + \"' class='col-md-12'></div>\");\n                  coldom.addClass(\"tab-content\");\n                } else {\n                  if (c) {\n                    coldom = $('<div style=\"' + styles + '\" class=\"col-md-' + val + '\"></div>');\n                  }\n                }\n              }\n\n              if (data[i].$attr(\"parent/parent/source\") == \"ROW\") {\n                if (data[i].$attr(\"parent/parent/parameters/alignment\") == \"float\") {\n                  coldom.css(\"width\", \"auto\");\n                }\n              }\n\n              var coldomInner = $(\"<div class='wrap'></div>\");\n\n              var renderRow = function renderRow(tg) {\n                if (coldom) {\n                  targetDom.append(coldom);\n\n                  if (!pMode) {\n                    coldom.append(coldomInner);\n                    coldom.attr(\"id\", data[i].id);\n                  }\n\n                  traverseRow(tg, data[i].children, pMode, renderFinish_callback);\n                }\n              };\n\n              if (!pMode) {\n                if (data[i].type == \"tabItem\") {\n                  if (data.parent) {\n                    if (data.parent.tabInx != undefined) {\n                      if (i == data.parent.tabInx) {\n                        renderRow(coldom);\n                      }\n                    } else {\n                      if (data[i].default) {\n                        renderRow(coldom);\n                      }\n                    }\n                  }\n                } else {\n                  renderRow(coldomInner);\n                }\n              } else {\n                if (data[i].type == \"tabItem\") {\n                  if (data.parent) {\n                    if (data.parent.tabInx != undefined) {\n                      if (i == data.parent.tabInx) {\n                        if (data[i].children) {\n                          if (data[i].children.length > 0) {\n                            renderRow(coldom);\n                          }\n                        }\n                      }\n                    } else {\n                      if (data[i].default) {\n                        renderRow(coldom);\n                      }\n                    }\n                  }\n                } else {\n                  if (data[i].children) {\n                    if (data[i].children.length > 0) {\n                      renderRow(coldom);\n                    }\n                  }\n                }\n              }\n            }\n          }\n\n          function insertCssFile(str, callback) {\n            if (!str) {\n              return;\n            }\n\n            var cssFile = document.createElement(\"style\");\n            cssFile.setAttribute(\"type\", \"text/css\");\n            cssFile.innerHTML = str;\n            document.body.appendChild(cssFile);\n            timeout(function () {\n              cssFile ? cssFile.onload = function (e) {\n                callback && callback(e);\n              } : null;\n            });\n            return function () {\n              cssFile.remove();\n              cssFile = null;\n            };\n          }\n\n          function json2Str(uuid, obj) {\n            var backgroundColor = '';\n            var str = \"#item_\" + uuid + \".box-header .box-title {\";\n\n            for (var i in obj) {\n              if (i == \"background-color\") {\n                backgroundColor = i + \":\" + obj[i] + \";\";\n                continue;\n              }\n\n              str += i + \":\" + obj[i] + \";\";\n            }\n\n            str += \"} \";\n            str += \"#item_\" + uuid + \".box-header {\";\n            str += backgroundColor;\n            str += \"} \";\n            instance[uuid] = str;\n            return instance[uuid];\n          }\n\n          function traverseRow(targetDom, data, pMode, renderFinish_callback) {\n            traverseRow.promises = traverseRow.promises || [];\n            var endDom = $(\"<div class='emptyEnd'></div>\");\n            var hasBox = false;\n\n            if ($(targetDom).attr(\"id\")) {\n              endDom.attr(\"id\", $(targetDom).attr(\"id\"));\n            } else {\n              endDom.attr(\"id\", $(targetDom).parent().attr(\"id\"));\n            }\n\n            for (var i in data) {\n              (function (index, element) {\n                var tElement;\n                var uuid = element.id;\n                var rowDom, instruct;\n                var coldomInner = $(\"<div class='wrap'></div>\");\n                var setting = $(\"<div class='btn'><span class='proudsmart ps-edit'></span></div>\");\n                var move = $(\"<div id='move' class='btn move'><span class='proudsmart ps-move'></span></div>\");\n                var dataBtn = $(\"<div id='data' class='btn'><span class='proudsmart ps-linked-data'></span></div>\");\n                var emptyDom = $(\"<div id='beforeDom' class='empty'></div>\");\n                var delBtn = $(\"<div class='btn'><span class='proudsmart ps-delete'></span></div>\");\n                var copyBtn = $(\"<button class='btn'><span class='glyphicon glyphicon-duplicate'></span></button>\");\n                var pasteBtn = $(\"<div class='btn'><span class='glyphicon glyphicon-duplicate'></span></div>\");\n                var cutBtn = $(\"<div class='btn'><span class='glyphicon glyphicon-scissors'></span></div>\");\n                var tool = $(\"<div class='tool'></div>\");\n                var title = $(\"<div></div>\").text(element.label).css(\"padding\", \"0 15px\").css(\"color\", \"#fff\").css(\"background-color\", \"#3c8dbc\").css(\"float\", \"left\").css(\"font-weight\", \"bold\");\n                var tabWrap = $(\"<div class='tabWrap'></div>\");\n                var titleDom = $(\"<h3 class='box-title'>标题标题</h3>\");\n                var minbutton = $('<div class=\"box-tools pull-right\">\\\n\t\t\t\t\t\t\t\t\t\t<button class=\"btn btn-box-tool\" data-widget=\"collapse\"><i class=\"fa fa-minus\"></i></button>\\\n\t\t\t\t\t\t\t\t\t</div>');\n                tool.append(title);\n                tool.append(delBtn);\n                tool.append(copyBtn);\n                tool.append(cutBtn);\n\n                if (element.type == \"box\") {\n                  titleDom.css(\"width\", \"100%\");\n                  tool.append(setting);\n                  var headerDom = $(\"<div id='item_\" + uuid + \"' class='box-header with-border'></div>\");\n                  headerDom.append(titleDom);\n                  instance[uuid] && instance[uuid]();\n                  var titleStyle = {\n                    'font-size': element.parameters['font-size'] || '12px',\n                    'text-align': element.parameters['text-align'] || 'left',\n                    'font-weight': element.parameters['font-weight'] || 'bold',\n                    //'color': element.parameters['color'] || '#000',\n                    'background-color': element.parameters['background-color'] || 'transparent'\n                  };\n                  instance[uuid] = insertCssFile(json2Str(uuid, titleStyle)); //titleDom.css(\"fontSize\", \"inherit\");\n\n                  rowDom = $(\"<div class='row column'></div>\");\n                  /**\n                   if (element.style) {\n                    rowDom.css(element.style);\n                  }*/\n\n                  rowDom.append(headerDom);\n\n                  if (!pMode) {\n                    rowDom.append(tool);\n                  } else {\n                    headerDom.append(minbutton);\n                  }\n                } else if (element.type == \"box-body\") {\n                  instruct = $(\"<div class='instruct'></div>\");\n                  instruct.text(\"内容区\");\n\n                  if (!pMode) {\n                    rowDom = $(\"<div class='row column'></div>\");\n                    rowDom.append(instruct);\n                  } else {\n                    rowDom = $(\"<div></div>\");\n                  }\n                } else if (element.type == \"box-footer\") {\n                  instruct = $(\"<div class='instruct'></div>\");\n                  instruct.text(\"注释区\");\n\n                  if (!pMode) {\n                    rowDom = $(\"<div class='row column'></div>\");\n                    rowDom.append(instruct);\n                  } else {\n                    rowDom = $(\"<div></div>\");\n                  }\n                } else if (element.type == \"block\") {\n                  if (!pMode) {\n                    rowDom = $(\"<div class='row column block'></div>\");\n                    rowDom.append(tool);\n                  } else {\n                    rowDom = $(\"<div class='row block'></div>\");\n                    /**\n                     if(settingData) {\n                      rowDom.css(\"margin-right\", \"-\" + 0 + \"px\");\n                      rowDom.css(\"margin-left\", \"-\" + 0 + \"px\");\n                    }*/\n                  }\n                } else if (element.type == \"tab\") {\n                  if (!pMode) {\n                    rowDom = $(\"<div class='row column'></div>\");\n                    rowDom.append(tool);\n                  } else {\n                    rowDom = $(\"<div class='row'></div>\");\n                  }\n\n                  if (element.style) {\n                    rowDom.css(element.style);\n                  }\n\n                  rowDom.append(tabWrap);\n                } else {\n                  if (!pMode) {\n                    rowDom = $(\"<div class='row column'></div>\")\n                    /**.css(\"overflow\", \"hidden)*/\n                    ;\n                    rowDom.append(tool);\n                  } else {\n                    rowDom = $(\"<div class='row'></div>\");\n                  }\n                }\n\n                var addDom = function addDom(target, dom) {\n                  if (dom) {\n                    target.append(dom);\n                  }\n                };\n\n                var placeholder = $(\"<div></div>\");\n                addDom(pMode ? targetDom : coldomInner, placeholder);\n                tElement = $(\"<div></div>\");\n\n                if (element.parameters) {\n                  titleDom.text(element.parameters.title);\n                }\n\n                var promise = function (defer, inx) {\n                  defer.id = inx;\n                  $$.loadExternalJs(['../toolkit/component/data-switch.js'], function (dataSwitch) {\n                    var el = dataSwitch(element);\n                    var path = 'toolkit/component/' + el.type;\n\n                    if (el.type != \"column\" && el.type != \"tabItem\") {\n                      $$.loadExternalJs([path], callback);\n                    }\n\n                    function callback(method) {\n                      //if(typeof method != \"function\") return;\n                      console.assert(typeof method == \"function\", path + \"加载失败！\" + _typeof(method));\n                      var dom = method({\n                        Info: Info,\n                        global: inData.layout,\n                        location: location,\n                        window: window,\n                        index: index,\n                        element: element,\n                        scope: scope || rootScope,\n                        rootScope: rootScope,\n                        compile: compile,\n                        ngDialog: ngDialog,\n                        wholeJSON: inData,\n                        serviceCenterService: serviceCenterService,\n                        chartOptionService: chartOptionService,\n                        projectUIService: projectUIService,\n                        thridPartyApiService: thridPartyApiService,\n                        userLoginUIService: userLoginUIService,\n                        angularStyle: angularStyle,\n                        traverseRow: traverseRow,\n                        timeout: timeout,\n                        target: pMode ? rowDom : coldomInner,\n                        tabWrap: tabWrap,\n                        customMethodService: customMethodService,\n                        energyConsumeUIService: energyConsumeUIService,\n                        dictionaryService: dictionaryService,\n                        targetDom: targetDom,\n                        coldomInner: coldomInner,\n                        kqiManagerUIService: kqiManagerUIService,\n                        growl: growl,\n                        defer: defer,\n                        tElement: tElement,\n                        rowDom: rowDom,\n                        ajax: ajax,\n                        psTopo: psTopo,\n                        userDomainService: userDomainService,\n                        weatherService: weatherService,\n                        serviceProxy: serviceProxy,\n                        viewFlexService: viewFlexService,\n                        previewMode: pMode,\n                        resourceUIService: resourceUIService,\n                        ticketTaskService: ticketTaskService,\n                        buttonEnabled: buttonEnabled,\n                        alertService: alertService,\n                        onTabClick: events.onTabClick,\n                        SwSocket: SwSocket,\n                        kpiDataService: kpiDataService,\n                        route: route,\n                        routeParam: routeParam,\n                        q: q,\n                        imageslist: angularStyle.getParameters()[\"imgSrc\"].options.map(function (element) {\n                          return element.value;\n                        }),\n                        traverseColumn: traverseColumn //onTabClick : onTabClick\n\n                      }) || {};\n\n                      if (typeof renderFinish_callback == \"function\") {\n                        renderFinish_callback(element, dom);\n                      }\n\n                      if (!dom.underWatch) {\n                        defer.resolve(\"not under watch!!\");\n                      }\n\n                      placeholder.after(dom);\n                      placeholder.remove();\n                    }\n                  });\n                  defer.promise.$$state.dom = element;\n                  defer.promise.id = inx;\n                  promiseInx++;\n                  return defer.promise;\n                }(q.defer(), promiseInx);\n\n                traverseRow.promises.push(promise);\n                tool.append(setting);\n                tool.append(move);\n\n                if (!pMode) {\n                  rowDom.append(coldomInner);\n                  rowDom.attr(\"id\", element.id);\n                  rowDom.draggable({\n                    cursor: 'move',\n                    revert: true,\n                    handle: move,\n                    start: start,\n                    stop: stop,\n                    cursorAt: {\n                      right: 30\n                    },\n                    helper: function helper(ui) {\n                      var result = $(\"<div class='colDrag row'>\" + \"<div class='col-xs-12'>\" + \"<div class='row title'>\" + \"移动一个区块去其它位置\" + \"</div>\" + \"<div class='row' id='grid'>\" + \"</div>\" + \"</div>\" + \"</div>\");\n                      return result;\n                    },\n                    appendTo: $(\".drawarea\"),\n                    containment: $(\".drawarea\"),\n                    revertDuration: 0,\n                    zIndex: 999\n                  });\n                }\n\n                if (targetDom.attr(\"id\") != \"whole\" && data.length > 0) {\n                  emptyDom.attr({\n                    id: element.id\n                  });\n                }\n\n                if (!previewMode) {\n                  if (typeof emptyDom.contextMenu == 'function') {\n                    emptyDom.contextMenu(\"myMenu1\", {\n                      'bindings': {\n                        'paste': function paste(t) {\n                          var targetId = $(t).attr(\"id\");\n                          events.onInsert({\n                            id: targetId\n                          });\n                        },\n                        'json': function json(t) {\n                          var targetId = $(t).attr(\"id\");\n                          events.onInsertJSON({\n                            id: targetId\n                          });\n                        }\n                      }\n                    });\n                  }\n\n                  delBtn.attr({\n                    id: element.id\n                  });\n                  delBtn.on(\"click\", function (event, ui) {\n                    rootScope.$apply(function () {\n                      events.onDelete({\n                        event: event,\n                        ui: ui\n                      });\n                    });\n                  });\n                  cutBtn.attr({\n                    id: element.id\n                  });\n                  cutBtn.on(\"click\", function (event, ui) {\n                    rootScope.$apply(function () {\n                      events.onCut({\n                        event: event,\n                        ui: ui\n                      });\n                    });\n                  });\n                  var clone = element.$clone();\n                  delete clone.$index;\n                  delete clone.id;\n                  delete clone.template;\n\n                  if (!clone.hasOwnProperty(\"url\")) {\n                    clone.url = \"images/map/map1.png\";\n                  }\n\n                  copyBtn.attr({\n                    \"id\": element.id,\n                    \"data-clipboard-text\": JSON.stringify(clone, null, 2)\n                  });\n                  $$.loadExternalJs(['clipboard'], function (Clipboard) {\n                    var clipboard = new Clipboard(copyBtn[0]);\n                    clipboard.on('success', function (e) {\n                      rootScope.$apply(function () {\n                        e.id = element.id;\n                        events.onCopy({\n                          event: e\n                        });\n                      });\n                      growl.success(\"成功复制到剪切版\");\n                      e.clearSelection();\n                    });\n                    clipboard.on('error', function (e) {\n                      console.error('Action:', e.action);\n                      console.error('Trigger:', e.trigger);\n                    });\n                  });\n                  /**\n                   copyBtn.on(\"click\", function(event, ui){\n                    rootScope.$apply(function(){\n                      events.onCopy({event : event});\n                    });\n                    growl.success(\"成功复制到剪切版\");\n                  });*/\n\n                  /**\n                   $$.loadExternalJs(['zeroclipboard'], function(ZeroClipboard){\n                    var client = new ZeroClipboard(copyBtn[0]);\n                    client.on( \"ready\", function( readyEvent ) {\n                      client.on( \"aftercopy\", function( event ) {\n                        rootScope.$apply(function(){\n                          events.onCopy({event : event});\n                        });\n                        growl.success(\"成功复制到剪切版\");\n                      });\n                    });\n                  });*/\n\n                  pasteBtn.attr({\n                    id: element.id\n                  });\n                  setting.attr({\n                    id: element.id\n                  });\n                  dataBtn.attr({\n                    id: element.id\n                  });\n                  setting.on(\"click\", function (event, ui) {\n                    rootScope.$apply(function () {\n                      events.onSetting({\n                        event: event,\n                        ui: {\n                          element: tElement\n                        }\n                      });\n                    });\n                  });\n                  dataBtn.on(\"click\", function (event, ui) {\n                    rootScope.$apply(function () {\n                      events.onDataChange({\n                        event: event,\n                        ui: ui\n                      });\n                    });\n                  });\n                }\n\n                var hideEndBlank = false;\n\n                if (element.type != 'box-body' && element.type != 'box-footer') {\n                  if (!pMode) {\n                    targetDom.append(emptyDom);\n                  }\n                } else {\n                  hasBox = true;\n                }\n\n                if (!pMode) {\n                  targetDom.append(rowDom);\n                } else {\n                  if (element.type == 'col' || element.type == 'row' || element.type == 'box' || element.type == 'box-body' || element.type == 'box-footer' || element.type == 'block' || element.type == 'tab') {\n                    targetDom.append(rowDom);\n                  }\n                }\n\n                var dropConfig = _DROPCONFIG_.$clone();\n\n                dropConfig.over = over;\n                dropConfig.out = out;\n                dropConfig.drop = dropBefore;\n\n                if (typeof emptyDom.droppable == 'function') {\n                  emptyDom.droppable(dropConfig);\n                } else {\n                  require(['jquery-ui'], function () {\n                    emptyDom.droppable(dropConfig);\n                  });\n                }\n\n                if (!pMode) {\n                  if (element.type == \"box\") {\n                    traverseRow(coldomInner, element.children, pMode, renderFinish_callback);\n                  } else if (element.type != \"repeater\" && element.type != \"injector\") {\n                    if (element.children) {\n                      if (element.children.length > 0) {\n                        traverseColumn(coldomInner, element.children, pMode, renderFinish_callback);\n                      }\n                    }\n                  }\n                } else {\n                  if (element.type == \"box\") {\n                    traverseRow(rowDom, element.children, pMode, renderFinish_callback);\n                  } else if (element.type != \"repeater\" && element.type != \"injector\") {\n                    if (element.children) {\n                      if (element.children.length > 0) {\n                        traverseColumn(rowDom, element.children, pMode, renderFinish_callback);\n                      }\n                    }\n                  }\n                }\n              })(i, data[i]);\n            }\n\n            var dropConfig = _DROPCONFIG_.$clone();\n\n            dropConfig.over = over;\n            dropConfig.out = out;\n\n            if (typeof endDom.droppable == 'function') {\n              endDom.droppable(dropConfig);\n            } else {\n              require(['jquery-ui'], function () {\n                endDom.droppable(dropConfig);\n              });\n            }\n\n            if (!hasBox) {\n              if (!pMode) {\n                targetDom.append(endDom);\n                $$.loadExternalJs(['contextmenu'], function () {\n                  endDom.contextMenu(\"myMenu1\", {\n                    'bindings': {\n                      'paste': function paste(t) {\n                        var targetId = $(t).attr(\"id\");\n                        events.onPaste({\n                          id: targetId\n                        });\n                      },\n                      'json': function json(t) {\n                        var targetId = $(t).attr(\"id\");\n                        events.onPasteJSON({\n                          id: targetId\n                        });\n                      }\n                    }\n                  });\n                });\n              }\n            }\n\n            return traverseRow.promises;\n          }\n        }\n\n        ;\n      };\n\n      function start(event, ui) {\n        $(\"#drawarea\").css(\"overflow-y\", \"hidden\");\n        var targetId = $(event.target).attr(\"id\");\n        $(\"#\" + targetId + \".empty\").addClass(\"hideElement\");\n        $(\"#\" + targetId + \".row\").addClass(\"hideElement\");\n      }\n\n      function stop(event, ui) {\n        $(\"#drawarea\").css(\"overflow-y\", \"auto\");\n        var targetId = $(event.target).attr(\"id\");\n        $(\"#\" + targetId + \".empty\").removeClass(\"hideElement\");\n        $(\"#\" + targetId + \".row\").removeClass(\"hideElement\");\n      }\n\n      function dropBefore(event, ui) {\n        events.onDrop({\n          event: event,\n          ui: ui,\n          before: true\n        });\n      }\n\n      function over(event, ui) {\n        var targetId = $(event.target).attr(\"id\");\n        var dragId = ui.draggable.attr(\"id\");\n\n        if (targetId != dragId) {\n          var target = $(event.target);\n          target.addClass(\"hover\");\n        }\n      }\n\n      function out(event, ui) {\n        var target = $(event.target);\n        target.removeClass(\"hover\");\n      }\n\n      function overBefore(event, ui) {\n        var target = $(event.target);\n        target.children(\".wrap\").addClass(\"hover\");\n      }\n\n      function outBefore(event, ui) {\n        var target = $(event.target);\n        target.children(\".wrap\").removeClass(\"hover\");\n      }\n\n      function drop(event, ui) {\n        events.onDrop({\n          event: event,\n          ui: ui,\n          before: false\n        });\n      } //上传文件的设置，第4句最重要\n\n\n      rootScope.fileFormat = \"xls、xlsx、pdf、doc、docx、jpg、png、jpeg、bmp、gif、svg、pptx、ppt|DOCX|PNG|JPEG|DOC|JPG|XLX|XLSX\";\n      rootScope.fileMaxSize = 10;\n      rootScope.serviceOrigin = '/api/rest/upload/resourceFileUIService/uploadResourceFile';\n      controller('AppUploadCtrl', {\n        $scope: rootScope,\n        growl: growl,\n        FileUploader: FileUploader\n      });\n      instance.renderLayout = renderLayout;\n      instance.setMode = setMode;\n      instance.setButtonDisable = setButtonDisable;\n      instance.addEvents = addEvents;\n      return instance;\n    };\n  }]);\n});"],"sourceRoot":"/source/"}