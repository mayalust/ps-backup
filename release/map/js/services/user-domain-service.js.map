{"version":3,"sources":["js/services/user-domain-service.js"],"names":["define","services","factory","serviceProxy","serviceNm","service","queryDomainInfo","domianId","callBack","get","modifyDomain","param","addDomain","domainID","domain","deleteDomain","domainPath","id","getAssociateDomain2User","addDomain2User","userID","addDomainUser","queryDeleteDomain","queryDomainTreeByDomainPath","deviceId","returnObj","domainListTree","domainListDic","dom","newObj","parentID","name","description","domains","data","push","initTreeview","nodes","deleteDomain2User","changeDomain","newDomainID","newDomainPath","oldDomainID","queryDomainByUser","userId","queryDomainTreeByUser","obj","domainInfos","i","tags","length","belong","state","checked","text","icon","getDomainTree","code","queryDomainTree","queryEnterpriseDomainTree"],"mappings":"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","file":"js/services/user-domain-service.js","sourcesContent":["define(['../services/services.js'], function (services) {\n  'use strict';\n\n  services.factory('userDomainService', ['serviceProxy', function (serviceProxy) {\n    var serviceNm = 'userDomainService',\n        service = {};\n    /**\n     * 查看域信息\n     */\n\n    service.queryDomainInfo = function (domianId, callBack) {\n      serviceProxy.get(serviceNm, \"queryDomainInfo\", domianId, callBack);\n    };\n    /**\n     * 修改域信息\n     */\n\n\n    service.modifyDomain = function (param, callBack) {\n      serviceProxy.get(serviceNm, \"modifyDomain\", param, callBack);\n    };\n    /**\n     * 添加域\n     */\n\n\n    service.addDomain = function (domainID, domain, callBack) {\n      serviceProxy.get(serviceNm, \"addDomain\", [domainID, domain], callBack);\n    };\n    /**\n     * 移除域\n     */\n\n\n    service.deleteDomain = function (domainID, domainPath, callBack) {\n      serviceProxy.get(serviceNm, \"deleteDomain\", [{\n        \"id\": domainID,\n        \"domainPath\": domainPath\n      }], callBack);\n    };\n    /**\n     * 查看域关联的用户\n     */\n\n\n    service.getAssociateDomain2User = function (domainPath, callBack) {\n      serviceProxy.get(serviceNm, \"getAssociateDomain2User\", domainPath, callBack);\n    };\n    /**\n     * 给用户添加域\n     */\n\n\n    service.addDomain2User = function (domain, userID, callBack) {\n      serviceProxy.get(serviceNm, \"addDomain2User\", [domain, userID], callBack);\n    };\n    /**\n     * 资源域管理 给用户添加域\n     */\n\n\n    service.addDomainUser = function (domain, userID, callBack) {\n      serviceProxy.get(serviceNm, \"addDomainUser\", [domain, userID], callBack);\n    };\n    /**\n     * 删除资源域时查询是否可以删除\n     */\n\n\n    service.queryDeleteDomain = function (domain, callBack) {\n      serviceProxy.get(serviceNm, \"queryDeleteDomain\", domain, callBack);\n    };\n    /**\n     * 根据设备id切换域\n     */\n\n\n    service.queryDomainTreeByDomainPath = function (deviceId, callBack) {\n      serviceProxy.get(serviceNm, \"queryDomainTreeByDomainPath\", deviceId, function (returnObj) {\n        var domainListDic = {};\n        var domainListTree;\n        var dom = [];\n        var newObj = {\n          parentID: \"\",\n          domainPath: \"\",\n          name: \"\",\n          description: \"\",\n          domains: returnObj.data\n        };\n        dom.push(newObj);\n        var menu_list = service.initTreeview(dom[0], domainListDic);\n        domainListTree = menu_list.nodes;\n        returnObj.domainListDic = domainListDic;\n        returnObj.domainListTree = domainListTree;\n\n        if (callBack) {\n          callBack(returnObj);\n        }\n      });\n    };\n    /**\n     * 删除用户的一个域\n     */\n\n\n    service.deleteDomain2User = function (domainID, userID, callBack) {\n      serviceProxy.get(serviceNm, \"deleteDomain2User\", [{\n        \"id\": domainID\n      }, userID], callBack);\n    };\n    /**\n     * 切换用户的一个域\n     */\n\n\n    service.changeDomain = function (userID, newDomainID, newDomainPath, oldDomainID, callBack) {\n      serviceProxy.get(serviceNm, \"changeDomain\", [userID, {\n        \"id\": newDomainID,\n        \"domainPath\": newDomainPath\n      }, oldDomainID], callBack);\n    };\n    /**\n     * 查看用户下域信息\n     */\n\n\n    service.queryDomainByUser = function (userId, callBack) {\n      serviceProxy.get(serviceNm, \"queryDomainByUser\", userId, callBack);\n    };\n    /**\n     * 根据用户查域的树 \n     */\n\n\n    service.queryDomainTreeByUser = function (userId, callBack) {\n      serviceProxy.get(serviceNm, \"queryDomainTreeByUser\", userId, callBack);\n    };\n    /**\n     * 查看域的树 \n     */\n\n\n    service.initTreeview = function (obj, domainListDic) {\n      if (obj.domainInfos) {\n        obj.nodes = [];\n\n        for (var i in obj.domainInfos) {\n          obj.nodes.push(service.initTreeview(obj.domainInfos[i], domainListDic));\n        }\n\n        obj.tags = [obj.nodes.length];\n      }\n\n      if (obj.belong == 1) {\n        obj.state = {\n          checked: true\n        };\n      } else {\n        obj.state = {\n          checked: false\n        };\n      }\n\n      obj.text = obj.name;\n      obj.icon = \"ion ion-ios-color-filter\";\n      domainListDic[obj.domainPath] = obj;\n      if (obj.id) domainListDic[obj.id] = obj;else domainListDic[0] = obj;\n      return obj;\n    };\n\n    service.getDomainTree = function () {\n      serviceProxy.get(\"nodejsapi\", \"getDomainTree\", function (returnObj) {\n        if (returnObj.code != 0) return;\n      });\n    };\n\n    service.queryDomainTree = function (userId, callBack) {\n      serviceProxy.get(serviceNm, \"queryDomainTree\", userId, function (returnObj) {\n        if (returnObj.code != 0) return;\n        var domainListDic = {};\n        var domainListTree;\n        var dom = [];\n        var newObj = {\n          parentID: \"\",\n          domainPath: \"\",\n          name: \"\",\n          description: \"\",\n          domainInfos: returnObj.data\n        };\n        dom.push(newObj);\n        var menu_list = service.initTreeview(dom[0], domainListDic);\n        domainListTree = menu_list.nodes;\n        returnObj.domainListDic = domainListDic;\n        returnObj.domainListTree = domainListTree;\n\n        if (callBack) {\n          callBack(returnObj);\n        }\n      });\n    }; //经销商树\n\n\n    service.queryEnterpriseDomainTree = function (userId, callBack) {\n      serviceProxy.get(serviceNm, \"queryEnterpriseDomainTree\", userId, function (returnObj) {\n        var domainListDic = {};\n        var domainListTree;\n        var dom = [];\n        var newObj = {\n          parentID: \"\",\n          domainPath: \"\",\n          name: \"\",\n          description: \"\",\n          domainInfos: returnObj.data\n        };\n        dom.push(newObj);\n        var menu_list = service.initTreeview(dom[0], domainListDic);\n        domainListTree = menu_list.nodes;\n        returnObj.domainListDic = domainListDic;\n        returnObj.domainListTree = domainListTree;\n\n        if (callBack) {\n          callBack(returnObj);\n        }\n      });\n    };\n\n    return service;\n  }]);\n});"],"sourceRoot":"/source/"}