{"version":3,"sources":["js/directives/equipment-malfunctions-dom.js"],"names":["define","directives","BootstrapDialog","datatables","initDirective","$timeout","$compile","growl","$filter","restrict","controller","$scope","$element","$attrs","table","domMain","$on","Event","ALERTINFOSINIT","event","args","destroy","empty","DataTable","dom","option","length","$","ProudSmart","datatable","footerdom","language","data","pageLength","selLength","order","columns","title","optionCol3","columnDefs","targets","render","type","full","str","menuitems","modelId","nodeTypeList","nodeId","agentId","indexOf","alertCode","escape","severityStr","severityBg","orderable","state","rowCallback","nRow","aData","iDataIndex","selected","addClass","removeClass","on","e","settings","len","stopPropagation","target","checked","rows","select","tableRows","i","nodes","row","invalidate","draw","deselect","selectedHandler","tr","this","closest","count","attr","prop","preventDefault","doAction","flg","reloadViewId","code","cells","rowData","ngDialogOrder","submitBtn","css","returnObj","addOrder","selectedOrder","selectedClose","ifGo","each","changeState","selectedCount","show","closable","message","buttons","label","cssClass","action","dialogRef","successCount","errorCount","AlertIdsArr","push","alertId","success","selectAlertList","selList","$apply","close","warning","ordering","specialdom","processing","serverSide","ajax","pipeline","selectCol","drawCallback","api","hide","parentDom","parent","html","$broadcast","undefined","closeTime","actTime","list","pageAlertList","ajaxListUpdate","reload","confirmActiveAlert","forEach","deactiveGate","closeActiveAlert"],"mappings":"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","file":"js/directives/equipment-malfunctions-dom.js","sourcesContent":["define(['directives/directives', 'bootstrap-dialog', 'datatables.net', 'datatables.net-bs', 'datatables.net-select'], function (directives, BootstrapDialog, datatables) {\n  'use strict';\n\n  directives.initDirective('alertTable', ['$timeout', '$compile', 'growl', '$filter', function ($timeout, $compile, growl, $filter) {\n    return {\n      restrict: 'A',\n      controller: ['$scope', '$element', '$attrs', function ($scope, $element, $attrs) {\n        var domMain = $element;\n        var table;\n        var isEditing = false;\n        $scope.$on(Event.ALERTINFOSINIT + \"_view\", function (event, args) {\n          if (table) {\n            table.destroy();\n            domMain.empty();\n          }\n\n          isEditing = false;\n          table = domMain.DataTable({\n            dom: args.option[0] && args.option[0].length > 0 ? $.ProudSmart.datatable.footerdom : '',\n            language: $.ProudSmart.datatable.language,\n            data: args.option[0],\n            \"pageLength\": $scope.selLength,\n            // select: $.ProudSmart.datatable.select,\n            order: [[6, \"desc\"]],\n            columns: [// $.ProudSmart.datatable.selectCol,\n            {\n              title: \"告警对象\",\n              data: \"devName\"\n            }, {\n              title: \"告警名称\",\n              data: \"title\"\n            }, {\n              title: \"告警消息\",\n              data: \"message\"\n            }, {\n              title: \"告警级别\",\n              data: \"severity\"\n            }, {\n              title: \"状态\",\n              data: \"state\"\n            }, {\n              title: \"首次告警时间\",\n              data: \"firstArisingTime\"\n            }, {\n              title: \"最近告警时间\",\n              data: \"arisingTime\"\n            }, {\n              title: \"次数\",\n              data: \"count\"\n            }, {\n              title: \"关闭告警时间\",\n              data: \"closeTime\"\n            }, $.ProudSmart.datatable.optionCol3],\n            columnDefs: [//   {\n            //   \"targets\": 0,\n            //   orderable: false,\n            //   \"render\": function(data, type, full) {\n            //     // 返回自定义内容\n            //     if(type == \"display\") {\n            //       if(data) {\n            //         return '<input class=\"itemCheckBox\" checked type=\"checkbox\">';\n            //       } else {\n            //         return '<input class=\"itemCheckBox\" type=\"checkbox\">';\n            //       }\n            //     }\n            //     return \"\";\n            //   }\n            // },\n            {\n              \"targets\": 0,\n              \"data\": \"devName\",\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                var str = '';\n\n                if ($scope.menuitems['A02_S02']) {\n                  var modelId = full.nodeTypeList[full.nodeTypeList.length - 1];\n\n                  if (modelId == 300) {\n                    str = \"[管理域]\" + data;\n                  } else if (modelId == 301) {\n                    str = \"[客户域]\" + data;\n                  } else if (modelId == 302) {\n                    str = \"[项目域]\" + data;\n                  } else {\n                    str = \"<a href='#/facility/DEVICESEARCH/\" + full.nodeId + \"'>\" + data + \"</a>\";\n                  }\n                } else {\n                  str = data;\n                }\n\n                return str;\n              }\n            }, {\n              \"targets\": 1,\n              \"data\": \"title\",\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                var str = '';\n\n                if ($scope.menuitems['A01_S05']) {\n                  // str = \"<a href='#/alertRules/special/\" + full.nodeTypeList[full.nodeTypeList.length - 1] + \"/view'>\" + data + \"</a>\";\n                  if (full.agentId && full.agentId.indexOf(\"RULE:\") != -1) {\n                    str = \"<a href='#/alertRules/\" + full.nodeId + \"/\" + full.alertCode + \"'>\" + data + \"</a>\";\n                  } else {\n                    str = data;\n                  }\n                } else {\n                  str = data;\n                }\n\n                return str;\n              }\n            }, {\n              \"targets\": 2,\n              \"data\": \"message\",\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                var str;\n                str = escape(data);\n                return str;\n              }\n            }, {\n              \"targets\": 3,\n              \"data\": \"severity\",\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                var severityStr = \"无数据\";\n                var severityBg = \"alerts-warning\";\n\n                if (data == 4) {\n                  severityStr = \"严重\";\n                  severityBg = \"alerts-critical\";\n                } else if (data == 3) {\n                  severityStr = \"重要\";\n                  severityBg = \"alerts-major\";\n                } else if (data == 2) {\n                  severityStr = \"次要\";\n                  severityBg = \"alerts-minor\";\n                } else if (data == 1) {\n                  severityStr = \"警告\";\n                  severityBg = \"alerts-warning\";\n                }\n\n                return \"<span class='label \" + severityBg + \"'>\" + severityStr + \"</span>\";\n              }\n            }, {\n              \"targets\": 4,\n              \"data\": \"state\",\n              \"render\": function render(data, type, full) {\n                var stateStr; // 返回自定义内容\n\n                if (data == 0) stateStr = \"<span class='label label-info'>新产生</span>\";else if (data == 5) stateStr = \"<span class='label label-primary'>已确认</span>\";else if (data == 10) stateStr = \"<span class='label label-warning'>处理中</span>\";else if (data == 20) stateStr = \"<span class='label label-success'>已解决</span>\";else if (data == 30) stateStr = \"已忽略\";else stateStr = \"无数据\";\n                return stateStr;\n              }\n            }, {\n              \"targets\": 5,\n              \"data\": \"firstArisingTime\",\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                var str;\n                str = $filter('date')(data, 'yyyy-MM-dd HH:mm:ss'); //str = \"<span date-label value=\" + data + \" format='yyyy-MM-dd HH:mm:ss'></span>\";\n\n                return str;\n              }\n            }, {\n              \"targets\": 6,\n              \"data\": \"arisingTime\",\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                var str;\n                str = $filter('date')(data, 'yyyy-MM-dd HH:mm:ss'); //str = \"<span date-label value=\" + data + \" format='yyyy-MM-dd HH:mm:ss'></span>\";\n\n                return str;\n              }\n            }, {\n              \"targets\": 8,\n              \"data\": \"closeTime\",\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                var str;\n                str = $filter('date')(data, 'yyyy-MM-dd HH:mm:ss'); //str = \"<span date-label value=\" + data + \" format='yyyy-MM-dd HH:mm:ss'></span>\";\n\n                return str;\n              }\n            }, {\n              \"targets\": 9,\n              \"orderable\": false,\n              \"data\": \"option\",\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                var str = \"<div class='btn-group btn-group-sm'>\";\n\n                if (full.state == 0) {\n                  if ($scope.menuitems['A08_S05']) {\n                    str += \"<button id='claim-btn' class='btn btn-primary' ><span class='hidden-xs'> 确认</span></button>\";\n                  }\n                } else {\n                  if ($scope.menuitems['A08_S05']) {\n                    str += \"<button disabled class='btn btn-primary' ><span class='hidden-xs'> 确认</span></button>\";\n                  }\n                }\n\n                if (full.state == 0 || full.state == 5 || full.state == 10) {\n                  if ($scope.menuitems['A07_S05']) {\n                    str += \"<button id='close-btn' class='btn btn-default' ><span class='hidden-xs'> 关闭</span></button>\";\n                  }\n                } else {\n                  if ($scope.menuitems['A07_S05']) {\n                    str += \"<button disabled class='btn btn-default' ><span class='hidden-xs'> 关闭</span></button>\";\n                  }\n                }\n\n                if ($scope.menuitems['A06_S05'] && (full.state == 0 || full.state == 5)) {\n                  str += \"<button type='button' class='btn btn-default dropdown-toggle' data-toggle='dropdown'> 更多<span class='caret'></span></button>\";\n                  str += \"<ul class='dropdown-menu' role='menu'>\";\n\n                  if ($scope.menuitems['A06_S05']) {\n                    str += \"<li><a role='button' id='order-btn'>转工单</a></li>\";\n                  }\n\n                  str += \"</ul>\";\n                }\n\n                str += \"</div>\";\n                return str;\n              }\n            }],\n            rowCallback: function rowCallback(nRow, aData, iDataIndex) {\n              if (aData.selected) {\n                $(nRow).addClass(\"selected\");\n              } else {\n                $(nRow).removeClass(\"selected\");\n              }\n\n              $compile(nRow)($scope);\n            }\n          });\n        });\n        /**\n         * 监听表格初始化后，添加按钮\n         */\n\n        domMain.on('init.dt', function () {\n          /*if(table != undefined){\n             \n            if($scope.selLength > 0){\n              table.page.len($scope.selLength).draw();\n            }\n          }*/\n        });\n        domMain.on('length.dt', function (e, settings, len) {\n          $scope.selLength = len;\n        });\n        domMain.on('change', '#allselect-btn', function (e) {\n          e.stopPropagation();\n\n          if (e.target.checked) {\n            table.rows().select();\n            var tableRows = table.rows({\n              selected: true\n            });\n\n            for (var i = 0; i < tableRows.nodes().length; i++) {\n              var row = table.row(tableRows.nodes()[i]);\n              row.data().selected = true;\n            }\n\n            ;\n            table.rows().invalidate().draw(false);\n          } else {\n            var tableRows = table.rows({\n              selected: true\n            });\n\n            for (var i = 0; i < tableRows.nodes().length; i++) {\n              var row = table.row(tableRows.nodes()[i]);\n              row.data().selected = false;\n            }\n\n            ;\n            table.rows().deselect();\n            table.rows().invalidate().draw(false);\n          }\n\n          $scope.selectedHandler();\n        });\n        domMain.on('change', '.itemCheckBox', function (e) {\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n\n          if (e.target.checked) {\n            row.data().selected = true;\n          } else {\n            row.data().selected = false;\n          }\n\n          var tableRows = table.rows({\n            selected: true\n          });\n\n          if (tableRows.count() != table.rows()[0].length) {\n            $('#allselect-btn').attr('checked', false);\n            $('#allselect-btn').prop('checked', false);\n          } else if (tableRows.count() == table.rows()[0].length) {\n            $('#allselect-btn').attr('checked', true);\n            $('#allselect-btn').prop('checked', true);\n          }\n\n          $scope.selectedHandler();\n        }); // domMain.on('click', 'td', function(e) {\n        //   var tr = $(this).closest('tr');\n        //   var row = table.row(tr);\n        //   var name = $(this).text();\n        //   var rowData = row.data();\n        //   if (rowData) {\n        //     if (($(this).context.cellIndex == 5) || ($(this).context.cellIndex == 0)) {\n        //       return;\n        //     }\n        //     if (name.indexOf(\"Dropdown\") < 0) {\n        //       if (rowData.orderId != null && rowData.orderId != '') {\n        //         location.href = \"index.html#/orderdetail/\" + rowData.orderId + \"/order\";\n        //       }\n        //     }\n        //   }\n        // });\n\n        domMain.on('click', '#claim-btn', function (e) {\n          e.stopPropagation();\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          $scope.doAction('claim', [row.data()['alertId']], function (flg) {\n            if (flg) {\n              $scope.reloadViewId();\n              /* row.data().state = 5;\n               row.cells().invalidate().draw(false);*/\n            }\n          });\n        });\n        domMain.on('click', '#close-btn', function (e) {\n          e.stopPropagation();\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          $scope.doAction('close', [row.data()['alertId']], function (flg) {\n            if (flg.code == 0) {\n              $scope.reloadViewId();\n              /*row.data().state = 20;\n              if(flg.data.closeTime == undefined){\n                row.data().closeTime = flg.data.actTime;\n              }\n              // row.cells().invalidate().draw(false);\n              row.remove().draw(false);*/\n            } else {\n              row.cells().invalidate().draw(false);\n            }\n          });\n        });\n        domMain.on('click', '#order-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          var rowData = row.data();\n          $scope.ngDialogOrder(rowData);\n\n          $scope.submitBtn = function () {\n            // var tr = $(this).closest('tr').parent();\n            // var row = table.row(tr);\n            $scope.doAction('submit-btn', 111, function (flg) {\n              if (flg) {\n                row.data().state = 10;\n                row.cells().invalidate().draw(false);\n              }\n            });\n          };\n        }); // domMain.on('click', '#submit-btn', function(e) {\n        //   e.preventDefault();\n        //   var tr = $(this).closest('tr').parent();\n        //   var row = table.row(tr);\n        //   $scope.isEditing = false;\n        //   tr.removeClass('shown');\n        //   $scope.doAction('submit-btn', 111, function(flg) {\n        //     if (flg) {\n        //       row.data().state = 10;\n        //       row.cells().invalidate().draw(false);\n        //     }\n        //   });\n        // });\n\n        domMain.on('click', \"#cancel-btn\", function (e) {\n          e.preventDefault();\n          var tr = $(\"#newtr\").closest('tr');\n          var row = table.row(tr);\n          var rowData = row.data();\n          tr.css(\"display\", \"none\");\n          $scope.doAction('cancel-btn', row.data(), function (returnObj) {});\n        });\n        $scope.$on(\"addOrder\", function () {\n          $scope.addOrder();\n        });\n        $scope.$on(\"selectedOrder\", function () {\n          $scope.selectedOrder();\n        });\n        $scope.$on(\"selectedClose\", function () {\n          $scope.selectedClose();\n        });\n        $scope.$on(\"changeState\", function () {\n          changeState();\n        }); //多项确认\n\n        $scope.selectedOrder = function () {\n          var tableRows = table.rows({\n            selected: true\n          });\n          var selectedCount = tableRows.count();\n          var nodes = tableRows.nodes();\n\n          if (selectedCount == 0) {\n            growl.warning(\"当前没有选中的告警项\", {});\n            return;\n          }\n\n          BootstrapDialog.show({\n            title: '提示',\n            closable: false,\n            //size:BootstrapDialog.SIZE_WIDE,\n            message: '确认您所选择的 ' + selectedCount + ' 条记录吗？',\n            buttons: [{\n              label: '确定',\n              cssClass: 'btn-success',\n              action: function action(dialogRef) {\n                var successCount = 0;\n                var errorCount = 0;\n                var AlertIdsArr = [];\n                var ifGo = false;\n\n                for (var i = 0; i < nodes.length; i++) {\n                  var row = table.row(nodes[i]);\n                  var rowData = row.data();\n\n                  if (rowData.state == 0) {\n                    AlertIdsArr.push(rowData.alertId);\n                    successCount++;\n                    row.data().state = 5;\n                  } else {\n                    errorCount++;\n                  }\n\n                  if (selectedCount == successCount + errorCount) {\n                    ifGo = true;\n                    growl.success(\"成功确认\" + successCount + \"个,失败\" + errorCount + \"个\", {});\n                    $scope.selectAlertList.selList = [];\n                    $scope.$apply();\n                  }\n                }\n\n                ;\n\n                if (ifGo) {\n                  $scope.doAction(\"claim\", AlertIdsArr, function (returnObj) {\n                    if (returnObj) {\n                      row.cells().invalidate().draw(false);\n                      $(\".itemCheckBox\").each(function () {\n                        $(this).attr(\"checked\", false);\n                      });\n                      $(\"#allselect-btn\").attr(\"checked\", false);\n                      table.rows().deselect();\n                    }\n                  });\n                }\n\n                dialogRef.close();\n              }\n            }, {\n              label: '取消',\n              action: function action(dialogRef) {\n                dialogRef.close();\n              }\n            }]\n          });\n        }; //多项关闭\n\n\n        $scope.selectedClose = function () {\n          var tableRows = table.rows({\n            selected: true\n          });\n          var selectedCount = tableRows.count();\n          var nodes = tableRows.nodes();\n\n          if (selectedCount == 0) {\n            growl.warning(\"当前没有选中的告警项\", {});\n            return;\n          }\n\n          BootstrapDialog.show({\n            title: '提示',\n            closable: false,\n            //size:BootstrapDialog.SIZE_WIDE,\n            message: '确认您所选择的 ' + selectedCount + ' 条记录吗？',\n            buttons: [{\n              label: '确定',\n              cssClass: 'btn-success',\n              action: function action(dialogRef) {\n                var successCount = 0;\n                var errorCount = 0;\n                var AlertIdsArr = [];\n                var ifGo = false;\n\n                for (var i = 0; i < nodes.length; i++) {\n                  var row = table.row(nodes[i]);\n                  var rowData = row.data();\n\n                  if (rowData.state == 0 || rowData.state == 5 || rowData.state == 10) {\n                    AlertIdsArr.push(rowData.alertId);\n                    successCount++;\n                    row.data().state = 20;\n                  } else {\n                    errorCount++;\n                  }\n\n                  if (selectedCount == successCount + errorCount) {\n                    ifGo = true;\n                    growl.success(\"成功确认\" + successCount + \"个,失败\" + errorCount + \"个\", {});\n                    $scope.selectAlertList.selList = [];\n                    $scope.$apply();\n                  }\n                }\n\n                ;\n\n                if (ifGo) {\n                  $scope.doAction(\"close2\", AlertIdsArr, function (returnObj) {\n                    if (returnObj) {\n                      row.cells().invalidate().draw(false);\n                      $(\".itemCheckBox\").each(function () {\n                        $(this).attr(\"checked\", false);\n                      });\n                      $(\"#allselect-btn\").attr(\"checked\", false);\n                      table.rows().deselect();\n                    }\n                  });\n                }\n\n                dialogRef.close();\n              }\n            }, {\n              label: '取消',\n              action: function action(dialogRef) {\n                dialogRef.close();\n              }\n            }]\n          });\n        }; //多项转工单\n\n\n        $scope.addOrder = function () {\n          var tableRows = table.rows({\n            selected: true\n          });\n          var selectedCount = tableRows.count();\n          var nodes = tableRows.nodes();\n\n          if (selectedCount == 0) {\n            growl.warning(\"当前没有选中的告警项\", {});\n            return;\n          }\n\n          var successCount = 0;\n          var errorCount = 0;\n          var AlertIdsArr = [];\n          var ifGo = false;\n\n          for (var i = 0; i < nodes.length; i++) {\n            var row = table.row(nodes[i]);\n            var rowData = row.data();\n\n            if (rowData.state == 0 || rowData.state == 5) {\n              AlertIdsArr.push(rowData.alertId);\n              successCount++;\n              row.data().state = 10;\n            } else {\n              errorCount++;\n            }\n\n            if (selectedCount == successCount + errorCount) {\n              ifGo = true;\n              growl.success(\"成功确认\" + successCount + \"个,失败\" + errorCount + \"个\", {});\n            }\n          }\n\n          ;\n\n          if (ifGo) {\n            $scope.doAction(\"order\", AlertIdsArr, function (returnObj) {\n              if (returnObj) {}\n            });\n          }\n        }; //转工单成功后改变状态\n\n\n        function changeState() {\n          var ifGo = false;\n          var tableRows = table.rows({\n            selected: true\n          });\n          var selectedCount = tableRows.count();\n          var nodes = tableRows.nodes();\n\n          for (var i = 0; i < nodes.length; i++) {\n            var row = table.row(nodes[i]);\n            var rowData = row.data(); // row.data().state = 10;\n\n            row.cells().invalidate().draw(false);\n            ifGo = true;\n          }\n\n          ;\n\n          if (ifGo) {\n            $(\".itemCheckBox\").each(function () {\n              $(this).attr(\"checked\", false);\n            });\n            $(\"#allselect-btn\").attr(\"checked\", false);\n            table.rows().deselect();\n          }\n        }\n      }]\n    };\n  }]);\n  directives.initDirective('alertPageTable', ['$timeout', '$compile', 'growl', '$filter', function ($timeout, $compile, growl, $filter) {\n    return {\n      restrict: 'A',\n      controller: ['$scope', '$element', '$attrs', function ($scope, $element, $attrs) {\n        var domMain = $element;\n        var table;\n        var isEditing = false;\n        $scope.$on(Event.ALERTINFOSINIT, function (event, args) {\n          if (table) {\n            table.destroy();\n            domMain.empty();\n          }\n\n          isEditing = false;\n          table = domMain.DataTable({\n            ordering: false,\n            dom: $.ProudSmart.datatable.specialdom,\n            language: $.ProudSmart.datatable.language,\n            processing: true,\n            serverSide: true,\n            select: $.ProudSmart.datatable.select,\n            ajax: $scope.pipeline(),\n            columns: [$.ProudSmart.datatable.selectCol, {\n              title: \"告警对象\",\n              data: \"devName\"\n            }, {\n              title: \"告警名称\",\n              data: \"title\"\n            }, {\n              title: \"告警消息\",\n              data: \"message\"\n            }, {\n              title: \"告警级别\",\n              data: \"severity\"\n            }, {\n              title: \"状态\",\n              data: \"state\"\n            }, {\n              title: \"首次告警时间\",\n              data: \"firstArisingTime\"\n            }, {\n              title: \"最近告警时间\",\n              data: \"arisingTime\"\n            }, {\n              title: \"次数\",\n              data: \"count\"\n            }, {\n              title: \"关闭告警时间\",\n              data: \"closeTime\"\n            }, $.ProudSmart.datatable.optionCol3],\n            columnDefs: [{\n              \"targets\": 0,\n              \"orderable\": false,\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                if (type == \"display\") {\n                  if (data) {\n                    return '<input class=\"itemCheckBox\" checked type=\"checkbox\">';\n                  } else {\n                    return '<input class=\"itemCheckBox\" type=\"checkbox\">';\n                  }\n                }\n\n                return \"\";\n              }\n            }, {\n              \"targets\": 1,\n              \"data\": \"devName\",\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                var str = '';\n\n                if ($scope.menuitems['A02_S02']) {\n                  var modelId = full.nodeTypeList[full.nodeTypeList.length - 1];\n\n                  if (modelId == 300) {\n                    str = \"[管理域]\" + data;\n                  } else if (modelId == 301) {\n                    str = \"[客户域]\" + data;\n                  } else if (modelId == 302) {\n                    str = \"[项目域]\" + data;\n                  } else {\n                    str = \"<a href='#/facility/DEVICESEARCH/\" + full.nodeId + \"'>\" + data + \"</a>\";\n                  }\n                } else {\n                  str = data;\n                }\n\n                return str;\n              }\n            }, {\n              \"targets\": 2,\n              \"data\": \"title\",\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                var str = '';\n\n                if ($scope.menuitems['A01_S05']) {\n                  // str = \"<a href='#/alertRules/special/\" + full.nodeTypeList[full.nodeTypeList.length - 1] + \"/view'>\" + data + \"</a>\";\n                  // str = \"<a href='#/alertRules//\" + full.alertCode + \"'>\" + data + \"</a>\";\n                  if (full.agentId && full.agentId.indexOf(\"RULE:\") != -1) {\n                    str = \"<a href='#/alertRules/\" + full.nodeId + \"/\" + full.alertCode + \"'>\" + data + \"</a>\";\n                  } else {\n                    str = data;\n                  }\n                } else {\n                  str = data;\n                }\n                /*if(full.kpiCode == 0) {\n                  // var str = \"<a href='#/resource_type/\" + full.nodeTypeList[full.nodeTypeList.length - 1] + \"/fault'>\" + data + \"</a>\";\n                   str = \"<a href='#/alertRules/special/\" + full.nodeTypeList[full.nodeTypeList.length - 1] + \"/fault'>\" + data + \"</a>\";\n                } else {\n                  // var str = \"<a href='#/resource_type/\" + full.nodeTypeList[full.nodeTypeList.length - 1] + \"/alert'>\" + data + \"</a>\";\n                  var str = \"<a href='#/alertRules/special/\" + full.nodeTypeList[full.nodeTypeList.length - 1] + \"/alert'>\" + data + \"</a>\";\n                }*/\n\n\n                return str;\n              }\n            }, {\n              \"targets\": 3,\n              \"data\": \"message\",\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                var str;\n                str = escape(data);\n                return str;\n              }\n            }, {\n              \"targets\": 4,\n              \"data\": \"severity\",\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                var severityStr = \"无数据\";\n                var severityBg = \"alerts-warning\";\n\n                if (data == 4) {\n                  severityStr = \"严重\";\n                  severityBg = \"alerts-critical\";\n                } else if (data == 3) {\n                  severityStr = \"重要\";\n                  severityBg = \"alerts-major\";\n                } else if (data == 2) {\n                  severityStr = \"次要\";\n                  severityBg = \"alerts-minor\";\n                } else if (data == 1) {\n                  severityStr = \"警告\";\n                  severityBg = \"alerts-warning\";\n                }\n\n                return \"<span class='label \" + severityBg + \"'>\" + severityStr + \"</span>\";\n              }\n            }, {\n              \"targets\": 5,\n              \"data\": \"state\",\n              \"render\": function render(data, type, full) {\n                var stateStr; // 返回自定义内容\n\n                if (data == 0) stateStr = \"<span class='label label-info'>新产生</span>\";else if (data == 5) stateStr = \"<span class='label label-primary'>已确认</span>\";else if (data == 10) stateStr = \"<span class='label label-warning'>处理中</span>\";else if (data == 20) stateStr = \"<span class='label label-success'>已解决</span>\";else if (data == 30) stateStr = \"已忽略\";else stateStr = \"无数据\";\n                return stateStr;\n              }\n            }, {\n              \"targets\": 6,\n              \"data\": \"firstArisingTime\",\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                var str;\n                str = $filter('date')(data, 'yyyy-MM-dd HH:mm:ss'); //str = \"<span date-label value=\" + data + \" format='yyyy-MM-dd HH:mm:ss'></span>\";\n\n                return str;\n              }\n            }, {\n              \"targets\": 7,\n              \"data\": \"arisingTime\",\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                var str;\n                str = $filter('date')(data, 'yyyy-MM-dd HH:mm:ss'); //str = \"<span date-label value=\" + data + \" format='yyyy-MM-dd HH:mm:ss'></span>\";\n\n                return str;\n              }\n            }, {\n              \"targets\": 9,\n              \"data\": \"closeTime\",\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                var str;\n                str = $filter('date')(data, 'yyyy-MM-dd HH:mm:ss'); //str = \"<span date-label value=\" + data + \" format='yyyy-MM-dd HH:mm:ss'></span>\";\n\n                return str;\n              }\n            }, {\n              \"targets\": 10,\n              \"data\": \"option\",\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                var str = \"<div class='btn-group btn-group-sm'>\";\n\n                if (full.state == 0) {\n                  if ($scope.menuitems['A08_S05']) {\n                    str += \"<button id='claim-btn' class='btn btn-primary' ><span class='hidden-xs'> 确认</span></button>\";\n                  }\n                } else {\n                  if ($scope.menuitems['A08_S05']) {\n                    str += \"<button disabled class='btn btn-primary' ><span class='hidden-xs'> 确认</span></button>\";\n                  }\n                }\n\n                if (full.state == 0 || full.state == 5 || full.state == 10) {\n                  if ($scope.menuitems['A07_S05']) {\n                    str += \"<button id='close-btn' class='btn btn-default' ><span class='hidden-xs'> 关闭</span></button>\";\n                  }\n                } else {\n                  if ($scope.menuitems['A07_S05']) {\n                    str += \"<button disabled class='btn btn-default' ><span class='hidden-xs'> 关闭</span></button>\";\n                  }\n                }\n\n                if ($scope.menuitems['A06_S05'] && (full.state == 0 || full.state == 5)) {\n                  str += \"<button type='button' class='btn btn-default dropdown-toggle' data-toggle='dropdown'> 更多<span class='caret'></span></button>\";\n                  str += \"<ul class='dropdown-menu' role='menu'>\";\n\n                  if ($scope.menuitems['A06_S05']) {\n                    str += \"<li><a role='button' id='order-btn'>转工单</a></li>\";\n                  }\n\n                  str += \"</ul>\";\n                }\n\n                str += \"</div>\";\n                return str;\n              }\n            }],\n            rowCallback: function rowCallback(nRow, aData, iDataIndex) {\n              if (aData.selected) {\n                $(nRow).addClass(\"selected\");\n              } else {\n                $(nRow).removeClass(\"selected\");\n              }\n\n              $compile(nRow)($scope);\n            },\n            drawCallback: function drawCallback(settings) {\n              var api = this.api();\n\n              if (api.data().length > 0) {\n                $(\".footerdom\").show(); //                $(\".dataTables_wrapper .dataTables_filter\").show();\n\n                $(\".dataTables_wrapper .dataTables_filter\").empty();\n              } else {\n                $(\".footerdom\").hide();\n                $(\".dataTables_wrapper .row\").hide();\n                $(\".dataTables_wrapper .dataTables_filter\").empty();\n              }\n\n              $('#allselect-btn').attr('checked', false);\n              $('#allselect-btn').prop('checked', false);\n            }\n          });\n        });\n        /**\n         * 监听表格初始化后，添加按钮\n         */\n\n        domMain.on('init.dt', function () {\n          var parentDom = $(\".special-btn\").parent();\n          var str = '<div class=\"btn-group margin-bottom-5\">';\n          str += '<button type=\"button\" ng-click=\"selectedOrder();\" ng-show=\"menuitems[&apos;A08_S05&apos;]\" ng-disabled=\"confirmActiveAlert.length == 0\" class=\"btn btn-default btn-sm\"><i class=\"fa fa-check\"></i><span class=\"hidden-sm\"> 确认告警</span></button>';\n          str += '<button type=\"button\" ng-click=\"selectedClose();\" ng-show=\"menuitems[&apos;A07_S05&apos;]\" ng-disabled=\"closeActiveAlert.length == 0\" class=\"btn btn-default btn-sm\"><i class=\"fa fa-close\"></i><span class=\"hidden-sm\"> 关闭告警</span></button>';\n          str += '<button type=\"button\" ng-if=\"false\" ng-click=\"addOrder();\" class=\"btn btn-default btn-sm\"><i class=\"fa fa-mail-forward\"></i><span class=\"hidden-sm\"> 转工单</span></button></div>';\n          parentDom.html(str);\n          $compile(parentDom)($scope);\n        });\n        domMain.on('change', '#allselect-btn', function (e) {\n          e.stopPropagation();\n\n          if (e.target.checked) {\n            table.rows().select();\n            var tableRows = table.rows({\n              selected: true\n            });\n\n            for (var i = 0; i < tableRows.nodes().length; i++) {\n              var row = table.row(tableRows.nodes()[i]);\n              row.data().selected = true;\n            }\n\n            ;\n            table.rows().invalidate().draw(false);\n          } else {\n            var tableRows = table.rows({\n              selected: true\n            });\n\n            for (var i = 0; i < tableRows.nodes().length; i++) {\n              var row = table.row(tableRows.nodes()[i]);\n              row.data().selected = false;\n            }\n\n            ;\n            table.rows().deselect();\n            table.rows().invalidate().draw(false);\n          }\n\n          $scope.selectedHandler();\n        });\n        domMain.on('change', '.itemCheckBox', function (e) {\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n\n          if (e.target.checked) {\n            row.data().selected = true;\n          } else {\n            row.data().selected = false;\n          }\n\n          var tableRows = table.rows({\n            selected: true\n          });\n\n          if (tableRows.count() != table.rows()[0].length) {\n            $('#allselect-btn').attr('checked', false);\n            $('#allselect-btn').prop('checked', false);\n          } else if (tableRows.count() == table.rows()[0].length) {\n            $('#allselect-btn').attr('checked', true);\n            $('#allselect-btn').prop('checked', true);\n          }\n\n          $scope.selectedHandler();\n        }); // domMain.on('click', 'td', function(e) {\n        //   var tr = $(this).closest('tr');\n        //   var row = table.row(tr);\n        //   var name = $(this).text();\n        //   var rowData = row.data();\n        //   if (rowData) {\n        //     if (($(this).context.cellIndex == 5) || ($(this).context.cellIndex == 0)) {\n        //       return;\n        //     }\n        //     if (name.indexOf(\"Dropdown\") < 0) {\n        //       if (rowData.orderId != null && rowData.orderId != '') {\n        //         location.href = \"index.html#/orderdetail/\" + rowData.orderId + \"/order\";\n        //       }\n        //     }\n        //   }\n        // });\n\n        domMain.on('click', '#claim-btn', function (e) {\n          e.stopPropagation();\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          $scope.doAction('claim', [row.data()['alertId']], function (flg) {\n            if (flg) {\n              row.data().state = 5;\n              $scope.$broadcast(Event.ALERTINFOSINIT, {\n                \"option\": []\n              }); // row.cells().invalidate().draw(false);\n            }\n          });\n        });\n        domMain.on('click', '#close-btn', function (e) {\n          e.stopPropagation();\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          $scope.doAction('close', [row.data()['alertId']], function (flg) {\n            if (flg.code == 0) {\n              row.data().state = 20;\n\n              if (flg.data.closeTime == undefined) {\n                row.data().closeTime = flg.data.actTime;\n              }\n\n              $scope.$broadcast(Event.ALERTINFOSINIT, {\n                \"option\": []\n              });\n            } else {\n              row.cells().invalidate().draw(false);\n            }\n          });\n        });\n        domMain.on('click', '#order-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          var rowData = row.data();\n          $scope.ngDialogOrder(rowData);\n\n          $scope.submitBtn = function () {\n            // var tr = $(this).closest('tr').parent();\n            // var row = table.row(tr);\n            $scope.doAction('submit-btn', 111, function (flg) {\n              if (flg) {\n                var list = $scope.pageAlertList;\n                var data = row.data();\n\n                for (var i in list) {\n                  if (list[i].alertId == data.alertId) {\n                    list[i].state = 10;\n                  }\n\n                  $scope.ajaxListUpdate.push(list[i]);\n                }\n\n                table.ajax.reload(); // row.data().state = 10;\n                // row.cells().invalidate().draw(false);\n              }\n            });\n          };\n        }); // domMain.on('click', '#submit-btn', function(e) {\n        //   e.preventDefault();\n        //   var tr = $(this).closest('tr').parent();\n        //   var row = table.row(tr);\n        //   $scope.isEditing = false;\n        //   tr.removeClass('shown');\n        //   $scope.doAction('submit-btn', 111, function(flg) {\n        //     if (flg) {\n        //       row.data().state = 10;\n        //       row.cells().invalidate().draw(false);\n        //     }\n        //   });\n        // });\n\n        domMain.on('click', \"#cancel-btn\", function (e) {\n          e.preventDefault();\n          var tr = $(\"#newtr\").closest('tr');\n          var row = table.row(tr);\n          var rowData = row.data();\n          tr.css(\"display\", \"none\");\n          $scope.doAction('cancel-btn', row.data(), function (returnObj) {});\n        });\n        $scope.$on(\"addOrder\", function () {\n          $scope.addOrder();\n        });\n        $scope.$on(\"selectedOrder\", function () {\n          $scope.selectedOrder();\n        });\n        $scope.$on(\"selectedClose\", function () {\n          $scope.selectedClose();\n        });\n        $scope.$on(\"changeState\", function () {\n          changeState();\n        }); //多项确认\n\n        $scope.selectedOrder = function () {\n          var tableRows = table.rows({\n            selected: true\n          });\n          var selectedCount = tableRows.count();\n          var nodes = tableRows.nodes();\n\n          if ($scope.confirmActiveAlert.length == 0) {\n            growl.warning(\"当前没有要确认的告警项\", {});\n            return;\n          }\n\n          BootstrapDialog.show({\n            title: '提示',\n            closable: false,\n            //size:BootstrapDialog.SIZE_WIDE,\n            message: '当前有 ' + $scope.confirmActiveAlert.length + ' 个告警未确认状态，要确认吗？',\n            buttons: [{\n              label: '确定',\n              cssClass: 'btn-success',\n              action: function action(dialogRef) {\n                var successCount = 0;\n                var errorCount = 0;\n                var AlertIdsArr = [];\n                var ifGo = false;\n\n                for (var i = 0; i < nodes.length; i++) {\n                  var row = table.row(nodes[i]);\n                  var rowData = row.data();\n\n                  if (rowData.state == 0) {\n                    // AlertIdsArr.push(rowData.alertId);\n                    successCount++;\n                    row.data().state = 5;\n                  } else {\n                    errorCount++;\n                  }\n\n                  if (selectedCount == successCount + errorCount) {\n                    ifGo = true;\n                    growl.success(\"成功确认\" + successCount + \"个,失败\" + errorCount + \"个\", {});\n                    $scope.selectAlertList.selList = [];\n                    $scope.$apply();\n                  }\n                }\n\n                ;\n                $scope.confirmActiveAlert.forEach(function (deactiveGate) {\n                  AlertIdsArr.push(deactiveGate.alertId);\n                });\n\n                if (ifGo) {\n                  $scope.doAction(\"claim2\", AlertIdsArr, function (returnObj) {\n                    if (returnObj) {\n                      $scope.confirmActiveAlert = [];\n                      row.cells().invalidate().draw(false);\n                      $(\".itemCheckBox\").each(function () {\n                        $(this).attr(\"checked\", false);\n                      });\n                      $(\"#allselect-btn\").attr(\"checked\", false);\n                      table.rows().deselect();\n                    }\n                  });\n                }\n\n                dialogRef.close();\n              }\n            }, {\n              label: '取消',\n              action: function action(dialogRef) {\n                dialogRef.close();\n              }\n            }]\n          });\n        }; //多项关闭\n\n\n        $scope.selectedClose = function () {\n          var tableRows = table.rows({\n            selected: true\n          });\n          var selectedCount = tableRows.count();\n          var nodes = tableRows.nodes();\n\n          if ($scope.closeActiveAlert.length == 0) {\n            growl.warning(\"当前没有要关闭的告警项\", {});\n            return;\n          }\n\n          BootstrapDialog.show({\n            title: '提示',\n            closable: false,\n            //size:BootstrapDialog.SIZE_WIDE,\n            message: '当前有 ' + $scope.closeActiveAlert.length + ' 个告警未关闭状态，要关闭吗？',\n            buttons: [{\n              label: '确定',\n              cssClass: 'btn-success',\n              action: function action(dialogRef) {\n                var successCount = 0;\n                var errorCount = 0;\n                var AlertIdsArr = [];\n                var ifGo = false;\n\n                for (var i = 0; i < nodes.length; i++) {\n                  var row = table.row(nodes[i]);\n                  var rowData = row.data();\n\n                  if (rowData.state == 0 || rowData.state == 5 || rowData.state == 10) {\n                    // AlertIdsArr.push(rowData.alertId);\n                    successCount++;\n                    row.data().state = 20;\n                  } else {\n                    errorCount++;\n                  }\n\n                  if (selectedCount == successCount + errorCount) {\n                    ifGo = true;\n                    growl.success(\"成功关闭\" + successCount + \"个,失败\" + errorCount + \"个\", {});\n                    $scope.selectAlertList.selList = [];\n                    $scope.$apply();\n                  }\n                }\n\n                ;\n\n                if (ifGo) {\n                  $scope.closeActiveAlert.forEach(function (deactiveGate) {\n                    AlertIdsArr.push(deactiveGate.alertId);\n                  });\n                  $scope.doAction(\"close2\", AlertIdsArr, function (returnObj) {\n                    if (returnObj) {\n                      $scope.closeActiveAlert = [];\n                      row.cells().invalidate().draw(false);\n                      $(\".itemCheckBox\").each(function () {\n                        $(this).attr(\"checked\", false);\n                      });\n                      $(\"#allselect-btn\").attr(\"checked\", false);\n                      table.rows().deselect();\n                    }\n                  });\n                }\n\n                dialogRef.close();\n              }\n            }, {\n              label: '取消',\n              action: function action(dialogRef) {\n                dialogRef.close();\n              }\n            }]\n          });\n        }; //多项转工单\n\n\n        $scope.addOrder = function () {\n          var tableRows = table.rows({\n            selected: true\n          });\n          var selectedCount = tableRows.count();\n          var nodes = tableRows.nodes();\n\n          if (selectedCount == 0) {\n            growl.warning(\"当前没有选中的告警项\", {});\n            return;\n          }\n\n          var successCount = 0;\n          var errorCount = 0;\n          var AlertIdsArr = [];\n          var ifGo = false;\n\n          for (var i = 0; i < nodes.length; i++) {\n            var row = table.row(nodes[i]);\n            var rowData = row.data();\n\n            if (rowData.state == 0 || rowData.state == 5) {\n              AlertIdsArr.push(rowData.alertId);\n              successCount++;\n              row.data().state = 10;\n            } else {\n              errorCount++;\n            }\n\n            if (selectedCount == successCount + errorCount) {\n              ifGo = true;\n              growl.success(\"成功确认\" + successCount + \"个,失败\" + errorCount + \"个\", {});\n            }\n          }\n\n          ;\n\n          if (ifGo) {\n            $scope.doAction(\"order\", AlertIdsArr, function (returnObj) {\n              if (returnObj) {}\n            });\n          }\n        }; //转工单成功后改变状态\n\n\n        function changeState() {\n          var ifGo = false;\n          var tableRows = table.rows({\n            selected: true\n          });\n          var selectedCount = tableRows.count();\n          var nodes = tableRows.nodes();\n\n          for (var i = 0; i < nodes.length; i++) {\n            var row = table.row(nodes[i]);\n            var rowData = row.data(); // row.data().state = 10;\n\n            row.cells().invalidate().draw(false);\n            ifGo = true;\n          }\n\n          ;\n\n          if (ifGo) {\n            $(\".itemCheckBox\").each(function () {\n              $(this).attr(\"checked\", false);\n            });\n            $(\"#allselect-btn\").attr(\"checked\", false);\n            table.rows().deselect();\n          }\n        }\n      }]\n    };\n  }]);\n});"],"sourceRoot":"/source/"}