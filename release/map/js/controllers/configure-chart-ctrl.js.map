{"version":3,"sources":["js/controllers/configure-chart-ctrl.js"],"names":["define","controllers","initController","$scope","rootScope","$timeout","kpiDataService","SwSocket","Info","resourceUIService","viewFlexService","q","$controller","freeboardservice","console","info","$parent","view","echartViewId","viewIdAry","split","length","nodeIdsAry","jQuery","isArray","nodeIds","forEach","item","ary","push","Number","getViewById","returnObj","code","content","data","JSON","parse","i","elements","nodes","echartItem","instance","size","$","css","width","x","y","editData","replaceCiKpi","setMode","renderLayout","scope","$q"],"mappings":"AAAAA,OAAO,CAAC,2BAA4B,SAAUC,GAC5C,aAEAA,EAAYC,eAAe,sBAAuB,CAAC,SAAU,aAAc,WAAY,iBAAkB,WAAY,OAAQ,oBAAqB,kBAAmB,KAAM,cAAe,mBAAoB,SAAUC,EAAQC,EAAWC,EAAUC,EAAgBC,EAAUC,EAAMC,EAAmBC,EAAiBC,EAAGC,EAAaC,GAGvU,GAFAC,QAAQC,KAAK,0BAETZ,EAAOa,QAAQC,MAAQd,EAAOa,QAAQC,KAAKC,aAAc,CAC3D,IAAIC,EAAYhB,EAAOa,QAAQC,KAAKC,aAAaE,MAAM,KAEvD,GAAwB,GAApBD,EAAUE,OAAa,CACzB,IAAIC,EAAa,GAEbC,OAAOC,QAAQrB,EAAOa,QAAQC,KAAKQ,UACrCtB,EAAOa,QAAQC,KAAKQ,QAAQC,QAAQ,SAAUC,GAC5C,GAAmB,iBAARA,EAAkB,CAC3B,IAAIC,EAAMD,EAAKP,MAAM,KACrBE,EAAWO,KAAKC,OAAOF,EAAIA,EAAIP,OAAS,UAExCC,EAAWO,KAAKF,KAKtBjB,EAAgBqB,YAAYZ,EAAUA,EAAUE,OAAS,GAAI,SAAUW,GACrE,GAAsB,GAAlBA,EAAUC,KAAW,CACvB,IAAIC,EAGJ,GAFIF,EAAUG,KAAKD,UAASA,EAAUE,KAAKC,MAAML,EAAUG,KAAKD,UAExC,EAApBZ,EAAWD,OACb,IAAK,IAAIiB,KAAKJ,EAAQK,SACpBL,EAAQK,SAASD,GAAGE,MAAQlB,EAIhC,GAAIY,EAAQK,SACVpC,EAAOsC,WAAaP,EAAQK,SAAS,OAChC,CACLpC,EAAOa,QAAQA,QAAQ0B,SAAW,GAClC,IAAIC,EAAOxC,EAAOa,QAAQC,KAAK0B,KAC/BC,EAAE,eAAeC,IAAI,QAASF,EAAKG,OACnCF,EAAE,eAAeC,IAAI,OAAQF,EAAKI,GAClCH,EAAE,eAAeC,IAAI,MAAOF,EAAKK,GACjC,IAAIC,EAAW,IAAIpC,EAAiBqC,aAAahB,EAAS,WACxD7B,EAAS,WACPF,EAAOa,QAAQA,QAAQ0B,SAASS,SAAQ,GACxChD,EAAOa,QAAQA,QAAQ0B,SAASU,aAAaH,EAAU,KAAMI,WAMnEzC,EAAY,iBAAkB,CAC5BT,OAAQA,EACRE,SAAUA,EACVC,eAAgBA,EAChBC,SAAUA,EACVC,KAAMA,EACNC,kBAAmBA,EACnB6C,GAAI3C","file":"js/controllers/configure-chart-ctrl.js","sourcesContent":["define(['controllers/controllers'], function (controllers) {\n  'use strict';\n\n  controllers.initController('ConfigureChartsCtrl', ['$scope', '$rootScope', '$timeout', 'kpiDataService', 'SwSocket', 'Info', 'resourceUIService', 'viewFlexService', '$q', '$controller', 'freeboardservice', function ($scope, rootScope, $timeout, kpiDataService, SwSocket, Info, resourceUIService, viewFlexService, q, $controller, freeboardservice) {\n    console.info(\"ConfigureChartsCtrl被触发\"); // \n\n    if ($scope.$parent.view && $scope.$parent.view.echartViewId) {\n      var viewIdAry = $scope.$parent.view.echartViewId.split(\":\");\n\n      if (viewIdAry.length == 2) {\n        var nodeIdsAry = [];\n\n        if (jQuery.isArray($scope.$parent.view.nodeIds)) {\n          $scope.$parent.view.nodeIds.forEach(function (item) {\n            if (typeof item != \"number\") {\n              var ary = item.split(\":\");\n              nodeIdsAry.push(Number(ary[ary.length - 1]));\n            } else {\n              nodeIdsAry.push(item);\n            }\n          });\n        }\n\n        viewFlexService.getViewById(viewIdAry[viewIdAry.length - 1], function (returnObj) {\n          if (returnObj.code == 0) {\n            var content;\n            if (returnObj.data.content) content = JSON.parse(returnObj.data.content);\n\n            if (nodeIdsAry.length > 0) {\n              for (var i in content.elements) {\n                content.elements[i].nodes = nodeIdsAry;\n              }\n            }\n\n            if (content.elements) {\n              $scope.echartItem = content.elements[0];\n            } else {\n              $scope.$parent.$parent.instance = {};\n              var size = $scope.$parent.view.size;\n              $(\"#free-board\").css(\"width\", size.width);\n              $(\"#free-board\").css(\"left\", size.x);\n              $(\"#free-board\").css(\"top\", size.y);\n              var editData = new freeboardservice.replaceCiKpi(content, function () {\n                $timeout(function () {\n                  $scope.$parent.$parent.instance.setMode(true);\n                  $scope.$parent.$parent.instance.renderLayout(editData, null, scope);\n                });\n              });\n            }\n\n            ;\n            $controller('ViewChartsCtrl', {\n              $scope: $scope,\n              $timeout: $timeout,\n              kpiDataService: kpiDataService,\n              SwSocket: SwSocket,\n              Info: Info,\n              resourceUIService: resourceUIService,\n              $q: q\n            });\n          }\n        });\n      }\n    }\n  }]);\n});"],"sourceRoot":"/source/"}