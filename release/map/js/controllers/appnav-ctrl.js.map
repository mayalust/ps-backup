{"version":3,"sources":["js/controllers/appnav-ctrl.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","define","controllers","BootstrapDialog","controller","$scope","$state","ngDialog","$location","Info","alertService","userLoginUIService","viewFlexService","unitService","configUIService","resourceUIService","dictionaryService","ticketTaskService","route","timeout","$rootScope","growl","userDomainService","userUIService","userEnterpriseService","q","registerService","psTreeData","psUiRouterHandler","cms","cms2","psConfig","projectUIService","psStore","dialogInstance","menuDisplayAlertCount","runtime","init","criticalCount","orderCount","myOptions","myOptionDic","myDicts","provinces","citys","districts","cityDics","districtDics","alertView","designView","enterpriseType","treeviewIndex","oldTreeviewIndex","loadingShow","currentMenuCode","firstMenuCode","localMenuCode","showMenu","menuitems","getAllUserInfo","getAllDeviceInfo","$on","rootHandler","detailshow","$attr","closeDialog","close","add","checkLoginAccont","userInfo","watch","$watch","n","o","s","path","match","window","location","pathname","exec","openSidebar","$","css","queryEnterpriseRole","returnObj","code","index","hash","split","roles","data","filter","ele","roleID","indexOf","values","roleInfo","find","user","currentRoleID","Error","setRoleValues","console","log","Date","__loadedTime__","toFixed","tabs","JSON","parse","children","e","error","event","main_active_index","navToPage","params","then","d","go","apply","$broadcast","parameter","changeRole","usercurrentRoleID","updateRoleValues","navigateTo","loginNames","forEach","arr","account","loginName","sessionStorage","setItem","getItem","isShowSelect","get","info","baseConfig","customerConfig","projectConfig","jQuery","extend","kpiIconList","kpiIcon","host","userName","password","getAllKpis","callback","condition","success","rs","next","modelId","map","a","getKpisByModelId","recursive","queue","item","shift","push","initUserObjects","callbackFun","initMenus","getConfigsByGroupName","length","value","title","html","shortcut","attr","getTime","rootModelsDic","300","301","302","getModelsByCondition","model","id","subReturnObj","kpiDef","kpiDic","unit","unitLabel","range","test","rangeObj","rangeAry","Array","min","max","Object","modelLoader","getAllAttrs","attrDef","attrs","getDirectivesByModelId","dirDef","directives","getAllUnits","i","units","unitDics","unitCode","unitName","unitLoader","getAllDicts","dicts","dic","dictCode","items","commit","queryUserByCondition","getAllUserInfoList","userID","deviceLoader","getAllDeviceInfos","externalDevId","hasOwnProperty","getSimpleDistricts","province","city","getAllDataTypes","allDataTypes","dashboardView","getAllMyViews","v","viewList","view","description","viewType","viewmenus","viewTitle","url","viewId","status","statusBg","statusLab","icon","splice","label","show","viewLoadFinished","getRootDomain","rootCi","states","countFromCache","getTicketsByStatus","m","initCount","getKpiTypeByFilter","newObj","text","defaultKpiList","domainsArr","domains","domainListTree","getResourceById","tc","domainPath","getDomainsByFilter","domainListDic","domainsLoader","domainTreeQuery","getResourceByModelId","customer","customerObj","project","projectObj","j","parentID","getDevicesByCondition","device","deviceObj","_i","_j","projectId","customerLabel","deviceObjs","deviceDicArr","deviceDic","deviceObjLoader","search","concat","loginFun","loginCallback","removeItem","href","gotoHomePage","enterprise","logoStatus","gotoAppPage","showMenuFun","logout","clear","onViewLoad","menusFilter","functionCode","charAt","publicTableSearch","tabelname","name","evt","isAuthenticated","lastLoginTime","newDateJson","Format","GetDateCategoryStrByLabel","FileUploader","fileMaxSize","fileFormat","queueLimit","uploader","serviceOrigin","withCredentials","removeAfterUpload","fileBelongDic","filters","fn","options","nameAry","type","warning","size","onWhenAddingFileFailed","onAfterAddingFile","fileItem","removeFromQueue","onAfterAddingAll","addedFileItems","fileBelongId","onBeforeUploadItem","formData","onProgressItem","progress","onProgressAll","onSuccessItem","response","headers","onErrorItem","onCancelItem","onCompleteItem","state","message","onCompleteAll","uplaodHandler","uploadAll","scope","clearHandler","clearQueue","msg"],"mappings":"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","file":"js/controllers/appnav-ctrl.js","sourcesContent":["function _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\ndefine([\"controllers/controllers\", \"bootstrap-dialog\"], function (controllers, BootstrapDialog) {\n  \"use strict\";\n\n  controllers.controller(\"AppNavCtrl\", [\"$scope\", \"$state\", \"ngDialog\", \"$location\", \"Info\", \"alertService\", \"userLoginUIService\", \"viewFlexService\", \"unitService\", \"configUIService\", \"resourceUIService\", \"dictionaryService\", \"ticketTaskService\", \"$route\", \"$timeout\", \"$rootScope\", \"growl\", \"userDomainService\", \"userUIService\", \"userEnterpriseService\", \"$q\", \"$registerService\", \"psTreeData\", \"psUiRouterHandler\", \"commonMethodService\", \"commonMethodService2\", \"psConfig\", \"projectUIService\", \"psStore\", function ($scope, $state, ngDialog, $location, Info, alertService, userLoginUIService, viewFlexService, unitService, configUIService, resourceUIService, dictionaryService, ticketTaskService, route, timeout, $rootScope, growl, userDomainService, userUIService, userEnterpriseService, q, registerService, psTreeData, psUiRouterHandler, cms, cms2, psConfig, projectUIService, psStore) {\n    var dialogInstance; // 弹出框实例\n\n    var localmodel = false; // 本地测试模式\n\n    var menuDisplayAlertCount = false; //菜单是否显示告警数量\n\n    runtime.init();\n    var target = new cms();\n    $scope.criticalCount = 0; // 菜单栏严重告警个数\n\n    $scope.orderCount = 0; // 待处理工单\n\n    $scope.myOptions; // 单位对象\n\n    $scope.myOptionDic; //单位字典\n\n    $scope.myDicts; // 配置项字典\n\n    $scope.provinces; // 省级区域\n\n    $scope.citys; // 市级区域\n\n    $scope.districts; // 县级区域\n\n    $scope.cityDics; // 市级区域\n\n    $scope.districtDics; // 县级区域\n    //    $scope.powers = {}; // 权限列表\n\n    $scope.alertView = []; //告警视图集合\n\n    $scope.designView = []; //性能视图集合\n\n    $scope.enterpriseType = 0; // 企业类型\n\n    $scope.treeviewIndex = \"\";\n    $scope.oldTreeviewIndex = \"\";\n    $scope.loadingShow = false; //true 显示loading false 隐藏\n\n    $scope.currentMenuCode = null; //当前的菜单编码\n\n    $scope.firstMenuCode = null; //第一层的菜单编码\n\n    $scope.localMenuCode = \"F01\"; //判断使用哪一个服务中心，用来替代localIndex\n\n    $scope.showMenu = false;\n    $scope.menuitems = {};\n    $scope.getAllUserInfo; //缓存用户信息\n\n    $scope.getAllDeviceInfo; //缓存设备信息\n    // 路由跳转成功后触发\n\n    $scope.$on(\"$routeChangeSuccess\", function () {\n      userLoginUIService.rootHandler($scope, $location);\n      $scope.detailshow = route && route.$attr(\"current/params/mode\") == \"detail\";\n    }); //弹出框的关闭事件\n\n    $scope.closeDialog = function () {\n      ngDialog.close();\n    };\n\n    psStore.add(\"getAllDicts\");\n    /**\n     * 判断未登录后如何处理\n     * localmodel＝true 本地测试使用\n     */\n\n    function extend(a, b) {\n      for (var i in b) {\n        a[i] = b[i];\n      }\n\n      return a;\n    }\n\n    var showLogin = function showLogin() {\n      if (!localmodel) {\n        return;\n      }\n\n      dialogInstance = BootstrapDialog.show({\n        title: \"欢迎来到普奥的世界\",\n        closable: false,\n        //size:BootstrapDialog.SIZE_WIDE,\n        message: function message(dialog) {\n          var $message = $(\"<div></div>\");\n          var pageToLoad = dialog.getData(\"pageToLoad\");\n          $message.load(pageToLoad);\n          return $message;\n        },\n        data: {\n          pageToLoad: \"partials/login.html\"\n        },\n        buttons: [{\n          label: \"登录\",\n          cssClass: \"btn-success\",\n          action: function action(dialogRef) {\n            var userInput = document.getElementById(\"username\");\n            var psdInput = document.getElementById(\"password\");\n            userLoginUIService.login(userInput.value, psdInput.value);\n          }\n        }, {\n          label: \"退出\",\n          action: function action(dialogRef) {\n            dialogRef.close();\n            location.href = \"../index.html\";\n          }\n        }]\n      });\n    };\n    /**\n     * 获得基础配置\n     */\n\n\n    Info.get(\"../localdb/info.json\", function (info) {\n      if ($scope.baseConfig) {\n        delete info.customerConfig;\n        delete info.projectConfig;\n        $scope.baseConfig = jQuery.extend(true, $scope.baseConfig, info);\n      } else {\n        $scope.baseConfig = info;\n      }\n    });\n    /**\n     * 获得KPI的图片配置\n     */\n\n    Info.get(\"../localdb/icon.json\", function (info) {\n      $scope.kpiIconList = info.kpiIcon;\n    });\n    /**\n     * 切换角色的登陆状态\n     * 韩星 2018.01.08\n     */\n\n    function checkLoginAccont(userInfo) {\n      /**\n       * 1 该用户有几个角色\n       * 2 每个角色切换视图\n       */\n      function getCurrentLocation() {\n        var path = window.location.pathname,\n            match = /\\/(app\\-[\\w-]+)\\//.exec(path);\n        return match ? match[1] : null;\n      }\n\n      function getMainActiveIndexFromHash() {\n        var hash = window.location.hash,\n            arr = hash.split(\"/\");\n        return arr[4] - 0;\n      }\n\n      var watch = $scope.$watch(\"baseConfig\", function (n, o, s) {\n        if (_typeof(n) === \"object\") {\n          var location = getCurrentLocation();\n\n          if (location === \"app-sc\" && !n.openSidebar) {\n            $(\".sidebar-toggle\").css(\"display\", \"none\");\n            $(\".main-sidebar\").css(\"display\", \"none\");\n            $(\".sidebar-mini.sidebar-collapse .content-wrapper\").css(\"cssText\", \"margin-left: 0px!important\");\n          }\n\n          watch();\n        }\n      });\n      userEnterpriseService.queryEnterpriseRole(function (returnObj) {\n        if (returnObj.code == 0) {\n          $scope.index = getMainActiveIndexFromHash();\n          $scope.roles = returnObj.data ? returnObj.data.filter(function (ele) {\n            if (ele.roleID == \"100\") {\n              return false;\n            }\n\n            if (userInfo.roleID.indexOf(ele.roleID) == -1) {\n              return false;\n            }\n\n            return ele.values;\n          }) : [];\n          $scope.roleInfo = $scope.roles.find(function (n) {\n            return n.roleID == userLoginUIService.user.currentRoleID;\n          });\n\n          if (typeof $scope.roleInfo === \"undefinded\") {\n            throw new Error(\"role cannot be found on current user\");\n            return;\n          }\n\n          psConfig.setRoleValues($scope.roleInfo.values);\n\n          try {\n            console.log(\"render Tabs\", ((new Date() - window.__loadedTime__) / 1000).toFixed(3) + \"s\");\n            $rootScope.tabs = JSON.parse($scope.roleInfo.values).children;\n          } catch (e) {\n            $rootScope.tabs = [];\n            console.error(e);\n            return;\n          }\n        }\n      });\n      $rootScope.$on(\"main_active_index\", function (event, index) {\n        $scope.index = index;\n        $rootScope.main_active_index = index;\n      });\n\n      $scope.navToPage = function (params, index) {\n        $rootScope.main_active_index = index;\n        $scope.index = params.index;\n        psUiRouterHandler(params).then(function (d) {\n          $state.go.apply($state, d);\n        });\n      };\n\n      $scope.$on('PS_MENU_BUTTON_CLICKED', function (e, data) {\n        //console.log(e, data);\n        $scope.$broadcast('PS_MENU_BUTTON_CLICKED_DONE', data);\n      });\n      $scope.$on('PS_MENU_LIST_ITEM_CLICKED', function (e, data) {\n        psUiRouterHandler(data.parameter).then(function (d) {\n          $state.go.apply($state, d);\n        });\n      }); //PS_MENU_LIST_ITEM_CLICKED\n\n      $scope.changeRole = function (e) {\n        userLoginUIService.user.usercurrentRoleID = e.roleID + \"\";\n        userLoginUIService.user.currentRoleID = e.roleID;\n        psConfig.updateRoleValues(e.values).then(function (values) {\n          var default_tab = values.children[0];\n          $rootScope.tabs = values.children;\n          cms2.navigateTo(0);\n        });\n      };\n\n      $scope.loginNames.forEach(function (ele, index, arr) {\n        if (ele.account == userInfo.loginName) {\n          $scope.loginName = $scope.loginNames[index];\n        }\n      }); // 缓存用户\n\n      if (userInfo.loginName == \"baowu_admin\" || userInfo.loginName == \"013346\" || userInfo.loginName == \"045400\" || userInfo.loginName == \"171171\" || userInfo.loginName == \"013346\") {\n        sessionStorage.setItem(\"loginNames\", userInfo);\n      } // 判断该不该显示选择框\n\n\n      if (sessionStorage.getItem(\"loginNames\")) {\n        $scope.isShowSelect = true;\n      } else {\n        $scope.isShowSelect = false;\n      }\n    }\n\n    var loginNames = [{\n      userName: \"决策者虚拟工作台\",\n      account: \"baowu_admin\",\n      password: \"abc123\"\n    }, {\n      userName: \"报警管理虚拟工作台  \",\n      account: \"baowu_bj\",\n      password: \"abc123\"\n    }, {\n      userName: \"诊断管理虚拟工作台   \",\n      account: \"baowu_fx\",\n      password: \"abc123\"\n    }, {\n      userName: \"协同管理虚拟工作台   \",\n      account: \"baowu_xt\",\n      password: \"abc123\"\n    }, {\n      userName: \"审核管理虚拟工作台   \",\n      account: \"baowu_sh\",\n      password: \"abc123\"\n    }, {\n      userName: \"点检管理虚拟工作台   \",\n      account: \"baowu_dj\",\n      password: \"abc123\"\n    }, {\n      userName: \"产线管理虚拟工作台   \",\n      account: \"baowu_cx\",\n      password: \"abc123\"\n    }, {\n      userName: \"检修管理虚拟工作台   \",\n      account: \"baowu_jx\",\n      password: \"abc123\"\n    }, {\n      userName: \"孟坤荫\",\n      //  精密检测工程师\n      account: \"170628\",\n      password: \"abc123\"\n    }, {\n      userName: \"乐海滨\",\n      //产线工程师\n      account: \"041048\",\n      password: \"abc123\"\n    }, {\n      userName: \"沈政\",\n      //产线工程师\n      account: \"171211\",\n      password: \"abc123\"\n    }, {\n      userName: \"宋明中\",\n      //总包诊断工程师\n      account: \"080231\",\n      password: \"abc123\"\n    }, {\n      userName: \"陈黎敏\",\n      // 总包产线诊断\n      account: \"190625\",\n      password: \"abc123\"\n    }, {\n      userName: \"沈嘉麟\",\n      //产线工程师\n      account: \"170373\",\n      password: \"abc123\"\n    }, {\n      userName: \"廖勇\",\n      // 2050产线决策\n      account: \"190712\",\n      password: \"abc123\"\n    }, {\n      userName: \"陈红琳\",\n      //'报警管理员',\n      account: \"170307\",\n      password: \"abc123\"\n    }, {\n      userName: \"张骏骋\",\n      // 辊道备修工程师\n      account: \"174079\",\n      password: \"abc123\"\n    }, {\n      userName: \"腾威\",\n      //辊道备修质量工程师\n      account: \"171352\",\n      password: \"abc123\"\n    }, {\n      userName: \"张君\",\n      //访客工作台\n      account: \"170381\",\n      password: \"abc123\"\n    }, {\n      userName: \"陈弘\",\n      //卷筒工作台\n      account: \"171163\",\n      password: \"abc123\"\n    }, {\n      userName: \"审核专家\",\n      //审核专家\n      account: \"baowu_shzj\",\n      password: \"abc123\"\n    }, {\n      userName: \"宋小佩\",\n      //电厂脱硫系统\n      account: \"190494\",\n      password: \"abc123\"\n    }, {\n      userName: \"沈亮\",\n      // 电厂脱硫产线工程师\n      account: \"190426\",\n      password: \"abc123\"\n    }, {\n      userName: \"炼铁厂(产内)\",\n      // 电厂脱硫产线工程师\n      account: \"baowu_lt\",\n      password: \"abc123\"\n    }, {\n      userName: \"万欣(测试新框架)\",\n      // 电厂脱硫产线工程师\n      account: \"170616\",\n      password: \"abc123\"\n    }, {\n      userName: \"智能诊断工程师\",\n      // 电厂脱硫产线工程师\n      account: \"190747\",\n      password: \"abc123\"\n    }, {\n      userName: \"葛申剑\",\n      //产线工程师\n      account: \"190747\",\n      password: \"abc123\"\n    }, {\n      userName: \"经营服务人员\",\n      // 备修流程经营服务人员\n      account: \"baowu_jyfw\",\n      password: \"abc123\"\n    }, {\n      userName: \"工艺工程师\",\n      // 备修流程工艺工程师\n      account: \"baowu_gygc\",\n      password: \"abc123\"\n    }, {\n      userName: \"作业实施人员\",\n      // 备修流程作业实施人员\n      account: \"baowu_zyss\",\n      password: \"abc123\"\n    }, {\n      userName: \"质量工程师\",\n      // 备修流程质量工程师\n      account: \"baowu_zlgc\",\n      password: \"abc123\"\n    }],\n        // 本地用户显示\n    loginNamesLocal = [{\n      userName: \"汤霄炯\",\n      // 电厂脱硫产线工程师\n      account: \"190520\",\n      password: \"abc123\"\n    }, {\n      userName: \"环保管理员\",\n      // 电厂脱硫产线工程师\n      account: \"baowu_huanbao\",\n      password: \"abc123\"\n    }, {\n      userName: \"废水\",\n      // 能环部废水\n      account: \"baowu_fs\",\n      password: \"abc123\"\n    }],\n        isLocal = function isLocal() {\n      var host = window.location.host;\n      return host && host.search(\"localhost\") != -1 && host.search(\"127.0.0.1\");\n    };\n\n    $scope.loginNames = isLocal() ? loginNames.concat(loginNamesLocal) : loginNames;\n\n    $scope.loginFun = function (e) {\n      userLoginUIService.loginCallback(e.account, e.password, function (userInfo) {\n        if (userInfo.code == 0) {\n          // 清除所有的设备除了用户的sessionStorage\n          for (var i in sessionStorage) {\n            if (i != \"loginNames\") {\n              sessionStorage.removeItem(i);\n            }\n          }\n\n          window.location.href = \"index.html\";\n        }\n      });\n    };\n\n    $scope.gotoHomePage = function () {\n      if (userLoginUIService.user.enterprise.logoStatus != \"0\") {\n        location.href = \"http://www.proudsmart.com\";\n      }\n    };\n\n    $scope.gotoAppPage = function () {\n      location.href = \"index.html\";\n    };\n\n    $scope.showMenuFun = function () {\n      $scope.showMenu = !$scope.showMenu;\n    };\n\n    $scope.logout = function () {\n      sessionStorage.clear();\n      userLoginUIService.logout();\n    };\n\n    $scope.onViewLoad = function () {};\n\n    function initUnit(callbackFun) {\n      unitService.getAllUnits(function (returnObj) {\n        if (returnObj.code == 0) {\n          unitService.units = returnObj.data;\n          $scope.myOptions = returnObj.data;\n          unitService.unitDics = {};\n\n          for (var i in $scope.myOptions) {\n            unitService.unitDics[$scope.myOptions[i].unitCode] = $scope.myOptions[i].unitName;\n            if ($scope.myOptions[i].unitCode == \"NA\" || $scope.myOptions[i].unitCode == \"Number\") unitService.unitDics[$scope.myOptions[i].unitCode] = \"\";\n          }\n\n          $scope.myOptionDic = unitService.unitDics;\n\n          if (callbackFun) {\n            callbackFun();\n          }\n\n          resourceUIService.unitLoader($scope.myOptionDic);\n        }\n      });\n      dictionaryService.getAllDicts(function (returnObj) {\n        if (returnObj.code == 0) {\n          dictionaryService.dicts = returnObj.data;\n          $scope.myDicts = returnObj.data;\n          var dic = {};\n\n          for (var i in returnObj.data) {\n            var obj = returnObj.data[i];\n\n            if (dic[obj.dictCode]) {\n              dic[obj.dictCode].push(obj);\n            } else {\n              dic[obj.dictCode] = [];\n              dic[obj.dictCode].push(obj);\n            }\n          }\n\n          for (var items in dic) {\n            $scope.myDicts[items] = dic[items];\n          }\n\n          psStore.commit(\"getAllDicts\", $scope.myDicts);\n        }\n      });\n      /**\n       * 韩星 2018.2.6\n       * 缓存所有的用户\n       */\n\n      userUIService.queryUserByCondition({}, function (returnObj) {\n        if (returnObj.code == 0) {\n          var getAllUserInfoList = returnObj.data;\n\n          for (var i in getAllUserInfoList) {\n            getAllUserInfoList[getAllUserInfoList[i].loginName] = getAllUserInfoList[i].userName;\n            getAllUserInfoList[getAllUserInfoList[i].userID] = getAllUserInfoList[i].userName;\n          }\n\n          $scope.getAllUserInfo = getAllUserInfoList;\n        }\n      });\n      /**\n       * 缓存所有的设备的部分字段(includeFields=label,externalDevId,id)\n       * HANXING 2018.3.28\n       */\n\n      resourceUIService.deviceLoader().then(function (getAllDeviceInfos) {\n        var obj = {};\n\n        for (var i in getAllDeviceInfos) {\n          obj[getAllDeviceInfos[i].id] = getAllDeviceInfos[i];\n          obj[getAllDeviceInfos[i].externalDevId] = getAllDeviceInfos[i];\n        }\n\n        $scope.getAllDeviceInfo = obj;\n      });\n\n      if (!resourceUIService.hasOwnProperty(\"provinces\")) {\n        resourceUIService.getSimpleDistricts(function (returnObj) {\n          if (returnObj.code == 0) {\n            resourceUIService.provinces = returnObj.data;\n            $scope.provinces = returnObj.data;\n            $scope.cityDics = {};\n            $scope.districtDics = {};\n            $scope.provinces.forEach(function (province) {\n              $scope.cityDics[province.id] = province.children;\n              province.children.forEach(function (city) {\n                $scope.districtDics[city.id] = city.children;\n              });\n            });\n          }\n        });\n      }\n\n      resourceUIService.getAllDataTypes(function (returnObj) {\n        if (returnObj.code == 0) {\n          $scope.allDataTypes = returnObj.data;\n        }\n      });\n    }\n\n    function initRootDomain() {\n      resourceUIService.getRootDomain(function (returnObj) {\n        if (returnObj.code == 0) {\n          if (returnObj.data) {\n            $scope.rootCi = returnObj.data.id;\n          } else {\n            growl.error(\"当前用户不存在rootCi，请联系客服处理。\", {});\n          }\n        }\n      });\n    }\n    /**\n     * 获得基本的模型定义，包括：\n     * 测点定义\n     * 指令定义\n     * 属性定义\n     */\n\n\n    function getKpisByModelId(modelId, callback) {\n      resourceUIService.getKpisByModelId(modelId, function (e) {\n        if (e.code == 0) {\n          callback(e.data);\n        }\n      });\n    }\n\n    function makeSequence(condition, success) {\n      var rs = [];\n      return function recursive(queue) {\n        var item = queue.shift(),\n            next = function next(d) {\n          [].push.apply(rs, d);\n          recursive(queue);\n        };\n\n        item ? condition(item, next) : success(rs);\n      };\n    }\n\n    function getAllKpis(callback) {\n      var sequence = makeSequence(function (d, next) {\n        getKpisByModelId(d, function (n) {\n          next(n.map(function (a) {\n            d != -1 ? a.modelId = d != -1 : null;\n            return a;\n          }));\n        });\n      }, callback);\n      sequence([300, 301, 302, -1]);\n    }\n\n    function initRootModels() {\n      $rootScope.rootModelsDic = {\n        300: {},\n        301: {},\n        302: {}\n      };\n      resourceUIService.rootModelsDic = $rootScope.rootModelsDic;\n      resourceUIService.getModelsByCondition({}, function (returnObj) {\n        if (returnObj.code == 0) {\n          returnObj.data.forEach(function (model) {\n            if (!$rootScope.rootModelsDic[model.id]) $rootScope.rootModelsDic[model.id] = {};\n            $rootScope.rootModelsDic[model.id].model = model;\n          }); //-1表示查询所有的模版上的KPI\n\n          getAllKpis(function (subReturnObj) {\n            //resourceUIService.getKpisByModelId(-1, function (subReturnObj) {\n            subReturnObj.forEach(function (kpiDef) {\n              if (!$rootScope.rootModelsDic[kpiDef.modelId]) return;\n              $rootScope.rootModelsDic[kpiDef.modelId].kpiDic = $rootScope.rootModelsDic[kpiDef.modelId].kpiDic || {};\n              if ($scope.myOptionDic[kpiDef.unit]) kpiDef.unitLabel = $scope.myOptionDic[kpiDef.unit];\n              var regExp = /\\{|\\[.*\\}|\\]/;\n\n              if (kpiDef.range) {\n                var find = regExp.test(kpiDef.range);\n                var rangeObj = [];\n\n                if (find) {\n                  try {\n                    rangeObj = find ? JSON.parse(kpiDef.range) : [];\n                  } catch (e) {}\n                }\n\n                kpiDef.rangeAry = rangeObj;\n\n                if (rangeObj instanceof Array) {\n                  kpiDef.rangeAry = rangeObj;\n\n                  if (rangeObj.length == 2) {\n                    kpiDef.min = rangeObj[0];\n                    kpiDef.max = rangeObj[1];\n                  }\n                } else if (rangeObj instanceof Object) {\n                  kpiDef.rangeObj = rangeObj;\n                }\n              }\n\n              $rootScope.rootModelsDic[kpiDef.modelId].kpiDic[kpiDef.id] = kpiDef;\n            });\n            resourceUIService.modelLoader($rootScope.rootModelsDic);\n          }); //获得所有模板的属性\n\n          resourceUIService.getAllAttrs(function (subReturnObj) {\n            if (subReturnObj.code == 0) {\n              subReturnObj.data.forEach(function (attrDef) {\n                if (!$rootScope.rootModelsDic[attrDef.modelId]) return;\n                if (!$rootScope.rootModelsDic[attrDef.modelId].attrs) $rootScope.rootModelsDic[attrDef.modelId].attrs = [];\n                $rootScope.rootModelsDic[attrDef.modelId].attrs.push(attrDef);\n              });\n            }\n          }); //-1表示获得所有模板的指令\n\n          resourceUIService.getDirectivesByModelId(-1, function (subReturnObj) {\n            if (subReturnObj.code == 0) {\n              subReturnObj.data.forEach(function (dirDef) {\n                if (!$rootScope.rootModelsDic[dirDef.modelId]) return;\n                if (!$rootScope.rootModelsDic[dirDef.modelId].directives) $rootScope.rootModelsDic[dirDef.modelId].directives = [];\n                $rootScope.rootModelsDic[dirDef.modelId].directives.push(dirDef);\n              });\n            }\n          });\n        }\n      });\n    }\n\n    ;\n\n    function initCount() {\n      if (menuDisplayAlertCount) {\n        var params = {};\n        params.states = \"0\";\n        alertService.countFromCache(params, function (returnObj) {\n          if (returnObj.code == 0) {\n            $scope.criticalCount = returnObj.data.criticalCount;\n          }\n        }); //获取执行中工单\n\n        var status = 100;\n        ticketTaskService.getTicketsByStatus(status, function (m) {\n          if (m.code == 0) {\n            $scope.orderCount = m.data.length;\n          }\n        });\n      }\n    }\n\n    ;\n\n    function initViews() {\n      $scope.alertView = [];\n      $scope.designView = [];\n      $scope.dashboardView = [];\n      viewFlexService.getAllMyViews(function (returnObj) {\n        if (returnObj.code == 0) {\n          var v = returnObj.data;\n          var viewList = [];\n\n          for (var i = 0; i < v.length; i++) {\n            var view = v[i];\n\n            if (view) {\n              viewList.push(view);\n              var description = {};\n\n              if (typeof view.description == \"string\") {\n                var objectLike = /^\\{(.|\\n)*\\}$/;\n                var reg = objectLike.test(view.description);\n\n                if (reg) {\n                  description = JSON.parse(view.description);\n                }\n              }\n\n              if (view.viewType == \"designView\") {\n                var viewmenus = {\n                  title: view.viewTitle.split(\"?\")[0],\n                  url: \"#/\" + view.viewType + \"/\" + view.viewId,\n                  viewId: view.viewId,\n                  view: view,\n                  status: description[\"status\"],\n                  statusBg: description[\"status\"] == 1 ? \"bg-red\" : description[\"status\"] == 2 ? \"bg-green\" : \"\",\n                  statusLab: description[\"status\"] == 1 ? \"授权\" : description[\"status\"] == 2 ? \"购买\" : \"\",\n                  icon: \"fa fa-area-chart\"\n                };\n                $scope.designView.push(viewmenus);\n              } else if (view.viewType == \"configAlert\") {\n                var viewmenus = {\n                  title: view.viewTitle.split(\"?\")[0],\n                  url: \"#/\" + view.viewType + \"/\" + view.viewId,\n                  viewId: view.viewId,\n                  view: view,\n                  status: description[\"status\"],\n                  statusBg: description[\"status\"] == 1 ? \"bg-red\" : description[\"status\"] == 2 ? \"bg-green\" : \"\",\n                  statusLab: description[\"status\"] == 1 ? \"授权\" : description[\"status\"] == 2 ? \"购买\" : \"\",\n                  icon: \"fa fa-warning\"\n                };\n\n                if (viewmenus.title == \"全部告警\") {\n                  $scope.alertView.splice(0, 0, viewmenus);\n                } else {\n                  $scope.alertView.push(viewmenus);\n                }\n              } else if (view.viewType == \"dashboard\") {\n                view.label = view.viewTitle;\n                view.show = true;\n                $scope.dashboardView.push(view);\n              }\n            }\n          }\n          /* for(var i = 0; i < 1; i++){\n           var viewmenus = {\n           \"title\": \"viewmenus\" + i,\n           \"url\": \"#\",\n           \"viewId\": i,\n           \"icon\": \"fa fa-warning\",\n           \"view\" : {\n           \"viewId\" : 123\n           }\n           };\n           $scope.alertView.push(viewmenus);\n           }*/\n\n\n          viewFlexService.viewLoadFinished = true;\n          viewFlexService.viewList = viewList;\n          $scope.viewList = viewList;\n          $scope.$broadcast(\"viewLoadFinished\");\n        }\n      });\n    }\n\n    function initDefaultKpis() {\n      resourceUIService.getKpiTypeByFilter({}, function (returnObj) {\n        if (returnObj.code == 0) {\n          var newObj = [];\n          returnObj.data.forEach(function (obj) {\n            obj.text = obj.label;\n            newObj.push(obj);\n          });\n          $scope.defaultKpiList = newObj;\n        }\n      });\n    }\n\n    ;\n\n    function devDicInit() {\n      resourceUIService.getResourceByModelId(301, function (customer) {\n        var customerObj = customer.data;\n        resourceUIService.getResourceByModelId(302, function (project) {\n          var projectObj = project.data;\n\n          for (var i = 0; i < projectObj.length; i++) {\n            for (var j = 0; j < customerObj.length; j++) {\n              if (projectObj[i].parentID == customerObj[j].id) {\n                projectObj[i][\"customerLabel\"] = customerObj[j].label;\n              }\n            }\n          }\n\n          resourceUIService.getDevicesByCondition({}, function (device) {\n            var deviceObj = device.data;\n\n            for (var _i = 0; _i < deviceObj.length; _i++) {\n              for (var _j = 0; _j < projectObj.length; _j++) {\n                if (deviceObj[_i].projectId == projectObj[_j].id) {\n                  deviceObj[_i][\"customerLabel\"] = projectObj[_j].customerLabel;\n                  deviceObj[_i][\"projectLabel\"] = projectObj[_j].label;\n                }\n              }\n            }\n\n            var deviceObjs = {};\n            deviceObj.forEach(function (d) {\n              deviceObjs[d.id] = d;\n            });\n            $rootScope.deviceDicArr = deviceObj;\n            $rootScope.deviceDic = deviceObjs;\n            resourceUIService.deviceObjLoader($rootScope.deviceDic);\n          });\n        }, \"includeFields=label,id,parentID\");\n      }, \"includeFields=label,id\");\n    }\n\n    ;\n\n    $scope.menusFilter = function (item) {\n      return item.functionCode.charAt(0) === \"S\";\n    };\n\n    $scope.publicTableSearch = function (tabelname, value) {\n      $scope.$broadcast(\"table-search-handle\", {\n        name: tabelname,\n        value: value\n      });\n    };\n\n    function initConfigManager(callbackFun) {\n      configUIService.getConfigsByGroupName(\"EnterpriseConfig\", function (returnObj) {\n        if (returnObj.code == 0) {\n          if (returnObj.data && returnObj.data.length > 0) {\n            returnObj.data.forEach(function (item) {\n              try {\n                if ($scope.baseConfig) {\n                  $scope.baseConfig = jQuery.extend(true, $scope.baseConfig, JSON.parse(item.value));\n                } else {\n                  $scope.baseConfig = JSON.parse(item.value);\n                }\n\n                if ($scope.baseConfig) {\n                  //拥有企业设置\n                  if ($scope.baseConfig.title) $(\"title\").html($scope.baseConfig.title);else $(\"title\").html(\"\");\n                  if ($scope.baseConfig.shortcut) $(\"link[rel='shortcut icon']\").attr(\"href\", $scope.baseConfig.shortcut + \"?\" + new Date().getTime());else $(\"link[rel='shortcut icon']\").attr(\"href\", \"../login/images/shortcut_null.png\" + \"?\" + new Date().getTime());\n                }\n              } catch (e) {}\n            });\n          } else {\n            $(\"title\").html(\"\");\n            $(\"link[rel='shortcut icon']\").attr(\"href\", \"../login/images/shortcut_null.png\" + \"?\" + new Date().getTime());\n          }\n\n          callbackFun();\n        }\n      });\n    }\n\n    ;\n\n    function domainTreeQuery() {\n      // 获取当前用户的domains\n      var domainsArr = userLoginUIService.user.domains.split(\"/\");\n      var domainListTree = {};\n\n      for (var i = 2; i < domainsArr.length - 1; i++) {\n        resourceUIService.getResourceById([domainsArr[i]], function (tc) {\n          domainListTree[tc.data.domainPath] = tc.data;\n          domainListTree[tc.data.id] = tc.data;\n        });\n      }\n\n      resourceUIService.getDomainsByFilter({}, function (tc) {\n        for (var i in tc.data) {\n          domainListTree[tc.data[i].domainPath] = tc.data[i];\n          domainListTree[tc.data[i].id] = tc.data[i];\n        }\n\n        $rootScope.domainListDic = domainListTree;\n        resourceUIService.domainsLoader(domainListTree);\n      });\n    }\n\n    ;\n\n    function initUserObjects() {\n      initConfigManager(function () {\n        userLoginUIService.initMenus($scope, $location);\n      });\n      initUnit(function () {\n        initRootModels();\n      });\n      initViews();\n      initRootDomain();\n      initCount();\n      initDefaultKpis();\n      domainTreeQuery();\n      devDicInit();\n    } // 监听用户登录状态\n\n\n    $scope.$on(\"loginStatusChanged\", function (evt, d) {\n      if (userLoginUIService.user.isAuthenticated) {\n        if (dialogInstance) {\n          dialogInstance.close();\n        }\n\n        $scope.userInfo = userLoginUIService.user;\n        $scope.lastLoginTime = newDateJson(userLoginUIService.user.lastLoginTime).Format(GetDateCategoryStrByLabel());\n        if (userLoginUIService.user.enterprise) $scope.enterpriseType = userLoginUIService.user.enterprise.enterpriseType;\n        initUserObjects();\n        checkLoginAccont($scope.userInfo);\n      } else {\n        $scope.userInfo = {};\n        $scope.lastLoginTime = \"\";\n        showLogin();\n      }\n    });\n  }]);\n  controllers.controller(\"AppUploadCtrl\", [\"$scope\", \"growl\", \"FileUploader\", function ($scope, growl, FileUploader) {\n    $scope.fileMaxSize = $scope.fileMaxSize ? $scope.fileMaxSize : 1;\n    $scope.fileFormat = $scope.fileFormat ? $scope.fileFormat : \"jpg、png、jpeg、bmp、gif、svg\";\n    $scope.queueLimit = $scope.queueLimit ? $scope.queueLimit : 1;\n    var uploader = $scope.uploader = new FileUploader({\n      url: $scope.serviceOrigin,\n      withCredentials: true,\n      //      queueLimit: 1, //文件个数\n      removeAfterUpload: true //上传后删除文件\n\n    });\n    uploader.fileBelongDic = {}; // FILTERS\n\n    uploader.filters.push({\n      name: \"fileFilter\",\n      fn: function fn(item, options) {\n        var nameAry = item.name.split(\".\");\n        var type = nameAry[nameAry.length - 1];\n\n        if ($scope.fileFormat.indexOf(type) == -1) {\n          growl.warning(\"文件格式仅支持\" + $scope.fileFormat + \"文件，请重新选择\", {});\n          return false;\n        }\n\n        if (item.size / 1024 > $scope.fileMaxSize * 1000) {\n          growl.warning(\"您选择的文件大于\" + $scope.fileMaxSize + \"M，请重新选择\", {});\n          return false;\n        }\n\n        return true;\n      }\n    }); // CALLBACKS\n\n    uploader.onWhenAddingFileFailed = function (item, filter, options) {\n      //      uploader.clearQueue();\n      //      uploader.destroy();\n      console.info(\"onWhenAddingFileFailed\", item, filter, options);\n    };\n\n    uploader.onAfterAddingFile = function (fileItem) {\n      if (uploader.queue.length > $scope.queueLimit) uploader.removeFromQueue(uploader.queue.length.length - 1);\n      console.info(\"onAfterAddingFile\", fileItem);\n    };\n\n    uploader.onAfterAddingAll = function (addedFileItems) {\n      if (uploader.fileBelongId) {\n        uploader.fileBelongDic[uploader.fileBelongId] = addedFileItems;\n      }\n\n      $scope.$broadcast(\"onAfterAddingAll\", {\n        addedFileItems: addedFileItems\n      });\n      console.info(\"onAfterAddingAll\", addedFileItems);\n    };\n\n    uploader.onBeforeUploadItem = function (item) {\n      Array.prototype.push.apply(item.formData, uploader.formData);\n      console.info(\"onBeforeUploadItem\", item);\n    };\n\n    uploader.onProgressItem = function (fileItem, progress) {\n      console.info(\"onProgressItem\", fileItem, progress);\n    };\n\n    uploader.onProgressAll = function (progress) {\n      console.info(\"onProgressAll\", progress);\n    };\n\n    uploader.onSuccessItem = function (fileItem, response, status, headers) {\n      console.info(\"onSuccessItem\", fileItem, response, status, headers);\n    };\n\n    uploader.onErrorItem = function (fileItem, response, status, headers) {\n      growl.warning(\"上传文件失败\", {});\n      $scope.loadingShow = false;\n      console.info(\"onErrorItem\", fileItem, response, status, headers);\n    };\n\n    uploader.onCancelItem = function (fileItem, response, status, headers) {\n      console.info(\"onCancelItem\", fileItem, response, status, headers);\n    };\n\n    uploader.onCompleteItem = function (fileItem, response, status, headers) {\n      console.info(\"onCompleteItem\", fileItem, response, status, headers);\n      uploader.formData = []; //清空参数\n\n      if (response) {\n        if (response.code == 0) $scope.$broadcast(\"uploadTemplate\", {\n          state: true,\n          response: response\n        });else growl.error(response.message, {});\n        $scope.loadingShow = false;\n      } else {\n        growl.error(\"操作异常了，尝试重新刷新\", {});\n      }\n    };\n\n    uploader.onCompleteAll = function () {\n      console.info(\"onCompleteAll\");\n    };\n\n    uploader.uplaodHandler = function () {\n      uploader.uploadAll();\n      scope.loadingShow = true;\n      uploader.fileBelongDic = {};\n      uploader.fileBelongId = \"\";\n    };\n\n    uploader.clearHandler = function () {\n      uploader.clearQueue();\n      uploader.fileBelongDic = {};\n      uploader.fileBelongId = \"\";\n    };\n\n    uploader.growl = function (msg) {\n      growl.info(msg, {});\n    };\n  }]);\n});"],"sourceRoot":"/source/"}