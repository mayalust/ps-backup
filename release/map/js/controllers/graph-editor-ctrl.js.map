{"version":3,"sources":["js/controllers/graph-editor-ctrl.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","define","controllers","controller","scope","rootScope","routeParams","timeout","kpiDataService","resourceUIService","SwSocket","Info","viewFlexService","growl","q","window","location","solutionUIService","serviceCenterService","chartOptionService","toolBarList","status","rootCi","freeBoardValue","CHARTDATA","solutionId","serviceViewId","allViews","viewId","currentView","loadedView","groupId","modelId","path","callback","event","data","filter","element","viewType","find","Error","viewTitle","titleChange","getDashboard","cachBindData","undefined","clone","dt","JSON","parse","content","standardDashboard","layout","setting","editData","traveseByChild","onChange","eval","source","$extension","bindTo","id","$randomString","replaceCiKpi","call","renderBoard","getModelDashboardViewSolution","code","version","type","children","col","padding","toolbar","this","subtoolbar","modelSelector","get","info","titleComposory","getModelDashboardViewContent","getAllMyViews","click","toolbarDetail","sub","map","select","tools","dataType","tempData","option","uuid","push","exitDashboard","fnlist","label","icon","style","width","border-radius","font-size","font-weight","fn","href","dialogBox","saveDashboard","viewmode","title","description","change","defer","defera","deferb","unitFilter","unitFilterDisabled","kpis","getBymodelId","then","kpiUnits","reduce","prev","next","some","elem","value","unit","resolve","err","resources","all","promise","cols","inx","drop","colstyles","path1","path2","refineDataStructure","$$hashKey","model","resource","kpi","attributes","i","reset","applied","panelCancel","dataPanel","editPanel","init","rootDomain","getModelByIds","allmodel","models","getAll","Array","apply","allModels","TEXT","modelDisable","SPARKLINE","LINECHART","GAUGECHART","PIECHART","BARCHART","SCATTERCHART","KCHART","RADARCHART","grid","GRID","linechart","gaugechart","piechart","barchart","scatterchart","kchart","radarchart","mapchart","map1chart","map2chart","scatter2chart","scatter3chart","relation1chart","relation2chart","parallels1chart","parallels2chart","parallels3chart","sankey1chart","sankey2chart","panelClose","dataPanelShow","temp","checked","defers","finished","def","getcikpi","$","isArray","resourceId","kpiId","check","correct","savedata","saveModelDashboardViewContent","stringify","success","error","param","length","slice","viewName","updateView","addView","colstyle","gridSelector","colChange","setValue","onDelete","getElem","getParent","targetId","target","attr","parent","$remove","onSetting","ui","selectData","switchToData","valueGroup","onDataChange","onDrop","before","dragId","draggable","indexOf","targetParent","insertBefore","split","pare","row","traverse","el","selectWrap","kpiChange","maxKpi","resourceChange","mode","groupRemove","list","clearDashboard","resetDashboard","dataTypeChange","groupAdd","parseInt","Math","random","toString","tabClick","removeClass","addClass"],"mappings":"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","file":"js/controllers/graph-editor-ctrl.js","sourcesContent":["function _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\ndefine(['controllers/controllers'], function (controllers) {\n  'use strict';\n\n  controllers.controller('graphEditorCtrl', ['$scope', '$rootScope', '$routeParams', '$timeout', 'kpiDataService', 'resourceUIService', 'SwSocket', 'Info', 'viewFlexService', 'growl', '$q', '$window', '$location', 'solutionUIService', 'serviceCenterService', 'chartOptionService', 'toolBarList', function (scope, rootScope, routeParams, timeout, kpiDataService, resourceUIService, SwSocket, Info, viewFlexService, growl, q, window, location, solutionUIService, serviceCenterService, chartOptionService, toolBarList) {\n    var status, rootCi, freeBoardValue, CHARTDATA, solutionId, serviceViewId, allViews, viewId, currentView, loadedView;\n    var solutionId = routeParams.solutionId;\n    var groupId = routeParams.groupId;\n    var modelId = routeParams.modelId;\n    var viewId = routeParams.viewId;\n    var path = \"../localdb/freeboard.json\";\n    scope.solutionId = solutionId;\n    loadedView = {\n      id: $randomString(32),\n      type: 'column',\n      children: [],\n      col: 12\n    };\n    Info.get(path, function (info) {\n      if (solutionId) {\n        scope.titleComposory = false;\n        solutionUIService.getModelDashboardViewContent(solutionId, groupId, modelId, getModelDashboardViewSolution);\n      } else {\n        scope.titleComposory = true;\n\n        if (viewId) {\n          viewFlexService.getAllMyViews(callback);\n          scope.viewId = viewId;\n        }\n      }\n    });\n\n    function callback(event) {\n      allViews = event.data.filter(function (element) {\n        return element.viewType == \"designView_v2\" && element.viewId != viewId;\n      });\n      currentView = event.data.find(function (element) {\n        return element.viewId == viewId;\n      });\n\n      if (currentView) {\n        scope.viewTitle = currentView.viewTitle;\n        scope.titleChange();\n        getDashboard();\n      } else {\n        throw new Error(\"视图不存在！！\");\n      }\n    }\n\n    function getDashboard() {\n      var cachBindData = {};\n\n      if (currentView != undefined) {\n        var clone,\n            dt = JSON.parse(currentView.content);\n        clone = dt;\n      } else {\n        clone = standardDashboard.clone();\n      }\n\n      loadedView = {\n        layout: clone.data,\n        setting: clone.setting\n      };\n      scope.editData = {\n        layout: clone.data,\n        setting: clone.setting\n      };\n      scope.editData.layout.traveseByChild(function (element) {\n        if (element.onChange) {\n          element.onChange = eval(element.onChange);\n        }\n\n        if (element.source) {\n          var source = element.source;\n          element.clone(freeBoardValue[source].clone().$extension(element));\n        }\n\n        if (element.data) {\n          if (element.data.bindTo) {\n            if (cachBindData[element.data.bindTo]) {\n              element.data = cachBindData[element.data.bindTo];\n            } else {\n              cachBindData[element.data.bindTo] = element.data;\n            }\n          }\n        }\n\n        element.id = $randomString(32);\n      });\n      replaceCiKpi.call(scope.editData.layout, function () {\n        timeout(function () {\n          scope.editData.renderBoard();\n        });\n      });\n    }\n\n    function getModelDashboardViewSolution(event) {\n      if (event.code) {\n        if (event.data != null) {\n          var clone,\n              dt = JSON.parse(event.data);\n\n          if (dt.version == \"V_2\") {\n            clone = {\n              layout: dt.data,\n              setting: dt.setting\n            };\n          } else {\n            clone = {\n              layout: {\n                id: $randomString(32),\n                type: 'column',\n                children: [],\n                col: 12\n              },\n              setting: {\n                padding: 15\n              }\n            };\n          }\n        }\n\n        loadedView = clone.clone();\n        scope.editData = clone;\n        scope.editData.layout.traveseByChild(function (element) {\n          if (element.onChange) {\n            element.onChange = eval(element.onChange);\n          }\n\n          if (element.source) {\n            var source = element.source;\n            element.clone(freeBoardValue[source].clone().$extension(element.clone()));\n          }\n\n          element.id = $randomString(32); // \n        });\n        replaceCiKpi.call(scope.editData.layout, function () {\n          timeout(function () {\n            scope.editData.renderBoard();\n          });\n        });\n      }\n    }\n\n    function toolbar(data) {\n      this.clone(data);\n    }\n\n    toolbar.prototype.click = function () {\n      scope.toolbarDetail = this.clone();\n      scope.toolbarDetail.sub = scope.toolbarDetail.sub.map(function (element) {\n        return new subtoolbar(element);\n      });\n    };\n\n    function subtoolbar(data) {\n      this.clone(data);\n    }\n\n    subtoolbar.prototype.click = function () {\n      var select = scope.tools[this.dataType.type + 'chart'].clone();\n      var tempData = CHARTDATA[this.option];\n      var uuid = $randomString(32);\n      var selectWrap;\n      select.$extension(tempData);\n      select.id = $randomString(32);\n\n      if (tempData) {\n        select.$extension({\n          data: {\n            bindTo: uuid\n          }\n        });\n        selectWrap = {\n          type: \"row\",\n          style: \"border : 1px dashed #aaa; padding : 20px 0; margin : 20px auto;\",\n          children: [{\n            type: 'col',\n            col: 12,\n            children: [{\n              id: $randomString(32),\n              type: 'multiSelect',\n              data: select.data.$extension({\n                bindTo: uuid\n              })\n            }]\n          }, {\n            type: 'col',\n            col: 12,\n            children: [select]\n          }]\n        };\n      } else {\n        selectWrap = select;\n      }\n\n      scope.toolbarDetail = undefined;\n      scope.editData.layout.children.push(select);\n      scope.editData.renderBoard();\n    };\n\n    function modelSelector(data) {\n      this.clone(data);\n    }\n\n    ;\n\n    rootScope.exitDashboard = function () {\n      var fnlist = [{\n        label: '不保存',\n        icon: 'btn btn-default pull-left',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        fn: function fn() {\n          if (solutionId && serviceViewId) {\n            window.location.href = \"../app-ac/index.html#/myView\";\n          } else {\n            window.location.href = \"../app-oc/index.html#/designView/\" + scope.viewId;\n          }\n        }\n      }, {\n        label: '取消',\n        icon: 'btn btn-cancel',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        fn: function fn() {\n          scope.dialogBox = undefined;\n        }\n      }, {\n        label: '保存',\n        icon: 'btn btn-success',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        fn: function fn() {\n          rootScope.saveDashboard(function () {\n            if (rootScope.viewmode == 'editor') {\n              if (solutionId && serviceViewId) {\n                window.location.href = \"../app-ac/index.html#/myView\";\n              } else {\n                window.location.href = \"../app-oc/index.html#/designView/\" + scope.viewId;\n              }\n            } else {\n              if (solutionId && serviceViewId) {\n                window.location.href = \"../app-ac/index.html#/myView\";\n              } else {\n                window.location.href = \"../app-oc/index.html#/designView/\" + scope.viewId;\n              }\n            }\n          });\n        }\n      }];\n      scope.dialogBox = {\n        title: {\n          label: '退出DASHBOARD编辑器'\n        },\n        description: {\n          label: '尚有未保存的修改，是否保存？'\n        },\n        fnlist: fnlist\n      };\n    };\n\n    modelSelector.prototype.change = function () {\n      var modelId = this.id;\n      var defer = q.defer();\n      var defera = q.defer();\n      var deferb = q.defer();\n      scope.unitFilter = undefined;\n      scope.unitFilterDisabled = false;\n      serviceCenterService.kpis.getBymodelId(modelId).then(function success(data) {\n        scope.kpis = data;\n        scope.kpiUnits = data.reduce(function (prev, next) {\n          var some = prev.some(function (elem) {\n            return elem.value == next.unit;\n          });\n\n          if (!some) {\n            prev.push({\n              label: next.unit,\n              value: next.unit\n            });\n          }\n\n          return prev;\n        }, [{\n          label: 'all',\n          value: ''\n        }]);\n        defera.resolve(\"success\");\n      }, function error(err) {});\n      serviceCenterService.resources.getBymodelId(modelId).then(function success(data) {\n        scope.resources = data;\n        deferb.resolve(\"success\");\n      }, function error(err) {});\n      q.all([defera.promise, deferb.promise]).then(function (event) {\n        defer.resolve(\"success\");\n      });\n      return defer.promise;\n    };\n\n    scope.toolBarList = toolBarList.map(function (element) {\n      return new toolbar(element);\n    });\n    scope.cols = [{\n      inx: 0,\n      value: 12\n    }];\n    scope.drop = {};\n    scope.colstyles = [{\n      label: '自定义',\n      value: []\n    }, {\n      label: '100%',\n      value: [12]\n    }, {\n      label: '50% - 50%',\n      value: [6, 6]\n    }, {\n      label: '66% - 33%',\n      value: [8, 4]\n    }, {\n      label: '33% - 66%',\n      value: [4, 8]\n    }, {\n      label: '33% - 33% - 33%',\n      value: [4, 4, 4]\n    }, {\n      label: '25% - 25% - 25% - 25%',\n      value: [3, 3, 3, 3]\n    }];\n    var path1 = \"../localdb/editor.json\";\n    var path2 = \"../localdb/freeboard.json\";\n\n    scope.titleChange = function () {\n      if (allViews) {\n        check();\n      } else {\n        viewFlexService.getAllMyViews(function (event) {\n          if (event.code == '0') {\n            allViews = event.data.filter(function (element) {\n              return element.viewType == \"designView_v2\" && element.viewId != viewId;\n            });\n            check();\n          }\n        });\n      }\n\n      function check() {\n        var find = allViews.some(function (element) {\n          return element.viewTitle == scope.viewTitle;\n        });\n        scope.correct = !find;\n      }\n    };\n\n    function refineDataStructure() {\n      var cachBindData = {};\n      this.traveseByChild(function (element) {\n        delete element.id;\n\n        if (element.$$hashKey) {\n          delete element.$$hashKey;\n        }\n\n        if (element.data) {\n          if (element.data.model) {\n            element.data.model = {\n              id: element.data.model.id\n            };\n          }\n\n          if (element.data.resource) {\n            element.data.resource = element.data.resource.map(function (elem) {\n              if (elem.id == rootCi.id) {\n                return \"rootCi\";\n              } else {\n                return elem.id;\n              }\n            });\n          }\n\n          if (element.data.kpi) {\n            element.data.kpi = element.data.kpi.map(function (elem) {\n              return elem.id;\n            });\n          }\n        }\n\n        if (element.attributes) {\n          for (var i in element.attributes) {\n            var reset = {\n              value: element.attributes[i].value\n            };\n\n            if (element.attributes[i].applied != undefined) {\n              reset.applied = element.attributes[i].applied;\n            }\n\n            if (element.attributes[i].data) {\n              reset.$extension({\n                data: {\n                  value: element.attributes[i].data.value\n                }\n              });\n            }\n\n            element.attributes[i] = reset;\n          }\n\n          if (element.data.bindTo) {\n            if (cachBindData[element.data.bindTo]) {\n              element.data = cachBindData[element.data.bindTo];\n            } else {\n              cachBindData[element.data.bindTo] = element.data;\n            }\n          }\n        }\n      });\n    }\n\n    ;\n\n    rootScope.saveDashboard = function (callback) {\n      if (solutionId || typeof scope.viewTitle == 'string' && scope.viewTitle != '') {\n        var savedata = scope.editData.clone();\n        refineDataStructure.call(savedata.layout);\n        var content = {\n          version: 'V_2',\n          data: savedata.layout,\n          setting: savedata.setting\n        };\n\n        if (solutionId) {\n          solutionUIService.saveModelDashboardViewContent(solutionId, groupId, modelId, JSON.stringify(content), function (event) {\n            if (event.code == 0) {\n              //window.location.href = \"../app-ac/index.html#/myView\";\n              growl.success(\"解决方案视图修改成功\", {});\n            } else {\n              growl.error(\"解决方案视图修改失败\", {});\n            }\n          });\n        } else {\n          var param = {\n            viewTitle: scope.viewTitle.length > 30 ? scope.viewTitle.slice(0, 30) : scope.viewTitle,\n            viewName: 'designView_v2',\n            viewType: \"designView_v2\",\n            content: JSON.stringify(content)\n          };\n\n          if (scope.viewId) {\n            param.viewId = scope.viewId;\n            viewFlexService.updateView(param, function (event) {\n              if (event.code == 0) {\n                growl.success(\"性能视图修改成功\", {});\n\n                if (callback) {\n                  callback();\n                } //window.location.href = \"../app-oc/index.html#/designView/\" + scope.viewId;\n\n              }\n            });\n          } else {\n            viewFlexService.addView(param, function (event) {\n              if (event.code == 0) {\n                growl.success(\"性能视图创建成功\", {});\n                scope.viewId = event.data.viewId;\n\n                if (callback) {\n                  callback();\n                } //window.location.href = \"../app-oc/index.html#/designView/\" + event.data.viewId;\n\n              }\n            });\n          }\n        }\n      } else {\n        growl.error(\"视图名不能为空！\", {});\n      }\n    };\n\n    Info.get(path1, function (info) {\n      CHARTDATA = info;\n      Info.get(path2, function (info) {\n        freeBoardValue = info.freeBoardValue;\n        init();\n      });\n    });\n    scope.editData = {\n      layout: {\n        id: $randomString(32),\n        type: 'column',\n        children: [],\n        col: 12\n      },\n      setting: {\n        padding: 15\n      }\n    };\n    rootScope.panelCancel = panelCancel;\n\n    function panelCancel() {\n      scope.unitFilter = \"\";\n      scope.unitFilterDisabled = false;\n      scope.dataPanel = undefined;\n      scope.editPanel = undefined;\n      scope.resources = undefined;\n      scope.kpis = undefined;\n    }\n\n    function init() {\n      serviceCenterService.rootDomain.get().then(function success(data) {\n        rootCi = data;\n        var model = [data.modelId];\n        resourceUIService.getModelByIds(model, function (event) {\n          var rootModel = event.data[0];\n          var allmodel = [rootModel];\n          serviceCenterService.models.getAll().then(function success(data) {\n            Array.prototype.push.apply(allmodel, data);\n            scope.allModels = allmodel.map(function (element) {\n              return new modelSelector(element);\n            });\n            freeBoardValue.TEXT.$extension({\n              data: {\n                model: scope.allModels[0],\n                resource: [rootCi],\n                modelDisable: false\n              }\n            });\n            freeBoardValue.SPARKLINE.$extension({\n              data: {\n                model: scope.allModels[0],\n                resource: [rootCi],\n                modelDisable: false\n              }\n            });\n            freeBoardValue.LINECHART.$extension({\n              data: {\n                model: scope.allModels[0],\n                resource: [rootCi],\n                modelDisable: false\n              }\n            });\n            freeBoardValue.GAUGECHART.$extension({\n              data: {\n                model: scope.allModels[0],\n                resource: [rootCi],\n                modelDisable: false\n              }\n            });\n            freeBoardValue.PIECHART.$extension({\n              data: {\n                model: scope.allModels[0],\n                resource: [rootCi],\n                modelDisable: false\n              }\n            });\n            freeBoardValue.BARCHART.$extension({\n              data: {\n                model: scope.allModels[0],\n                resource: [rootCi],\n                modelDisable: false\n              }\n            });\n            freeBoardValue.SCATTERCHART.$extension({\n              data: {\n                model: scope.allModels[0],\n                resource: [rootCi],\n                modelDisable: false\n              }\n            });\n            freeBoardValue.KCHART.$extension({\n              data: {\n                model: scope.allModels[0],\n                resource: [rootCi],\n                modelDisable: false\n              }\n            });\n            freeBoardValue.RADARCHART.$extension({\n              data: {\n                model: scope.allModels[0],\n                resource: [rootCi],\n                modelDisable: false\n              }\n            });\n            scope.tools = {\n              grid: freeBoardValue.GRID,\n              linechart: freeBoardValue.LINECHART,\n              gaugechart: freeBoardValue.GAUGECHART,\n              piechart: freeBoardValue.PIECHART,\n              barchart: freeBoardValue.BARCHART,\n              scatterchart: freeBoardValue.SCATTERCHART,\n              kchart: freeBoardValue.KCHART,\n              radarchart: freeBoardValue.RADARCHART,\n              mapchart: {\n                type: 'mapchart'\n              },\n              map1chart: {\n                type: 'map1chart'\n              },\n              map2chart: {\n                type: 'map2chart'\n              },\n              scatter2chart: {\n                type: 'scatter2chart'\n              },\n              scatter3chart: {\n                type: 'scatter3chart'\n              },\n              relation1chart: {\n                type: \"relation1chart\"\n              },\n              relation2chart: {\n                type: \"relation2chart\"\n              },\n              parallels1chart: {\n                type: 'parallels1chart'\n              },\n              parallels2chart: {\n                type: 'parallels2chart'\n              },\n              parallels3chart: {\n                type: 'parallels3chart'\n              },\n              sankey1chart: {\n                type: 'sankey1chart'\n              },\n              sankey2chart: {\n                type: 'sankey2chart'\n              }\n            };\n\n            for (var i in scope.tools) {\n              replaceCiKpi.call(scope.tools[i]);\n            }\n\n            scope.editData.renderBoard();\n          }, function error(err) {});\n        });\n      });\n    }\n\n    scope.colstyle = scope.colstyles[1];\n    scope.gridSelector = {};\n\n    scope.colChange = function (col) {\n      scope.gridSelector.setValue(col);\n    };\n\n    scope.onDelete = function (event) {\n      var targetId = $(event.target).attr(\"id\");\n      var getElem, getParent;\n      scope.editData.layout.traveseByChild(function (element, parent) {\n        if (element.id == targetId) {\n          getElem = element;\n          getParent = parent;\n        }\n      });\n      var find = getParent.find(function (elem) {\n        return elem == getElem;\n      });\n\n      if (find) {\n        getParent.$remove(function (element) {\n          return element.id == find.id;\n        });\n      }\n\n      scope.editData.renderBoard();\n    };\n\n    scope.onSetting = function (event, ui) {\n      var getElem, getParent;\n      var targetId = $(event.target).attr(\"id\");\n      scope.editData.layout.traveseByChild(function (element, parent) {\n        if (element.id == targetId) {\n          getElem = element;\n          getParent = parent;\n        }\n      });\n      scope.selectData = getElem;\n      scope.editPanel = getElem.clone();\n\n      rootScope.panelClose = function panelCloseData() {\n        getElem.$extension(scope.editPanel);\n        scope.unitFilter = \"\";\n        scope.unitFilterDisabled = false;\n        scope.dataPanel = undefined;\n        scope.editPanel = undefined;\n        scope.resources = undefined;\n        scope.kpis = undefined;\n        scope.editData.renderBoard();\n      };\n    };\n\n    scope.switchToData = function () {\n      var temp = scope.editPanel;\n      scope.editPanel = undefined;\n      timeout(function () {\n        dataPanelShow(temp);\n      }, 400);\n      rootScope.panelClose = panelCloseData;\n\n      function panelCloseData() {\n        if (scope.dataPanel.data.resource && scope.dataPanel.data.kpi) {\n          for (var i in scope.dataPanel.attributes) {\n            if (scope.dataPanel.attributes[i].data) {\n              if (scope.dataPanel.attributes[i].data.value == 'none') {\n                scope.dataPanel.attributes[i].data.value = scope.dataPanel.attributes[i].data.option[1].value;\n              }\n            }\n          }\n\n          if (scope.dataPanel.valueGroup) {\n            scope.dataPanel.valueGroup.data.value = \"value\";\n          }\n        } else {\n          for (var i in scope.dataPanel.attributes) {\n            if (scope.dataPanel.attributes[i].data) {\n              if (scope.dataPanel.attributes[i].data.value != 'none') {\n                scope.dataPanel.attributes[i].data.value = 'none';\n              }\n            }\n          }\n\n          if (scope.dataPanel.valueGroup) {\n            scope.dataPanel.valueGroup.data.value = \"custom\";\n          }\n        }\n\n        scope.selectData.$extension(scope.dataPanel);\n        scope.editData.renderBoard();\n        timeout(function () {\n          var temp = scope.selectData.clone();\n          scope.editPanel = temp;\n\n          rootScope.panelClose = function () {\n            scope.selectData.$extension(scope.editPanel);\n            scope.editData.renderBoard();\n            scope.unitFilter = \"\";\n            scope.unitFilterDisabled = false;\n            scope.dataPanel = undefined;\n            scope.editPanel = undefined;\n            scope.resources = undefined;\n            scope.kpis = undefined;\n          };\n        }, 400);\n        scope.unitFilter = \"\";\n        scope.unitFilterDisabled = false;\n        scope.dataPanel = undefined;\n        scope.editPanel = undefined;\n        scope.resources = undefined;\n        scope.kpis = undefined;\n      }\n    };\n\n    scope.onDataChange = function (event, ui) {\n      var getElem, getParent;\n      var targetId = $(event.target).attr(\"id\");\n      scope.editData.layout.traveseByChild(function (element, parent) {\n        if (element.id == targetId) {\n          getElem = element;\n          getParent = parent;\n        }\n      });\n\n      for (var i in scope.resources) {\n        scope.resources[i].checked = false;\n      }\n\n      for (var i in scope.kpis) {\n        scope.kpis[i].checked = false;\n      }\n\n      scope.selectData = getElem;\n      dataPanelShow(getElem.clone());\n      rootScope.panelClose = panelCloseData;\n\n      function panelCloseData() {\n        if (scope.dataPanel.data.resource && scope.dataPanel.data.kpi) {\n          for (var i in scope.dataPanel.attributes) {\n            if (scope.dataPanel.attributes[i].data) {\n              if (scope.dataPanel.attributes[i].data.value == 'none') {\n                scope.dataPanel.attributes[i].data.value = scope.dataPanel.attributes[i].data.option[1].value;\n              }\n            }\n          }\n\n          if (scope.dataPanel.valueGroup) {\n            scope.dataPanel.valueGroup.data.value = \"value\";\n          }\n        } else {\n          for (var i in scope.dataPanel.attributes) {\n            if (scope.dataPanel.attributes[i].data) {\n              if (scope.dataPanel.attributes[i].data.value != 'none') {\n                scope.dataPanel.attributes[i].data.value = 'none';\n              }\n            }\n          }\n\n          if (scope.dataPanel.valueGroup) {\n            scope.dataPanel.valueGroup.data.value = \"custom\";\n          }\n        }\n\n        scope.selectData.$extension(scope.dataPanel.clone());\n        scope.editData.renderBoard();\n        scope.unitFilter = \"\";\n        scope.unitFilterDisabled = false;\n        scope.dataPanel = undefined;\n        scope.editPanel = undefined;\n        scope.resources = undefined;\n        scope.kpis = undefined;\n      }\n    };\n\n    function panelClose() {\n      scope.unitFilter = \"\";\n      scope.unitFilterDisabled = false;\n      scope.dataPanel = undefined;\n      scope.editPanel = undefined;\n      scope.resources = undefined;\n      scope.kpis = undefined;\n      scope.editData.renderBoard();\n    }\n\n    scope.onChange = function (cols, reset) {\n      scope.tools.grid.children = cols.map(function (element) {\n        var result = {\n          type: 'column',\n          children: [],\n          col: element\n        };\n        return result;\n      });\n\n      if (reset) {\n        scope.colstyle = scope.colstyles[0];\n      }\n    };\n\n    scope.onDrop = function (event, ui, before) {\n      var targetId = $(event.target).attr(\"id\");\n      var dragId = ui.draggable.attr(\"id\");\n\n      if (targetId != dragId) {\n        if (dragId.indexOf(\"add_\") == -1) {\n          var getElem,\n              getParent,\n              clone = {};\n          scope.editData.layout.traveseByChild(function (element, parent) {\n            if (element.id == dragId) {\n              getElem = element;\n              getParent = parent;\n            }\n          });\n          clone = getElem.clone();\n          var find = getParent.find(function (elem) {\n            return elem == getElem;\n          });\n\n          if (find) {\n            getParent.$remove(function (element) {\n              return element.id == find.id;\n            });\n          }\n\n          var find, targetParent;\n          scope.editData.layout.traveseByChild(function (element, parent) {\n            if (element.id == targetId) {\n              find = element;\n              targetParent = parent;\n            }\n          });\n\n          if (before) {\n            var inx = targetParent.indexOf(find);\n\n            if (inx != -1) {\n              targetParent.insertBefore(inx, clone);\n            }\n          } else {\n            find.children.push(clone);\n          }\n\n          scope.editData.renderBoard();\n        } else {\n          var dragId = dragId.split(\"add_\")[1];\n\n          if (dragId == 'grid') {\n            var find, pare, children;\n            var children = [];\n            var row;\n\n            if (scope.tools.clone()[dragId]) {\n              row = scope.tools.clone()[dragId];\n            } else if (scope.tools.clone()[dragId + 'chart']) {\n              row = scope.tools.clone()[dragId + 'chart'];\n            } else {\n              throw new Error(\"找不到视图!\");\n            }\n\n            row.traveseByChild(function (element) {\n              element.id = $randomString(32);\n              element.traverse(function (el) {\n                if (el.onChange) {\n                  el.onChange = eval(el.onChange);\n                }\n              });\n            });\n            scope.editData.layout.traveseByChild(function (element, parent) {\n              if (element.id == targetId) {\n                find = element;\n                pare = parent;\n              }\n            });\n\n            if (before) {\n              var inx = pare.indexOf(find);\n              pare.insertBefore(inx, row);\n            } else {\n              find.children.push(row);\n            }\n\n            scope.editData.renderBoard();\n          } else {\n            var find = toolBarList.find(function (element) {\n              return element.id == dragId;\n            });\n            var uuid = $randomString(32);\n            var option = find.sub[0].option;\n            var find, pare, children;\n            var children = [];\n            var select;\n\n            if (scope.tools.clone()[dragId]) {\n              select = scope.tools.clone()[dragId];\n            } else if (scope.tools.clone()[dragId + 'chart']) {\n              select = scope.tools.clone()[dragId + 'chart'];\n            } else {\n              throw new Error(\"找不到视图!\");\n            }\n\n            var tempData = CHARTDATA[option];\n            select.id = $randomString(32);\n            select.$extension(tempData);\n            var selectWrap = {\n              type: \"row\",\n              style: \"border : 1px dashed #aaa; padding : 20px 0; margin : 20px auto;\",\n              children: [{\n                type: 'col',\n                col: 12,\n                children: [{\n                  id: $randomString(32),\n                  type: 'multiSelect',\n                  data: {\n                    bindTo: uuid,\n                    model: select.data.model,\n                    resource: select.data.resource\n                  }\n                }]\n              }, {\n                type: 'col',\n                col: 12,\n                children: [select]\n              }]\n            };\n            selectWrap.traveseByChild(function (element) {\n              element.id = $randomString(32);\n              element.traverse(function (el) {\n                if (el.onChange) {\n                  el.onChange = eval(el.onChange);\n                }\n              });\n            });\n            scope.editData.layout.traveseByChild(function (element, parent) {\n              if (element.id == targetId) {\n                find = element;\n                pare = parent;\n              }\n            });\n\n            if (before) {\n              var inx = pare.indexOf(find);\n              pare.insertBefore(inx, selectWrap);\n            } else {\n              find.children.push(selectWrap);\n            }\n\n            scope.editData.renderBoard();\n          }\n        }\n      }\n    };\n\n    scope.kpiChange = function (kpi) {\n      if (scope.dataPanel.data.maxKpi == 1) {\n        for (var i in scope.kpis) {\n          if (scope.kpis[i].id != kpi.id) {\n            scope.kpis[i].checked = false;\n          } else {\n            scope.kpis[i].checked = !scope.kpis[i].checked;\n          }\n        }\n      } else {\n        kpi.checked = !kpi.checked;\n      }\n\n      var filter = scope.kpis.filter(function (element) {\n        return element.checked == true;\n      });\n\n      if (filter.length > 0) {\n        scope.unitFilter = filter[0].unit;\n        scope.unitFilterDisabled = true;\n        scope.dataPanel.data.kpi = filter;\n      } else {\n        scope.unitFilter = \"\";\n        scope.unitFilterDisabled = false;\n        scope.dataPanel.data.kpi = undefined;\n      }\n    };\n\n    scope.resourceChange = function (resource) {\n      resource.checked = !resource.checked;\n      var filter = scope.resources.filter(function (element) {\n        return element.checked == true;\n      });\n\n      if (filter.length > 0) {\n        scope.dataPanel.data.resource = filter;\n      } else {\n        scope.dataPanel.data.resource = undefined;\n      }\n    };\n\n    function dataPanelShow(temp) {\n      scope.dataPanel = temp.clone();\n      scope.dataPanel.data.model = scope.allModels.find(function (element) {\n        return element.id == scope.dataPanel.data.model.id;\n      });\n      scope.dataPanel.data.model.change().then(function success() {\n        for (var i in scope.resources) {\n          var some = false;\n\n          if (scope.dataPanel.data.resource) {\n            some = scope.dataPanel.data.resource.some(function (elem) {\n              return scope.resources[i].id == elem.id;\n            });\n          }\n\n          scope.resources[i].checked = some;\n        }\n\n        for (var i in scope.kpis) {\n          var find;\n\n          if (scope.dataPanel.data.kpi) {\n            find = scope.dataPanel.data.kpi.find(function (elem) {\n              return scope.kpis[i].id == elem.id;\n            });\n          }\n\n          if (find) {\n            scope.unitFilter = find.unit;\n            scope.unitFilterDisabled = true;\n          }\n\n          scope.kpis[i].checked = find != undefined;\n        }\n      });\n    }\n\n    ;\n\n    function replaceCiKpi(callback) {\n      var defers = [];\n      var cur = this;\n      this.traveseByChild(function (element) {\n        var resourceArr = [];\n        var finished,\n            def = q.defer();\n        defers.push(def.promise);\n\n        (function (def) {\n          if (element.data) {\n            element.data.defer = function (callback) {\n              finished = callback;\n            };\n\n            if (_typeof(element.data.model) != 'object') {\n              var modelId = element.data.model;\n              resourceUIService.getModelByIds([modelId], function (event) {\n                if (event.code == '0') {\n                  element.data.model = new modelSelector(event.data[0]);\n                  getcikpi(modelId);\n                }\n              });\n            } else if (element.data.model != undefined) {\n              var modelId = element.data.model.id;\n\n              if (modelId == undefined) {}\n\n              getcikpi(modelId);\n            }\n          } else {\n            def.resolve(\"success\");\n          }\n\n          function getcikpi(modelId) {\n            serviceCenterService.resources.getBymodelId(modelId).then(function success(data) {\n              if ($.isArray(element.data.resource)) {\n                for (var i in element.data.resource) {\n                  if (element.data.resource[i] == 'rootCi') {\n                    element.data.resource[i] = rootCi;\n                  } else if (_typeof(element.data.resource[i]) != 'object') {\n                    var resourceId = element.data.resource[i];\n                    element.data.resource[i] = data.find(function (elem) {\n                      return resourceId == elem.id;\n                    });\n                  }\n                }\n              }\n\n              serviceCenterService.kpis.getBymodelId(modelId).then(function success(data) {\n                if ($.isArray(element.data.kpi)) {\n                  for (var i in element.data.kpi) {\n                    if (_typeof(element.data.kpi[i]) != 'object') {\n                      var kpiId = element.data.kpi[i];\n                      element.data.kpi[i] = data.find(function (elem) {\n                        return kpiId == elem.id;\n                      });\n                    }\n                  }\n                }\n\n                delete element.data.defer;\n\n                if (typeof finished == 'function') {\n                  finished(\"success!!\");\n                }\n\n                def.resolve(\"success\");\n              });\n            });\n          }\n        })(def);\n      });\n      q.all(defers).then(function success(data) {\n        if (typeof callback == 'function') {\n          callback();\n        }\n      });\n    }\n\n    scope.mode = \"EDIT\";\n\n    scope.groupRemove = function (target, list) {\n      if (list.length > 1) {\n        list.$remove(function (element) {\n          return target.id == element.id;\n        });\n\n        for (var i in list) {\n          list[i].id = i;\n        }\n      }\n    };\n\n    rootScope.clearDashboard = function () {\n      scope.editData = {\n        layout: {\n          id: $randomString(32),\n          type: 'column',\n          children: [],\n          col: 12\n        }\n      };\n      timeout(function () {\n        scope.editData.renderBoard();\n      });\n    };\n\n    rootScope.resetDashboard = function () {\n      var cachBindData = {};\n      scope.editData = loadedView.clone();\n      scope.editData.layout.traveseByChild(function (element) {\n        if (element.onChange) {\n          element.onChange = eval(element.onChange);\n        }\n\n        element.id = $randomString(32);\n\n        if (element.source) {\n          var source = element.source;\n          element.clone(freeBoardValue[source].clone().$extension(element.clone()));\n        }\n\n        if (element.data) {\n          if (element.data.bindTo) {\n            if (cachBindData[element.data.bindTo]) {\n              element.data = cachBindData[element.data.bindTo];\n            } else {\n              cachBindData[element.data.bindTo] = element.data;\n            }\n          }\n        }\n      });\n      replaceCiKpi.call(scope.editData.layout);\n      timeout(function () {\n        if (status == \"PREV\") {\n          scope.editData.renderBoard(true);\n        } else {\n          scope.editData.renderBoard();\n        }\n      });\n    };\n\n    scope.dataTypeChange = function (data, editPanel) {\n      if (data.value != \"none\") {\n        if (editPanel.data.resource == undefined || editPanel.data.kpi == undefined) {\n          var temp = scope.editPanel;\n          scope.editPanel = undefined;\n          timeout(function () {\n            dataPanelShow(temp);\n          }, 400);\n          rootScope.panelClose = panelCloseData;\n        }\n      }\n\n      function panelCloseData() {\n        if (scope.dataPanel.data.resource && scope.dataPanel.data.kpi) {\n          var temp = scope.dataPanel;\n          scope.selectData.clone(temp);\n          scope.dataPanel = undefined;\n          scope.editData.renderBoard();\n          timeout(function () {\n            rootScope.panelClose = function () {\n              scope.editPanel.clone(scope.selectData);\n              scope.unitFilter = \"\";\n              scope.unitFilterDisabled = false;\n              scope.dataPanel = undefined;\n              scope.editPanel = undefined;\n              scope.resources = undefined;\n              scope.kpis = undefined;\n            };\n\n            ;\n          }, 400);\n        } else {\n          data.value = \"none\";\n        }\n\n        scope.unitFilter = \"\";\n        scope.unitFilterDisabled = false;\n        scope.dataPanel = undefined;\n        scope.editPanel = undefined;\n        scope.resources = undefined;\n        scope.kpis = undefined;\n      }\n    };\n\n    scope.groupAdd = function (list) {\n      var clone = list[0].clone();\n      var value = [];\n\n      for (var i in clone.attributes.value.value.split(\",\")) {\n        value.push(parseInt(Math.random() * 100));\n      }\n\n      clone.attributes.value.value = value.toString();\n      list.push(clone);\n\n      for (var i in list) {\n        delete list[i]['$$hashKey'];\n        list[i].id = i;\n      }\n    };\n\n    scope.tabClick = function (mode) {\n      scope.mode = mode;\n\n      if (mode == \"EDIT\") {\n        $(\".free-board-left\").removeClass(\"free-board-fold\");\n        $(\".free-board-right\").removeClass(\"free-board-full\");\n        timeout(function () {\n          var target = $(\".previewarea\");\n          target.removeClass(\"previewarea\");\n          target.addClass(\"drawarea\");\n          scope.editData.renderBoard();\n          status = \"EDIT\";\n        }, 300);\n      } else {\n        $(\".free-board-left\").addClass(\"free-board-fold\");\n        $(\".free-board-right\").addClass(\"free-board-full\");\n        timeout(function () {\n          var target = $(\".drawarea\");\n          target.addClass(\"previewarea\");\n          target.removeClass(\"drawarea\");\n          scope.editData.renderBoard(true);\n          status = \"PREV\";\n        }, 300);\n      }\n\n      ;\n    };\n  }]);\n});"],"sourceRoot":"/source/"}