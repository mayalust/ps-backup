{"version":3,"sources":["js/controllers/free-board-ctrl.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","define","controllers","controller","scope","rootScope","route","serviceProxy","routeParams","timeout","thridPartyApiService","userDomainService","kqiManagerUIService","userLoginUIService","dictionaryService","configUIService","kpiDataService","resourceUIService","SwSocket","Info","viewFlexService","growl","q","window","location","solutionUIService","serviceCenterService","chartOptionService","toolbarListService","popup","angularStyle","ticketTaskService","alertService","freeboardBaseService","projectUIService","customMethodService","ngDialog","commonMethodService","keySet","currentView","loadedView","rootCi","status","allViews","allGraphViews","saveToManagement","titleComposory","CHARTDATA","groupModels","globalModel","dashboardTemplate","target","$","JSONparse","str","json","JSON","parse","e","getTitle","modelId","projectId","resourceId","cachedBackwardJSON","cachedForwardJSON","instance","toolbarListMap","tempResClick","resource","params","stringify","id","open","JSONParse","backTemp","tempResource","$on","callbackFun","viewmode","current","$$route","originalPath","split","viewtype","editorTitle","defer","callback","get","info","$$","isFunction","event","push","editData","$clone","length","shift","backward","last","pop","renderDataFn","forward","kqiModelId","solutionId","serviceViewId","flag","viewId","templateType","type","tempParams","decodeURIComponent","getResourceByModelId","code","resources","data","getResourceById","path","exit","close","dirty","undefined","layout","$randomString","children","col","setting","showNavi","style","padding","reconstruct","traveseByChild","element","onChange","eval","source","sourceMode","freeBoardValue","loop","attr","val","indexOf","at","$attr","i","getViewById","content","replaceCiKpi","call","toolbar","this","subtoolbar","initData","traverse","hasOwnProperty","oldValue","value","bool","tabIndex","setMode","setButtonDisable","renderLayout","clone","groups","anchorChange","curLayout","folder","item","renderToolbar","rs","$CLASS","parent","Object","defineProperty","enumerable","linkOnchange","color","remapData","$remapByChild","Error","label","setRootTarget","isObjectLike","RegExp","test","getDashboard","c","dt","viewType","rows","machineDashboard","standardDashboard","defers","index","tg","df","resolve","promise","wait","all","then","getDashboardSolution","version","modelSelector","onTabClick","ui","dialog","title","input","tabName","composory","maxlength","events","change","default","fnlist","icon","fn","$broadcast","dft","inx","tabInx","template","className","panelCancel","unitFilter","unitFilterDisabled","dataPanel","editPanel","kpis","dataPanelShow","temp","model","allModels","find","some","elem","checked","kpi","unit","refineDataStructure","$$hashKey","$index","legend","manual","toString","bind","xAxis","series","map","noEmptyObject","kqiModel","attributes","reset","applied","$extension","saveManagement","param2","viewTitle","viewName","saveManageDashboard","success","error","getViews","init","res","allmodel","a","Math","round","random","b","getAllModels","run","models","getAll","Array","apply","defaultModel","enable","firstCreate","concat","specialist","specialistView","theme","TEXT","modelType","resfilltype","modelDisable","DATALIST","LINECHART","RADARCHART","BARCHART","modelGroup","option","GAUGECHART","PIECHART","SCATTERCHART","tools","grid","ROW","datalist_wrap","class","parameters","font-size","font-weight","text-align","margin","totalItemTemp","TOTALITEM","subtitle","perfix","css","totalItem","downtab","DOWNTAB","mapchartTemp","BMAP","height","border","background-color","SPARKLINE","mapchartLinkTemp","text","fontSize","position","weight","bindTo","fun","piechartTemp","dataType","warningMapTemp","help","timespan","frequency","aggregate_rule","aggregate_instance","aggregate_period","aggregate_type","autoFillBlank","format","xAxisType","yAxisType","yAxis","name","advance","variable","getfunction","category","custom_category","condition","expression","width","echart","general","textStyle","fontWeight","toolbox","tooltip","trigger","boundaryGap","axisLine","lineStyle","splitLine","show","max","min","axisLabel","axisTick","markPoint","visualMap","url","stack","areaStyle","normal","left","right","top","gridIndex","inverse","symbolSize","xAxisIndex","yAxisIndex","resource_time","multipleCi","multipleKpi","border-width","line-height","border-radius","kpilist","KPILIST","toLowerCase","getToolbarList","err","scatterOp","toolBarList","sub","rootDomain","getModelByIds","message","click","toolbarDetail","templateInx","seleteTemplate","save","mode","templates","settingDashboard","previewDashboard","warning","helpFun","getManageViewContent","types","typeVars","finished","dashboardViews","designView","filter","view","getKqiModels","fd","resourceType","viewContent","thumb","contiFn","self","$apply","on","subclick","titleChange","topo","configure","render","dview","desview","callbackTopo","viewFound","getConfigsByGroupName","getDefaultView","allDefaultViews","keyValue","getManagedViewsByTypeAndRole","editorSubTitle","description","tmp","fold","removeConfigClick","splice","deleteConfig","remove","parseInt","defera","deferb","getBymodelId","kpiUnits","reduce","prev","next","clearDashboard","resetDashboard","switchToData","panelClose","selectData","rsTarget","valueGroup","link","anchors","switchToEdit","groupAdd","list","groupRemove","$remove","dataTypeChange","exitDashboard","dialogBox","disabled","inputCheck","correct","saveDashboard","check","num","switchToNumber","msg","getAllMyViews","saveAsServiceView","savedata","param","slice","addView","saveManageViewContent","saveModelDashboardViewContent","groupId","updateView","releaseViews","encodeURIComponent","ModelKpiSelector","onCommandKeyWith","openTemplate","inputJSON","themes","kpiChange","maxKpi","resourceChange","tabClick","removeClass","addClass","createSystemPopupByJsonName","cols","drop","colstyles","gridSelector","colChange","setValue","testFn","colstyle","mm","toolbarClick","currentSelect","showInstruction","j","onDelete","getElem","getParent","targetId","onCut","clipBoard","onCopy","onInsert","k","insertBefore","body","importGraphToFunc","submit","groupName","saveConfig","it","onInsertJSON","destroy","onPasteJSON","onPaste","onDataChange","selectTemp","ctemp","selectSpec","cspec","applySpecTemp","applyTemp","tpath","openSpecialist","templateClose","specialistClose","jsonClose","JsonInput","JsonData","onSetting","extend","isDiff","arguments","$name","defaulttype","getType","setContent","submitPanel","onDrop","before","JSONstring","dragId","draggable","targetParent","pare","row","el","catchBind","tabId","addEditDataGroup","removeEditDataGroup","tab","renameEditDataGroup","placeholder","selectEditDataGroup"],"mappings":"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","file":"js/controllers/free-board-ctrl.js","sourcesContent":["function _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\ndefine(['controllers/controllers'], function (controllers) {\n  'use strict';\n\n  controllers.controller('freeBoardCtrl', ['$scope', '$rootScope', '$route', 'serviceProxy', '$routeParams', '$timeout', 'thridPartyApiService', 'userDomainService', 'kqiManagerUIService', 'userLoginUIService', 'dictionaryService', 'configUIService', 'kpiDataService', 'resourceUIService', 'SwSocket', 'Info', 'viewFlexService', 'growl', '$q', '$window', '$location', 'solutionUIService', 'serviceCenterService', 'chartOptionService', 'toolbarListService', 'popup', 'angular-style', 'ticketTaskService', 'alertService', 'freeboardBaseService', 'projectUIService', 'customMethodService', 'ngDialog', 'commonMethodService', 'keySet', function (scope, rootScope, route, serviceProxy, routeParams, timeout, thridPartyApiService, userDomainService, kqiManagerUIService, userLoginUIService, dictionaryService, configUIService, kpiDataService, resourceUIService, SwSocket, Info, viewFlexService, growl, q, window, location, solutionUIService, serviceCenterService, chartOptionService, toolbarListService, popup, angularStyle, ticketTaskService, alertService, freeboardBaseService, projectUIService, customMethodService, ngDialog, commonMethodService, keySet) {\n    var currentView,\n        loadedView,\n        rootCi,\n        status,\n        allViews,\n        allGraphViews,\n        saveToManagement,\n        titleComposory,\n        CHARTDATA = {},\n        groupModels,\n        globalModel;\n    var dashboardTemplate;\n    var target = $(\"#free-board-area\");\n\n    var JSONparse = function JSONparse(str) {\n      var json;\n\n      try {\n        json = JSON.parse(str);\n      } catch (e) {\n        json = {};\n      } finally {\n        return json;\n      }\n    };\n\n    var getTitle = function getTitle(str) {\n      switch (str) {\n        case \"service\":\n          return \"服务视图管理\";\n\n        case \"editor\":\n          return \"分析视图编辑器\";\n\n        default:\n          return \"仪表板编辑器\";\n      }\n    };\n\n    scope.cachedBackwardJSON = [];\n    scope.cachedForwardJSON = [];\n    scope.instance = freeboardBaseService(target);\n    scope.toolbarListMap = toolbarListService;\n\n    scope.tempResClick = function (resource) {\n      var params = JSON.stringify({\n        modelId: resource.modelId,\n        resourceId: resource.id\n      });\n      window.open(\"index.html#/template/device/dashboard/\" + params, \"_self\");\n    };\n\n    scope.JSONParse = function (str) {\n      if (_typeof(str) == \"object\") {\n        return str;\n      } else if (typeof str == \"string\") {\n        return JSON.parse(str);\n      } else {\n        return {};\n      }\n    };\n\n    scope.backTemp = function () {\n      var params = JSON.stringify({\n        modelId: scope.tempResource.modelId\n      });\n      window.open(\"index.html#/template/model/dashboard/\" + params, \"_self\");\n    };\n\n    scope.$on(\"$routeChangeSuccess\", function () {\n      rootScope.viewmode = route.current.$$route.originalPath.split(\"/\")[1];\n      scope.viewtype = route.current.$$route.originalPath.split(\"/\")[2];\n      rootScope.editorTitle = getTitle(rootScope.viewmode);\n\n      if (rootScope.viewmode == 'editor') {\n        var callbackFun;\n\n        CHARTDATA.defer = function (callback) {\n          callbackFun = callback;\n        };\n\n        Info.get('../localdb/editor.json', function (info) {\n          CHARTDATA = info;\n\n          if ($$.isFunction(callbackFun)) {\n            callbackFun();\n          }\n        });\n      }\n    });\n    scope.$on(\"viewChanged\", function (event) {\n      if (!scope.cachedBackwardJSON) {\n        scope.cachedBackwardJSON = [];\n      }\n\n      scope.cachedBackwardJSON.push(scope.editData.$clone());\n\n      if (scope.cachedBackwardJSON.length > 5) {\n        scope.cachedBackwardJSON.shift();\n      } //growl.success(\"view changed!!\");\n\n    });\n\n    rootScope.backward = function () {\n      if (scope.cachedBackwardJSON.length > 0) {\n        scope.cachedForwardJSON.push(scope.editData.$clone());\n\n        if (scope.cachedForwardJSON.length > 5) {\n          scope.cachedForwardJSON.shift();\n        }\n\n        var last = scope.cachedBackwardJSON[scope.cachedBackwardJSON.length - 1];\n        scope.editData = last;\n        scope.cachedBackwardJSON.pop();\n        renderDataFn(false);\n      }\n    };\n\n    rootScope.forward = function () {\n      if (scope.cachedForwardJSON.length > 0) {\n        scope.cachedBackwardJSON.push(scope.editData.$clone());\n\n        if (scope.cachedBackwardJSON.length > 5) {\n          scope.cachedBackwardJSON.shift();\n        }\n\n        var last = scope.cachedForwardJSON[scope.cachedForwardJSON.length - 1];\n        scope.editData = last;\n        scope.cachedForwardJSON.pop();\n        renderDataFn(false);\n      }\n    };\n\n    var modelId, projectId, resourceId;\n    var kqiModelId = routeParams.kqiModelId;\n    var solutionId = routeParams.solutionId;\n    var serviceViewId = routeParams.serviceViewId;\n    var flag = routeParams.flag;\n    var viewId = routeParams.viewId;\n    scope.templateType = routeParams.type;\n    var tempParams = routeParams.params;\n\n    if (tempParams) {\n      tempParams = decodeURIComponent(tempParams);\n      tempParams = JSON.parse(tempParams);\n      modelId = tempParams.modelId;\n      projectId = tempParams.projectId;\n      resourceId = tempParams.resourceId;\n    }\n\n    if (modelId) {\n      resourceUIService.getResourceByModelId(modelId, function (event) {\n        if (event.code == 0) {\n          scope.resources = event.data;\n        }\n      });\n    }\n\n    if (resourceId) {\n      resourceUIService.getResourceById(resourceId, function (event) {\n        if (event.code == 0) {\n          scope.tempResource = event.data;\n        }\n      });\n    }\n\n    var path = \"../localdb/freeboard.json\";\n\n    var exit = function exit() {\n      window.open(\"\", \"_self\").close();\n      /**\n               if(flag == 'home') {\n        window.location.href = \"../app-oc/index.html#/dashboard\";\n      } else if(flag == 'facility') {\n        window.location.href = \"../app-oc/index.html#/facility\";\n      } else if(flag == 'resource_type') {\n        window.location.href = \"../app-oc/index.html#/resource_type\";\n      } else if(flag == 'editor') {\n        window.location.href = \"../app-oc/index.html#/views/designView\";\n      } else if(flag == 'dashboard') {\n        window.location.href = \"../app-oc/index.html#/views/dashboard\";\n      } else if(flag == 'solutionView') {\n        window.location.href = \"../app-ac/index.html#/myView\";\n      } else if(flag == 'scenter') {\n        window.location.href = \"../app-sc/index_freeboard.html#/freeboard/index\";\n      } else if(flag == 'servicelist') {\n        window.location.href = \"../app-oc/index.html#/service/management/service\";\n      } else if(flag == 'kqiModel') {\n        window.location.href = \"../app-oc/index.html#/specialist/input/\" + kqiModelId + \"/3\";\n      } else if(flag == 'freestyle') {\n        window.location.href = \"../app-free-style/index.html\";\n      } else {\n        window.location.href = \"../app-oc/index.html#/resource_type\";\n      }*/\n    };\n\n    rootScope.dirty = viewId == undefined && modelId == undefined && projectId == undefined && resourceId == undefined;\n    loadedView = {\n      layout: {\n        id: $randomString(32),\n        type: 'column',\n        children: [],\n        col: 12\n      },\n      setting: {\n        \"showNavi\": false,\n        \"style\": {\n          \"padding\": \"5px\"\n        }\n      }\n    };\n\n    var reconstruct = function reconstruct(target, callback) {\n      target.traveseByChild(function (element) {\n        if (element.onChange) {\n          element.onChange = eval(element.onChange);\n        }\n\n        if (element.type == \"map\") {\n          element.source = \"BMAP\";\n        }\n\n        if (element.type == \"mapchart\") {\n          element.source = \"MAP\";\n        }\n\n        if (element.source) {\n          var source = element.source;\n\n          if (_typeof(source) == \"object\") {\n            source = element.source = \"LISTTABLE\";\n          }\n\n          var sourceMode = freeBoardValue[source].$clone();\n\n          var loop = function loop(attr, val) {\n            var sample = [\"data\", \"parameters\", \"advance\"];\n\n            if (sample.indexOf(attr) != -1) {\n              var loop = function loop(at, val) {\n                if (element.$attr(attr + \"/\" + at) == undefined) {\n                  element.$attr(attr + \"/\" + at, val);\n                }\n              };\n\n              for (var i in val) {\n                loop(i, val[i]);\n              }\n            } else {\n              if (element.$attr(attr) == undefined) {\n                element.$attr(attr, val);\n              }\n            }\n          };\n\n          for (var i in sourceMode) {\n            loop(i, sourceMode[i]);\n          }\n\n          if (element.source == \"TOPO\") {\n            var viewId = element.viewId;\n            viewFlexService.getViewById(viewId, function (event) {\n              if (event.code == 0 && event.data) {\n                var json = JSON.parse(event.data.content);\n                element.JSON = json;\n              }\n            });\n          }\n        }\n\n        element.id = $randomString(32);\n      });\n      replaceCiKpi.call(target, function () {\n        timeout(function () {\n          if (typeof callback == \"function\") {\n            callback();\n          } else {\n            renderDataFn();\n          }\n        });\n      });\n    };\n\n    function toolbar(data) {\n      this.$clone(data);\n    }\n\n    toolbar.prototype.click = function () {\n      scope.toolbarDetail = this.$clone();\n      scope.toolbarDetail.sub = scope.toolbarDetail.sub.map(function (element) {\n        return new subtoolbar(element);\n      });\n    };\n\n    function subtoolbar(data) {\n      this.$clone(data);\n    }\n\n    subtoolbar.prototype.click = function () {\n      var cur = this;\n      var source = this.source;\n      var json = window.freeBoardValue[source];\n      var templateInx = this.template;\n\n      var getTemplate = function getTemplate(inx) {\n        return json.template[inx];\n      };\n\n      var setTemplate = function setTemplate(template) {\n        json.echart = template.echart;\n        json.style = template.style;\n      };\n\n      var seleteTemplate = getTemplate(templateInx);\n      setTemplate(seleteTemplate);\n      json.id = $randomString(32);\n      scope.toolbarDetail = undefined;\n      var source = json.source;\n\n      if (source) {\n        json.label = window.freeBoardValue[source].label;\n      }\n\n      var rs = remapData(json);\n      scope.$broadcast(\"viewChanged\");\n      curLayout().layout.children.push(rs);\n      renderDataFn(false);\n      rootScope.dirty = true;\n    };\n\n    saveToManagement = routeParams.saveToManagement;\n\n    function initData() {\n      this.traverse(function (attr, element) {\n        if (element.hasOwnProperty(\"__onChange__\")) {\n          element.onChange = eval(element[\"__onChange__\"]);\n          element.oldValue = element.value;\n        }\n      });\n    }\n\n    function renderDataFn(bool) {\n      if (scope.tabIndex == undefined) {\n        scope.instance.setMode(bool);\n        scope.instance.setButtonDisable();\n        scope.instance.renderLayout(scope.editData, null, scope); //scope.editData.renderBoard(bool);\n      } else {\n        var clone = {\n          layout: scope.editData.groups[scope.tabIndex].layout,\n          setting: scope.editData.setting\n        };\n        scope.instance.setMode(bool);\n        scope.instance.setButtonDisable();\n        scope.instance.renderLayout(clone, null, scope); //clone.renderBoard(bool);\n      }\n    }\n\n    function anchorChange() {\n      var value = this.value,\n          oldValue = this.oldValue;\n      curLayout().layout.traveseByChild(function (element) {\n        if (element.$attr(\"attributes/linkData/value\") == oldValue) {\n          element.$attr(\"attributes/linkData/value\", value);\n        }\n      });\n    }\n\n    function setting(data) {\n      this.$clone(data);\n    }\n\n    setting.prototype.close = function () {\n      if (scope.firstCreate == true) {\n        exit();\n      } else {\n        delete scope.setting;\n      }\n    };\n\n    setting.prototype.save = function () {\n      rootScope.dirty = true;\n      var json = JSONparse(scope.setting.data);\n      json.theme = scope.setting.theme;\n      scope.editData.setting = JSON.stringify(json, null, 2);\n      scope.firstCreate = false;\n      delete scope.setting;\n\n      if (scope.editData.groups == undefined) {\n        var target = scope.editData.layout;\n        replaceCiKpi.call(target, function () {\n          timeout(function () {\n            if (scope.mode == 'EDIT') {\n              renderDataFn();\n            } else {\n              renderDataFn(true);\n            }\n          });\n        });\n      } else {\n        var loop = function loop(index, item) {\n          var target = item.layout,\n              callback;\n\n          if (index == scope.tabIndex) {\n            callback = function callback() {\n              timeout(function () {\n                if (scope.mode == 'EDIT') {\n                  renderDataFn();\n                } else {\n                  renderDataFn(true);\n                }\n              });\n            };\n          } else {\n            callback = function callback() {};\n          }\n\n          replaceCiKpi.call(target, callback);\n        };\n\n        for (var i in scope.editData.groups) {\n          loop(i, scope.editData.groups[i]);\n        }\n      }\n    };\n\n    groupModels = [];\n    Info.get(path, function (info) {\n      window.freeBoardValue = info.freeBoardValue;\n      var inx = 0;\n      window.template = info.templates.map(function (element) {\n        element.id = inx;\n        inx++;\n        return element;\n      });\n      initData.call(freeBoardValue);\n\n      rootScope.settingDashboard = function () {\n        if (scope.editData.setting == undefined) {\n          scope.editData.setting = {\n            padding: 15\n          };\n        }\n\n        scope.setting = new setting({\n          theme: JSONparse(scope.editData.setting).theme || \"default\",\n          data: scope.editData.setting\n        });\n      };\n\n      rootScope.previewDashboard = function () {\n        if (viewId) {\n          window.open(\"../app-free-style/index.html#/\" + viewId, \"_blank\");\n        } else {\n          growl.warning(\"保存之后才可以预览！您可以进入预览模式预览！\", {});\n        }\n      };\n\n      rootScope.helpFun = function () {\n        window.open(\"../app-free-style/index.html#/help\", \"_blank\");\n      };\n\n      if (rootScope.viewmode == 'editor') {\n        /**\n        scope.toolBarList = toolBarList.map(function(element) {\n          return new toolbar(element);\n        });\n         **/\n      }\n\n      scope.titleComposory = true;\n\n      if (solutionId && serviceViewId) {\n        scope.titleComposory = false;\n        solutionUIService.getManageViewContent(solutionId, function (event) {\n          if (event.code == \"0\") {}\n        });\n      } else {\n        var types = [\"dashboard\", \"designView\", \"configure\"];\n        var typeVars = [\"dashboardViews\", \"designView\", \"configure\"];\n        var start = 0;\n\n        var finished = function finished() {\n          if (rootScope.viewmode == 'freeboard' || rootScope.viewmode == 'template') {\n            allGraphViews = scope.dashboardViews;\n          } else if (rootScope.viewmode == 'editor' || rootScope.viewmode == 'specialist') {\n            allGraphViews = scope.designView;\n          }\n\n          allViews = allGraphViews.filter(function (view) {\n            return view.viewId != viewId;\n          });\n          /**\n                       window.specialistView = allGraphViews.filter(function(element){\n              var fd = false;\n              if(element.template){\n                fd = element.template.resourceType == \"kqiModel\";\n              }\n              return fd;\n            });*/\n\n          window.specialistView = [];\n          kqiManagerUIService.getKqiModels(function (event) {\n            if (event.code == 0) {\n              window.specialistView = event.data.filter(function (elem) {\n                var some = allGraphViews.some(function (view) {\n                  var fd = false;\n\n                  if (view.template) {\n                    if (view.template.resourceType == \"kqiModel\") {\n                      fd = view.template.resourceId == elem.id;\n                    }\n                  }\n\n                  return fd;\n                });\n                return some;\n              }).map(function (elem) {\n                var find = allGraphViews.find(function (view) {\n                  var fd = false;\n\n                  if (view.template) {\n                    if (view.template.resourceType == \"kqiModel\") {\n                      fd = view.template.resourceId == elem.id;\n                    }\n                  }\n\n                  return fd;\n                });\n                elem.url = JSON.parse(elem.viewContent).thumb;\n                elem.viewId = find.viewId;\n                return elem;\n              });\n            }\n          });\n          /**\n                       for(var i in window.specialistView){\n              var kqiModelId = window.specialistView[i].template.resourceId;\n              (function(inx, tg){\n                kqiManagerUIService.getKqiModelById(kqiModelId, function(event){\n                  if(event.code == \"0\"){\n                    if(event.data){\n                      var json = JSON.parse(event.data.viewContent);\n                      window.specialistView[inx].label = event.data.label;\n                      window.specialistView[inx].url = json.thumb;\n                    } else {\n                       \n                      window.specialistView.$remove(function(idex, elem){\n                        return tg == elem;\n                      })\n                    };\n                  }\n                })\n              })(i, window.specialistView[i]);\n            };*/\n\n          var contiFn = function contiFn() {\n            scope.globalModel = {\n              open: false,\n              click: function click() {\n                var self = this;\n                this.open = !this.open;\n\n                var click = function click(event) {\n                  scope.$apply(function () {\n                    self.open = false;\n                  });\n                };\n\n                $(\"body\").on(\"click.whole\", click);\n              },\n              subclick: function subclick(model) {\n                this.open = !this.open;\n                this.model = model;\n              }\n            };\n            init(function () {\n              if (solutionId && serviceViewId) {\n                scope.titleComposory = false;\n                solutionUIService.getManageViewContent(solutionId, getDashboardSolution);\n              } else {\n                if (scope.viewmode == \"template\") {\n                  callback();\n\n                  if (currentView) {\n                    scope.viewId = currentView.viewId;\n                  }\n                } else if (scope.viewmode == \"specialist\") {\n                  callback();\n\n                  if (currentView) {\n                    scope.viewId = currentView.viewId;\n                  }\n                } else {\n                  if (viewId) {\n                    scope.viewId = viewId;\n                    callback();\n                  } else {\n                    callbackTopo();\n                  }\n                }\n              }\n            });\n          };\n\n          var find;\n\n          var viewFound = function viewFound(find) {\n            if (find) {\n              viewFlexService.getViewById(find.viewId, function (event) {\n                if (event.code == 0) {\n                  currentView = event.data;\n                  contiFn();\n                }\n              });\n            } else {\n              contiFn();\n            }\n          };\n\n          configUIService.getConfigsByGroupName(\"Dashboard_template\", function (event) {\n            if (event.code) {\n              dashboardTemplate = event.data;\n\n              if (scope.viewmode == \"template\") {\n                viewFlexService.getDefaultView(modelId, function (event) {\n                  if (event.code == 0) {\n                    var allDefaultViews = event.data;\n                    find = allDefaultViews.find(function (elem) {\n                      if (elem.template) {\n                        if (elem.template.keyValue == \"default\") {\n                          if (scope.templateType == \"model\") {\n                            return elem.template.resourceId == modelId;\n                          } else if (scope.templateType == \"project\") {\n                            return elem.template.resourceId == projectId;\n                          } else if (scope.templateType == \"device\") {\n                            return elem.template.resourceId == resourceId;\n                          } else {\n                            return false;\n                          }\n                        } else {\n                          return false;\n                        }\n                      } else {\n                        return false;\n                      }\n                    });\n                    viewFound(find);\n                  }\n                });\n              } else if (scope.viewmode == \"specialist\") {\n                find = allGraphViews.find(function (element) {\n                  var fd = false;\n\n                  if (element.template) {\n                    if (element.template.resourceType == \"kqiModel\") {\n                      fd = element.template.resourceId == kqiModelId;\n                    }\n                  }\n\n                  return fd;\n                });\n                viewFound(find);\n              } else {\n                find = allGraphViews.find(function (element) {\n                  return element.viewId == viewId;\n                });\n                viewFound(find);\n              }\n            }\n          });\n        };\n\n        var loop = function loop(inx) {\n          if (inx < types.length) {\n            var viewtype = types[inx];\n            viewFlexService.getManagedViewsByTypeAndRole(viewtype, function (event) {\n              if (event.code == 0) {\n                scope[typeVars[inx]] = event.data;\n              }\n\n              loop(inx + 1);\n            });\n          } else {\n            finished();\n          }\n        };\n\n        loop(start);\n      }\n\n      function callback() {\n        var topo = scope.configure.map(function (element) {\n          return {\n            label: element.viewTitle,\n            type: \"topo\",\n            render: \"text\",\n            viewId: element.viewId,\n            $CLASS: \"item\"\n          };\n        });\n        var dview = scope.dashboardViews.map(function (element) {\n          return {\n            label: element.viewTitle,\n            type: \"dashboard\",\n            render: \"text\",\n            viewId: element.viewId,\n            $CLASS: \"item\"\n          };\n        });\n        var desview = scope.designView.map(function (element) {\n          return {\n            label: element.viewTitle,\n            type: \"designView\",\n            render: \"text\",\n            viewId: element.viewId,\n            $CLASS: \"item\"\n          };\n        });\n        var map = dashboardTemplate.map(function (elem) {\n          var json = JSON.parse(elem.value);\n          var type = \"template_\" + elem.id;\n          json.type = type;\n          json.label = elem.label;\n          json.$CLASS = \"item\";\n          json.render = \"edit\"; //toolbarListService[1].sub.push(json)\n\n          return json;\n        });\n        Array.prototype.push.apply(scope.toolbarListMap[1].sub, map);\n        scope.toolbarListMap[2].sub[0].sub = dview;\n        scope.toolbarListMap[2].sub[0].sub = dview;\n        scope.toolbarListMap[2].sub[1].sub = topo;\n        scope.toolbarListMap[2].sub[2].sub = desview;\n        scope.toolbarListMap = renderToolbar(scope.toolbarListMap);\n\n        if (currentView) {\n          scope.viewTitle = currentView.viewTitle;\n          rootScope.editorSubTitle = \"[\" + scope.viewTitle + \"]\";\n          scope.description = currentView.description;\n          scope.titleChange(); // if (viewId) {\n          //   rootScope.dirty = true;\n          // } else {\n          //   rootScope.dirty = false;\n          // }\n\n          getDashboard();\n        } else {\n          rootScope.editorSubTitle = \"[新建视图]\";\n        }\n      }\n\n      function callbackTopo() {\n        scope.viewTitle = '';\n        scope.titleChange();\n        /**\n                   scope.dashboardViews = allGraphViews.filter(function(element){\n            if(element.viewType == \"dashboard\")\n            {\n              var dt = JSON.parse(element.content);\n              element.JSON = dt;\n            }\n            return element.viewType == \"dashboard\";\n          });\n                   scope.configure = allGraphViews.filter(function(element){\n            if(element.viewType == \"configure\")\n            {\n              var dt = JSON.parse(element.content);\n              element.JSON = dt;\n            }\n            return element.viewType == \"configure\";\n          });\n                   */\n\n        var topo = scope.configure.map(function (element) {\n          return {\n            label: element.viewTitle,\n            type: \"topo\",\n            render: \"text\",\n            viewId: element.viewId,\n            $CLASS: \"item\"\n          };\n        });\n        var dview = scope.dashboardViews.map(function (element) {\n          return {\n            label: element.viewTitle,\n            type: \"dashboard\",\n            render: \"text\",\n            viewId: element.viewId,\n            $CLASS: \"item\"\n          };\n        });\n        var desview = scope.designView.map(function (element) {\n          return {\n            label: element.viewTitle,\n            type: \"designView\",\n            render: \"text\",\n            viewId: element.viewId,\n            $CLASS: \"item\"\n          };\n        });\n        var map = dashboardTemplate.map(function (elem) {\n          var json = JSON.parse(elem.value);\n          var type = \"template_\" + elem.id;\n          json.type = type;\n          json.label = elem.label;\n          json.$CLASS = \"item\";\n          json.render = \"text\"; //toolbarListService[1].sub.push(json)\n\n          return json;\n        });\n        scope.toolbarListMap[2].sub[0].sub = dview;\n        scope.toolbarListMap[2].sub[1].sub = topo;\n        scope.toolbarListMap[2].sub[2].sub = desview;\n        scope.toolbarListMap = renderToolbar(scope.toolbarListMap);\n      }\n    });\n    /**\n           serviceCenterService.groupModels.getAll().then(function success(data) {\n      groupModels = data.map(function (element) {\n      return {\n        value: element.id,\n        label: element.label\n      }\n    });\n    }, function error(data){\n     });*/\n\n    function folder() {}\n\n    folder.prototype.click = function () {\n      var tmp = this.fold;\n\n      for (var i in this.parent) {\n        this.parent[i].fold = true;\n      }\n\n      this.fold = !tmp;\n    };\n\n    folder.prototype.fold = true;\n\n    function item() {}\n\n    item.prototype.click = function () {\n      var tmp = this.show;\n\n      if (this.render != \"text\" || this.message) {\n        for (var i in this.parent) {\n          this.parent[i].show = false;\n        }\n\n        this.show = !tmp;\n      }\n    };\n\n    item.prototype.show = false;\n\n    scope.removeConfigClick = function (item) {\n      var id = item.type.split(\"template_\")[1];\n      var inx = scope.toolbarListMap[1].sub.indexOf(item);\n      scope.toolbarListMap[1].sub.splice(inx, 1);\n      configUIService.deleteConfig(id, function (event) {\n        if (event.code == 0) {}\n      });\n    };\n\n    function renderToolbar(data) {\n      var rs;\n\n      if (_typeof(data) == 'object' && data != null) {\n        rs = new data.constructor();\n      } else {\n        rs = data;\n      }\n\n      traverse(rs, data);\n\n      function traverse(target, data) {\n        for (var i in data) {\n          if (_typeof(data[i]) == 'object' && data[i] != null) {\n            var constructor;\n\n            if (data[i].hasOwnProperty('$CLASS')) {\n              constructor = eval(data[i].$CLASS);\n            } else {\n              constructor = data[i].constructor;\n            }\n\n            target[i] = new constructor();\n            target[i].parent = target;\n            Object.defineProperty(target[i], \"parent\", {\n              enumerable: false\n            });\n            traverse(target[i], data[i]);\n          } else {\n            if (i != '$CLASS') {\n              target[i] = data[i];\n            }\n          }\n        }\n      }\n\n      return rs;\n    }\n\n    function linkOnchange() {\n      this.parent.color.value = \"#3c8dbc\";\n    }\n\n    function remapData(data) {\n      return data.$remapByChild(function (element) {\n        var source = element.source;\n\n        if (source) {\n          if (window.freeBoardValue[source]) {\n            element.label = window.freeBoardValue[source].label;\n          } else {\n            throw new Error(source + \"组件不存在\");\n          }\n        }\n\n        var rs = commonMethodService(element, scope);\n        rs.setRootTarget(scope.editData);\n        return rs;\n      });\n    }\n\n    function isObjectLike(str) {\n      var objectRegExp = new RegExp(\"^\\\\{.*\\\\}$\", \"g\");\n      return objectRegExp.test(str);\n    }\n\n    function getDashboard() {\n      var dt = function (c) {\n        if (!c) return null;\n        if (isObjectLike(c.content)) return JSON.parse(c.content);\n        return null;\n      }(currentView);\n\n      if (dt) {\n        var clone, setting;\n\n        if (currentView.viewType == 'dashboard' || currentView.viewType == 'designView' || currentView.viewType == 'serviceView') {\n          setting = dt.setting;\n\n          if (dt.groups == undefined) {\n            clone = remapData(dt.data || dt.layout);\n            scope.editData = {\n              layout: clone,\n              setting: setting\n            };\n          } else {\n            scope.editData = dt.$clone();\n\n            for (var i in scope.editData.groups) {\n              scope.editData.groups[i].layout = remapData(scope.editData.groups[i].layout);\n            }\n\n            scope.tabIndex = 0;\n          }\n        } else {\n          if (dt.rows) {\n            if (dt.rows.length == 3) {\n              clone = remapData(machineDashboard.data.$clone());\n              setting = machineDashboard.setting.$clone();\n            } else {\n              clone = remapData(standardDashboard.data.$clone());\n              setting = standardDashboard.setting.$clone();\n            }\n          } else {\n            clone = remapData(standardDashboard.data.$clone());\n            setting = standardDashboard.setting.$clone();\n            scope.editData = {\n              layout: clone,\n              setting: setting\n            };\n          }\n        }\n      } else {\n        clone = remapData(standardDashboard.data.$clone());\n        setting = standardDashboard.setting.$clone();\n        scope.editData = {\n          layout: clone,\n          setting: setting\n        };\n      }\n\n      loadedView = scope.editData.$clone();\n\n      if (scope.tabIndex == undefined) {\n        reconstruct(scope.editData.layout);\n      } else {\n        var defers = [];\n\n        for (var i in scope.editData.groups) {\n          var wait = function wait(index, tg) {\n            var df = q.defer();\n            reconstruct(tg.layout, function () {\n              df.resolve(\"success\");\n            });\n            return df.promise;\n          };\n\n          defers.push(wait(i, scope.editData.groups[i]));\n        }\n\n        q.all(defers).then(function () {\n          renderDataFn();\n        });\n      }\n    }\n\n    function getDashboardSolution(event) {\n      if (event.code) {\n        if (event.data != null) {\n          var clone,\n              dt = JSON.parse(event.data);\n\n          if (dt.version == 'V_2') {\n            currentView = event.data;\n            clone = dt;\n          } else {\n            if (serviceViewId == 201) {\n              clone = machineDashboard.$clone();\n            } else {\n              clone = standardDashboard.$clone();\n            }\n          }\n        } else {\n          if (serviceViewId == 201) {\n            clone = machineDashboard.$clone();\n          } else {\n            clone = standardDashboard.$clone();\n          }\n        }\n\n        scope.editData = {\n          layout: clone.data,\n          setting: clone.setting\n        };\n        loadedView = {\n          layout: clone.data,\n          setting: clone.setting\n        }.$clone();\n        var catchBind = {};\n        var target = curLayout().layout;\n        reconstruct(target);\n      }\n    }\n\n    Array.prototype.remove = function (elem) {\n      var find = false;\n\n      for (var i in this) {\n        if (this[i] == elem) {\n          find = true;\n        }\n\n        if (find) {\n          if (i < this.length - 1) {\n            this[i] = this[parseInt(i) + 1];\n          } else {\n            delete this[i];\n          }\n        }\n      }\n\n      if (find) {\n        this.length--;\n      }\n    };\n\n    Object.defineProperty(Array.prototype, \"remove\", {\n      enumerable: false\n    });\n\n    function modelSelector(data) {\n      if (_typeof(data) == 'object' && data != null) {\n        this.$clone(data);\n      }\n    }\n\n    modelSelector.prototype.change = function () {\n      var modelId = this.id;\n      var defer = q.defer();\n      var defera = q.defer();\n      var deferb = q.defer();\n      scope.unitFilter = \"\";\n      scope.unitFilterDisabled = false;\n      serviceCenterService.kpis.getBymodelId(modelId).then(function success(data) {\n        scope.kpis = data.map(function (elem) {\n          if (typeof elem.unit == 'string' && elem.unit != '') {\n            /** 此处一定要获取KPI列表的CLON，因为如果是获取原始列表，修改之后对象的值也会跟着修改 */\n            return elem.$clone();\n          } else {\n            elem.unit = '无';\n            return elem.$clone();\n          }\n        });\n        scope.kpiUnits = scope.kpis.reduce(function (prev, next) {\n          var some = prev.some(function (elem) {\n            return elem.value == next.unit;\n          });\n\n          if (!some) {\n            prev.push({\n              label: next.unit,\n              value: next.unit\n            });\n          }\n\n          return prev;\n        }, [{\n          label: 'all',\n          value: ''\n        }]);\n        defera.resolve(\"success\");\n      }, function error(err) {\n        if (err == 'data back is empty!!!') {\n          growl.warning(\"您通过模型ID[\", modelId, \"]并为获取任何kpi信息！\");\n        }\n      });\n      serviceCenterService.resources.getBymodelId(modelId).then(function success(data) {\n        scope.resources = data.map(function (element) {\n          return element.$clone();\n        });\n        deferb.resolve(\"success\");\n      }, function error(err) {\n        if (err == 'data back is empty!!!') {\n          growl.warning(\"您通过模型ID[\", modelId, \"]并为获取任何设备信息！\");\n        }\n      });\n      q.all([defera.promise, deferb.promise]).then(function (event) {\n        defer.resolve(\"success\");\n      });\n      return defer.promise;\n    };\n\n    scope.unitFilter = \"\";\n    scope.unitFilterDisabled = false;\n    scope.onTabClick = onTabClick;\n\n    function onTabClick(event, ui, target, parent) {\n      scope.dialog = {\n        title: {\n          label: \"标签信息\"\n        },\n        input: [{\n          \"label\": \"修改标签名称\",\n          \"value\": target.tabName,\n          \"composory\": true,\n          \"data\": \"tabName\",\n          \"type\": \"input\",\n          maxlength: 32,\n          \"events\": {\n            \"change\": function change(item) {}\n          }\n        }, {\n          \"label\": \"设为启始标签\",\n          \"value\": target.default,\n          \"composory\": false,\n          \"data\": \"default\",\n          \"type\": \"checkbox\",\n          \"maxlength\": 32,\n          \"onChange\": function onChange(item) {\n            if (item.value == false) {\n              item.value = true;\n            }\n          }\n        }],\n        fnlist: [{\n          label: \"确定\",\n          icon: \"btn btn-primary\",\n          fn: function fn() {\n            rootScope.dirty = true;\n            scope.$broadcast(\"viewChanged\");\n            var dft = scope.dialog.input[1].value;\n\n            if (dft == true) {\n              for (var i in parent.children) {\n                parent.children[i].default = false;\n              }\n\n              var inx = parent.children.indexOf(target);\n              parent.tabInx = inx;\n            }\n\n            target.tabName = scope.dialog.input[0].value;\n            target.default = dft;\n            timeout(function () {\n              renderDataFn();\n            });\n            ngDialog.close();\n          }\n        }, {\n          label: '取消',\n          icon: \"btn btn-default\",\n          fn: function fn() {\n            ngDialog.close();\n          }\n        }]\n      };\n      ngDialog.open({\n        template: '../partials/dialogue/common_dia.html',\n        className: 'ngdialog-theme-plain',\n        scope: scope\n      });\n    }\n\n    rootScope.clearDashboard = function () {\n      rootScope.dirty = true;\n      scope.$broadcast(\"viewChanged\");\n      delete scope.tabIndex;\n      scope.editData = {\n        layout: {\n          id: $randomString(32),\n          type: 'column',\n          children: [],\n          col: 12\n        },\n        setting: {\n          \"showNavi\": false,\n          \"style\": {\n            \"padding\": \"5px\"\n          }\n        }\n      };\n      timeout(function () {\n        renderDataFn();\n      });\n    };\n\n    rootScope.resetDashboard = function () {\n      rootScope.dirty = true;\n      scope.$broadcast(\"viewChanged\");\n      scope.editData = loadedView.$clone();\n      var target = curLayout().layout;\n      reconstruct(target);\n      timeout(function () {\n        if (status == \"PREV\") {\n          renderDataFn(true); //scope.editData.renderBoard(true);\n        } else {\n          renderDataFn(); //scope.editData.renderBoard();\n        }\n      });\n    };\n\n    rootScope.panelCancel = panelCancel;\n\n    function panelCancel() {\n      scope.unitFilter = \"\";\n      scope.unitFilterDisabled = false;\n      scope.dataPanel = undefined;\n      scope.editPanel = undefined;\n      scope.resources = undefined;\n      scope.kpis = undefined;\n    }\n\n    scope.switchToData = function () {\n      var temp = scope.editPanel;\n      scope.editPanel = undefined;\n      timeout(function () {\n        dataPanelShow(temp);\n      }, 400);\n      rootScope.panelClose = panelCloseData;\n\n      function panelCloseData() {\n        rootScope.dirty = true;\n        scope.$broadcast(\"viewChanged\");\n        var temp = scope.dataPanel;\n        delete scope.dataPanel;\n        scope.selectData.$extension(temp); //scope.editData.renderBoard();\n\n        renderDataFn();\n        timeout(function () {\n          var rs = [{\n            label: '不使用链接',\n            value: 'none'\n          }],\n              rsTarget = [];\n          scope.editPanel = scope.selectData.$clone();\n          var filter = scope.resources.filter(function (element) {\n            return element.checked == true;\n          });\n          scope.editPanel.data.resource = filter;\n\n          if (scope.editPanel.data.resource && scope.editPanel.data.kpi) {\n            for (var i in scope.editPanel.attributes) {\n              if (scope.editPanel.attributes[i].data) {\n                if (scope.editPanel.attributes[i].data.value == 'none') {\n                  scope.editPanel.attributes[i].data.value = scope.editPanel.attributes[i].data.option[1].value;\n                }\n              }\n            }\n\n            if (scope.editPanel.valueGroup) {\n              scope.editPanel.valueGroup.data.value = \"value\";\n            }\n          } else {\n            for (var i in scope.editPanel.attributes) {\n              if (scope.editPanel.attributes[i].data) {\n                if (scope.editPanel.attributes[i].data.value != 'none') {\n                  scope.editPanel.attributes[i].data.value = 'none';\n                }\n              }\n            }\n\n            if (scope.editPanel.valueGroup) {\n              scope.editPanel.valueGroup.data.value = \"custom\";\n            }\n          }\n\n          rootScope.panelClose = function () {\n            scope.selectData.$extension(scope.editPanel);\n            curLayout().layout.traveseByChild(function (element) {\n              if (element.$attr(\"attributes/anchor/applied\") == true) {\n                var val = element.$attr(\"attributes/anchor/value\");\n\n                if (typeof val == 'string' && val != '') {\n                  rs.push({\n                    label: element.$attr(\"attributes/anchor/value\"),\n                    value: element.$attr(\"attributes/anchor/value\")\n                  });\n                  rsTarget[element.$attr(\"attributes/anchor/value\")] = element.data;\n                }\n              }\n            });\n            curLayout().layout.traveseByChild(function (element) {\n              var link = element.$attr(\"attributes/linkData/value\");\n\n              if (link != 'none' && link != undefined) {\n                element.data = rsTarget[link];\n\n                if (element.$attr(\"data/resource\") && element.$attr(\"data/kpi\")) {\n                  for (var i in element.attributes) {\n                    if (element.attributes[i].data) {\n                      if (element.attributes[i].data.value == 'none') {\n                        element.attributes[i].data.value = element.attributes[i].data.option[1].value;\n                      }\n                    }\n                  }\n\n                  if (element.valueGroup) {\n                    element.valueGroup.data.value = \"value\";\n                  }\n                } else {\n                  for (var i in element.attributes) {\n                    if (element.attributes[i].data) {\n                      if (element.attributes[i].data.value != 'none') {\n                        element.attributes[i].data.value = 'none';\n                      }\n                    }\n                  }\n\n                  if (element.valueGroup) {\n                    element.valueGroup.data.value = \"custom\";\n                  }\n                }\n\n                element.data = rsTarget[link];\n              }\n            });\n            scope.anchors = rs;\n            renderDataFn(); //scope.editData.renderBoard();\n\n            scope.unitFilter = \"\";\n            scope.unitFilterDisabled = false;\n            scope.dataPanel = undefined;\n            scope.editPanel = undefined;\n            scope.resources = undefined;\n            scope.kpis = undefined;\n          };\n        }, 400);\n      }\n    };\n\n    function dataPanelShow(temp) {\n      scope.dataPanel = temp.$clone();\n      scope.dataPanel.data.model = scope.allModels.find(function (element) {\n        return element.id == scope.dataPanel.data.model.id;\n      });\n      scope.dataPanel.data.model.change().then(function success() {\n        for (var i in scope.resources) {\n          var some = false;\n\n          if (scope.dataPanel.data.resource) {\n            some = scope.dataPanel.data.resource.some(function (elem) {\n              return scope.resources[i].id == elem.id;\n            });\n          }\n\n          scope.resources[i].checked = some;\n        }\n\n        for (var i in scope.kpis) {\n          var find;\n\n          if (scope.dataPanel.data.kpi) {\n            find = scope.dataPanel.data.kpi.find(function (elem) {\n              return scope.kpis[i].id == elem.id;\n            });\n          }\n\n          if (find) {\n            scope.unitFilter = find.unit;\n            scope.unitFilterDisabled = true;\n          }\n\n          scope.kpis[i].checked = find != undefined;\n        }\n      });\n    }\n\n    scope.switchToEdit = function () {\n      var temp = scope.dataPanel;\n      scope.dataPanel = undefined;\n      timeout(function () {\n        scope.editPanel = temp;\n      }, 400);\n    };\n\n    scope.groupAdd = function (list) {\n      var clone = list[0].$clone();\n      var value = [];\n\n      for (var i in clone.attributes.value.value.split(\",\")) {\n        value.push(parseInt(Math.random() * 100));\n      }\n\n      clone.attributes.value.value = value.toString();\n      list.push(clone);\n\n      for (var i in list) {\n        delete list[i]['$$hashKey'];\n        list[i].id = i;\n      }\n    };\n\n    scope.groupRemove = function (target, list) {\n      if (list.length > 1) {\n        list.$remove(function (index, element) {\n          return target.id == element.id;\n        });\n\n        for (var i in list) {\n          list[i].id = i;\n        }\n      }\n    };\n\n    scope.dataTypeChange = function (data, editPanel) {\n      if (data.value != \"none\") {\n        if (editPanel.data.resource == undefined || editPanel.data.kpi == undefined) {\n          var temp = scope.editPanel;\n          scope.editPanel = undefined;\n          timeout(function () {\n            dataPanelShow(temp);\n          }, 400);\n          rootScope.panelClose = panelCloseData;\n        }\n      }\n\n      function panelCloseData() {\n        if (scope.dataPanel.data.resource && scope.dataPanel.data.kpi) {\n          var temp = scope.dataPanel;\n          scope.selectData.$clone(temp);\n          scope.dataPanel = undefined;\n          renderDataFn(); //scope.editData.renderBoard();\n\n          timeout(function () {\n            rootScope.panelClose = function () {\n              scope.editPanel.$clone(scope.selectData);\n              scope.unitFilter = \"\";\n              scope.unitFilterDisabled = false;\n              scope.dataPanel = undefined;\n              scope.editPanel = undefined;\n              scope.resources = undefined;\n              scope.kpis = undefined;\n            };\n          }, 400);\n        } else {\n          data.value = \"none\";\n        }\n\n        scope.unitFilter = \"\";\n        scope.unitFilterDisabled = false;\n        scope.dataPanel = undefined;\n        scope.editPanel = undefined;\n        scope.resources = undefined;\n        scope.kpis = undefined;\n      }\n    };\n\n    rootScope.exitDashboard = function () {\n      if (rootScope.dirty) {\n        var fnlist = [{\n          label: '不保存',\n          icon: 'btn btn-default pull-left',\n          style: {\n            width: '50%',\n            'border-radius': 0,\n            'font-size': '18px',\n            'font-weight': 'bold',\n            'padding': 10\n          },\n          fn: function fn() {\n            exit();\n          }\n        }, {\n          label: '取消',\n          icon: 'btn btn-cancel',\n          style: {\n            width: '50%',\n            'border-radius': 0,\n            'font-size': '18px',\n            'font-weight': 'bold',\n            'padding': 10\n          },\n          fn: function fn() {\n            scope.dialogBox = undefined;\n          }\n        }, {\n          label: '保存',\n          icon: 'btn btn-success',\n          disabled: scope.inputCheck.correct != true,\n          style: {\n            width: '50%',\n            'border-radius': 0,\n            'font-size': '18px',\n            'font-weight': 'bold',\n            'padding': 10\n          },\n          fn: function fn() {\n            rootScope.saveDashboard(exit);\n          }\n        }];\n        scope.dialogBox = {\n          title: {\n            label: '退出编辑器'\n          },\n          description: {\n            label: '尚有未保存的修改，是否保存？'\n          },\n          fnlist: fnlist\n        };\n      } else {\n        exit();\n      }\n    };\n\n    scope.titleChange = function () {\n      if (allViews) {\n        rootScope.inputCheck = check();\n      } else {\n        viewFlexService.getAllMyViews(function (event) {\n          if (event.code == '0') {\n            if (rootScope.viewmode == 'freeboard') {\n              allViews = event.data.filter(function (element) {\n                return element.viewType == \"dashboard\" && element.viewId != viewId;\n              });\n\n              for (var i in allViews) {\n                var dt = JSON.parse(allViews[i].content);\n                allViews[i].JSON = dt;\n              }\n            } else {\n              allViews = event.data.filter(function (element) {\n                return element.viewType == \"designView\" && element.viewId != viewId;\n              });\n\n              for (var i in allViews) {\n                var dt = JSON.parse(allViews[i].content);\n                allViews[i].JSON = dt;\n              }\n            }\n\n            rootScope.inputCheck = check();\n          }\n        });\n      }\n\n      function check() {\n        var find = allViews.filter(function (element) {\n          var rs;\n\n          if (currentView) {\n            rs = element.viewTitle == scope.viewTitle && element.viewTitle != currentView.viewTitle;\n          } else {\n            rs = element.viewTitle == scope.viewTitle;\n          }\n\n          return rs;\n        });\n        var num = $$.switchToNumber(scope['viewTitle'].length);\n\n        if (scope.titleComposory) {\n          if (num == 0) {\n            return {\n              correct: false,\n              icon: 'glyphicon-warning-sign',\n              msg: '不可为空',\n              style: {\n                color: 'red'\n              }\n            };\n          } else if (num > 32) {\n            return {\n              correct: false,\n              icon: 'glyphicon-remove',\n              msg: '不可超过32字符',\n              style: {\n                color: 'red'\n              }\n            };\n          } else if (find.length > 0) {\n            return {\n              correct: false,\n              icon: 'glyphicon-remove',\n              msg: '错误 : 该视图名已被占用',\n              style: {\n                color: 'red'\n              }\n            };\n          } else {\n            return {\n              correct: true,\n              icon: 'glyphicon-ok',\n              msg: '正确',\n              style: {\n                color: 'green'\n              }\n            };\n          }\n        } else {\n          return {\n            correct: true,\n            icon: 'glyphicon-ok',\n            msg: '正确',\n            style: {\n              color: 'green'\n            }\n          };\n        }\n      }\n    };\n\n    function refineDataStructure() {\n      this.traveseByChild(function (element) {\n        delete element.id;\n\n        if (element.$$hashKey) {\n          delete element.$$hashKey;\n        }\n\n        if (element.JSON) {\n          delete element.JSON;\n        }\n\n        if (element.type == \"injector\") {\n          element.children = [];\n        }\n\n        if (element.hasOwnProperty(\"tabInx\")) {\n          delete element.tabInx;\n        }\n\n        if (element.hasOwnProperty(\"template\")) {\n          delete element.template;\n        }\n\n        if (element.hasOwnProperty(\"$index\")) {\n          delete element.$index;\n        }\n\n        if (element.hasOwnProperty(\"id\")) {\n          delete element.id;\n        }\n\n        if (element.data) {\n          if (element.data.model) {\n            if (_typeof(element.data.model) == \"object\") {\n              element.data.model = {\n                id: element.data.model.id\n              };\n            }\n          }\n\n          if (element.data.legend) {\n            if (typeof element.data.legend.manual == \"function\") {\n              element.data.legend.manual = \"(\" + element.data.legend.manual.toString() + \")\";\n            }\n\n            if (typeof element.data.legend.bind == \"function\") {\n              element.data.legend.bind = \"(\" + element.data.bind.manual.toString() + \")\";\n            }\n          }\n\n          if (element.data.xAxis) {\n            if (typeof element.data.xAxis.manual == \"function\") {\n              element.data.xAxis.manual = \"(\" + element.data.xAxis.manual.toString() + \")\";\n            }\n\n            if (typeof element.data.xAxis.bind == \"function\") {\n              element.data.xAxis.bind = \"(\" + element.data.xAxis.bind.toString() + \")\";\n            }\n          }\n\n          if (element.data.series) {\n            if (typeof element.data.series.manual == \"function\") {\n              element.data.series.manual = \"(\" + element.data.series.manual.toString() + \")\";\n            }\n\n            if (typeof element.data.series.bind == \"function\") {\n              element.data.series.bind = \"(\" + element.data.series.bind.toString() + \")\";\n            }\n          }\n\n          if (element.data.resource) {\n            element.data.resource = element.data.resource.map(function (elem) {\n              if ($$.noEmptyObject(elem) && $$.noEmptyObject(rootCi)) {\n                if (elem.id == rootCi.id) {\n                  return \"rootCi\";\n                } else {\n                  return elem.id;\n                }\n              } else {\n                return elem;\n              }\n            });\n          }\n\n          if (element.data.kpi) {\n            element.data.kpi = element.data.kpi.map(function (elem) {\n              if ($$.noEmptyObject(elem)) {\n                return elem.id;\n              } else {\n                return elem;\n              }\n            });\n          }\n\n          if (element.data.kqiModel) {\n            if (_typeof(element.data.kqiModel) == \"object\") {\n              element.data.kqiModel = {\n                id: element.data.kqiModel.id\n              };\n            }\n          }\n        }\n\n        if (element.attributes) {\n          for (var i in element.attributes) {\n            var reset = {\n              value: element.attributes[i].value\n            };\n\n            if (element.attributes[i].applied != undefined) {\n              reset.applied = element.attributes[i].applied;\n            }\n\n            if (element.attributes[i].data) {\n              reset.$extension({\n                data: {\n                  value: element.attributes[i].data.value\n                }\n              });\n            }\n\n            element.attributes[i] = reset;\n          }\n        }\n      });\n    }\n\n    rootScope.saveAsServiceView = function (callback) {\n      rootScope.dirty = false;\n\n      if (!scope.titleComposory || typeof scope.viewTitle == 'string' && scope.viewTitle != '') {\n        if (scope.tabIndex == undefined) {\n          var savedata = scope.editData.$clone();\n          refineDataStructure.call(savedata.layout);\n          var content = {\n            version: 'V_2',\n            layout: savedata.layout,\n            setting: savedata.setting\n          };\n        } else {\n          var savedata = scope.editData.$clone();\n\n          for (var i in savedata.groups) {\n            refineDataStructure.call(savedata.groups[i].layout);\n            var content = {\n              version: 'V_2',\n              groups: savedata.groups,\n              setting: savedata.setting\n            };\n          }\n        } // \n\n\n        var param = {\n          viewTitle: scope.viewTitle.length > 30 ? scope.viewTitle.slice(0, 30) : scope.viewTitle,\n          content: JSON.stringify(content)\n        };\n        param.$extension({\n          viewName: 'serviceView',\n          viewType: 'serviceView'\n        });\n        viewFlexService.addView(param, function (event) {\n          if (event.code == 0) {\n            growl.success(\"服务视图另存成功\", {});\n            location.path(rootScope.viewmode + \"/\" + scope.viewtype + \"/\" + flag + \"/\" + event.data.viewId);\n            scope.viewId = event.data.viewId;\n\n            if (callback) {\n              callback();\n            }\n          }\n        });\n      } else {\n        growl.error(\"视图名不能为空！\", {});\n      }\n    };\n\n    rootScope.saveDashboard = function (callback) {\n      rootScope.dirty = false;\n\n      if (!scope.titleComposory || typeof scope.viewTitle == 'string' && scope.viewTitle != '') {\n        if (scope.tabIndex == undefined) {\n          var savedata = scope.editData.$clone();\n          loadedView = scope.editData.$clone();\n          refineDataStructure.call(savedata.layout); //refineDataStructure.call(loadedView);\n\n          var content = {\n            version: 'V_2',\n            layout: savedata.layout,\n            setting: savedata.setting\n          };\n        } else {\n          var savedata = scope.editData.$clone();\n\n          for (var i in savedata.groups) {\n            refineDataStructure.call(savedata.groups[i].layout);\n            var content = {\n              version: 'V_2',\n              groups: savedata.groups,\n              setting: savedata.setting\n            };\n          }\n        }\n\n        if (solutionId && serviceViewId) {\n          if (scope.viewmode == 'freeboard') {\n            solutionUIService.saveManageViewContent(solutionId, JSON.stringify(content), function (event) {\n              if (event.code == 0) {\n                if (scope.viewmode == \"freeboard\") {\n                  growl.success(\"解决方案仪表板视图修改成功\", {});\n                } else {\n                  growl.success(\"解决方案分析视图修改成功\", {});\n                }\n\n                if (callback) {\n                  callback();\n                }\n              } else {\n                if (scope.viewmode == \"freeboard\") {\n                  growl.success(\"解决方案仪表板视图修改失败\", {});\n                } else {\n                  growl.success(\"解决方案分析视图修改失败\", {});\n                }\n              }\n            });\n          } else {\n            solutionUIService.saveModelDashboardViewContent(solutionId, groupId, modelId, JSON.stringify(content), function (event) {\n              if (event.code == 0) {\n                if (scope.viewmode == \"freeboard\") {\n                  growl.success(\"解决方案仪表板视图修改成功\", {});\n                } else {\n                  growl.success(\"解决方案分析视图修改成功\", {});\n                }\n\n                if (callback) {\n                  callback();\n                }\n              } else {\n                if (scope.viewmode == \"freeboard\") {\n                  growl.success(\"解决方案仪表板视图修改失败\", {});\n                } else {\n                  growl.success(\"解决方案分析视图修改失败\", {});\n                }\n              }\n            });\n          }\n        } else {\n          /**\n                       if (!content.groups) {\n            if (content.layout.children.length == 0) {\n              growl.error(\"视图内容为空!!!\");\n              throw new Error(\"视图内容为空!!!\");\n            }\n          };*/\n          loadedView = content;\n          var param = {\n            viewTitle: scope.viewTitle.length > 32 ? scope.viewTitle.slice(0, 32) : scope.viewTitle,\n            description: scope.description,\n            content: JSON.stringify(content)\n          };\n\n          if (scope.viewmode == 'freeboard') {\n            param.$extension({\n              viewName: 'dashboard',\n              viewType: 'dashboard'\n            });\n            param.template = null;\n\n            if (scope.globalModel.enable) {\n              if (scope.globalModel.model) {\n                param.template = {\n                  resourceId: scope.globalModel.model.id,\n                  resourceType: 'device'\n                };\n              }\n            }\n          } else if (scope.viewmode == 'editor') {\n            param.$extension({\n              viewName: 'designView',\n              viewType: 'designView'\n            });\n          } else if (scope.viewmode == 'service') {\n            param.$extension({\n              viewName: 'serviceView',\n              viewType: 'serviceView'\n            });\n          } else if (scope.viewmode == 'template') {\n            param.$extension({\n              viewName: 'dashboard',\n              viewType: 'dashboard'\n            });\n\n            if (scope.globalModel.enable) {\n              if (scope.globalModel.model) {\n                param.template = {\n                  resourceId: scope.globalModel.model.id,\n                  resourceType: 'device',\n                  keyValue: 'default'\n                };\n              }\n            }\n          } else if (scope.viewmode == 'specialist') {\n            param.$extension({\n              viewName: 'designView',\n              viewType: 'designView'\n            });\n            param.template = {\n              resourceId: kqiModelId,\n              resourceType: 'kqiModel'\n            };\n          }\n\n          if (scope.viewId) {\n            param.viewId = scope.viewId;\n            viewFlexService.updateView(param, function (event) {\n              if (event.code == 0) {\n                if (saveToManagement == 1) {\n                  content.viewId = scope.viewId;\n                  saveManagement(content, callback);\n                } else {\n                  if (scope.viewmode == \"freeboard\") {\n                    growl.success(\"仪表板视图修改成功\", {});\n                  } else if (scope.viewmode == 'editor') {\n                    growl.success(\"分析视图修改成功\", {});\n                  } else if (scope.viewmode == 'service') {\n                    growl.success(\"服务视图修改成功\", {});\n                  } else if (scope.viewmode == 'template') {\n                    growl.success(\"仪表板视图修改成功\", {});\n                  } else if (scope.viewmode == 'specialist') {\n                    growl.success(\"专家模版视图修改成功\", {});\n                  }\n\n                  if (callback) {\n                    callback();\n                  }\n                }\n              }\n            });\n          } else {\n            viewFlexService.addView(param, function (event) {\n              if (event.code == 0) {\n                if (scope.viewmode == \"freeboard\") {\n                  growl.success(\"仪表板视图创建成功\", {});\n                } else if (scope.viewmode == 'editor') {\n                  growl.success(\"分析视图创建成功\", {});\n                } else if (scope.viewmode == 'service') {\n                  growl.success(\"服务视图创建成功\", {});\n                } else if (scope.viewmode == 'template') {\n                  growl.success(\"仪表板视图创建成功\", {});\n                } else if (scope.viewmode == 'specialist') {\n                  growl.success(\"专家模版视图创建成功\", {});\n                }\n\n                if (rootScope.viewmode == \"template\") {\n                  viewFlexService.releaseViews([event.data.viewId], function (event) {\n                    if (event.code == 0) {\n                      location.path(rootScope.viewmode + \"/model/\" + flag + \"/\" + encodeURIComponent(JSON.stringify({\n                        modelId: modelId\n                      })));\n                    }\n                  });\n                } else if (rootScope.viewmode == \"specialist\") {\n                  viewFlexService.releaseViews([event.data.viewId], function (event) {\n                    if (event.code == 0) {\n                      location.path(rootScope.viewmode + \"/\" + flag + \"/\" + kqiModelId);\n                    }\n                  });\n                } else {\n                  location.path(rootScope.viewmode + \"/\" + scope.viewtype + \"/\" + flag + \"/\" + event.data.viewId);\n                }\n\n                scope.viewId = event.data.viewId;\n\n                if (callback) {\n                  callback();\n                }\n              }\n            });\n          }\n        }\n      } else {\n        growl.error(\"视图名不能为空！\", {});\n      }\n    };\n\n    rootScope.ModelKpiSelector = function () {\n      window.open(\"../app-free-style/index.html#/kpiselector\", \"_blank\");\n    };\n\n    keySet.onCommandKeyWith('s', function () {\n      rootScope.saveDashboard();\n    });\n    keySet.onCommandKeyWith('z', function () {\n      rootScope.backward();\n    });\n    keySet.onCommandKeyWith('y', function () {\n      rootScope.forward();\n    });\n    keySet.onCommandKeyWith('p', function () {\n      rootScope.previewDashboard();\n    });\n    keySet.onCommandKeyWith('h', function () {\n      rootScope.helpFun();\n    });\n    keySet.onCommandKeyWith('u', function () {\n      scope.openTemplate();\n    });\n    keySet.onCommandKeyWith('i', function () {\n      scope.inputJSON();\n    });\n    keySet.onCommandKeyWith('k', function () {\n      scope.ModelKpiSelector();\n    });\n\n    function saveManagement(content, callback) {\n      var param2 = {\n        viewTitle: 'dashboard',\n        viewName: 'dashboard',\n        viewType: \"dashboard\",\n        content: JSON.stringify(content)\n      };\n      viewFlexService.saveManageDashboard(param2, function (event) {\n        if (event.code == 0) {\n          growl.success(\"仪表板视图修改成功\", {});\n\n          if (callback) {\n            callback();\n          }\n        } else {\n          growl.error(\"运营首页修改失败\", {});\n          getViews();\n        }\n      });\n    }\n\n    scope.themes = [{\n      id: \"none\",\n      label: \"默认主题\"\n    }, {\n      id: \"default\",\n      label: \"系统主题\"\n    }, {\n      id: \"Cyborg\",\n      label: \"黑色主题\"\n    }, {\n      id: \"Slate\",\n      label: \"深蓝主题\"\n    }, {\n      id: \"Solar\",\n      label: \"海洋主题\"\n    }, {\n      id: \"Darkly\",\n      label: \"Darkly\"\n    }, {\n      id: \"steel\",\n      label: \"钢铁行业\"\n    }];\n\n    scope.kpiChange = function (kpi) {\n      if (scope.dataPanel.data.maxKpi == 1) {\n        for (var i in scope.kpis) {\n          if (scope.kpis[i].id != kpi.id) {\n            scope.kpis[i].checked = false;\n          } else {\n            scope.kpis[i].checked = !scope.kpis[i].checked;\n          }\n        }\n      } else {\n        kpi.checked = !kpi.checked;\n      }\n\n      var filter = scope.kpis.filter(function (element) {\n        return element.checked == true;\n      });\n\n      if (filter.length > 0) {\n        scope.unitFilter = filter[0].unit;\n        scope.unitFilterDisabled = true;\n        scope.dataPanel.data.kpi = filter;\n      } else {\n        scope.unitFilter = \"\";\n        scope.unitFilterDisabled = false;\n        scope.dataPanel.data.kpi = undefined;\n      }\n    };\n\n    scope.resourceChange = function (resource) {\n      var filter = scope.resources.filter(function (element) {\n        return !element.checked == true;\n      });\n\n      if (filter.length > 0) {\n        scope.dataPanel.data.resource = filter;\n      } else {\n        delete scope.dataPanel.data.resource;\n      }\n\n      resource.checked = !resource.checked;\n    };\n\n    function init(callback) {\n      var run = function run() {\n        var res = [],\n            allmodel = [];\n\n        for (var i = 0; i < 80; i++) {\n          var a = Math.round(Math.random() * 100);\n          var b = Math.round(Math.random() * 1000) / 100;\n          res.push([a, b]);\n        }\n\n        serviceCenterService.rootDomain.get().then(function success(data) {\n          if (data) {\n            rootCi = data;\n          }\n\n          var model = [data.modelId];\n          resourceUIService.getModelByIds(model, function (event) {\n            var rootModel = event.data[0]; //allmodel.push(rootModel);\n\n            getAllModels();\n          }, function (err) {\n            if (err.message == 'databack is undefined !!') {\n              growl.error(\"输入的模型ID获取不到模型信息。\", {});\n            }\n\n            getAllModels();\n          });\n        }, function (err) {\n          if (err.message == 'databack is undefined !!') {\n            growl.error(\"根设备不存在\", {});\n          }\n\n          rootCi = null;\n          getAllModels();\n        });\n\n        function getAllModels() {\n          var run = function run() {\n            serviceCenterService.models.getAll().then(function success(data) {\n              Array.prototype.push.apply(allmodel, data);\n              scope.allModels = allmodel.map(function (element) {\n                return new modelSelector(element);\n              });\n              var defaultModel,\n                  open = false;\n\n              if (scope.viewmode == \"template\") {\n                defaultModel = scope.allModels.find(function (elem) {\n                  return elem.id == modelId;\n                });\n                open = defaultModel ? true : false;\n              } else {\n                if (currentView) {\n                  if (currentView.hasOwnProperty(\"template\")) {\n                    defaultModel = scope.allModels.find(function (elem) {\n                      return elem.id == currentView.$attr(\"template/resourceId\");\n                    });\n                    open = defaultModel ? true : false;\n                  }\n                }\n              }\n\n              scope.globalModel.model = defaultModel;\n              scope.globalModel.enable = open;\n\n              var getToolbarList = function getToolbarList() {\n                freeBoardValue.TEXT.$extension({\n                  data: {\n                    modelType: 300,\n                    resfilltype: \"parameter\",\n                    modelDisable: rootScope.viewmode == 'freeboard'\n                  }\n                });\n                freeBoardValue.DATALIST.$extension({\n                  data: {\n                    modelType: 300,\n                    resfilltype: \"parameter\",\n                    modelDisable: rootScope.viewmode == 'freeboard'\n                  }\n                });\n                freeBoardValue.LINECHART.$extension({\n                  data: {\n                    modelType: 300,\n                    resfilltype: \"parameter\",\n                    modelDisable: rootScope.viewmode == 'freeboard'\n                  }\n                });\n                freeBoardValue.RADARCHART.$extension({\n                  data: {\n                    modelType: 300,\n                    resfilltype: \"parameter\",\n                    modelDisable: rootScope.viewmode == 'freeboard'\n                  }\n                });\n                freeBoardValue.BARCHART.$extension({\n                  attributes: {\n                    modelGroup: {\n                      applied: false,\n                      default: '不采用设备组',\n                      label: '设备组',\n                      value: groupModels[0] ? groupModels[0].value : '',\n                      type: 'select',\n                      option: groupModels\n                    }\n                  },\n                  data: {\n                    modelType: 300,\n                    resfilltype: \"parameter\",\n                    modelDisable: rootScope.viewmode == 'freeboard'\n                  }\n                });\n                freeBoardValue.GAUGECHART.$extension({\n                  data: {\n                    modelType: 300,\n                    resfilltype: \"parameter\",\n                    modelDisable: rootScope.viewmode == 'freeboard'\n                  }\n                });\n                freeBoardValue.PIECHART.$extension({\n                  data: {\n                    modelType: 300,\n                    resfilltype: \"parameter\",\n                    modelDisable: rootScope.viewmode == 'freeboard'\n                  }\n                });\n                freeBoardValue.SCATTERCHART.$extension({\n                  data: {\n                    modelType: 300,\n                    resfilltype: \"parameter\",\n                    modelDisable: rootScope.viewmode == 'freeboard'\n                  }\n                });\n                freeBoardValue.BARCHART.$extension({\n                  data: {\n                    modelType: 300,\n                    resfilltype: \"parameter\",\n                    modelDisable: rootScope.viewmode == 'freeboard'\n                  }\n                });\n                scope.tools = {\n                  grid: freeBoardValue.ROW,\n                  datalist_wrap: {\n                    \"label\": \"控制板2\",\n                    \"type\": \"box\",\n                    \"class\": \"box box-info\",\n                    \"source\": \"BOX\",\n                    \"parameters\": {\n                      \"title\": \"数据列表\"\n                    },\n                    \"style\": {\n                      \"font-size\": \"12px\",\n                      \"font-weight\": \"bold\",\n                      \"text-align\": \"left\",\n                      \"margin\": \"5px\"\n                    },\n                    children: [{\n                      type: 'box-body',\n                      children: [{\n                        type: 'column',\n                        col: 12,\n                        children: [freeBoardValue.DATALIST.$clone()]\n                      }],\n                      class: 'box-body'\n                    }, {\n                      type: 'box-footer',\n                      children: [{\n                        type: 'column',\n                        col: 12,\n                        children: []\n                      }],\n                      class: 'box-footer'\n                    }]\n                  },\n                  totalItemTemp: {\n                    label: '控制器1',\n                    type: 'row',\n                    children: [{\n                      type: 'column',\n                      col: 3,\n                      children: [freeBoardValue.TOTALITEM.$clone().$extension({\n                        attributes: {\n                          title: {\n                            data: {\n                              value: 'value'\n                            }\n                          },\n                          subtitle: {\n                            data: {\n                              value: 'kpi'\n                            }\n                          },\n                          \"unit\": {\n                            \"value\": \"个\",\n                            \"data\": {\n                              \"value\": \"none\"\n                            }\n                          },\n                          \"icon\": {\n                            \"value\": {\n                              \"perfix\": \"fa\",\n                              \"css\": \"fa-connectdevelop\",\n                              \"id\": \"0\"\n                            }\n                          },\n                          color: {\n                            value: \"#25bce7\"\n                          }\n                        },\n                        data: {\n                          modelType: 300,\n                          resfilltype: \"parameter\",\n                          kpi: [3001]\n                        }\n                      })]\n                    }, {\n                      type: 'column',\n                      col: 3,\n                      children: [freeBoardValue.TOTALITEM.$clone().$extension({\n                        attributes: {\n                          title: {\n                            data: {\n                              value: 'value'\n                            }\n                          },\n                          subtitle: {\n                            data: {\n                              value: 'kpi'\n                            }\n                          },\n                          \"unit\": {\n                            \"value\": \"个\",\n                            \"data\": {\n                              \"value\": \"none\"\n                            }\n                          },\n                          \"icon\": {\n                            \"value\": {\n                              \"perfix\": \"fa\",\n                              \"css\": \"fa-edit\",\n                              \"id\": \"2\"\n                            }\n                          },\n                          color: {\n                            value: \"#00b9b2\"\n                          }\n                        },\n                        data: {\n                          modelType: 300,\n                          resfilltype: \"parameter\",\n                          kpi: [3002]\n                        }\n                      })]\n                    }, {\n                      type: 'column',\n                      col: 3,\n                      children: [freeBoardValue.TOTALITEM.$clone().$extension({\n                        attributes: {\n                          title: {\n                            data: {\n                              value: 'value'\n                            }\n                          },\n                          subtitle: {\n                            data: {\n                              value: 'kpi'\n                            }\n                          },\n                          \"unit\": {\n                            \"label\": \"单位\",\n                            \"data\": {\n                              \"value\": \"none\"\n                            }\n                          },\n                          \"icon\": {\n                            \"label\": \"图标\",\n                            \"value\": {\n                              \"perfix\": \"fa\",\n                              \"css\": \"fa-warning\",\n                              \"id\": \"1\"\n                            }\n                          },\n                          color: {\n                            value: \"#e7675d\"\n                          }\n                        },\n                        data: {\n                          modelType: 300,\n                          resfilltype: \"parameter\",\n                          kpi: [3003]\n                        }\n                      })]\n                    }, {\n                      type: 'column',\n                      col: 3,\n                      children: [freeBoardValue.TOTALITEM.$clone().$extension({\n                        attributes: {\n                          title: {\n                            data: {\n                              value: 'value'\n                            }\n                          },\n                          subtitle: {\n                            data: {\n                              value: 'kpi'\n                            }\n                          },\n                          \"icon\": {\n                            \"value\": {\n                              \"perfix\": \"fa\",\n                              \"css\": \"fa-user\",\n                              \"id\": \"4\"\n                            }\n                          },\n                          \"unit\": {\n                            \"value\": \"条\",\n                            \"data\": {\n                              \"value\": \"none\"\n                            }\n                          },\n                          color: {\n                            value: \"#ebae0b\"\n                          }\n                        },\n                        data: {\n                          modelType: 300,\n                          resfilltype: \"parameter\",\n                          kpi: [3004]\n                        }\n                      })]\n                    }]\n                  },\n                  totalItem: freeBoardValue.TOTALITEM.$clone().$extension({\n                    data: {\n                      modelType: 300,\n                      resfilltype: \"parameter\"\n                    }\n                  }),\n                  downtab: freeBoardValue.DOWNTAB.$clone().$extension({\n                    data: {\n                      modelType: 300,\n                      resfilltype: \"parameter\"\n                    }\n                  }),\n                  mapchartTemp: {\n                    \"label\": \"控制板2\",\n                    \"type\": \"box\",\n                    \"class\": \"box box-info\",\n                    \"source\": \"BOX\",\n                    \"parameters\": {\n                      \"title\": \"标题文字\"\n                    },\n                    \"style\": {\n                      \"font-size\": \"12px\",\n                      \"font-weight\": \"bold\",\n                      \"text-align\": \"left\",\n                      \"margin\": \"5px\"\n                    },\n                    children: [{\n                      type: 'box-body',\n                      children: [{\n                        type: 'column',\n                        col: 8,\n                        children: [freeBoardValue.BMAP.$clone().$extension({\n                          style: {\n                            \"height\": \"452px\"\n                          }\n                        })]\n                      }, {\n                        type: 'column',\n                        col: 4,\n                        children: [{\n                          \"label\": \"控制板1\",\n                          \"type\": \"block\",\n                          \"source\": \"BLOCK\",\n                          \"style\": {\n                            \"margin\": \"0 5px 0 0\",\n                            \"border\": \"1px solid rgba(147,196,129,1)\",\n                            \"background-color\": \"rgba(0,185,178,1)\"\n                          },\n                          children: [{\n                            type: 'column',\n                            col: 12,\n                            children: [freeBoardValue.SPARKLINE.$clone().$extension({\n                              style: {\n                                height: \"150px\"\n                              },\n                              data: {\n                                modelType: 300,\n                                resfilltype: \"parameter\",\n                                kpi: [3005]\n                              }\n                            }), freeBoardValue.SPARKLINE.$clone().$extension({\n                              style: {\n                                height: \"150px\"\n                              },\n                              data: {\n                                modelType: 300,\n                                resfilltype: \"parameter\",\n                                kpi: [3012]\n                              }\n                            }), freeBoardValue.SPARKLINE.$clone().$extension({\n                              style: {\n                                height: \"150px\"\n                              },\n                              data: {\n                                modelType: 300,\n                                resfilltype: \"parameter\",\n                                kpi: [100005]\n                              }\n                            })]\n                          }]\n                        }]\n                      }],\n                      class: 'box-body'\n                    }, {\n                      type: 'box-footer',\n                      children: [{\n                        type: 'row',\n                        children: []\n                      }],\n                      class: 'box-footer'\n                    }]\n                  },\n                  mapchartLinkTemp: {\n                    \"label\": \"控制板2\",\n                    \"type\": \"box\",\n                    \"class\": \"box box-info\",\n                    \"source\": \"BOX\",\n                    \"parameters\": {\n                      \"title\": \"标题文字\"\n                    },\n                    \"style\": {\n                      \"font-size\": \"12px\",\n                      \"font-weight\": \"bold\",\n                      \"text-align\": \"left\",\n                      \"margin\": \"5px\"\n                    },\n                    attributes: {\n                      \"text\": {\n                        \"label\": \"标题文字\",\n                        \"value\": \"设备分布\",\n                        \"type\": \"standardInput\"\n                      },\n                      \"color\": {\n                        \"label\": \"颜色\",\n                        \"value\": \"#333\",\n                        \"type\": \"colorPicker\"\n                      },\n                      \"fontSize\": {\n                        \"label\": \"字体大小\",\n                        \"value\": 18,\n                        \"type\": \"slider\"\n                      },\n                      \"position\": {\n                        \"label\": \"对齐\",\n                        \"value\": \"left\",\n                        \"type\": \"select\",\n                        \"option\": [{\n                          \"label\": \"左对齐\",\n                          \"value\": \"left\"\n                        }, {\n                          \"label\": \"中间对齐\",\n                          \"value\": \"center\"\n                        }]\n                      },\n                      \"weight\": {\n                        \"label\": \"粗细\",\n                        \"value\": \"bold\",\n                        \"type\": \"select\",\n                        \"option\": [{\n                          \"label\": \"正常\",\n                          \"value\": \"normal\"\n                        }, {\n                          \"label\": \"粗体\",\n                          \"value\": \"bold\"\n                        }]\n                      }\n                    },\n                    children: [{\n                      type: 'box-body',\n                      children: [{\n                        type: 'column',\n                        col: 7,\n                        children: [{\n                          type: 'mapchart',\n                          data: {\n                            bindTo: \"mapChartBindLink\"\n                          },\n                          children: []\n                        }]\n                      }, {\n                        type: 'column',\n                        col: 5,\n                        children: [{\n                          type: 'list',\n                          attributes: {\n                            fun: {\n                              value: \"ticketService.getTicketsByStatus\"\n                            }\n                          },\n                          data: {\n                            bindTo: \"mapChartBindLink\"\n                          }\n                        }]\n                      }],\n                      class: 'box-body'\n                    }, {\n                      type: 'box-footer',\n                      children: [{\n                        type: 'row',\n                        children: []\n                      }],\n                      class: 'box-footer'\n                    }]\n                  },\n                  piechartTemp: {\n                    \"label\": \"控制板2\",\n                    \"type\": \"box\",\n                    \"class\": \"box box-info\",\n                    \"source\": \"BOX\",\n                    \"parameters\": {\n                      \"title\": \"标题文字\"\n                    },\n                    \"style\": {\n                      \"font-size\": \"12px\",\n                      \"font-weight\": \"bold\",\n                      \"text-align\": \"left\",\n                      \"margin\": \"5px\"\n                    },\n                    children: [{\n                      type: 'box-body',\n                      children: [{\n                        type: 'column',\n                        col: 12,\n                        children: [freeBoardValue.PIECHART.$clone().$extension({\n                          attributes: {\n                            title: {\n                              value: \"\"\n                            },\n                            subtitle: {\n                              value: \"\"\n                            },\n                            dataType: {\n                              value: 'alert'\n                            },\n                            value: {\n                              data: {\n                                value: 'value'\n                              }\n                            },\n                            legend: {\n                              data: {\n                                value: 'value'\n                              }\n                            }\n                          }\n                        })]\n                      }],\n                      class: 'box-body'\n                    }, {\n                      type: 'box-footer',\n                      children: [{\n                        type: 'column',\n                        col: 12,\n                        children: [{\n                          type: 'alertcount',\n                          children: []\n                        }]\n                      }],\n                      class: 'box-footer'\n                    }]\n                  },\n                  warningMapTemp: {\n                    \"label\": \"控制板2\",\n                    \"type\": \"box\",\n                    \"class\": \"box box-info\",\n                    \"source\": \"BOX\",\n                    \"parameters\": {\n                      \"title\": \"最近一周告警情况\"\n                    },\n                    \"style\": {\n                      \"font-size\": \"12px\",\n                      \"font-weight\": \"bold\",\n                      \"text-align\": \"left\",\n                      \"margin\": \"5px\"\n                    },\n                    \"children\": [{\n                      \"type\": \"box-body\",\n                      \"children\": [{\n                        \"type\": \"column\",\n                        \"col\": 8,\n                        \"children\": [{\n                          \"label\": \"线图\",\n                          \"type\": \"echart\",\n                          \"source\": \"LINECHART\",\n                          \"help\": \"../app-free-style/index.html#/help/index%7Cechart/%5B%220%22,%7B%7D%5D\",\n                          \"data\": {\n                            \"applied\": false,\n                            \"resource\": [],\n                            \"modelDisable\": true,\n                            \"modelType\": 300,\n                            \"resfilltype\": \"parameter\",\n                            \"timespan\": {\n                              \"value\": 24,\n                              \"unit\": \"hour\"\n                            },\n                            \"frequency\": {\n                              \"value\": 30,\n                              \"unit\": \"minute\"\n                            },\n                            \"aggregate_rule\": 0,\n                            \"aggregate_instance\": [],\n                            \"aggregate_period\": 15,\n                            \"aggregate_type\": [1],\n                            \"autoFillBlank\": true,\n                            \"format\": \"年月日\",\n                            \"grid\": [{}],\n                            \"legend\": {\n                              \"manual\": [\"第一组\", \"第二组\", \"第三组\"],\n                              \"bind\": \"(function (source){\\n  var formatter=function(elem){\\n    return elem.kpi\\n   }\\n  return source.time.getSeries(formatter);\\n})\"\n                            },\n                            \"xAxisType\": \"category\",\n                            \"xAxis\": {\n                              \"manual\": [[\"第一个数据\", \"第二个数据\", \"第三个数据\", \"第四个数据\", \"第五个数据\", \"第六个数据\"]],\n                              \"bind\": \"(function (source){\\n  var formatter=function(elem){\\n    return elem.kpi\\n   }\\n  return source.time.getxAxis(formatter);\\n})\"\n                            },\n                            \"yAxisType\": \"value\",\n                            \"yAxis\": {\n                              \"manual\": [[\"第一个数据\", \"第二个数据\", \"第三个数据\", \"第四个数据\", \"第五个数据\", \"第六个数据\"]],\n                              \"bind\": \"(function (source){\\n  var formatter=function(elem){\\n    return elem.kpi\\n   }\\n  return source.time.getxAxis(formatter);\\n})\"\n                            },\n                            \"series\": {\n                              \"manual\": [{\n                                \"name\": \"第一组\",\n                                \"data\": [120, 85, 64, 130, 152, 87]\n                              }, {\n                                \"name\": \"第二组\",\n                                \"data\": [88, 120, 180, 78, 232, 140]\n                              }, {\n                                \"name\": \"第三组\",\n                                \"data\": [50, 80, 140, 60, 70, 90]\n                              }],\n                              \"bind\": \"(function (source){\\n   var formatter=function(elem){\\n    return elem.kpi\\n   }\\n  return source.time.getSeries(formatter);\\n})\"\n                            },\n                            \"kpi\": [3006, 3007, 3008, 3009]\n                          },\n                          \"advance\": {\n                            \"variable\": \"\",\n                            \"getfunction\": \"kpiDataService.getValueList\",\n                            \"category\": \"time\",\n                            \"custom_category\": \"\",\n                            \"condition\": [\"kpi\", \"{object:kpiQueryModel}\"],\n                            \"expression\": {}\n                          },\n                          \"parameters\": {\n                            \"title\": \"主标题\",\n                            \"subtitle\": \"附标题\"\n                          },\n                          \"style\": {\n                            \"margin\": \"auto\",\n                            \"width\": \"100%\",\n                            \"height\": \"300px\"\n                          },\n                          \"echart\": {\n                            \"general\": {},\n                            \"title\": {\n                              \"padding\": 30,\n                              \"text\": \"草莓大棚温度变化\",\n                              \"textStyle\": {\n                                \"fontWeight\": \"bold\",\n                                \"fontSize\": 16\n                              }\n                            },\n                            \"toolbox\": {},\n                            \"tooltip\": {\n                              \"trigger\": \"axis\"\n                            },\n                            \"legend\": {\n                              \"data\": [\"数据1\", \"数据2\", \"数据3\"]\n                            },\n                            \"grid\": [{}],\n                            \"xAxis\": [{\n                              \"type\": \"category\",\n                              \"boundaryGap\": false,\n                              \"axisLine\": {\n                                \"lineStyle\": {\n                                  \"color\": \"#b0b0b0\",\n                                  \"width\": 1\n                                }\n                              },\n                              \"splitLine\": {\n                                \"lineStyle\": {\n                                  \"color\": \"rgb(239, 239, 239)\",\n                                  \"width\": 1\n                                }\n                              }\n                            }],\n                            \"yAxis\": [{\n                              \"show\": true,\n                              \"max\": \"auto\",\n                              \"min\": \"auto\",\n                              \"type\": \"value\",\n                              \"boundaryGap\": false,\n                              \"axisLine\": {\n                                \"lineStyle\": {\n                                  \"color\": \"#b0b0b0\",\n                                  \"width\": 1\n                                }\n                              },\n                              \"splitLine\": {\n                                \"lineStyle\": {\n                                  \"color\": \"rgb(239, 239, 239)\",\n                                  \"width\": 1\n                                }\n                              },\n                              \"axisLabel\": {\n                                \"show\": true,\n                                \"textStyle\": {}\n                              },\n                              \"axisTick\": {\n                                \"show\": true,\n                                \"lineStyle\": {}\n                              }\n                            }],\n                            \"series\": [{\n                              \"name\": \"数据1\",\n                              \"type\": \"line\",\n                              \"markPoint\": {\n                                \"data\": [{\n                                  \"name\": \"最大值\",\n                                  \"type\": \"max\"\n                                }, {\n                                  \"name\": \"最小值\",\n                                  \"type\": \"min\"\n                                }]\n                              }\n                            }, {\n                              \"name\": \"数据2\",\n                              \"type\": \"line\",\n                              \"markPoint\": {\n                                \"data\": [{\n                                  \"name\": \"最大值\",\n                                  \"type\": \"max\"\n                                }, {\n                                  \"name\": \"最小值\",\n                                  \"type\": \"min\"\n                                }]\n                              }\n                            }, {\n                              \"name\": \"数据3\",\n                              \"type\": \"line\",\n                              \"markPoint\": {\n                                \"data\": [{\n                                  \"name\": \"最大值\",\n                                  \"type\": \"max\"\n                                }, {\n                                  \"name\": \"最小值\",\n                                  \"type\": \"min\"\n                                }]\n                              }\n                            }],\n                            \"visualMap\": []\n                          },\n                          \"template\": [{\n                            \"label\": \"基础线图\",\n                            \"type\": \"image\",\n                            \"url\": \"images/line/line1.png\",\n                            \"style\": {\n                              \"margin\": \"auto\",\n                              \"width\": \"100%\",\n                              \"height\": \"300px\"\n                            },\n                            \"echart\": {\n                              \"general\": {},\n                              \"title\": {\n                                \"padding\": 30,\n                                \"text\": \"草莓大棚温度变化\",\n                                \"textStyle\": {\n                                  \"fontWeight\": \"bold\",\n                                  \"fontSize\": 16\n                                }\n                              },\n                              \"toolbox\": {},\n                              \"legend\": {\n                                \"data\": [\"数据1\", \"数据2\", \"数据3\"]\n                              },\n                              \"grid\": [{}],\n                              \"tooltip\": {\n                                \"trigger\": \"axis\"\n                              },\n                              \"xAxis\": [{\n                                \"type\": \"category\",\n                                \"boundaryGap\": false,\n                                \"axisLine\": {\n                                  \"lineStyle\": {\n                                    \"color\": \"#b0b0b0\",\n                                    \"width\": 1\n                                  }\n                                },\n                                \"splitLine\": {\n                                  \"lineStyle\": {\n                                    \"color\": \"rgb(239, 239, 239)\",\n                                    \"width\": 1\n                                  }\n                                }\n                              }],\n                              \"yAxis\": [{\n                                \"show\": true,\n                                \"max\": \"auto\",\n                                \"min\": \"auto\",\n                                \"type\": \"value\",\n                                \"boundaryGap\": false,\n                                \"axisLine\": {\n                                  \"lineStyle\": {\n                                    \"color\": \"#b0b0b0\",\n                                    \"width\": 1\n                                  }\n                                },\n                                \"splitLine\": {\n                                  \"lineStyle\": {\n                                    \"color\": \"rgb(239, 239, 239)\",\n                                    \"width\": 1\n                                  }\n                                },\n                                \"axisLabel\": {\n                                  \"show\": true,\n                                  \"textStyle\": {}\n                                },\n                                \"axisTick\": {\n                                  \"show\": true,\n                                  \"lineStyle\": {}\n                                }\n                              }],\n                              \"series\": [{\n                                \"name\": \"数据1\",\n                                \"type\": \"line\",\n                                \"markPoint\": {\n                                  \"data\": [{\n                                    \"name\": \"最大值\",\n                                    \"type\": \"max\"\n                                  }, {\n                                    \"name\": \"最小值\",\n                                    \"type\": \"min\"\n                                  }]\n                                }\n                              }, {\n                                \"name\": \"数据2\",\n                                \"type\": \"line\",\n                                \"markPoint\": {\n                                  \"data\": [{\n                                    \"name\": \"最大值\",\n                                    \"type\": \"max\"\n                                  }, {\n                                    \"name\": \"最小值\",\n                                    \"type\": \"min\"\n                                  }]\n                                }\n                              }, {\n                                \"name\": \"数据3\",\n                                \"type\": \"line\",\n                                \"markPoint\": {\n                                  \"data\": [{\n                                    \"name\": \"最大值\",\n                                    \"type\": \"max\"\n                                  }, {\n                                    \"name\": \"最小值\",\n                                    \"type\": \"min\"\n                                  }]\n                                }\n                              }]\n                            }\n                          }, {\n                            \"label\": \"堆积线图\",\n                            \"type\": \"image\",\n                            \"url\": \"images/line/line2.png\",\n                            \"style\": {\n                              \"margin\": \"auto\",\n                              \"width\": \"100%\",\n                              \"height\": \"300px\"\n                            },\n                            \"echart\": {\n                              \"general\": {},\n                              \"title\": {},\n                              \"legend\": {\n                                \"data\": [\"数据1\", \"数据2\", \"数据3\"]\n                              },\n                              \"grid\": [{}],\n                              \"xAxis\": [{\n                                \"boundaryGap\": false,\n                                \"type\": \"category\"\n                              }],\n                              \"yAxis\": [{\n                                \"type\": \"value\"\n                              }],\n                              \"series\": [{\n                                \"stack\": \"总量\",\n                                \"name\": \"数据1\",\n                                \"type\": \"line\"\n                              }, {\n                                \"stack\": \"总量\",\n                                \"name\": \"数据2\",\n                                \"type\": \"line\"\n                              }],\n                              \"toolbox\": {},\n                              \"tooltip\": {}\n                            }\n                          }, {\n                            \"label\": \"对数轴\",\n                            \"type\": \"image\",\n                            \"url\": \"images/line/line3.png\",\n                            \"style\": {\n                              \"margin\": \"auto\",\n                              \"width\": \"100%\",\n                              \"height\": \"300px\"\n                            },\n                            \"echart\": {\n                              \"general\": {},\n                              \"title\": {},\n                              \"legend\": {\n                                \"data\": [\"数据1\", \"数据2\", \"数据3\"]\n                              },\n                              \"grid\": [{}],\n                              \"xAxis\": [{\n                                \"boundaryGap\": false,\n                                \"type\": \"category\"\n                              }],\n                              \"yAxis\": [{\n                                \"type\": \"log\"\n                              }],\n                              \"series\": [{\n                                \"name\": \"数据1\",\n                                \"type\": \"line\"\n                              }, {\n                                \"name\": \"数据2\",\n                                \"type\": \"line\"\n                              }, {\n                                \"name\": \"数据3\",\n                                \"type\": \"line\"\n                              }],\n                              \"toolbox\": {},\n                              \"tooltip\": {}\n                            }\n                          }, {\n                            \"label\": \"面积线图\",\n                            \"type\": \"image\",\n                            \"url\": \"images/line/line4.png\",\n                            \"style\": {\n                              \"margin\": \"auto\",\n                              \"width\": \"100%\",\n                              \"height\": \"300px\"\n                            },\n                            \"echart\": {\n                              \"general\": {},\n                              \"title\": {\n                                \"padding\": 30,\n                                \"text\": \"草莓大棚温度变化\",\n                                \"textStyle\": {\n                                  \"fontWeight\": \"bold\",\n                                  \"fontSize\": 16\n                                }\n                              },\n                              \"toolbox\": {},\n                              \"tooltip\": {\n                                \"trigger\": \"axis\"\n                              },\n                              \"legend\": {\n                                \"data\": [\"数据1\", \"数据2\", \"数据3\"]\n                              },\n                              \"xAxis\": [{\n                                \"type\": \"category\",\n                                \"boundaryGap\": false,\n                                \"axisLine\": {\n                                  \"lineStyle\": {\n                                    \"color\": \"#b0b0b0\",\n                                    \"width\": 1\n                                  }\n                                },\n                                \"splitLine\": {\n                                  \"lineStyle\": {\n                                    \"color\": \"rgb(239, 239, 239)\",\n                                    \"width\": 1\n                                  }\n                                }\n                              }],\n                              \"yAxis\": [{\n                                \"show\": true,\n                                \"max\": \"auto\",\n                                \"min\": \"auto\",\n                                \"type\": \"value\",\n                                \"boundaryGap\": false,\n                                \"axisLine\": {\n                                  \"lineStyle\": {\n                                    \"color\": \"#b0b0b0\",\n                                    \"width\": 1\n                                  }\n                                },\n                                \"splitLine\": {\n                                  \"lineStyle\": {\n                                    \"color\": \"rgb(239, 239, 239)\",\n                                    \"width\": 1\n                                  }\n                                },\n                                \"axisLabel\": {\n                                  \"show\": true,\n                                  \"textStyle\": {}\n                                },\n                                \"axisTick\": {\n                                  \"show\": true,\n                                  \"lineStyle\": {}\n                                }\n                              }],\n                              \"series\": [{\n                                \"name\": \"数据1\",\n                                \"type\": \"line\",\n                                \"areaStyle\": {\n                                  \"normal\": {\n                                    \"show\": true\n                                  }\n                                }\n                              }, {\n                                \"name\": \"数据2\",\n                                \"type\": \"line\",\n                                \"areaStyle\": {\n                                  \"normal\": {\n                                    \"show\": true\n                                  }\n                                }\n                              }, {\n                                \"name\": \"数据3\",\n                                \"type\": \"line\",\n                                \"areaStyle\": {\n                                  \"normal\": {\n                                    \"show\": true\n                                  }\n                                }\n                              }]\n                            }\n                          }, {\n                            \"label\": \"面堆积线图\",\n                            \"type\": \"image\",\n                            \"url\": \"images/line/line5.png\",\n                            \"style\": {\n                              \"margin\": \"auto\",\n                              \"width\": \"100%\",\n                              \"height\": \"300px\"\n                            },\n                            \"echart\": {\n                              \"general\": {},\n                              \"title\": {\n                                \"padding\": 30,\n                                \"text\": \"草莓大棚温度变化\",\n                                \"textStyle\": {\n                                  \"fontWeight\": \"bold\",\n                                  \"fontSize\": 16\n                                }\n                              },\n                              \"toolbox\": {},\n                              \"tooltip\": {\n                                \"trigger\": \"axis\"\n                              },\n                              \"legend\": {\n                                \"data\": [\"数据1\", \"数据2\", \"数据3\"]\n                              },\n                              \"grid\": [{}],\n                              \"xAxis\": [{\n                                \"type\": \"category\",\n                                \"boundaryGap\": false,\n                                \"axisLine\": {\n                                  \"lineStyle\": {\n                                    \"color\": \"#b0b0b0\",\n                                    \"width\": 1\n                                  }\n                                },\n                                \"splitLine\": {\n                                  \"lineStyle\": {\n                                    \"color\": \"rgb(239, 239, 239)\",\n                                    \"width\": 1\n                                  }\n                                }\n                              }],\n                              \"yAxis\": [{\n                                \"show\": true,\n                                \"max\": \"auto\",\n                                \"min\": \"auto\",\n                                \"type\": \"value\",\n                                \"boundaryGap\": false,\n                                \"axisLine\": {\n                                  \"lineStyle\": {\n                                    \"color\": \"#b0b0b0\",\n                                    \"width\": 1\n                                  }\n                                },\n                                \"splitLine\": {\n                                  \"lineStyle\": {\n                                    \"color\": \"rgb(239, 239, 239)\",\n                                    \"width\": 1\n                                  }\n                                },\n                                \"axisLabel\": {\n                                  \"show\": true,\n                                  \"textStyle\": {}\n                                },\n                                \"axisTick\": {\n                                  \"show\": true,\n                                  \"lineStyle\": {}\n                                }\n                              }],\n                              \"series\": [{\n                                \"stack\": \"总量\",\n                                \"name\": \"数据1\",\n                                \"type\": \"line\",\n                                \"areaStyle\": {\n                                  \"normal\": {\n                                    \"show\": true\n                                  }\n                                }\n                              }, {\n                                \"stack\": \"总量\",\n                                \"name\": \"数据2\",\n                                \"type\": \"line\",\n                                \"areaStyle\": {\n                                  \"normal\": {\n                                    \"show\": true\n                                  }\n                                }\n                              }, {\n                                \"stack\": \"总量\",\n                                \"name\": \"数据3\",\n                                \"type\": \"line\",\n                                \"areaStyle\": {\n                                  \"normal\": {\n                                    \"show\": true\n                                  }\n                                }\n                              }]\n                            }\n                          }, {\n                            \"label\": \"双坐标轴图\",\n                            \"type\": \"image\",\n                            \"url\": \"images/line/line6.png\",\n                            \"style\": {\n                              \"margin\": \"auto\",\n                              \"width\": \"100%\",\n                              \"height\": \"600px\"\n                            },\n                            \"echart\": {\n                              \"general\": {},\n                              \"title\": {\n                                \"padding\": 30,\n                                \"text\": \"草莓大棚温度变化\",\n                                \"textStyle\": {\n                                  \"fontWeight\": \"bold\",\n                                  \"fontSize\": 16\n                                }\n                              },\n                              \"legend\": {\n                                \"data\": [\"数据1\", \"数据2\", \"数据3\"]\n                              },\n                              \"grid\": [{\n                                \"left\": 50,\n                                \"right\": 50,\n                                \"height\": \"35%\"\n                              }, {\n                                \"left\": 50,\n                                \"right\": 50,\n                                \"top\": \"55%\",\n                                \"height\": \"35%\"\n                              }],\n                              \"toolbox\": {},\n                              \"tooltip\": {\n                                \"trigger\": \"axis\"\n                              },\n                              \"xAxis\": [{\n                                \"type\": \"category\",\n                                \"boundaryGap\": false\n                              }, {\n                                \"gridIndex\": 1,\n                                \"type\": \"category\",\n                                \"boundaryGap\": false,\n                                \"position\": \"top\"\n                              }],\n                              \"yAxis\": [{\n                                \"name\": \"流量(m^3/s)\",\n                                \"type\": \"value\"\n                              }, {\n                                \"gridIndex\": 1,\n                                \"name\": \"降雨量(mm)\",\n                                \"type\": \"value\",\n                                \"inverse\": true\n                              }],\n                              \"series\": [{\n                                \"name\": \"数据1\",\n                                \"type\": \"line\",\n                                \"symbolSize\": 16\n                              }, {\n                                \"name\": \"数据2\",\n                                \"type\": \"line\",\n                                \"xAxisIndex\": 1,\n                                \"yAxisIndex\": 1,\n                                \"symbolSize\": 16\n                              }, {\n                                \"name\": \"数据3\",\n                                \"type\": \"line\",\n                                \"xAxisIndex\": 1,\n                                \"yAxisIndex\": 1,\n                                \"symbolSize\": 16\n                              }]\n                            }\n                          }],\n                          \"id\": \"6HymH6eC2aQ5PPdBwDPaFYPxWSmibC5B\",\n                          \"resource_time\": {}\n                        }],\n                        \"id\": \"R47z77CYWWP5HHQn6pMADQdhW7kJDb3c\"\n                      }, {\n                        \"type\": \"column\",\n                        \"col\": 4,\n                        \"children\": [{\n                          \"type\": \"row\",\n                          \"children\": [{\n                            \"type\": \"column\",\n                            \"col\": 12,\n                            \"children\": [{\n                              \"label\": \"文字\",\n                              \"type\": \"text\",\n                              \"source\": \"TEXT\",\n                              \"help\": \"http://localhost/app-free-style/index.html#/help/index%7Ctext/%5B%220%22,%7B%7D%5D\",\n                              \"data\": {\n                                \"applied\": false,\n                                \"multipleCi\": false,\n                                \"multipleKpi\": false,\n                                \"resource\": [],\n                                \"modelType\": 300,\n                                \"resfilltype\": \"parameter\",\n                                \"series\": {\n                                  \"manual\": \"处理情况\",\n                                  \"bind\": \"(function (source){\\n  return source.getSeries();\\n})\"\n                                },\n                                \"modelDisable\": true\n                              },\n                              \"style\": {\n                                \"margin\": \"5px auto\",\n                                \"padding\": \"0\",\n                                \"font-size\": \"12px\",\n                                \"font-weight\": \"bold\",\n                                \"border-width\": \"0px\",\n                                \"text-align\": \"center\"\n                              },\n                              \"advance\": {\n                                \"getfunction\": \"kpiDataService.getValueList\",\n                                \"category\": \"ci\",\n                                \"condition\": [\"kpi\", \"{object:kpiQueryModel}\"],\n                                \"expression\": \"expression = {\\n    on : {\\n        init : function(event){\\n            var target = event.target;\\n            target.setText(\\\"新建文字\\\")\\n        }\\n    }\\n}\"\n                              },\n                              \"template\": [{\n                                \"type\": \"text\",\n                                \"style\": {\n                                  \"margin\": \"auto\",\n                                  \"padding\": \"0\",\n                                  \"font-size\": \"10px\",\n                                  \"font-weight\": \"bold\",\n                                  \"color\": \"#333\"\n                                }\n                              }, {\n                                \"type\": \"text\",\n                                \"style\": {\n                                  \"margin\": \"auto\",\n                                  \"padding\": \"0\",\n                                  \"font-size\": \"16px\",\n                                  \"font-weight\": \"bold\",\n                                  \"color\": \"#666\",\n                                  \"text-align\": \"center\"\n                                }\n                              }, {\n                                \"type\": \"text\",\n                                \"style\": {\n                                  \"width\": \"60px\",\n                                  \"height\": \"60px\",\n                                  \"margin\": \"auto\",\n                                  \"padding\": \"0\",\n                                  \"font-size\": \"12px\",\n                                  \"line-height\": \"60px\",\n                                  \"font-weight\": \"bold\",\n                                  \"color\": \"#fff\",\n                                  \"text-align\": \"center\",\n                                  \"border-radius\": \"50%\",\n                                  \"background-color\": \"#3c8dbc\"\n                                }\n                              }, {\n                                \"type\": \"text\",\n                                \"style\": {\n                                  \"width\": \"140px\",\n                                  \"height\": \"60px\",\n                                  \"margin\": \"auto\",\n                                  \"padding\": \"0\",\n                                  \"font-size\": \"12px\",\n                                  \"line-height\": \"60px\",\n                                  \"font-weight\": \"bold\",\n                                  \"color\": \"#fff\",\n                                  \"text-align\": \"center\",\n                                  \"border-radius\": \"4px\",\n                                  \"background-color\": \"#3c8dbc\"\n                                }\n                              }, {\n                                \"type\": \"text\",\n                                \"style\": {\n                                  \"width\": \"140px\",\n                                  \"height\": \"60px\",\n                                  \"margin\": \"auto\",\n                                  \"padding\": \"0\",\n                                  \"font-size\": \"12px\",\n                                  \"line-height\": \"60px\",\n                                  \"font-weight\": \"bold\",\n                                  \"color\": \"#444\",\n                                  \"text-align\": \"center\",\n                                  \"border-radius\": \"4px\",\n                                  \"background-color\": \"#eee\"\n                                }\n                              }, {\n                                \"type\": \"text\",\n                                \"style\": {\n                                  \"margin\": \"auto\",\n                                  \"padding\": \"5px\",\n                                  \"font-size\": \"18px\",\n                                  \"font-weight\": \"bold\",\n                                  \"color\": \"#444\",\n                                  \"text-align\": \"center\",\n                                  \"border-radius\": \"0px\",\n                                  \"background-color\": \"#eee\"\n                                }\n                              }],\n                              \"id\": \"FzNAswf4ZrJnTjWDz8QdhXTwYQWxMXAs\"\n                            }, {\n                              \"label\": \"百分比状态条\",\n                              \"type\": \"progress\",\n                              \"source\": \"PROGRESS\",\n                              \"advance\": {\n                                \"getfunction\": \"kpiDataService.getValueList\",\n                                \"category\": \"ci\",\n                                \"condition\": [\"kpi\", \"{object:kpiQueryModel}\"],\n                                \"expression\": \"\"\n                              },\n                              \"data\": {\n                                \"applied\": false,\n                                \"multipleCi\": false,\n                                \"multipleKpi\": false,\n                                \"resource\": [],\n                                \"modelDisable\": true,\n                                \"modelType\": 300,\n                                \"resfilltype\": \"parameter\",\n                                \"series\": {\n                                  \"manual\": [{\n                                    \"data\": [{\n                                      \"name\": \"指标\",\n                                      \"value\": 90\n                                    }]\n                                  }],\n                                  \"bind\": \"(function (source){\\n  var formatter=function(elem){\\n    return elem.kpi\\n   }\\n  return source.ci.getSeries(formatter);\\n})\"\n                                },\n                                \"kpi\": [100002]\n                              },\n                              \"id\": \"RPEr8iAt3SByJwwXFRnczbSkFHR83zYW\"\n                            }, {\n                              \"label\": \"百分比状态条\",\n                              \"type\": \"progress\",\n                              \"source\": \"PROGRESS\",\n                              \"advance\": {\n                                \"getfunction\": \"kpiDataService.getValueList\",\n                                \"category\": \"ci\",\n                                \"condition\": [\"kpi\", \"{object:kpiQueryModel}\"],\n                                \"expression\": \"\"\n                              },\n                              \"data\": {\n                                \"applied\": false,\n                                \"multipleCi\": false,\n                                \"multipleKpi\": false,\n                                \"resource\": [],\n                                \"modelDisable\": true,\n                                \"modelType\": 300,\n                                \"resfilltype\": \"parameter\",\n                                \"series\": {\n                                  \"manual\": [{\n                                    \"data\": [{\n                                      \"name\": \"指标\",\n                                      \"value\": 90\n                                    }]\n                                  }],\n                                  \"bind\": \"(function (source){\\n  var formatter=function(elem){\\n    return elem.kpi\\n   }\\n  return source.ci.getSeries(formatter);\\n})\"\n                                },\n                                \"kpi\": [100004]\n                              },\n                              \"id\": \"5wnnSPf7yYmDN3yBGpyZrGTYkW4nXDcT\"\n                            }],\n                            \"id\": \"srEECX5j4pJEeijNPk88f27YZwp7Tt7w\"\n                          }],\n                          \"id\": \"MrNYhzNNyHGQHe5KwwiziDYHGPWdTmZy\",\n                          \"source\": \"ROW\"\n                        }],\n                        \"id\": \"3YWchjGDckGzeF5s3Mk86n4CKj64WeJt\"\n                      }],\n                      \"class\": \"box-body\",\n                      \"id\": \"zP3MPNW2ai5b7bbr5mKYfSm6szFCXrcD\"\n                    }, {\n                      \"type\": \"box-footer\",\n                      \"children\": [{\n                        \"type\": \"column\",\n                        \"col\": 3,\n                        \"children\": [{\n                          \"type\": \"row\",\n                          \"children\": [{\n                            \"type\": \"column\",\n                            \"col\": 12,\n                            \"children\": [{\n                              \"label\": \"环比标签\",\n                              \"type\": \"downTab\",\n                              \"source\": \"DOWNTAB\",\n                              \"data\": {\n                                \"applied\": false,\n                                \"multipleCi\": false,\n                                \"multipleKpi\": false,\n                                \"resource\": [],\n                                \"modelDisable\": true,\n                                \"modelType\": 300,\n                                \"resfilltype\": \"parameter\",\n                                \"series\": {\n                                  \"manual\": [{\n                                    \"name\": \"指标\",\n                                    \"data\": [60, 70, 80, 90, 100]\n                                  }],\n                                  \"bind\": \"(function (source){\\n  return source.time.getSeries();\\n})\"\n                                }\n                              },\n                              \"id\": \"mBFpBH7p4JCSQyk6H2CtnSTPykzTenr5\"\n                            }],\n                            \"id\": \"hp3WaMD2kGhcM2mhD4EbnkSKjYs7wKY5\"\n                          }],\n                          \"id\": \"kbJHZJD4YP7CQSDEcDCfQA7eDmzf6DAa\",\n                          \"source\": \"ROW\"\n                        }],\n                        \"id\": \"Ka5YZdRA3483d4BMXzWm3CihefnNBKSA\"\n                      }, {\n                        \"type\": \"column\",\n                        \"col\": 3,\n                        \"children\": [{\n                          \"type\": \"row\",\n                          \"children\": [{\n                            \"type\": \"column\",\n                            \"col\": 12,\n                            \"children\": [{\n                              \"label\": \"环比标签\",\n                              \"type\": \"downTab\",\n                              \"source\": \"DOWNTAB\",\n                              \"data\": {\n                                \"applied\": false,\n                                \"kpi\": [],\n                                \"modelType\": 300,\n                                \"resfilltype\": \"parameter\",\n                                \"resource\": [],\n                                \"multipleCi\": false,\n                                \"multipleKpi\": false,\n                                \"series\": {\n                                  \"manual\": \"[\\n  {\\n    \\\"name\\\": \\\"指标\\\",\\n    \\\"data\\\": [\\n      60,\\n      70,\\n      80,\\n      120,\\n      100\\n    ]\\n  }\\n]\",\n                                  \"bind\": \"(function (source){\\n  return source.time.getSeries();\\n})\"\n                                }\n                              },\n                              \"id\": \"XxiSTfPFmtpFBRhSKCjpJErXtnWRMHFn\",\n                              \"$index\": [0, 0]\n                            }],\n                            \"id\": \"dcNQsbxxN5dsmxCWmTNMMYNbTFQyxBXz\"\n                          }],\n                          \"id\": \"K7rQRk3AWdmyh2j53YbbZK8GyJs2rn3t\",\n                          \"source\": \"ROW\"\n                        }],\n                        \"id\": \"nEY7NzkpYHYC6Pni2mBHjkCbYMaGDExn\"\n                      }, {\n                        \"type\": \"column\",\n                        \"col\": 3,\n                        \"children\": [{\n                          \"type\": \"row\",\n                          \"children\": [{\n                            \"type\": \"column\",\n                            \"col\": 12,\n                            \"children\": [{\n                              \"label\": \"环比标签\",\n                              \"type\": \"downTab\",\n                              \"source\": \"DOWNTAB\",\n                              \"data\": {\n                                \"applied\": false,\n                                \"multipleCi\": false,\n                                \"multipleKpi\": false,\n                                \"resource\": [],\n                                \"modelDisable\": true,\n                                \"modelType\": 300,\n                                \"resfilltype\": \"parameter\",\n                                \"series\": {\n                                  \"manual\": [{\n                                    \"name\": \"指标\",\n                                    \"data\": [60, 70, 80, 90, 100]\n                                  }],\n                                  \"bind\": \"(function (source){\\n  return source.time.getSeries();\\n})\"\n                                }\n                              },\n                              \"id\": \"k8rPPWfmtGdcz5Ntffe8fXsMApxkzePE\"\n                            }],\n                            \"id\": \"WGQkZKY82WZKhyXZZNPAjh2P6p8ekhir\"\n                          }],\n                          \"id\": \"Ajc67sHcmPtAfMCFSkk5DnnT7FxbGn68\",\n                          \"source\": \"ROW\"\n                        }],\n                        \"id\": \"myKtr6ftX4x5ytbkKkw3ieXxQyfPi45C\"\n                      }, {\n                        \"type\": \"column\",\n                        \"col\": 3,\n                        \"children\": [{\n                          \"type\": \"row\",\n                          \"children\": [{\n                            \"type\": \"column\",\n                            \"col\": 12,\n                            \"children\": [{\n                              \"label\": \"环比标签\",\n                              \"type\": \"downTab\",\n                              \"source\": \"DOWNTAB\",\n                              \"data\": {\n                                \"applied\": false,\n                                \"kpi\": [],\n                                \"modelType\": 300,\n                                \"resfilltype\": \"parameter\",\n                                \"resource\": [],\n                                \"multipleCi\": false,\n                                \"multipleKpi\": false,\n                                \"series\": {\n                                  \"manual\": \"[\\n  {\\n    \\\"name\\\": \\\"指标\\\",\\n    \\\"data\\\": [\\n      120,\\n      70,\\n      80,\\n      90,\\n      100\\n    ]\\n  }\\n]\",\n                                  \"bind\": \"(function (source){\\n  return source.time.getSeries();\\n})\"\n                                }\n                              },\n                              \"id\": \"x5wdhitTAcyTw2RfMz3yGp2WsxSfAkMB\",\n                              \"$index\": [0, 0]\n                            }],\n                            \"id\": \"ycGwrJfnXDkKwX4c4AF4ERmyxxspYfeh\"\n                          }],\n                          \"id\": \"dmjDRfHy2wtjPAFkcbzwZybinf5Sk6Mt\",\n                          \"source\": \"ROW\"\n                        }],\n                        \"id\": \"dniekBCcRpT73p54b3axmD7p68cpTw6f\"\n                      }],\n                      \"class\": \"box-footer\",\n                      \"id\": \"GJGepfSKasQBzGPeDWK7erbFPyedK7i2\"\n                    }],\n                    \"url\": \"images/map/map1.png\",\n                    \"id\": \"DXnDspipMN7c247NrrWfhEHT3aiZ44RN\"\n                  },\n\n                  /**\n                                       resourcelist: {\n                    type: 'resourcelist',\n                    attributes: {\n                      fun: {\n                        value: \"serviceCenterService.resources.getAll\"\n                      }\n                    }\n                  },\n                                       svg_pie: {\n                    type: 'svg_pie',\n                  },*/\n                  kpilist: freeBoardValue.KPILIST.$clone().$extension({\n                    data: {\n                      modelType: 300,\n                      resfilltype: \"parameter\"\n                    }\n                  })\n                  /**,\n                                                           dashboardView: {\n                                        type: 'dashboard'\n                                      },\n                                                           mapchart: {\n                                        type: 'mapchart'\n                                      },\n                                                           map1chart: {\n                                        type: 'map1chart'\n                                      },\n                                                           map2chart: {\n                                        type: 'map2chart'\n                                      },\n                                                           scatter2chart: {\n                                        type: 'scatter2chart'\n                                      },\n                                                           scatter3chart: {\n                                        type: 'scatter3chart'\n                                      },\n                                                           relationchart: {\n                                        type: \"relationchart\"\n                                      },\n                                                           relation1chart: {\n                                        type: \"relation1chart\"\n                                      },\n                                                           parallelschart: {\n                                        type: 'parallelschart'\n                                      },\n                                                           parallels1chart: {\n                                        type: 'parallels1chart'\n                                      },\n                                                           parallels2chart: {\n                                        type: 'parallels2chart'\n                                      },\n                                                           projecttopo: freeBoardValue.PROJECTTOP.$clone()*/\n\n                };\n\n                for (var i in freeBoardValue) {\n                  var type = i.toLowerCase();\n\n                  if (type) {\n                    if (!scope.tools[type]) {\n                      scope.tools[type] = freeBoardValue[i].$clone();\n                    }\n                  }\n                }\n\n                for (var i in dashboardTemplate) {\n                  var json = JSON.parse(dashboardTemplate[i].value); //json.type = dashboardTemplate[i].name;\n\n                  scope.tools[\"template_\" + dashboardTemplate[i].id] = json;\n                }\n\n                for (var i in scope.tools) {\n                  replaceCiKpi.call(scope.tools[i]);\n                }\n                /**\n                                   for(var k in scope.toolbarListMap) {\n                  for(var j in scope.toolbarListMap[k].sub) {\n                    (function(elem){\n                      if(elem.render==\"render\") {\n                        var item = remapData({\n                          layout : {\n                            id: $randomString(32),\n                            type: 'column',\n                            children: [scope.tools[elem.type]],\n                            col: 12\n                          }\n                        });\n                        var ins = freeboardBaseService($(\"#prev_\" + elem.type));\n                        ins.setMode(true);\n                        ins.renderLayout(item);\n                        item.renderBoardToTarget($(\"#prev_\" + elem.type), true);\n                      }\n                    })(scope.toolbarListMap[k].sub[j])\n                  }\n                }\n                                   */\n\n\n                if (typeof callback == 'function') {\n                  callback();\n                }\n              };\n\n              if (!currentView) {\n                if (scope.viewmode == \"freeboard\") {\n                  scope.firstCreate = true;\n                  scope.template = [{\n                    id: -1,\n                    title: \"空白视图\"\n                  }].concat(window.template);\n                } else if (scope.viewmode == \"editor\") {\n                  scope.firstCreate = true;\n                  scope.specialist = [{\n                    id: -1,\n                    label: \"空白视图\"\n                  }].concat(window.specialistView);\n                } else {\n                  scope.setting = new setting({\n                    theme: JSONparse(scope.editData.setting).theme || \"default\",\n                    data: scope.editData.setting\n                  });\n                }\n              }\n\n              getToolbarList();\n            }, function error(err) {\n              growl.error(\"获取不到模型列表。\", {});\n            });\n          };\n\n          if (rootScope.viewmode == 'editor') {\n            if ($$.isFunction(CHARTDATA.defer)) {\n              CHARTDATA.defer(function () {\n                var scatterOp = scope.toolBarList[5].sub[0].option;\n                freeBoardValue.SCATTERCHART.$extension(CHARTDATA[scatterOp]);\n                run();\n              });\n            } else {\n              var scatterOp = scope.toolBarList[5].sub[0].option;\n              freeBoardValue.SCATTERCHART.$extension(CHARTDATA[scatterOp]);\n              run();\n            }\n          } else {\n            run();\n          }\n\n          renderDataFn(); //scope.editData.renderBoard();\n        }\n      };\n\n      run();\n    }\n\n    function replaceCiKpi(callback) {\n      if (typeof callback == \"function\") {\n        callback();\n      }\n      /**\n               var cur = this;\n               var defers = [];\n               cur.traveseByChild(function(element){\n        var defer = q.defer();\n        if(element.getCiKpi){\n          element.getCiKpi(function(ci, kpi){\n            if(element.data){\n              element.data.resource = ci;\n              element.data.kpi = kpi;\n            };\n            defer.resolve(\"success\");\n          });\n        } else {\n          defer.resolve(\"success\");\n        };\n        defers.push(defer.promise);\n      });\n               q.all(defers).then(function(){\n        if(typeof callback == \"function\"){\n          callback(cur);\n        };\n      });\n               */\n\n      /**\n               var defers = [];\n               var cur = this;\n               this.traveseByChild(function(element){\n        var resourceArr = [];\n        var finished, def = q.defer();\n        defers.push(def.promise);\n        (function(def){\n          if(element.data) {\n            element.data.defer = function(callback){\n              finished = callback;\n            };\n            if(scope.globalModel.enable){\n              var model = scope.globalModel.model;\n              element.data.model = new modelSelector(model);\n              getcikpi(model.id);\n            } else {\n              if(typeof element.data.model != 'object') {\n                if(element.data.model) {\n                  var modelId = element.data.model.id;\n                  resourceUIService.getModelByIds([modelId], function(event){\n                    if(event.code == '0') {\n                      element.data.model = new modelSelector(event.data[0]);\n                      getcikpi(modelId);\n                    }\n                  });\n                } else {\n                  def.resolve(\"success\");\n                }\n              } else if(element.data.model != undefined) {\n                var modelId = element.data.model.id;\n                if(modelId) {\n                  getcikpi(modelId);\n                } else {\n                  def.resolve(\"success\");\n                }\n              }\n            }\n           } else {\n            def.resolve(\"success\");\n          }\n          function getcikpi(modelId){\n            serviceCenterService.resources.getBymodelId(modelId).then(function success(data){\n              if($.isArray(element.data.resource)) {\n                for(var i in element.data.resource) {\n                  if(element.data.resource[i] == 'rootCi') {\n                    if($$.noEmptyObject(rootCi)) {\n                      element.data.resource[i] = rootCi;\n                    }\n                  } else if(typeof element.data.resource[i] != 'object') {\n                    var resourceId = element.data.resource[i];\n                    element.data.resource[i] = data.find(function(elem){\n                      return resourceId == elem.id;\n                    });\n                  }\n                }\n              };\n              serviceCenterService.kpis.getBymodelId(modelId).then(function success(data){\n                var ckpi = []\n                if($.isArray(element.data.kpi)) {\n                  for(var i in element.data.kpi) {\n                    if(typeof element.data.kpi[i] != 'object'){\n                      var kpiId = element.data.kpi[i];\n                    } else if(typeof element.data.kpi[i] == 'object'){\n                      var kpiId = element.data.kpi[i].id;\n                    }\n                    var find =  data.find(function(elem){\n                      return kpiId == elem.id;\n                    });\n                    if(find) {\n                      ckpi.push(find)\n                      //element.data.kpi[i] = find;\n                    }\n                  }\n                  if(ckpi.length > 0) {\n                    element.data.kpi = ckpi;\n                  } else {\n                    delete element.data.kpi;\n                    for(var i in element.attributes)\n                    {\n                      if(element.attributes[i].data)\n                      {\n                        element.attributes[i].data.value = \"none\";\n                      }\n                    }\n                  }\n                }\n                delete element.data.defer;\n                if(typeof finished == 'function')\n                {\n                  finished(\"success!!\");\n                }\n                def.resolve(\"success\");\n              });\n            });\n          }\n        })(def);\n      })\n               q.all(defers).then(function success(data){\n        if(typeof callback == 'function')\n        {\n          callback();\n        }\n      });\n               */\n\n    }\n\n    scope.mode = \"EDIT\";\n\n    scope.tabClick = function (mode) {\n      if (mode) {\n        scope.mode = mode;\n\n        if (mode == \"EDIT\") {\n          $(\".free-board-left\").removeClass(\"free-board-fold\");\n          $(\".free-board-right\").removeClass(\"free-board-full\");\n          timeout(function () {\n            var target = $(\".previewarea\");\n            target.removeClass(\"previewarea\");\n            target.addClass(\"drawarea\");\n            renderDataFn();\n            status = \"EDIT\";\n          }, 300);\n        } else if (mode == \"PREV\") {\n          $(\".free-board-left\").addClass(\"free-board-fold\");\n          $(\".free-board-right\").addClass(\"free-board-full\");\n          timeout(function () {\n            var target = $(\".drawarea\");\n            target.addClass(\"previewarea\");\n            target.removeClass(\"drawarea\");\n            renderDataFn(true);\n            status = \"PREV\";\n          }, 300);\n        }\n      } else {\n        var savedata = scope.editData.$clone();\n\n        if (savedata.groups) {\n          for (var i in savedata.groups) {\n            refineDataStructure.call(savedata.groups[i].layout);\n          }\n        } else {\n          refineDataStructure.call(savedata.layout);\n        }\n\n        var popup = commonMethodService();\n        popup.createSystemPopupByJsonName('copyCode', {\n          title: \"页面代码\",\n          width: \"80%\"\n        }, {\n          message: \"页面代码请点击复制，拷贝代码到剪切板\",\n          code: savedata\n        });\n      }\n    };\n\n    scope.editData = {\n      layout: {\n        id: $randomString(32),\n        type: 'column',\n        children: [],\n        col: 12\n      },\n      setting: {\n        \"showNavi\": false,\n        \"style\": {\n          \"padding\": \"15px\"\n        }\n      }\n    };\n    scope.cols = [{\n      inx: 0,\n      value: 12\n    }];\n    scope.drop = {};\n    scope.colstyles = [{\n      label: '自定义',\n      value: []\n    }, {\n      label: '100%',\n      value: [12]\n    }, {\n      label: '50% - 50%',\n      value: [6, 6]\n    }, {\n      label: '66% - 33%',\n      value: [8, 4]\n    }, {\n      label: '33% - 66%',\n      value: [4, 8]\n    }, {\n      label: '33% - 33% - 33%',\n      value: [4, 4, 4]\n    }, {\n      label: '25% - 25% - 25% - 25%',\n      value: [3, 3, 3, 3]\n    }];\n    scope.gridSelector = {};\n\n    scope.colChange = function (col) {\n      scope.gridSelector.setValue(col);\n    };\n\n    scope.testFn = function () {\n      scope.colstyle = scope.colstyles[0];\n      scope.mm = 2;\n    };\n\n    scope.toolbarClick = function (toolbar) {\n      if (scope.currentSelect == toolbar.id) {\n        scope.currentSelect = undefined;\n      } else {\n        scope.currentSelect = toolbar.id;\n      }\n    };\n\n    scope.showInstruction = function (item) {\n      var temp;\n      temp = item.show;\n\n      if (item.show == undefined) {\n        item.show = false;\n      }\n\n      for (var i in scope.toolbarListMap) {\n        for (var j in scope.toolbarListMap[i].sub) {\n          scope.toolbarListMap[i].sub[j].show = false;\n        }\n      }\n\n      item.show = !temp;\n    };\n\n    scope.currentSelect = undefined;\n    scope.colstyle = scope.colstyles[1];\n\n    scope.onChange = function (cols, reset) {\n      scope.tools.grid.children = cols.map(function (element) {\n        var result = {\n          type: 'column',\n          children: [],\n          col: element\n        };\n        return result;\n      });\n\n      if (reset) {\n        scope.colstyle = scope.colstyles[0];\n      }\n    };\n\n    scope.onDelete = function (event) {\n      var targetId = $(event.target).attr(\"id\");\n      var getElem, getParent;\n      rootScope.dirty = true;\n      scope.$broadcast(\"viewChanged\");\n      curLayout().layout.traveseByChild(function (element, parent) {\n        if (element.id == targetId) {\n          getElem = element;\n          getParent = parent;\n        }\n      });\n      var find = getParent.find(function (elem) {\n        return elem == getElem;\n      });\n\n      if (find) {\n        getParent.remove(find);\n      }\n\n      renderDataFn();\n    };\n\n    scope.onCut = function (event) {\n      var targetId = $(event.target).attr(\"id\");\n      var getElem, getParent;\n      rootScope.dirty = true;\n      scope.$broadcast(\"viewChanged\");\n      curLayout().layout.traveseByChild(function (element, parent) {\n        if (element.id == targetId) {\n          getElem = element;\n          getParent = parent;\n        }\n      });\n      scope.clipBoard = getElem;\n      /**\n               $$.loadExternalJs(['jquery-session'], function(){\n          $.session.set(\"clipBoard\", JSON.stringify(getElem))\n       });*/\n\n      var find = getParent.find(function (elem) {\n        return elem == getElem;\n      });\n\n      if (find) {\n        getParent.remove(find);\n      }\n\n      renderDataFn();\n    };\n\n    scope.onCopy = function (event) {\n      var targetId = event.id;\n      var find;\n      curLayout().layout.traveseByChild(function (element, parent) {\n        if (element.id == targetId) {\n          find = element;\n        }\n      });\n\n      if (find) {\n        scope.clipBoard = find.$clone().$extension({\n          id: $randomString(32)\n        });\n      }\n    };\n\n    scope.onInsert = function (id) {\n      var targetId = id;\n      var getElem, getParent;\n      scope.$apply(function () {\n        rootScope.dirty = true;\n      });\n      scope.$broadcast(\"viewChanged\");\n      curLayout().layout.traveseByChild(function (element, parent) {\n        if (element.id == targetId) {\n          getElem = element;\n          getParent = parent;\n        }\n      });\n      var inx = 0;\n\n      for (var k in getParent) {\n        if (getParent[k].id == getElem.id) {\n          inx = k;\n          break;\n        }\n      }\n\n      if (scope.clipBoard) {\n        var clone = scope.clipBoard.$clone();\n        clone.id = $randomString(32);\n        clone.traveseByChild(function (element) {\n          if (element.id) {\n            element.id = $randomString(32);\n          }\n        });\n\n        if (inx != -1) {\n          getParent.insertBefore(inx, clone);\n        }\n\n        renderDataFn();\n      }\n    };\n\n    var body = $(['body']);\n\n    scope.importGraphToFunc = function () {\n      var popup = commonMethodService();\n      popup.createSystemPopupByJsonName('importCodeTemplate', {\n        title: \"导入JSON\",\n        width: \"80%\",\n        on: {\n          submit: function submit(obj) {\n            var code = obj.code;\n\n            var run = function run(json) {\n              var clone = json.$clone();\n              var param = {\n                label: obj.title,\n                groupName: \"Dashboard_template\",\n                value: JSON.stringify(clone)\n              }; //json.type = param.name;\n\n              var find = scope.toolbarListMap.find(function (elem) {\n                return elem.label == \"功能模块\";\n              }); //json.type = param.name;\n              //toolbarListService[1]['sub'].push(json);\n              //json.label = obj.title;\n\n              configUIService.saveConfig(param, function (event) {\n                if (event.code == 0) {\n                  var data = event.data;\n                  var id = data.id;\n                  var it = new item();\n                  Object.defineProperty(it, \"parent\", {\n                    enumerable: false,\n                    value: find.sub\n                  });\n                  it.label = obj.title;\n                  it.type = 'template _' + id;\n                  it.$CLASS = \"item\";\n                  it.render = \"edit\";\n                  find.sub.push(it);\n                  scope.tools['template _' + id] = clone;\n                }\n              });\n            };\n\n            run(JSON.parse(code));\n          }\n        }\n      }, {\n        message: \"页面代码请点击复制，拷贝代码到剪切板\"\n      });\n    };\n\n    scope.onInsertJSON = function (id) {\n      var targetId = id;\n      var getElem, getParent;\n      scope.$apply(function () {\n        rootScope.dirty = true;\n        scope.$broadcast(\"viewChanged\");\n        var popup = commonMethodService();\n        popup.createSystemPopupByJsonName('importCode', {\n          title: \"导入JSON\",\n          width: \"80%\",\n          on: {\n            submit: function submit(str, destroy) {\n              var run = function run(obj) {\n                curLayout().layout.traveseByChild(function (element, parent) {\n                  if (element.id == targetId) {\n                    getElem = element;\n                    getParent = parent;\n                  }\n                });\n                var inx = 0;\n\n                for (var k in getParent) {\n                  if (getParent[k].id == getElem.id) {\n                    inx = k;\n                    break;\n                  }\n                }\n\n                if (obj) {\n                  var clone = remapData(obj);\n                  clone.id = $randomString(32);\n                  clone.traveseByChild(function (element) {\n                    if (element.id) {\n                      element.id = $randomString(32);\n                    }\n                  });\n\n                  if (inx != -1) {\n                    getParent.insertBefore(inx, clone);\n                  }\n\n                  renderDataFn();\n                }\n              };\n\n              destroy && destroy();\n              run(JSON.parse(str));\n            }\n          }\n        }, {\n          message: \"页面代码请点击复制，拷贝代码到剪切板\"\n        });\n      });\n    };\n\n    scope.onPasteJSON = function (id) {\n      var targetId = id;\n      var getElem, getParent;\n      scope.$apply(function () {\n        rootScope.dirty = true;\n        scope.$broadcast(\"viewChanged\");\n        var popup = commonMethodService();\n        popup.createSystemPopupByJsonName('importCode', {\n          title: \"导入JSON\",\n          width: \"80%\",\n          on: {\n            submit: function submit(str, destroy) {\n              var run = function run(obj) {\n                curLayout().layout.traveseByChild(function (element, parent) {\n                  if (element.id == targetId) {\n                    getElem = element;\n                  }\n                });\n\n                if (obj) {\n                  var clone = remapData(obj);\n                  clone.id = $randomString(32);\n                  clone.traveseByChild(function (element) {\n                    if (element.id) {\n                      element.id = $randomString(32);\n                    }\n                  });\n                  getElem.children.push(clone);\n                  renderDataFn();\n                }\n              };\n\n              destroy && destroy();\n              run(JSON.parse(str));\n            }\n          }\n        }, {\n          message: \"页面代码请点击复制，拷贝代码到剪切板\"\n        });\n      });\n    };\n\n    scope.onPaste = function (id) {\n      var targetId = id;\n      var getElem, getParent;\n      scope.$apply(function () {\n        rootScope.dirty = true;\n        scope.$broadcast(\"viewChanged\");\n      });\n      curLayout().layout.traveseByChild(function (element, parent) {\n        if (element.id == targetId) {\n          getElem = element;\n        }\n      });\n      var clone = scope.clipBoard.$clone();\n      clone.traveseByChild(function (element) {\n        if (element.id) {\n          element.id = $randomString(32);\n        }\n      });\n      clone.id = $randomString(32);\n      getElem.children.push(clone);\n      renderDataFn();\n    };\n\n    scope.onDataChange = function (event, ui) {\n      var getElem, getParent;\n      var targetId = $(event.target).attr(\"id\");\n\n      for (var i in scope.resources) {\n        scope.resources[i].checked = false;\n      }\n\n      for (var i in scope.kpis) {\n        scope.kpis[i].checked = false;\n      }\n\n      curLayout().layout.traveseByChild(function (element, parent) {\n        if (element.id == targetId) {\n          getElem = element;\n          getParent = parent;\n        }\n      });\n      rootScope.panelClose = panelCloseData;\n\n      function panelCloseData() {\n        rootScope.dirty = true;\n        scope.$broadcast(\"viewChanged\");\n        var filter = scope.resources.filter(function (element) {\n          return element.checked == true;\n        });\n        scope.dataPanel.data.resource = filter;\n\n        if (scope.dataPanel.data.resource && scope.dataPanel.data.kpi) {\n          for (var i in scope.dataPanel.attributes) {\n            if (scope.dataPanel.attributes[i].data) {\n              if (scope.dataPanel.attributes[i].data.value == 'none') {\n                scope.dataPanel.attributes[i].data.value = scope.dataPanel.attributes[i].data.option[1].value;\n              }\n            }\n          }\n\n          if (scope.dataPanel.valueGroup) {\n            scope.dataPanel.valueGroup.data.value = \"value\";\n          }\n        } else {\n          for (var i in scope.dataPanel.attributes) {\n            if (scope.dataPanel.attributes[i].data) {\n              if (scope.dataPanel.attributes[i].data.value != 'none') {\n                scope.dataPanel.attributes[i].data.value = 'none';\n              }\n            }\n          }\n\n          if (scope.dataPanel.valueGroup) {\n            scope.dataPanel.valueGroup.data.value = \"custom\";\n          }\n        }\n\n        scope.selectData.$extension(scope.dataPanel);\n        renderDataFn();\n        scope.unitFilter = \"\";\n        scope.unitFilterDisabled = false;\n        scope.dataPanel = undefined;\n        scope.editPanel = undefined;\n        scope.resources = undefined;\n        scope.kpis = undefined;\n      }\n\n      scope.selectData = getElem;\n      dataPanelShow(getElem);\n    };\n\n    scope.selectTemp = function (temp) {\n      scope.ctemp = temp;\n    };\n\n    scope.selectSpec = function (temp) {\n      scope.cspec = temp;\n    };\n\n    scope.applySpecTemp = function () {\n      if (scope.firstCreate) {\n        scope.setting = new setting({\n          theme: JSONparse(scope.editData.setting).theme || \"default\",\n          data: scope.editData.setting\n        });\n      }\n\n      if (scope.cspec.id != -1) {\n        rootScope.dirty = true;\n        scope.$broadcast(\"viewChanged\");\n        var catchBind = {};\n        var viewId = scope.cspec.viewId;\n        viewFlexService.getViewById(viewId, function (event) {\n          if (event.code == \"0\") {\n            var content = JSON.parse(event.data.content);\n            scope.editData = {\n              layout: remapData(content.layout),\n              setting: content.setting\n            };\n            var target = curLayout().layout;\n            reconstruct(target);\n          }\n        });\n      }\n\n      scope.specialist = undefined;\n      scope.cspec = undefined;\n    };\n\n    scope.applyTemp = function () {\n      if (scope.firstCreate) {\n        scope.setting = new setting({\n          theme: JSONparse(scope.editData.setting).theme || \"default\",\n          data: scope.editData.setting\n        });\n      }\n\n      if (scope.ctemp.id != -1) {\n        rootScope.dirty = true;\n        scope.$broadcast(\"viewChanged\");\n        var catchBind = {};\n        var tpath = scope.ctemp.name;\n        var path = \"../../localdb/echartTemplate/\" + scope.ctemp.json;\n\n        var run = function run(template) {\n          if (template.groups == undefined) {\n            delete scope.tabIndex;\n            scope.editData = {\n              layout: remapData(template.$clone().layout),\n              setting: template.$clone().setting\n            };\n          } else {\n            for (var i in template.groups) {\n              template.groups[i].layout = remapData(template.groups[i].layout);\n            } // \n\n\n            scope.editData = template;\n            scope.tabIndex = 0;\n          }\n\n          var target = curLayout().layout;\n          reconstruct(target);\n        };\n\n        if (window[tpath]) {\n          run(window[tpath]);\n        } else {\n          Info.get(path, function (template) {\n            window[tpath] = template;\n            run(window[tpath]);\n          });\n        }\n      }\n\n      scope.template = undefined;\n      scope.ctemp = undefined;\n    };\n\n    scope.openTemplate = function () {\n      scope.template = window.template;\n    };\n\n    scope.openSpecialist = function () {\n      scope.specialist = window.specialistView;\n    };\n\n    scope.templateClose = function () {\n      if (scope.firstCreate) {\n        scope.setting = new setting({\n          theme: JSONparse(scope.editData.setting).theme || \"default\",\n          data: scope.editData.setting\n        });\n      }\n\n      scope.template = undefined;\n      scope.ctemp = undefined;\n    };\n\n    scope.specialistClose = function () {\n      if (scope.firstCreate) {\n        scope.setting = new setting({\n          theme: JSONparse(scope.editData.setting).theme || \"default\",\n          data: scope.editData.setting\n        });\n      }\n\n      scope.specialist = undefined;\n      scope.cspec = undefined;\n    };\n\n    scope.inputJSON = function () {\n      var popup = commonMethodService();\n      popup.createSystemPopupByJsonName('importCode', {\n        title: \"导入JSON\",\n        width: \"80%\",\n        on: {\n          submit: function submit(str) {\n            var run = function run(template) {\n              if (template.groups == undefined) {\n                delete scope.tabIndex;\n                scope.editData = {\n                  layout: remapData(template.$clone().layout),\n                  setting: template.$clone().setting\n                };\n              } else {\n                for (var i in template.groups) {\n                  template.groups[i].layout = remapData(template.groups[i].layout);\n                }\n\n                scope.editData = template;\n                scope.tabIndex = 0;\n              }\n\n              var target = curLayout().layout;\n              reconstruct(target);\n              scope.template = undefined;\n              scope.ctemp = undefined;\n            };\n\n            run(JSON.parse(str));\n          }\n        }\n      }, {\n        message: \"页面代码请点击复制，拷贝代码到剪切板\"\n      });\n    };\n\n    scope.jsonClose = function () {\n      scope.JsonInput = false;\n      scope.JsonData = undefined;\n    };\n\n    scope.anchors = [{\n      label: '不使用链接',\n      value: 'none'\n    }];\n\n    scope.onSetting = function (event, ui) {\n      var getElem, getParent;\n      var targetId = $(event.target).attr(\"id\");\n      curLayout().layout.traveseByChild(function (element, parent) {\n        if (element.id == targetId) {\n          getElem = element;\n          getParent = parent;\n        }\n      });\n      var content = [];\n\n      var pushData = function pushData() {\n        for (var i in arguments) {\n          if (arguments[i].content) {\n            this.push(arguments[i]);\n          }\n        }\n      };\n\n      var getType = function getType(source) {\n        switch (source) {\n          case \"LINECHART\":\n            return \"line\";\n            break;\n\n          case \"BARCHART\":\n            return \"bar\";\n            break;\n\n          case \"GAUGECHART\":\n            return \"gauge\";\n            break;\n\n          case \"PIECHART\":\n            return \"pie\";\n            break;\n\n          case \"GAUGECHART\":\n            return \"gauge\";\n            break;\n\n          case \"MAPCHARTDIST\":\n          case \"SCATTERCHART\":\n          case \"MAP\":\n            return \"scatter\";\n            break;\n\n          default:\n            return \"line\";\n            break;\n        }\n      };\n\n      pushData.apply(content, [{\n        $name: \"template\",\n        label: \"模板\",\n        content: getElem.template\n      }, {\n        $name: \"parameters\",\n        label: \"基本属性\",\n        content: getElem.parameters\n      }, {\n        $name: \"source\",\n        label: \"数据\",\n        content: getElem.data\n      }, {\n        $name: \"style\",\n        label: \"css样式\",\n        content: getElem.style\n      }, {\n        $name: \"echart\",\n        label: \"图表样式\",\n        defaulttype: getType(getElem.source),\n        content: getElem.echart\n      }, {\n        $name: \"advance\",\n        label: \"高级设置\",\n        content: getElem.advance\n      }]);\n      popup.setContent(content, ui.element, getElem.$index, getElem.label, getElem.help, getElem.type);\n      popup.open();\n      popup.on(\"onPanelOpen\", function () {});\n\n      function extend(target, data) {\n        var isDiff = false;\n\n        for (var i in data) {\n          if (data[i].isDiff == true) {\n            isDiff = true;\n            target[i] = data[i].data;\n          }\n        }\n\n        return isDiff;\n      }\n\n      keySet.onCommandKeyWith('s', function () {\n        popup.submitPanel(function (event) {\n          if (event) {\n            getElem.$index = event.index; // \n\n            var dif = extend(getElem, event);\n\n            if (dif) {\n              rootScope.dirty = true;\n              scope.$broadcast(\"viewChanged\");\n              timeout(function () {\n                renderDataFn();\n              });\n            }\n\n            rootScope.saveDashboard();\n          }\n        });\n      });\n      popup.on(\"onPanelSubmit\", function (event) {\n        getElem.$index = event.index;\n        var dif = extend(getElem, event);\n\n        if (dif) {\n          rootScope.dirty = true;\n          scope.$broadcast(\"viewChanged\");\n          timeout(function () {\n            renderDataFn();\n          });\n          keySet.onCommandKeyWith('s', function () {\n            rootScope.saveDashboard();\n          });\n        }\n      });\n    };\n\n    scope.onDrop = function (event, ui, before) {\n      var JSONstring;\n      var targetId = $(event.target).attr(\"id\");\n      var dragId = ui.draggable.attr(\"id\");\n      var viewId = ui.draggable.attr(\"viewId\");\n      rootScope.$apply(function () {\n        rootScope.dirty = true;\n        scope.$broadcast(\"viewChanged\");\n      });\n\n      if (viewId) {\n        if (dragId == 'add_topo') {\n          JSONstring = scope.configure.find(function (elem) {\n            return elem.viewId == viewId;\n          });\n        } else if (dragId == 'add_dashboard') {\n          JSONstring = scope.dashboardViews.find(function (elem) {\n            return elem.viewId == viewId;\n          });\n        } else if (dragId == 'add_designView') {\n          JSONstring = scope.designView.find(function (elem) {\n            return elem.viewId == viewId;\n          });\n        }\n      }\n\n      if (targetId != dragId) {\n        if (dragId.indexOf(\"add_\") == -1) {\n          var getElem,\n              getParent,\n              clone = {};\n          curLayout().layout.traveseByChild(function (element, parent) {\n            if (element.id == dragId) {\n              getElem = element;\n              getParent = parent;\n            }\n          });\n          clone = getElem.$clone();\n          var find = getParent.find(function (elem) {\n            return elem == getElem;\n          });\n\n          if (find) {\n            getParent.remove(find);\n          }\n\n          var find, targetParent;\n          curLayout().layout.traveseByChild(function (element, parent) {\n            if (element.id == targetId) {\n              find = element;\n              targetParent = parent;\n            }\n          });\n\n          if (before) {\n            var inx = targetParent.indexOf(find);\n\n            if (inx != -1) {\n              targetParent.insertBefore(inx, clone);\n            }\n          } else {\n            find.children.push(clone);\n          }\n\n          renderDataFn();\n        } else {\n          var find, pare, children, row;\n          dragId = dragId.split(\"add_\")[1];\n          dragId = dragId.toLowerCase();\n          var children = [];\n\n          if (dragId == 'dashboard' || dragId == 'designview') {\n            row = {};\n          } else if (scope.tools.$clone()[dragId]) {\n            row = remapData(scope.tools.$clone()[dragId]);\n          } else if (scope.tools.$clone()[dragId + 'chart']) {\n            row = remapData(scope.tools.$clone()[dragId + 'chart']);\n          } else {\n            throw new Error(\"找不到视图!\");\n          }\n\n          if (kqiModelId) {\n            row.parameters.title = \"专家曲线\";\n            row.parameters.subtitle = \"专家曲线\";\n            row.data.kqiModel = {\n              id: kqiModelId\n            };\n          }\n\n          var run = function run() {\n            replaceCiKpi.call(row);\n            curLayout().layout.traveseByChild(function (element, parent) {\n              if (element.id == targetId) {\n                find = element;\n                pare = parent;\n              }\n            });\n\n            if (before) {\n              var inx = pare.indexOf(find);\n              pare.insertBefore(inx, row);\n            } else {\n              find.children.push(row);\n            }\n\n            row.traveseByChild(function (element) {\n              element.id = $randomString(32);\n              element.traverse(function (attr, el) {\n                if (el.onChange) {\n                  el.onChange = eval(el.onChange);\n                }\n              });\n            });\n            curLayout().traverse(function (attr, elem) {\n              var catchBind = {};\n\n              if (elem.data) {\n                if (elem.data.bindTo) {\n                  if (catchBind[elem.data.bindTo]) {\n                    elem.data = catchBind[elem.data.bindTo];\n                  } else {\n                    catchBind[elem.data.bindTo] = elem.data;\n                  }\n                }\n              }\n            });\n            renderDataFn();\n          };\n\n          if (JSONstring) {\n            row.viewId = parseInt(viewId);\n            viewFlexService.getViewById(viewId, function (event) {\n              if (JSON.parse(event.data.content)) {\n                if (dragId == 'dashboard' || dragId == 'designview') {\n                  var dt = JSON.parse(event.data.content);\n\n                  if (dt.hasOwnProperty('groups')) {\n                    row = {\n                      id: $randomString(),\n                      type: \"tab\",\n                      children: []\n                    };\n\n                    for (var i in dt.groups) {\n                      row.children.push({\n                        id: $randomString(),\n                        \"tabName\": dt.groups[i].label,\n                        \"tabId\": i,\n                        \"type\": \"tabItem\",\n                        children: dt.groups[i].layout.children\n                      });\n                    }\n                  } else if (dt.hasOwnProperty('data')) {\n                    dt.data = dt.data.$remapByChild(function (element) {\n                      var source = element.source;\n                      var rs = commonMethodService(element);\n                      rs.setRootTarget(scope.editData);\n                      return rs;\n                    });\n                    row = {\n                      id: $randomString(),\n                      type: \"row\",\n                      children: [dt.data]\n                    };\n                  } else if (dt.hasOwnProperty('layout')) {\n                    dt.layout = dt.layout.$remapByChild(function (element) {\n                      var source = element.source;\n                      var rs = commonMethodService(element);\n                      rs.setRootTarget(scope.editData);\n                      return rs;\n                    });\n                    row = {\n                      id: $randomString(),\n                      type: \"row\",\n                      children: [dt.layout]\n                    };\n                  }\n                } else {\n                  row.JSON = JSON.parse(event.data.content);\n                }\n              } else {\n                row.JSON = {};\n              }\n\n              run();\n            });\n          } else {\n            run();\n          }\n        }\n      }\n    };\n\n    function curLayout() {\n      var rs;\n\n      if (scope.editData.groups == undefined) {\n        return scope.editData;\n      } else {\n        if (scope.tabIndex == undefined) {\n          scope.tabIndex = 0;\n        }\n\n        var rs = {\n          layout: scope.editData.groups[scope.tabIndex].layout,\n          setting: scope.editData.setting\n        };\n        return rs;\n      }\n    }\n\n    scope.addEditDataGroup = function () {\n      rootScope.dirty = true;\n      scope.$broadcast(\"viewChanged\");\n\n      if (scope.editData.groups == undefined) {\n        var clone = scope.editData.$clone();\n        scope.editData = {\n          groups: [{\n            id: 0,\n            label: '导航页',\n            path: 'page0',\n            layout: clone.layout\n          }],\n          setting: clone.setting\n        };\n        scope.tabIndex = 0;\n      } else {\n        scope.editData.groups.push({\n          label: '导航页',\n          path: 'page' + scope.editData.groups.length,\n          layout: {\n            id: $randomString(32),\n            type: 'column',\n            children: [],\n            col: 12\n          }\n        });\n\n        for (var i in scope.editData.groups) {\n          scope.editData.groups[i].id = i;\n        }\n\n        scope.tabIndex = scope.editData.groups.length - 1;\n      }\n\n      if (scope.mode == 'EDIT') {\n        renderDataFn();\n      } else {\n        renderDataFn(true);\n      }\n    };\n\n    scope.removeEditDataGroup = function (tab) {\n      rootScope.dirty = true;\n      scope.$broadcast(\"viewChanged\");\n      scope.editData.groups = scope.editData.groups.filter(function (elem) {\n        return tab.id != elem.id;\n      });\n\n      if (scope.editData.groups.length == 1) {\n        scope.editData = {\n          layout: scope.editData.groups[0].layout,\n          setting: scope.editData.setting\n        };\n        scope.tabIndex = undefined;\n      } else {\n        scope.tabIndex = 0;\n      }\n\n      if (scope.mode == 'EDIT') {\n        renderDataFn();\n      } else {\n        renderDataFn(true);\n      }\n    };\n\n    scope.renameEditDataGroup = function (tab) {\n      var find = scope.editData.groups.find(function (elem) {\n        return elem.id == tab.id;\n      });\n      var fnlist = [{\n        label: '确定',\n        icon: 'btn btn-success',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        fn: function fn() {\n          rootScope.dirty = true;\n          scope.$broadcast(\"viewChanged\");\n          find.label = scope.dialogBox.input[0].value;\n          find.path = scope.dialogBox.input[1].value;\n          scope.dialogBox = undefined;\n        }\n      }, {\n        label: '取消',\n        icon: 'btn btn-default',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        fn: function fn() {\n          scope.dialogBox = undefined;\n        }\n      }];\n      scope.dialogBox = {\n        title: {\n          label: '设置导航信息'\n        },\n        input: [{\n          value: find.label,\n          label: '导航页名称',\n          placeholder: '修改导航名称'\n        }, {\n          value: find.path,\n          label: '导航路径',\n          placeholder: '修改导航路径'\n        }],\n        fnlist: fnlist\n      };\n    };\n\n    scope.selectEditDataGroup = function (inx) {\n      scope.tabIndex = inx;\n\n      if (scope.mode == 'EDIT') {\n        renderDataFn();\n      } else {\n        renderDataFn(true);\n      }\n    };\n  }]);\n});"],"sourceRoot":"/source/"}