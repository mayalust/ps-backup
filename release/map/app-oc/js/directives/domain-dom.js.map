{"version":3,"sources":["app-oc/js/directives/domain-dom.js"],"names":["define","directives","datatables","initDirective","timeout","ngDialog","userDomainService","customerUIService","projectUIService","growl","restrict","scope","ngModel","add","delete","edit","user","link","element","attr","TEXT","description","$","css","des_text","text","des_close","append","$watch","n","o","s","getAllName","data","rs","traverse","elem","push","label","hasOwnProperty","i","children","render","type","searchlist","tree","searchFound","remove","target","depth","parentIcon","parentRmvBtn","parentDom","parentUser","parentData","dom","hover","btn","icon","addClass","userIcon","rubish","name","modelId","infoBtn","infoBtnClick","event","stopPropagation","offset","opacity","top","left","prepend","animate","on","infoBtnLeave","off","removeBtn","addBtn","clone","editBtn","cover","inner","find","prop","$broadcast","layer","foldClick","removeClass","max-height","intro","domainID","id","domainPath","domain","findProjectsByCondition","orCondition","projectName","r","length","warning","queryDeleteDomain","resultObj","fnlist","style","width","border-radius","font-size","font-weight","padding","fn","deleteDomain","code","success","$remove","index","removeAttr","close","size","dialog","title","open","template","className","findCustomersByCondition","customerName","customerAddress","customerPhone","res","provinces","$parent","cityDics","districtDics","namelist","undefined","inx","indexOf","disabled","input","every","right","errorStatus","forEach","error","value","des","number","externalDevId","standardAddress","areaList","returnObj","newAdd","after","getAddressPointFromTools","split","join","address","addDomain","values","longitude","location","lng","latitude","lat","confirm","composory","placeholder","format","abled","options","maxlength","onChange","arr","provinceId","province","item","cityId","city","county","modifyDomain","isFlag","$apply","show","Array","$on","$timeout","$compile","dialogue","userEnterpriseService","controller","$scope","$element","$attrs","enterpriseUser","table","checkbox","domMain","Event","DOMAININFOSINIT","args","destroy","hasClass","select","DataTable","language","ProudSmart","datatable","autoWidth","order","columns","optionCol1","initComplete","setting","eq","columnDefs","targets","orderable","full","str","parent","createBtn","cls","subcls","button","span","deleteBtn","queryPart","queryFormat","queryDom","btnGroup","drop","ul","inputWrap","searchIcon","searchText","searchBtn","dt","createInput","createLi","li","a","createQuary","run","queryEnterpriseUser","e","preventDefault","tr","this","closest","rowData","row","context","cellIndex","isEdit","toggleClass","rows","selectRow","doAction","$filter","isEditing","DOMAINDEVICESINIT","visible","escape","Math","random","selectDomain1","enterpriseDomain","selectPath","deviceIdTree","domainsAry","rowCallback","nRow","aData","iDataIndex","domainSelect","domainSelectName","val","flg","draw","cells","invalidate"],"mappings":"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","file":"app-oc/js/directives/domain-dom.js","sourcesContent":["define(['directives/directives', 'datatables.net', 'datatables.net-bs'], function (directives, datatables) {\n  'use strict';\n\n  directives.initDirective('treeData', ['$timeout', 'ngDialog', 'userDomainService', 'customerUIService', 'projectUIService', 'growl', function (timeout, ngDialog, userDomainService, customerUIService, projectUIService, growl) {\n    return {\n      restrict: 'A',\n      scope: {\n        ngModel: \"=\",\n        add: \"&\",\n        delete: \"&\",\n        edit: \"&\",\n        user: \"&\"\n      },\n      link: function link(scope, element, attr) {\n        var TEXT = {\n          \"SUBMIT\": \"确定\",\n          \"CANCEL\": \"取消\"\n        };\n        var description = $(\"<div></div>\").css(\"z-index\", 1999).css(\"background-color\", \"#fff\").css(\"box-shadow\", \"1px 1px 10px rgba(0,0,0,.3)\").css(\"padding\", \"15px 20px\").css(\"margin\", \"-5px 0 0 25px\").css(\"display\", \"block\").css(\"width\", \"300px\").css(\"position\", \"fixed\");\n        var des_text = $(\"<p></p>\").text('').css(\"color\", \"#666\").css(\"margin\", 0).css(\"line-height\", \"16px\").css(\"font-size\", \"12px\").css(\"font-weight\", \"normal\");\n        var des_close = $(\"<div></div>\").append($(\"<span class='close'>x</span>\"));\n        var des_title = $(\"<p></p>\").text(\"描述 :\").css(\"font-weight\", \"bold\").css(\"color\", \"#333\").css(\"margin\", \"10px auto\").css(\"line-height\", \"16px\").css(\"font-size\", \"12px\");\n        description.append(des_close).append(des_text);\n\n        var ready = function ready() {\n          $(element).css(\"position\", \"relative\");\n\n          var ngModelWatcher = function ngModelWatcher(n, o, s) {\n            var getAllName = function getAllName(data) {\n              var rs = [];\n\n              var traverse = function traverse(data) {\n                rs.push(data.label);\n\n                var loop = function loop(elem) {\n                  traverse(elem);\n                };\n\n                if (data.hasOwnProperty(\"children\")) {\n                  for (var i in data.children) {\n                    loop(data.children[i]);\n                  }\n                }\n              };\n\n              traverse(data);\n              return rs;\n            };\n\n            var render = function render(data, type, searchlist) {\n              var tree = data,\n                  searchFound = type == \"search\" ? false : true;\n              $(element).children().remove();\n\n              var traverse = function traverse(target, data, depth, parentIcon, parentRmvBtn, parentDom, parentUser, parentData) {\n                depth++;\n                var children;\n                var dom = $(\"<div></div>\").css(\"border-bottom\", \"1px solid #ddd\").css(\"position\", \"relative\").css(\"overflow\", \"hidden\").css(\"opacity\", 0).css(\"max-height\", 0).css(\"line-height\", \"32px\"); //提高用户体验  鼠标经过变色\n\n                $(dom).hover(function () {\n                  $(dom).css('background-color', '#eee');\n                }, function () {\n                  $(dom).css('background-color', '#fff');\n                });\n                var btn = $(\"<button></button>\").css(\"line-height\", \"20px\").css(\"color\", \"#fff\").css(\"border\", \"0\").css(\"background-color\", \"#009dea\").css(\"float\", \"left\").css(\"padding\", \"2px 5px 2px 6px\").css(\"margin\", \"4px 0px 0px 3px\");\n                var icon = $(\"<span></span>\").addClass(\"glyphicon glyphicon-minus\").css(\"font-size\", \"10px\");\n                var userIcon = $(\"<span></span>\").addClass(\"glyphicon glyphicon-user\").css(\"opacity\", 0).css(\"margin\", \"0 5px 0 8px\").css(\"color\", \"#ccc\");\n                var rubish = $(\"<div></div>\").addClass(\"glyphicon glyphicon-trash\");\n                var add = $(\"<div></div>\").addClass(\"glyphicon glyphicon-plus\");\n                var person = $(\"<span></span>\").addClass(\"glyphicon glyphicon-user\");\n                var text = $(\"<span></span>\").css(\"margin-left\", 10).text(data.name + (data.modelId == 301 ? \"[客户域]\" : data.modelId == 302 ? \"[项目域]\" : \"\"));\n                var infoBtn = $(\"<span></span>\").addClass(\"glyphicon glyphicon-question-sign\").css(\"font-size\", \"16px\").css(\"color\", \"#eee\").css(\"margin-left\", \"20px\");\n\n                var infoBtnClick = function infoBtnClick(event) {\n                  event.stopPropagation();\n                  description.remove();\n                  var offset = $(event.target).offset();\n                  description.css({\n                    opacity: 0,\n                    top: offset.top - 20,\n                    left: offset.left + 5\n                  });\n                  des_text.text(data.description);\n                  $(\"body\").prepend(description);\n                  description.animate({\n                    opacity: 1\n                  }, 300);\n                  $(\"body\").on(\"click.infoleave\", infoBtnLeave);\n                };\n\n                var infoBtnLeave = function infoBtnLeave(event) {\n                  event.stopPropagation();\n                  $(\"body\").off();\n                  description.remove();\n                };\n\n                var edit = $(\"<span></span>\").addClass(\"proudsmart ps-edit\");\n                var removeBtn = $(\"<button></button>\").css(\"color\", \"#dd695c\").css(\"border\", \"1px solid #ddd\").css(\"margin\", 0).css(\"background-color\", \"#fff\").css(\"line-height\", \"14px\").css(\"position\", \"relative\").css(\"overflow\", \"visible\").css(\"float\", \"right\").css(\"z-index\", 3).css(\"margin\", \"4px 3px 0px 2px\");\n                var addBtn = removeBtn.clone();\n                var editBtn = removeBtn.clone(); //var userBtn = removeBtn.clone();\n\n                var cover = $(\"<div></div>\").css(\"background-color\", \"#0f58a9\").css(\"opacity\", .2).css(\"position\", \"absolute\").css(\"height\", \"40px\").css(\"top\", 0).css(\"width\", \"100%\");\n                var inner = $(\"<div></div>\").css(\"margin-left\", (type != \"search\" ? depth * 20 : 0) + \"px\");\n                addBtn.append(add);\n                addBtn.css(\"z-index\", 1).css(\"color\", \"#1eb8b8\");\n                editBtn.append(edit);\n                editBtn.css(\"z-index\", 2).css(\"color\", \"#009fea\");\n                removeBtn.append(rubish); //userBtn.append(person);\n\n                if (type == \"search\") {\n                  var find = searchlist.find(function (elem) {\n                    return elem.name == data.name;\n                  });\n\n                  if (!find) {\n                    dom.css(\"display\", \"none\");\n                  } else {\n                    searchFound = true;\n                    btn.prop(\"disabled\", true);\n                    dom.on(\"click\", function (event) {\n                      scope.$broadcast(\"HIGHLIGHTDATA\", data);\n                    });\n                  }\n\n                  btn.css(\"display\", \"none\");\n                } else if (type == \"highlight\") {\n                  if (searchlist) {// if(data.id == searchlist.id){\n                    //   dom.css(\"background-color\", \"#d1edaa\");\n                    // }\n                  }\n                }\n\n                btn.append(icon);\n\n                if (data.description) {\n                  infoBtn.css(\"cursor\", \"pointer\").css(\"color\", \"#ccc\").on(\"click\", infoBtnClick);\n                }\n\n                if (!parentData || data.modelId == 301 && data.layer == 1 || data.modelId == 302 && data.layer == 1) {\n                  // dom.css(\"background-color\", \"#eee\");\n                  editBtn.css(\"display\", \"block\"); // removeBtn.css(\"display\", \"none\");\n                }\n\n                var foldClick = function foldClick(event) {\n                  if (children.css(\"max-height\") == \"0px\") {\n                    timeout(function () {\n                      icon.removeClass().addClass(\"glyphicon glyphicon-minus\");\n                      children.animate({\n                        \"max-height\": 800,\n                        \"opacity\": 1\n                      }, 300);\n                    });\n                  } else {\n                    timeout(function () {\n                      icon.removeClass().addClass(\"glyphicon glyphicon-plus\");\n                      children.animate({\n                        \"max-height\": 0,\n                        \"opacity\": 0\n                      }, 300);\n                    });\n                  }\n\n                  ;\n                };\n\n                var addClick = function addClick(event) {\n                  var provinces = scope.$parent.provinces;\n                  var cityDics = scope.$parent.cityDics;\n                  var districtDics = scope.$parent.districtDics;\n                  event.stopPropagation();\n                  description.remove();\n\n                  var cancel = function cancel(event) {\n                    ngDialog.close();\n                  };\n\n                  var namelist = [];\n\n                  if (data.children == undefined) {\n                    data.children = [];\n                  }\n\n                  namelist = getAllName(tree);\n                  var inx = 0;\n                  var name = \"新建域\";\n\n                  while (namelist.indexOf(name) != -1) {\n                    inx++;\n                    name = \"新建域_\" + inx;\n                  }\n\n                  var confirm = function confirm(event) {\n                    if (event.input[0].value == '' || event.input[0].value == null) {\n                      growl.warning(\"域名称不能为空\", {});\n                      return;\n                    }\n\n                    if (event.input[2].value == '' || event.input[2].value == null) {\n                      growl.warning(\"编码不能为空\", {});\n                      return;\n                    }\n\n                    if (event.input[3].value == '' || event.input[3].value == null) {\n                      growl.warning(\"所在省不能为空\", {});\n                      return;\n                    }\n\n                    ngDialog.close();\n                    var domainID = data.id;\n                    var name = event.input[0].value;\n                    var des = event.input[event.input.length - 1].value; // 新增加的序号\n\n                    var number = event.input[1].value - 0; // 新增加的编码\n\n                    var externalDevId = event.input[2].value;\n                    var standardAddress = areaList[2].value.id ? areaList[2].value.id : areaList[1].value.id ? areaList[1].value.id : areaList[0].value.id;\n\n                    var success = function success(returnObj) {\n                      if (returnObj.code == 0) {\n                        var newAdd = returnObj.data;\n                        data.children.push(newAdd);\n                        userIcon.css(\"display\", \"none\");\n                        btn.css(\"display\", \"inline\");\n                        icon.removeClass().addClass(\"glyphicon glyphicon-minus\");\n\n                        if (children == undefined) {\n                          children = $(\"<div></div>\").css(\"overflow\", \"hidden\").css(\"position\", \"relative\");\n                        }\n\n                        dom.after(children);\n                        btn.off(\"click\");\n                        btn.on(\"click\", foldClick);\n                        removeBtn.prop(\"disabled\", true);\n                        removeBtn.css(\"color\", \"#aaa\");\n                        dom.css(\"font-weight\", \"bold\");\n                        traverse(children, newAdd, depth, btn, removeBtn, dom, userIcon, data.children);\n                        scope.add({\n                          event: data\n                        });\n\n                        if (children.css(\"max-height\") == \"0px\") {\n                          timeout(function () {\n                            icon.removeClass().addClass(\"glyphicon glyphicon-minus\");\n                            children.animate({\n                              \"max-height\": 400,\n                              \"opacity\": 1\n                            }, 300, function () {});\n                          });\n                        }\n\n                        ;\n                        growl.success(\"新增管理域成功\", {});\n                      } else {\n                        growl.warning(\"新增管理域失败\", {});\n                      }\n                    };\n\n                    var error = function error(returnObj) {\n                      growl.warning(\"新增管理域失败\", {});\n                    };\n\n                    getAddressPointFromTools(standardAddress.split(\",\").join(\"\"), function (address) {\n                      userDomainService.addDomain(domainID, {\n                        name: name,\n                        description: des,\n                        externalDevId: externalDevId,\n                        values: {\n                          number: number,\n                          standardAddress: standardAddress,\n                          longitude: address ? address.location.lng : \"\",\n                          latitude: address ? address.location.lat : \"\"\n                        }\n                      }, success);\n                    });\n                  };\n\n                  var fnlist = [{\n                    label: TEXT.SUBMIT,\n                    icon: 'btn btn-primary',\n                    style: {\n                      width: '50%',\n                      'border-radius': 0,\n                      'font-size': '18px',\n                      'font-weight': 'bold',\n                      'padding': 10\n                    },\n                    disabled: function disabled() {\n                      var every = scope.dialog.input.every(function (elem) {\n                        return elem.right == true;\n                      });\n                      return !every;\n                    },\n                    fn: function fn() {\n                      var errorStatus = -1;\n                      scope.dialog.input.forEach(function (elem) {\n                        if (elem.error) {\n                          errorStatus = 1;\n                          return;\n                        }\n                      });\n\n                      if (errorStatus == -1) {\n                        var self = scope.dialog;\n                        confirm(self);\n                      }\n                    }\n                  }, {\n                    label: TEXT.CANCEL,\n                    icon: 'btn btn-default',\n                    style: {\n                      width: '50%',\n                      'border-radius': 0,\n                      'font-size': '18px',\n                      'font-weight': 'bold',\n                      'padding': 10\n                    },\n                    fn: cancel\n                  }];\n                  var areaList = [{\n                    value: '',\n                    label: '所在省',\n                    type: 'select',\n                    composory: true,\n                    placeholder: '',\n                    format: {\n                      label: 'label'\n                    },\n                    abled: false,\n                    right: false,\n                    options: provinces,\n                    maxlength: 32,\n                    onChange: function onChange(event) {\n                      areaList[2].value = \"\"; // areaList[2].right = false;\n\n                      if (event.value == \"\") {\n                        areaList[1].abled = true;\n                        event.right = false;\n                      } else {\n                        if (cityDics[event.value.id]) {\n                          areaList[1].options = cityDics[event.value.id];\n                        }\n\n                        areaList[1].abled = false;\n                        event.right = true;\n                      }\n                    }\n                  }, {\n                    value: '',\n                    label: '所在市',\n                    type: 'select',\n                    composory: false,\n                    placeholder: '',\n                    format: {\n                      label: 'label'\n                    },\n                    abled: true,\n                    right: true,\n                    options: cityDics,\n                    maxlength: 32,\n                    onChange: function onChange(event) {\n                      areaList[2].value = \"\"; // areaList[2].right = false;\n\n                      if (event.value == \"\") {\n                        areaList[2].abled = true;\n                        event.right = false;\n                      } else {\n                        if (event.value && districtDics[event.value.id]) {\n                          areaList[2].options = districtDics[event.value.id];\n                        }\n\n                        areaList[2].abled = false;\n                        event.right = true;\n                      }\n                    }\n                  }, {\n                    value: '',\n                    label: '区/县',\n                    type: 'select',\n                    composory: false,\n                    placeholder: '',\n                    format: {\n                      label: 'label'\n                    },\n                    abled: true,\n                    right: true,\n                    options: districtDics,\n                    maxlength: 32,\n                    onChange: function onChange(event) {\n                      if (event.value == \"\") {\n                        event.right = false;\n                      } else {\n                        event.right = true;\n                      }\n                    }\n                  }];\n                  scope.dialog = {\n                    title: {\n                      label: '管理域信息'\n                    },\n                    input: [{\n                      value: name,\n                      label: '域名称 ',\n                      type: 'input',\n                      composory: true,\n                      placeholder: '填写域名称',\n                      maxlength: 32,\n                      right: true,\n                      onChange: function onChange(event) {\n                        if (event.value == \"\") {\n                          event.error = \"域名称不可为空\";\n                          event.right = false;\n                        }\n                        /**else if (namelist.indexOf(event.value) != -1) {\n                        event.error = \"此域已被占用\";\n                        event.right = false;\n                        } */\n                        else {\n                            event.error = null;\n                            event.right = true;\n                          }\n                      }\n                    }, {\n                      value: \"\",\n                      label: '序号 ',\n                      type: 'input',\n                      placeholder: '填填写序号',\n                      right: true\n                    }, {\n                      value: \"\",\n                      label: '编码 ',\n                      type: 'input',\n                      composory: true,\n                      placeholder: '填填写编码',\n                      right: true,\n                      onChange: function onChange(event) {\n                        if (event.value == \"\") {\n                          event.error = \"编码不可为空\";\n                          event.right = false;\n                        } else {\n                          event.error = null;\n                          event.right = true;\n                        }\n                      }\n                    }, areaList[0], areaList[1], areaList[2], {\n                      maxlength: 200,\n                      value: '',\n                      label: '域描述 ',\n                      type: 'textarea',\n                      right: true,\n                      placeholder: '填写域描述'\n                    }],\n                    fnlist: fnlist\n                  };\n                  ngDialog.open({\n                    template: '../partials/dialogue/common_dia.html',\n                    className: 'ngdialog-theme-plain',\n                    scope: scope\n                  });\n                };\n\n                var removeClick = function removeClick() {\n                  event.stopPropagation();\n                  description.remove();\n                  var domainID = data.id;\n                  var domainPath = data.domainPath;\n                  var domain = {\n                    \"id\": domainID,\n                    \"domainPath\": domainPath\n                  }; // 300 是管理域\n\n                  if (data.modelId == 302) {\n                    //如果是项目域  （区域信息）  modelId 30\n                    projectUIService.findProjectsByCondition({\n                      \"orCondition\": \"\",\n                      \"domainPath\": \"\",\n                      \"projectName\": data.name\n                    }, function (r) {\n                      if (r.data && r.data.length != 0) {\n                        growl.warning('该域不能删除');\n                        return;\n                      }\n\n                      userDomainService.queryDeleteDomain(domain, function (resultObj) {\n                        if (resultObj.data != \"true\") {\n                          growl.warning(resultObj.data, {});\n                        } else {\n                          var confirm = function confirm() {\n                            var success = function success(event) {\n                              if (event.code == 0) {\n                                growl.success(\"删除管理域成功\", {});\n                                parentData.$remove(function (index, elem) {\n                                  return elem.id == data.id;\n                                });\n\n                                if (parentData.length == 0) {\n                                  parentRmvBtn.removeAttr(\"disabled\");\n                                  parentRmvBtn.css(\"color\", \"#dd695c\");\n                                } else {\n                                  parentRmvBtn.prop(\"disabled\", true);\n                                  parentRmvBtn.css(\"color\", \"#aaa\");\n                                }\n\n                                ngDialog.close();\n\n                                var animFinished = function animFinished() {\n                                  dom.remove();\n\n                                  if (target.children().size() == 0) {\n                                    target.remove();\n                                    parentDom.css(\"font-weight\", \"normal\");\n                                    parentDom.css(\"background-color\", \"#fff\");\n                                    parentRmvBtn.css(\"display\", \"block\");\n                                    parentIcon.css(\"display\", \"none\");\n                                    parentUser.css(\"display\", \"inline\");\n                                  }\n                                };\n\n                                dom.animate({\n                                  \"opacity\": 0,\n                                  \"max-height\": 0\n                                }, 300, animFinished);\n                                scope.delete({\n                                  event: data\n                                });\n                              }\n                            };\n\n                            userDomainService.deleteDomain(domainID, domainPath, success);\n                          };\n\n                          var cancel = function cancel() {\n                            ngDialog.close();\n                          };\n\n                          var fnlist = [{\n                            label: '确定',\n                            icon: 'btn btn-success',\n                            style: {\n                              width: '50%',\n                              'border-radius': 0,\n                              'font-size': '18px',\n                              'font-weight': 'bold',\n                              'padding': 10\n                            },\n                            fn: confirm\n                          }, {\n                            label: '取消',\n                            icon: 'btn btn-default',\n                            style: {\n                              width: '50%',\n                              'border-radius': 0,\n                              'font-size': '18px',\n                              'font-weight': 'bold',\n                              'padding': 10\n                            },\n                            fn: cancel\n                          }];\n                          scope.dialog = {\n                            title: {\n                              label: '提示'\n                            },\n                            description: {\n                              label: '确认删除域?'\n                            },\n                            fnlist: fnlist\n                          };\n                          ngDialog.open({\n                            template: '../partials/dialogue/common_dia_prompt.html',\n                            className: 'ngdialog-theme-plain',\n                            scope: scope\n                          });\n                        }\n                      });\n                    });\n                  } else if (data.modelId == 301) {\n                    2; //如果是客户域  （产线信息） modelId 301\n\n                    customerUIService.findCustomersByCondition({\n                      \"id\": data.id,\n                      \"orCondition\": \"\",\n                      \"customerName\": \"\",\n                      \"customerAddress\": \"\",\n                      \"domainPath\": \"\",\n                      \"customerPhone\": \"\"\n                    }, function (res) {\n                      if (res.data && res.data.length !== 0) {\n                        growl.warning('该域不能删除');\n                        return;\n                      }\n\n                      userDomainService.queryDeleteDomain(domain, function (resultObj) {\n                        if (resultObj.data != \"true\") {\n                          growl.warning(resultObj.data, {});\n                        } else {\n                          var confirm = function confirm() {\n                            var success = function success(event) {\n                              if (event.code == 0) {\n                                growl.success(\"删除管理域成功\", {});\n                                parentData.$remove(function (index, elem) {\n                                  return elem.id == data.id;\n                                });\n\n                                if (parentData.length == 0) {\n                                  parentRmvBtn.removeAttr(\"disabled\");\n                                  parentRmvBtn.css(\"color\", \"#dd695c\");\n                                } else {\n                                  parentRmvBtn.prop(\"disabled\", true);\n                                  parentRmvBtn.css(\"color\", \"#aaa\");\n                                }\n\n                                ngDialog.close();\n\n                                var animFinished = function animFinished() {\n                                  dom.remove();\n\n                                  if (target.children().size() == 0) {\n                                    target.remove();\n                                    parentDom.css(\"font-weight\", \"normal\");\n                                    parentDom.css(\"background-color\", \"#fff\");\n                                    parentRmvBtn.css(\"display\", \"block\");\n                                    parentIcon.css(\"display\", \"none\");\n                                    parentUser.css(\"display\", \"inline\");\n                                  }\n                                };\n\n                                dom.animate({\n                                  \"opacity\": 0,\n                                  \"max-height\": 0\n                                }, 300, animFinished);\n                                scope.delete({\n                                  event: data\n                                });\n                              }\n                            };\n\n                            userDomainService.deleteDomain(domainID, domainPath, success);\n                          };\n\n                          var cancel = function cancel() {\n                            ngDialog.close();\n                          };\n\n                          var fnlist = [{\n                            label: '确定',\n                            icon: 'btn btn-success',\n                            style: {\n                              width: '50%',\n                              'border-radius': 0,\n                              'font-size': '18px',\n                              'font-weight': 'bold',\n                              'padding': 10\n                            },\n                            fn: confirm\n                          }, {\n                            label: '取消',\n                            icon: 'btn btn-default',\n                            style: {\n                              width: '50%',\n                              'border-radius': 0,\n                              'font-size': '18px',\n                              'font-weight': 'bold',\n                              'padding': 10\n                            },\n                            fn: cancel\n                          }];\n                          scope.dialog = {\n                            title: {\n                              label: '提示'\n                            },\n                            description: {\n                              label: '确认删除域?'\n                            },\n                            fnlist: fnlist\n                          };\n                          ngDialog.open({\n                            template: '../partials/dialogue/common_dia_prompt.html',\n                            className: 'ngdialog-theme-plain',\n                            scope: scope\n                          });\n                        }\n                      });\n                    });\n                  }\n                };\n\n                var editClick = function editClick(event) {\n                  var provinces = scope.$parent.provinces;\n                  var cityDics = scope.$parent.cityDics;\n                  var districtDics = scope.$parent.districtDics;\n                  event.stopPropagation();\n                  description.remove();\n                  var domainID = data.id;\n\n                  if (data.values.standardAddress) {\n                    var arr = data.values.standardAddress.split(\",\");\n                    data.provinceId = arr[0];\n                    data.province = provinces.find(function (item) {\n                      return arr[0] == item.label;\n                    });\n\n                    if (arr[1]) {\n                      data.cityId = cityDics[arr[0]].find(function (item) {\n                        return arr[1] == item.label;\n                      }).id;\n                      data.city = cityDics[arr[0]].find(function (item) {\n                        return arr[1] == item.label;\n                      });\n\n                      if (!arr[2]) {\n                        data.county = \"\";\n                      }\n                    } else if (!arr[1]) {\n                      data.county = \"\";\n                      data.cityId = \"\";\n                    }\n\n                    if (arr[2]) {\n                      data.county = districtDics[data.cityId].find(function (item) {\n                        return arr[2] == item.label;\n                      });\n                    }\n                  } else {\n                    data.province = \"\";\n                    data.city = \"\";\n                    data.county = \"\";\n                  }\n                  /**\n                   var filter = parentData.filter(function(elem){\n                    return elem.domainID != data.domainID;\n                  });\n                   */\n\n\n                  var namelist = getAllName(tree);\n                  namelist.$remove(function (index, elem) {\n                    return elem == data.name;\n                  });\n\n                  var cancel = function cancel(event) {\n                    ngDialog.close();\n                  };\n\n                  var confirm = function confirm(event) {\n                    if (event.input[0].value == '' || event.input[0].value == null) {\n                      growl.warning(\"域名称不能为空\", {});\n                      return;\n                    }\n\n                    if (event.input[2].value == '' || event.input[2].value == null) {\n                      growl.warning(\"编码不能为空\", {});\n                      return;\n                    }\n\n                    if (event.input[3].value == '' || event.input[3].value == null) {\n                      growl.warning(\"所在省不能为空\", {});\n                      return;\n                    }\n\n                    var standardAddress;\n                    var name = event.input[0].value;\n                    var des = event.input[event.input.length - 1].value; // 新增加的序号\n\n                    var number = event.input[1].value - 0; // 新增加的编码\n\n                    var externalDevId = event.input[2].value;\n\n                    if (areaList[2].value) {\n                      standardAddress = areaList[2].value.id; // standardAddress = areaList[2].value.id ? areaList[2].value.id : (areaList[1].value.id ? areaList[1].value.id : (areaList[0].value.id));\n                    } else if (areaList[1].value) {\n                      standardAddress = areaList[1].value.id;\n                    } else {\n                      standardAddress = areaList[0].value.id;\n                    }\n\n                    getAddressPointFromTools(standardAddress.split(\",\").join(\"\"), function (address) {\n                      data.id = domainID;\n                      data.name = name;\n                      data.label = name; //label更新\n\n                      data.externalDevId = externalDevId;\n                      data.description = des;\n                      data.values = data.values || {};\n                      data.values.number = number;\n                      data.values.standardAddress = standardAddress;\n                      data.values.longitude = address ? address.location.lng : \"\";\n                      data.values.latitude = address ? address.location.lat : \"\";\n                      userDomainService.modifyDomain([data], function (returnObj) {\n                        if (returnObj.code == 0) {\n                          if (returnObj.data) {\n                            if (returnObj.data.description) {\n                              infoBtn.css(\"cursor\", \"pointer\").css(\"color\", \"#ccc\").on(\"click\", infoBtnClick);\n                            } else {\n                              infoBtn.css(\"cursor\", \"default\").css(\"color\", \"#eee\").off(\"click\");\n                            }\n\n                            text.text(returnObj.data.name + (returnObj.data.modelId == 301 ? \"[客户域]\" : returnObj.data.modelId == 302 ? \"[项目域]\" : \"\"));\n                            des_text.text(returnObj.data.description);\n                            data.name = returnObj.data.name;\n                            data.label = returnObj.data.label;\n                            data.externalDevId = returnObj.data.externalDevId;\n                            data.values.number = returnObj.data.values.number;\n                            data.values.standardAddress = returnObj.data.values.standardAddress;\n                            data.description = returnObj.data.description;\n                          }\n\n                          growl.success(\"修改管理域成功\", {});\n                        } else {\n                          growl.warning(\"修改管理域失败\", {});\n                          return;\n                        }\n                      });\n                    });\n                    ngDialog.close();\n                  };\n\n                  var fnlist = [{\n                    label: '确定',\n                    icon: 'btn btn-primary',\n                    style: {\n                      width: '50%',\n                      'border-radius': 0,\n                      'font-size': '18px',\n                      'font-weight': 'bold',\n                      'padding': 10\n                    },\n                    disabled: function disabled() {\n                      var every = scope.dialog.input.every(function (elem) {\n                        return elem.right == true;\n                      });\n                      return !every;\n                    },\n                    fn: function fn() {\n                      var errorStatus = -1;\n                      scope.dialog.input.forEach(function (elem) {\n                        if (elem.error) {\n                          errorStatus = 1;\n                          return;\n                        }\n                      });\n\n                      if (errorStatus == -1) {\n                        var self = scope.dialog;\n                        confirm(self);\n                      }\n                    }\n                  }, {\n                    label: '取消',\n                    icon: 'btn btn-default',\n                    style: {\n                      width: '50%',\n                      'border-radius': 0,\n                      'font-size': '18px',\n                      'font-weight': 'bold',\n                      'padding': 10\n                    },\n                    fn: cancel\n                  }];\n                  /**\n                   * 是客户域和项目域进行特殊处理不可以编辑\n                   * 韩星 2018-03-15\n                   * @type {boolean}\n                   */\n\n                  var isFlag = (data.modelId == \"301\" || data.modelId == \"302\") && data.layer == \"1\";\n                  var areaList = [{\n                    value: data.province,\n                    label: '所在省',\n                    type: 'select',\n                    composory: true,\n                    placeholder: '',\n                    format: {\n                      label: 'label'\n                    },\n                    abled: isFlag ? true : false,\n                    options: provinces,\n                    maxlength: 32,\n                    right: data.province ? true : false,\n                    onChange: function onChange(event) {\n                      areaList[2].value = \"\";\n                      areaList[2].options = []; // areaList[2].right = false;\n\n                      if (event.value == \"\") {\n                        areaList[1].abled = true;\n                        event.right = false;\n                      } else {\n                        if (cityDics[event.value.id]) {\n                          areaList[1].options = cityDics[event.value.id];\n                        }\n\n                        areaList[1].abled = false;\n                        event.right = true;\n                      }\n                    }\n                  }, {\n                    value: data.city,\n                    label: '所在市',\n                    type: 'select',\n                    composory: false,\n                    placeholder: '',\n                    format: {\n                      label: 'label'\n                    },\n                    abled: isFlag ? true : false,\n                    // abled: arr[0] ? false : true,\n                    right: true,\n                    // right: data.city ? true : false,\n                    options: cityDics[data.provinceId],\n                    maxlength: 32,\n                    onChange: function onChange(event) {\n                      areaList[2].value = \"\"; // areaList[2].right = false;\n\n                      if (event.value == \"\") {\n                        areaList[2].abled = true;\n                        areaList[2].options = [];\n                        event.right = false;\n                      } else {\n                        if (event.value && districtDics[event.value.id]) {\n                          areaList[2].options = districtDics[event.value.id];\n                        }\n\n                        areaList[2].abled = false;\n                        event.right = true;\n                      }\n                    }\n                  }, {\n                    value: data.county,\n                    label: '区/县',\n                    type: 'select',\n                    composory: false,\n                    placeholder: '',\n                    format: {\n                      label: 'label'\n                    },\n                    abled: isFlag ? true : false,\n                    right: true,\n                    // right: data.county ? true : false,\n                    options: districtDics[data.cityId],\n                    maxlength: 32,\n                    onChange: function onChange(event) {\n                      if (event.value == \"\") {\n                        event.right = false;\n                      } else {\n                        event.right = true;\n                      }\n                    }\n                  }];\n                  scope.dialog = {\n                    title: {\n                      label: '管理域信息'\n                    },\n                    input: [{\n                      value: data.name,\n                      type: 'input',\n                      label: '域名称',\n                      maxlength: 32,\n                      composory: true,\n                      disabled: isFlag ? true : false,\n                      right: true,\n                      placeholder: '填写域名称',\n                      onChange: function onChange(event) {\n                        if (event.value == \"\") {\n                          event.error = \"域名称不可为空\";\n                          event.right = false;\n                        }\n                        /** else if (namelist.indexOf(event.value) != -1) {\n                        event.error = \"此域已被占用\";\n                        event.right = false;\n                        } */\n                        else {\n                            event.error = null;\n                            event.right = true;\n                          }\n                      }\n                    }, {\n                      value: data.values.number,\n                      label: '序号 ',\n                      type: 'input',\n                      placeholder: '填填写序号',\n                      right: true,\n                      abled: true\n                    }, {\n                      value: data.externalDevId,\n                      label: '编码 ',\n                      type: 'input',\n                      composory: true,\n                      placeholder: '填填写编码',\n                      right: true,\n                      onChange: function onChange(event) {\n                        if (event.value == \"\") {\n                          event.error = \"编码不可为空\";\n                          event.right = false;\n                        } else {\n                          event.error = null;\n                          event.right = true;\n                        }\n                      }\n                    }, areaList[0], areaList[1], areaList[2], {\n                      value: data.description,\n                      label: '域描述',\n                      type: 'textarea',\n                      right: true,\n                      maxlength: 200,\n                      placeholder: '填写域描述'\n                    }],\n                    fnlist: fnlist\n                  };\n                  ngDialog.open({\n                    template: '../partials/dialogue/common_dia.html',\n                    className: 'ngdialog-theme-plain',\n                    scope: scope\n                  });\n\n                  var ready = function ready() {\n                    scope.edit({\n                      event: data\n                    });\n                  };\n\n                  scope.$apply(ready);\n                };\n\n                var userClick = function userClick() {\n                  var ready = function ready() {\n                    scope.user({\n                      event: data\n                    });\n                  };\n\n                  scope.$apply(ready);\n                };\n\n                var intro = $('<div></div>').css(\"padding\", \"2px 10px\").css(\"top\", \"0px\").css(\"right\", \"32px\").css(\"pointer-events\", \"none\").css(\"border-radius\", \"2px\").css(\"background-color\", \"#000\").css(\"position\", \"absolute\").css(\"font-weight\", \"bold\").css(\"width\", \"80px\").css(\"color\", \"#fff\");\n\n                var addenter = function addenter() {\n                  intro.text(\"创建子域\");\n                  addBtn.append(intro);\n                };\n\n                var addleave = function addleave() {\n                  intro.remove();\n                };\n\n                var removeenter = function removeenter() {\n                  intro.text(\"删除\");\n                  removeBtn.append(intro);\n                };\n\n                var removeleave = function removeleave() {\n                  intro.remove();\n                };\n\n                var editenter = function editenter() {\n                  intro.text(\"编辑\");\n                  editBtn.append(intro);\n                };\n\n                var editleave = function editleave() {\n                  intro.remove();\n                };\n\n                removeBtn.on(\"click\", removeClick);\n                addBtn.on(\"click\", addClick);\n                addBtn.on(\"mouseenter\", addenter);\n                addBtn.on(\"mouseleave\", addleave);\n                removeBtn.on(\"mouseenter\", removeenter);\n                removeBtn.on(\"mouseleave\", removeleave);\n                editBtn.on(\"click\", editClick);\n                editBtn.on(\"mouseenter\", editenter);\n                editBtn.on(\"mouseleave\", editleave); //userBtn.on(\"click\", userClick);\n\n                target.append(dom);\n\n                if (type != 'search') {\n                  inner.append(btn).append(userIcon);\n                }\n\n                ;\n                inner.append(text).append(infoBtn);\n                dom.animate({\n                  \"opacity\": 1,\n                  \"max-height\": \"50px\"\n                }, 300);\n                cover.animate({\n                  \"opacity\": \"0\"\n                }, 700, function () {\n                  cover.remove();\n                });\n\n                if (data.hasOwnProperty(\"children\")) {\n                  userIcon.css(\"display\", \"none\");\n                  btn.css(\"display\", \"block\");\n                  dom.css(\"font-weight\", \"bold\"); //dom.css(\"background-color\", \"#eee\");\n\n                  if (data.show = false) {\n                    dom.css(\"max-height\", 0);\n                  }\n\n                  ;\n                  children = $(\"<div></div>\").css(\"overflow\", \"hidden\");\n\n                  var hasChild = function hasChild(data, target) {\n                    var traverse = function traverse(data) {\n                      if (data == target) {\n                        return true;\n                      } else if (data.hasOwnProperty(\"children\")) {\n                        for (var i in data.children) {\n                          if (traverse(data.children[i])) {\n                            return true;\n                          }\n                        }\n\n                        return false;\n                      } else {\n                        return false;\n                      }\n                    };\n\n                    return traverse(data);\n                  };\n\n                  if (type == 'search') {\n                    icon.removeClass().addClass(\"glyphicon glyphicon-minus\");\n                  } else if (type == 'highlight') {\n                    if (hasChild(data, searchlist) && data != searchlist) {\n                      icon.removeClass().addClass(\"glyphicon glyphicon-minus\");\n                    } else {\n                      children.css(\"max-height\", 0);\n                      icon.removeClass().addClass(\"glyphicon glyphicon-plus\");\n                    }\n\n                    ;\n                  } else {\n                    if (depth > 1) {\n                      children.css(\"max-height\", 0);\n                      icon.removeClass().addClass(\"glyphicon glyphicon-plus\");\n                    }\n                  }\n\n                  target.append(children);\n\n                  for (var i in data.children) {\n                    traverse(children, data.children[i], depth, btn, removeBtn, dom, userIcon, data.children);\n                  }\n\n                  removeBtn.prop(\"disabled\", true);\n                  removeBtn.css(\"color\", \"#aaa\"); //removeBtn.css(\"display\", \"none\");\n\n                  btn.on(\"click\", foldClick);\n                } else {\n                  userIcon.css(\"display\", \"inline\");\n                  btn.css(\"display\", \"none\");\n                  removeBtn.removeAttr(\"disabled\");\n                  removeBtn.css(\"color\", \"#dd695c\"); //removeBtn.css(\"display\", \"inline\");\n                }\n\n                if (!parentData) {// dom.css(\"background-color\", \"#eee\");\n                } else {\n                  inner.append(removeBtn).append(editBtn);\n                }\n\n                inner.append(addBtn);\n                dom.append(inner);\n                dom.append(cover);\n              };\n\n              if (data instanceof Array) {\n                for (var i in data) {\n                  traverse($(element), data[i], -1);\n                }\n              } else {\n                traverse($(element), data, -1);\n              }\n\n              if (!searchFound) {\n                var error = $(\"<div></div>\").text(\"没有符合条件的记录。\").css(\"line-height\", \"50px\").css(\"text-align\", \"center\");\n                $(element).append(error);\n              }\n            };\n\n            if (n != undefined) {\n              scope.$on(\"SEARCHDATA\", function (event, data) {\n                render(n, \"search\", data);\n              });\n              scope.$on(\"HIGHLIGHTDATA\", function (event, data) {\n                render(n, 'highlight', data);\n              });\n              scope.$on(\"RENDERDATA\", function (event, data) {\n                render(n, 'normal', data);\n              });\n              render(n);\n            }\n          };\n\n          scope.$watch(\"ngModel\", ngModelWatcher);\n        };\n\n        timeout(ready);\n      }\n    };\n  }]);\n  directives.initDirective('domainUserTable', ['$timeout', '$compile', 'dialogue', 'userEnterpriseService', function ($timeout, $compile, dialogue, userEnterpriseService) {\n    return {\n      restrict: 'A',\n      controller: ['$scope', '$element', '$attrs', function ($scope, $element, $attrs) {\n        var enterpriseUser;\n        var domMain = $element;\n        var table;\n        var isEditing = false;\n        var checkbox;\n        $scope.$on(Event.DOMAININFOSINIT, function (event, args) {\n          if (table) {\n            table.destroy();\n          }\n\n          checkbox = $(\"<input type='checkbox'/>\");\n          checkbox.on(\"click\", function (event) {\n            event.stopPropagation();\n\n            if (checkbox.prop('checked')) {\n              if ($(domMain).find(\"tbody tr\").hasClass(\"select\") == false) {\n                $(domMain).find(\"tbody tr\").addClass(\"selected\");\n              }\n\n              $(domMain).find(\"tbody input[type*=checkbox]\").prop(\"checked\", true);\n            } else {\n              $(domMain).find(\"tbody tr\").removeClass(\"selected\");\n              $(domMain).find(\"tbody input[type*=checkbox]\").removeAttr(\"checked\");\n            }\n          });\n          isEditing = false;\n\n          for (var i in args.data) {\n            args.data[i].select = false;\n          }\n\n          table = domMain.DataTable({\n            dom: '<\"row\"<\"col-sm-12\"<\"special-btn\">>><\"row\"<\"clo-sm-12\">>t<\"row\"<\"col-sm-2\"i><\"col-sm-2\"l><\"col-sm-8\"p>>',\n            language: $.ProudSmart.datatable.language,\n            \"autoWidth\": false,\n            \"data\": args.data,\n            \"order\": [1, \"desc\"],\n            columns: [{\n              title: \"\",\n              data: \"select\",\n              type: \"\"\n            }, {\n              title: \"用户名称\",\n              data: \"userName\"\n            }, {\n              title: \"邮箱\",\n              data: \"emailAddress\"\n            }, {\n              title: \"手机\",\n              data: \"mobilePhone\"\n            }, $.ProudSmart.datatable.optionCol1],\n            \"initComplete\": function initComplete(setting) {\n              domMain.find('th').eq(0).children().remove();\n              domMain.find('th').eq(0).append(checkbox);\n            },\n            columnDefs: [{\n              \"targets\": 0,\n              \"width\": 14,\n              \"data\": \"userName\",\n              \"orderable\": false,\n              \"render\": function render(data, type, full) {\n                var str = '<input type=\"checkbox\" style=\"pointer-events: none;\"/>';\n                return str;\n              }\n            }, {\n              \"targets\": 1,\n              \"data\": \"userName\",\n              \"render\": function render(data, type, full) {\n                /**\n                 var str = '<select id=\"userDomainName\" name=\"userName\" class=\"combobox form-control input-sm\">' +\n                 '<option value=\"\">请选择用户</option>';\n                 var argData = args.data;\n                 var enterpriseData = $scope.enterpriseUser;\n                 for (var i = 0; i < enterpriseData.length; i++) {\n                    var index = -1;\n                    for (var j = 0; j < argData.length; ++j) {\n                      if (argData[j].userID == enterpriseData[i].userID) {\n                        index = j;\n                      }\n                    }\n                    if (index == -1) {\n                      str += '<option value=\"' + enterpriseData[i].userID + '\">' + escape(enterpriseData[i].userName) + '</option>';\n                    }\n                  }\n                 str += '</select>';\n                  if (full.isEdit == 2 && type == \"display\") {\n                  return str;\n                } else {\n                  return data;\n                }\n                 */\n                return data;\n              }\n            }, {\n              \"targets\": 3,\n              \"data\": 'mobilePhone',\n              \"render\": function render(data, type, full) {\n                if (data == null) {\n                  return \"\";\n                } else {\n                  return data;\n                }\n              }\n            }, {\n              \"targets\": 4,\n              \"data\": \"option\",\n              \"render\": function render(data, type, full) {\n                var str = \"<div class='btn-group btn-group-sm'>\";\n                str += \"<a id='del-btn' class='btn btn-default' ><i class='fa fa-minus hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'>移出</span></a>\";\n                /**\n                 if (full.isEdit == 2) {\n                  str += \"<a id='save-btn' class='btn btn-default' ><i class='fa fa-save hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 保存</span></a>\"\n                  str += \"<a id='cancel-btn' class='btn btn-default' ><i class='fa fa-times hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 取消</span></a>\"\n                } else {\n                  if($scope.selectedDomainitem.domainPath != full.domainPath){\n                    str += \"<a id='del-btn' class='btn btn-default' ><i class='fa fa-minus hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 删除</span></a>\"\n                  }\n                }\n                 */\n\n                str += \"</div>\";\n                return str;\n              }\n            }]\n          });\n        });\n        /**\n         * 监听表格初始化后，添加按钮\n         */\n\n        domMain.on('init.dt', function () {\n          var queryFormat = [{\n            title: \"用户名称\",\n            data: \"userName\",\n            type: \"input\"\n          }, {\n            title: \"邮箱\",\n            data: \"emailAddress\",\n            type: \"input\"\n          }, {\n            title: \"手机\",\n            data: \"mobilePhone\",\n            type: \"input\"\n          }];\n\n          var addClick = function addClick(event) {\n            var run = function run(enterpriseUser) {\n              var confirm = function confirm(event) {\n                ngDialog.close();\n                var username = event.input[0].value;\n                var email = event.input[1].value;\n                var cellphone = event.input[2].value;\n              };\n\n              var cancel = function cancel() {\n                ngDialog.close();\n              };\n\n              var fnlist = [{\n                label: '确定',\n                icon: 'btn btn-success',\n                style: {\n                  width: '50%',\n                  'border-radius': 0,\n                  'font-size': '18px',\n                  'font-weight': 'bold',\n                  'padding': 10\n                },\n                fn: confirm\n              }, {\n                label: '取消',\n                icon: 'btn btn-default',\n                style: {\n                  width: '50%',\n                  'border-radius': 0,\n                  'font-size': '18px',\n                  'font-weight': 'bold',\n                  'padding': 10\n                },\n                fn: cancel\n              }];\n              scope.dialog = {\n                type: \"list\",\n                title: {\n                  label: '添加域用户'\n                },\n                input: [{\n                  value: enterpriseUser[0],\n                  type: \"select\",\n                  options: enterpriseUser,\n                  composory: true,\n                  label: '选择用户',\n                  onChange: function onChange(event) {}\n                }, {\n                  value: 'example@example.com',\n                  type: \"input\",\n                  label: '邮箱',\n                  placeholder: '填写邮箱'\n                }, {\n                  value: '12345678',\n                  type: \"input\",\n                  label: '手机',\n                  placeholder: '填写手机'\n                }],\n                fnlist: fnlist\n              };\n            };\n\n            if (enterpriseUser) {\n              run(enterpriseUser);\n            } else {\n              userEnterpriseService.queryEnterpriseUser(function (event) {\n                if (event.code == 0) {\n                  enterpriseUser = event.data;\n                  run(enterpriseUser);\n                }\n              });\n            }\n          };\n\n          var parentDom = $(\".special-btn\").parent();\n\n          var createBtn = function createBtn(cls, subcls, text) {\n            var button = $(\"<button></button>\").addClass(cls);\n            var i = $(\"<i></i>\").addClass(subcls);\n            var span = $(\"<span></span>\").addClass(\"hidden-sm\").text(text);\n            i.append(span);\n            button.append(i);\n            return button;\n          };\n\n          var createQuary = function createQuary(queryFormat) {\n            var inx = 0;\n            var queryDom = $(\"<div></div>\").addClass(\"combined-query pull-right\");\n            var btnGroup = $(\"<div></div>\").addClass(\"btn-group\");\n            var button = $(\"<button></button>\").addClass(\"btn btn-default btn-sm dropdown-toggle\").css(\"margin\", \"2px\");\n            var text = $(\"<span></span>\").text(\"查询条件\");\n            var drop = $(\"<span></span>\").addClass(\"caret\");\n            var ul = $(\"<ul></ul>\").addClass(\"dropdown-menu\").css(\"cursor\", \"pointer\");\n            var inputWrap = $(\"<div></div>\").css(\"display\", \"inline-block\").css(\"margin\", \"2px\");\n            var searchIcon = $(\"<i></i>\").addClass(\"fa fa-search\");\n            var searchText = $(\"<span></span>\").text(\"查询\");\n            var searchBtn = $(\"<button></button>\").addClass(\"btn btn-primary btn-sm\").css(\"margin\", \"2px\");\n\n            var createInput = function createInput(dt) {\n              if (dt.type == \"input\") {\n                return $(\"<input />\").addClass(\"form-control\").css(\"height\", \"30px\").css(\"padding\", \"2px\");\n              }\n            };\n\n            searchBtn.append(searchIcon).append(searchText);\n            inputWrap.append(createInput(queryFormat[inx]));\n            button.append(text).append(drop);\n            button.on(\"click\", function (event) {\n              if (btnGroup.hasClass(\"open\")) {\n                btnGroup.removeClass(\"open\");\n              } else {\n                btnGroup.addClass(\"open\");\n              }\n            });\n            btnGroup.append(button).append(ul);\n            queryDom.append(btnGroup).append(inputWrap).append(searchBtn);\n\n            var createLi = function createLi(elem) {\n              var li = $(\"<li></li>\");\n              var a = $(\"<a></a>\").text(elem.title);\n              li.append(a);\n              li.on(\"click\", function (event) {\n                text.text(elem.title);\n                btnGroup.removeClass(\"open\");\n              });\n              return li;\n            };\n\n            for (var i in queryFormat) {\n              ul.append(createLi(queryFormat[i]));\n            }\n\n            ;\n            return queryDom;\n          };\n\n          var addBtn = createBtn(\"btn btn-primary btn-sm\", \"fa fa-plus\", \"添加域用户\").css(\"margin\", \"2px\");\n          var deleteBtn = createBtn(\"btn btn-default btn-sm\", \"fa fa-plus\", \"移除\").css(\"margin\", \"2px\");\n          var queryPart = createQuary(queryFormat);\n          parentDom.append(addBtn).append(deleteBtn).append(queryPart);\n          addBtn.on(\"click\", addClick);\n          $compile(parentDom)($scope);\n        });\n        domMain.on('click', 'td', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          var rowData = row.data();\n\n          if (rowData) {\n            if ($(this).context.cellIndex == 4 && rowData.isEdit == 0) {\n              return;\n            }\n\n            if (rowData.isEdit == 1) {}\n          }\n        });\n        domMain.on('click', 'tbody tr', function (e) {\n          e.preventDefault();\n          $(this).toggleClass('selected');\n\n          if ($(this).hasClass('selected')) {\n            $(this).find(\"input[type*=checkbox]\").prop(\"checked\", true);\n          } else {\n            $(this).find(\"input[type*=checkbox]\").removeAttr(\"checked\");\n          }\n\n          var selected = table.rows('.selected')[0].length;\n          var total = table.rows()[0].length;\n\n          if (selected == total) {\n            checkbox.prop(\"checked\", true);\n          } else {\n            checkbox.removeAttr(\"checked\");\n          }\n        });\n        domMain.on('click', '#save-btn', function (e) {\n          e.stopPropagation();\n          var tr = $(this).closest('tr');\n          var checkPass = true;\n          var selectRow = table.row('.shown');\n\n          if (checkPass) {\n            isEditing = false;\n            $scope.doAction('saveUserToDomain', selectRow.data());\n          }\n        });\n        domMain.on('click', '#cancel-btn', function (e) {\n          e.stopPropagation();\n          isEditing = false;\n          var selectRow = table.row('.shown');\n          $scope.doAction('cancel');\n        });\n        domMain.on('click', '#del-btn', function (e) {\n          e.stopPropagation();\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          $scope.doAction('removeDomain', row.data());\n        });\n        domMain.on('click', '#changeDomain-btn', function (e) {\n          e.preventDefault();\n          isEditing = false;\n\n          if (!isEditing) {\n            isEditing = true;\n            var tr = $(this).closest('tr');\n            var row = table.row(tr);\n            row.data().isEdit = 1;\n          }\n        });\n        domMain.on('click', '#removeDomain-btn', function (e) {\n          //e.preventDefault();\n          isEditing = false;\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          var selectRow = table.row('.shown');\n          $scope.doAction('removeDomain', row.data());\n        });\n      }]\n    };\n  }]);\n  directives.initDirective('domainCmdbTable', ['$timeout', '$compile', '$filter', function ($timeout, $compile, $filter) {\n    return {\n      restrict: 'A',\n      controller: ['$scope', '$element', '$attrs', function ($scope, $element, $attrs) {\n        var domMain = $element;\n        var table;\n        var isEditing = false;\n        $scope.$on(Event.DOMAINDEVICESINIT, function (event, args) {\n          if (table) {\n            table.destroy();\n          }\n\n          isEditing = false;\n          table = domMain.DataTable({\n            dom: '<\"row\"<\"col-sm-6\"<\"special-btn\">><\"col-sm-6\"f>><\"row\"<\"clo-sm-12\">>t<\"row\"<\"col-sm-2\"i><\"col-sm-2\"l><\"col-sm-8\"p>>',\n            language: directives.datatable.language,\n            data: args.data,\n            columns: [{\n              data: \"id\",\n              title: \"编码\"\n            }, {\n              data: \"label\",\n              title: \"名称\"\n            }, {\n              data: \"createTime\",\n              title: \"上线时间\"\n            }, {\n              data: \"onlineStatus\",\n              title: \"在线状态\"\n            }, {\n              data: \"health\",\n              title: \"健康度\",\n              visible: false\n            }, {\n              data: \"domainPath\",\n              title: \"管理域\"\n            }, {\n              data: \"option\",\n              orderable: false,\n              title: \"操作\",\n              width: \"120px\"\n            }],\n            columnDefs: [{\n              targets: 2,\n              data: \"createTime\",\n              render: function render(data, type, full) {\n                // 返回自定义内容\n                var str = $filter('date')(data, 'yyyy-MM-dd HH:mm:ss'); //                var str = \"<date-label value=\" + data + \" format='yyyy-MM-dd HH:mm:ss'>\";\n\n                return str;\n              }\n            }, {\n              targets: 1,\n              data: \"label\",\n              render: function render(data, type, full) {\n                // 返回自定义内容    \n                return escape(data);\n              }\n            }, {\n              \"targets\": 3,\n              \"data\": \"onlineStatus\",\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                return \"<span class='label \" + (data == 'online' ? \"label-primary\" : \"label-warning\") + \"'>\" + (data == 'online' ? \"在线\" : \"离线\") + \"</span>\";\n              }\n            }, {\n              \"targets\": 4,\n              \"data\": \"health\",\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                //自定义随机的健康度---等待接口的实现连接\n                data = Math.random() * 100;\n                return \"<div class='progress progress-xs progress-striped active'><div class='progress-bar \" + (data > 90 ? \"progress-bar-success\" : data > 60 ? \"progress-bar-yellow\" : \"progress-bar-red\") + \"' style='width:\" + data + \"%'></div></div>\";\n              }\n            }, {\n              \"targets\": 5,\n              \"data\": \"domainPath\",\n              \"render\": function render(data, type, full) {\n                var str = \"\";\n                var test = $scope.enterpriseDomain;\n                var selectDomain1 = \"\";\n                var selectPath = \"\"; // var selectDomain = $scope.domainListDic[data].name;\n\n                for (var i in $scope.enterpriseDomain) {\n                  if ($scope.enterpriseDomain[i].domainPath == data) {\n                    selectDomain1 = $scope.enterpriseDomain[i].name;\n                    selectPath = $scope.enterpriseDomain[i].domainPath;\n                  }\n                }\n\n                if (full.isEdit == 2 && type == \"display\") {\n                  $scope.deviceIdTree(full.id);\n\n                  if (data != null && data != \"\") {\n                    for (var i in $scope.domainsAry) {\n                      if ($scope.domainsAry[i].domainPath == data) {\n                        str += \"<input name='domainPath' domain-Picker class='form-control input-sm' type='text' value='\" + selectDomain1 + \"' domainPath='\" + selectPath + \"'>\";\n                      }\n                    }\n                  }\n\n                  if (!str) {\n                    str += \"<input name='domainPath'  domain-Picker class='form-control input-sm' type='text' domainPath='' value='请选择...'>\";\n                  }\n                } else {\n                  str += selectDomain1;\n                }\n\n                return str;\n              }\n            }, {\n              \"targets\": 6,\n              \"data\": \"option\",\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                var str = \"<div class='btn-group btn-group-sm'>\";\n\n                if (full.isEdit == 2) {\n                  str += \"<a id='save-btn' class='btn btn-default' ><i class='fa fa-save hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 保存</span></a>\";\n                  str += \"<a id='cancel-btn' class='btn btn-default' ><i class='fa fa-times hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 取消</span></a>\";\n                } else {\n                  str += \"<a id='edit-btn' class='btn btn-default' ><i class='fa fa-refresh hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 切换域</span></a>\";\n                }\n\n                str += \"</div>\";\n                return str;\n              }\n            }],\n            rowCallback: function rowCallback(nRow, aData, iDataIndex) {\n              $compile(nRow)($scope);\n            }\n          });\n        });\n        domMain.on('click', '#save-btn', function (e) {\n          e.stopPropagation();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          var rowData = row.data();\n          var domainSelect = $(tr).find('input[name=\"domainPath\"]').attr(\"domainPath\");\n          var domainSelectName = $(tr).find('input[name=\"domainPath\"]').val();\n          rowData['domainPath'] = domainSelect;\n          rowData['domainName'] = domainSelectName;\n          var checkPass = true;\n\n          if (checkPass) {\n            $scope.doAction('saveChangedDomain', rowData, function (flg) {\n              if (flg) {\n                isEditing = false;\n                rowData.isEdit = 0;\n                row.remove().draw();\n              }\n            });\n          }\n        });\n        domMain.on('click', '#edit-btn', function (e) {\n          e.preventDefault();\n\n          if (!isEditing) {\n            isEditing = true;\n            var tr = $(this).closest('tr');\n            var row = table.row(tr);\n            row.data().isEdit = 2;\n            row.cells().invalidate();\n            $compile(tr)($scope);\n          } else {\n            $scope.doAction(\"thresholdMessage\", \"当前有修改中的属性，请先完成该操作\");\n          }\n        });\n        domMain.on('click', '#cancel-btn', function (e) {\n          e.stopPropagation();\n\n          if (isEditing) {\n            isEditing = false;\n            var tr = $(this).closest('tr');\n            var row = table.row(tr);\n            row.data().isEdit = 0;\n            row.cells().invalidate();\n          }\n        });\n      }]\n    };\n  }]);\n});"],"sourceRoot":"/source/"}