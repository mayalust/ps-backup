{"version":3,"sources":["app-oc/js/directives/project-dom.js"],"names":["define","directives","datatables","initDirective","$timeout","$compile","$filter","userEnterpriseService","growl","restrict","controller","$scope","$element","$attrs","table","domMain","isEditing","ifShow","$on","Event","CONTECTITEMSINIT","event","args","destroy","empty","DataTable","dom","option","length","$","ProudSmart","datatable","footerdom","language","select","data","ordering","order","columns","title","optionCol3","visible","columnDefs","targets","render","type","full","returnDate","isEdit","id","customersObj","customerName","escape","projectName","newDate","undefined","projectObj","str","menuitems","rowCallback","nRow","aData","iDataIndex","on","e","preventDefault","tr","this","closest","row","warning","selTableProject","getselectedProject","customerId","selTableProjectId","projectId","cells","invalidate","draw","stopPropagation","startDate","endDate","checkPass","takeEffectTime","loseEfficacyTime","each","children","j","val1","jqob1","addClass","removeClass","has","txt","trim","val","cell","startval","Date","parse","doAction","returnObj","selCustomor","remove","info","child","show","next","ngDialog","PROJECTMANAGEINIT","defaultColumns","label","defaultcolumnDefs","domainListDic","customerDic","forEach","querykey","push","name","values","defaultCol","meta","addr","standardAddress","split","join","concat","defaultColDef","distributorDic","distributorName","parentDom","parent","installDate","debugFinishDate","qualityCloseDate","provinces","$parent","cityDics","districtDics","arr","province","city","county","extend","projectInfo","open","template","className","scope","selEditInfo","domainPath","distributorId","test","code","SELDEVICEINIT","selectCol","orderable","check","returnData","i","CustomerList","customerID","returnType","modelListSelect","obj","target","checked","tableRows","rows","selected","nodes","rowData","optionCol1","width","doActionss","PRODEVICEINIT","format","d","returnStr","phenomenon","cause","processingMethod","FAULTKNOWLEDGEINIT","optionCol2","severityStr","severityBg","context","cellIndex","isShown","hide","hasClass","selSeverity","severity","tds","parents","selectRow","ipts","find","attrname","attr"],"mappings":"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","file":"app-oc/js/directives/project-dom.js","sourcesContent":["define(['directives/directives', 'datatables.net', 'datatables.net-bs'], function (directives, datatables) {\n  'use strict'; //======================================    合同条款管理    ===================================================\n\n  directives.initDirective('contractTermsTable', ['$timeout', '$compile', '$filter', 'userEnterpriseService', 'growl', function ($timeout, $compile, $filter, userEnterpriseService, growl) {\n    return {\n      restrict: 'A',\n      controller: ['$scope', '$element', '$attrs', function ($scope, $element, $attrs) {\n        var domMain = $element;\n        var table;\n        var isEditing = false;\n        var ifShow = false;\n        $scope.$on(Event.CONTECTITEMSINIT, function (event, args) {\n          if (table) {\n            table.destroy();\n            domMain.empty();\n          }\n\n          if (ifShow) {\n            ifShow = false;\n          }\n\n          isEditing = false;\n          table = domMain.DataTable({\n            dom: args.option[0] && args.option[0].length > 0 ? $.ProudSmart.datatable.footerdom : '',\n            language: $.ProudSmart.datatable.language,\n            select: $.ProudSmart.datatable.select,\n            data: args.option[0],\n            ordering: false,\n            order: [[7, \"desc\"]],\n            columns: [{\n              data: \"customerId\",\n              title: \"客户名称\"\n            }, {\n              data: \"projectId\",\n              title: \"项目名称\"\n            }, {\n              data: \"label\",\n              title: \"合同条款名称\"\n            }, {\n              data: \"takeEffectTime\",\n              title: \"生效日期\"\n            }, {\n              data: \"loseEfficacyTime\",\n              title: \"失效日期\"\n            }, $.ProudSmart.datatable.optionCol3, {\n              data: \"id\",\n              visible: false,\n              title: \"\"\n            }, {\n              data: \"createTime\",\n              visible: false,\n              title: \"\"\n            }],\n            columnDefs: [{\n              targets: 0,\n              data: \"customerId\",\n              render: function render(data, type, full) {\n                var returnDate = ''; // 返回自定义内容    \n\n                if (full.isEdit == 2 && full.id == 0 && type == \"display\") {\n                  var str = ' <select style=\"width:100%;\"  ng-model=\"customor.id\" class=\"form-control select2\" selectdata=\"CustomerList\"  ng-options=\"value.id as value.customerName for value in CustomerList\"  ng-change=\"alertFunCustom()\"  select2></select>'; // var str = '<select ng-model=\"selCustomor\" id=\"userDomainName\" name=\"customerName\" style=\"width:100%\" class=\"combobox form-control\" ng-change=\"alertFun(selCustomor)\" ng-options=\"item.customerID as item.customerName for item in CustomerList\"><option value=\"\">请选择客户</option><select>'\n\n                  return str;\n                } else {\n                  if ($scope.customersObj && $scope.customersObj[data]) {\n                    returnDate = $scope.customersObj[data].customerName;\n                  }\n\n                  return escape(returnDate);\n                }\n              }\n            }, {\n              targets: 1,\n              data: \"projectId\",\n              render: function render(data, type, full) {\n                var returnProjectDate = '';\n                var put = ''; // 返回自定义内容  \n\n                if (full.isEdit == 2 && type == \"display\") {\n                  // put = \"<select class='combobox form-control input-sm'>\";\n                  // put += '<option value=\"\">请选择...</option>';\n                  // for (var i in $scope.selTableProject) {\n                  //   if ($scope.selTableProject[i].label == data) {\n                  //     put += '<option selected=\"true\" value=\"' + $scope.selTableProject[i].id + '\">' + $scope.selTableProject[i].label + '</option>';\n                  //   } else {\n                  //     put += '<option value=\"' + $scope.selTableProject[i].id + '\">' + $scope.selTableProject[i].label + '</option>';\n                  //   }\n                  // }\n                  // put += '</select>';\n                  var str = '<select ng-model=\"selTableProjectId\" ng-change=\"alertFunProId(selTableProjectId)\" id=\"projectlists\" name=\"projectId\" style=\"width:100%\" class=\"combobox form-control\" ng-options=\"item.id as item.projectName for item in selTableProject\"><option value=\"\">请选择项目</option><option selected=\"selected\">' + full.projectName + '</option><select>';\n                  return str;\n                } else {\n                  var newDate = \"\";\n\n                  if ($scope.projectObj[data] != undefined) {\n                    newDate = '<a href=\"index.html#/projectManagement/' + $scope.projectObj[data].id + ' \" ng-click=\"linkProject(' + $scope.projectObj[data].id + ')\">' + escape($scope.projectObj[data].projectName) + '</a>';\n                  }\n\n                  return newDate;\n                }\n              }\n            }, {\n              targets: 2,\n              data: \"label\",\n              render: function render(data, type, full) {\n                // 返回自定义内容    \n                if (full.isEdit == 2 && type == \"display\") return \"<input style='width:100%' class='form-control ' autocomplete='off' type='text' value='\" + escape(data) + \"'>\";else return escape(data);\n              }\n            }, {\n              targets: 3,\n              data: \"takeEffectTime\",\n              render: function render(data, type, full) {\n                // 返回自定义内容    \n                var str = '';\n                if (full.isEdit > 0) return \"<input style='width:100%' autocomplete='off' class='form-control ' type='text' readonly='readonly' value='\" + $filter('date')(data, 'yyyy-MM-dd') + \"' drops='down' date-time-picker>\";else str = $filter('date')(data, 'yyyy-MM-dd');\n                return str;\n              }\n            }, {\n              targets: 4,\n              data: \"loseEfficacyTime\",\n              render: function render(data, type, full) {\n                // 返回自定义内容  \n                var str = '';\n                if (full.isEdit > 0) return \"<input style='width:100%' autocomplete='off' class='form-control ' type='text' readonly='readonly' drops='down' value='\" + $filter('date')(data, 'yyyy-MM-dd') + \"' date-time-picker>\";else str = $filter('date')(data, 'yyyy-MM-dd');\n                return str;\n              }\n            }, {\n              \"targets\": 5,\n              \"data\": \"option\",\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                var str = \"<div class='btn-group btn-group-sm'>\";\n\n                if (full.isEdit > 0) {\n                  str += \"<button id='save-btn' class='btn btn-primary' ><i class='fa fa-save hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 保存</span></button>\";\n                  str += \"<button id='cancel-btn' class='btn btn-default' ><i class='fa fa-save hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 取消</span></button>\";\n                  str += \"</div>\";\n                } else {\n                  if ($scope.menuitems['A02_S14']) {\n                    str += \"<button id='edit-btn' class='btn btn-primary' ><i class='fa fa-edit hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 编辑</span></button>\";\n                  }\n\n                  if ($scope.menuitems['A03_S14']) {\n                    str += \"<button id='del-btn' class='btn btn-default' ><i class='fa fa-trash hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 删除</span></button>\";\n                  }\n\n                  if ($scope.menuitems['A05_S14']) {\n                    str += \"<button id='devicelist-btn' class='btn btn-default' ><i class='fa fa-trash hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 设备</span></button>\";\n                  }\n\n                  str += \"</div>\";\n                }\n\n                return str;\n              }\n            }],\n            rowCallback: function rowCallback(nRow, aData, iDataIndex) {\n              $compile(nRow)($scope);\n            }\n          });\n        });\n        /**\n         * 监听表格初始化后，添加按钮\n         */\n\n        domMain.on('init.dt', function () {// var parentDom = $(\".specialss-btn\").parent();\n          // parentDom.html('<a ng-click=\"addcontectitem()\" class=\"btn btn-default btn-sm\"><i class=\"fa fa-plus\"></i><span class=\"hidden-xs\"> 添加合同条款</span></a>');\n          //parentDom.html('<select class=\"form-control select2\" selectdata=\"CustomerList\" itemchange=\"addcontecthandler\" select2></select>');\n          // $compile(parentDom)($scope);\n        });\n        domMain.on('click', 'td', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          var rowData = row.data();\n        });\n        domMain.on('click', '#edit-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n\n          if (!isEditing) {\n            isEditing = true;\n            row.data().isEdit = 2;\n            $scope.selTableProject = $scope.getselectedProject(row.data().customerId); // $scope.alertFun(row.data().customerId);\n\n            $scope.selTableProjectId = row.data().projectId;\n            row.cells().invalidate().draw(false);\n          } else {\n            if (row.data().isEdit == 0) {\n              growl.warning(\"当前有正编辑的合同条款\", {});\n              return;\n            }\n          }\n\n          if (row.data().id == 0) {\n            growl.warning(\"当前有正编辑的合同条款\", {});\n            return;\n          }\n        });\n        domMain.on('click', '#save-btn', function (e) {\n          e.stopPropagation();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          var startDate = '';\n          var endDate = '';\n          var checkPass = true;\n          var selectRow = null;\n          var selproName = '';\n          var takeEffectTime = '';\n          var loseEfficacyTime = '';\n          $.each(tr.children(), function (j, val1) {\n            var jqob1 = $(val1);\n\n            if (j == 0) {\n              if (!row.data().customerId) {\n                //无值\n                $(val1).addClass('danger');\n                checkPass = false;\n                return false;\n              } else {\n                //有值\n                $(val1).removeClass('danger');\n              }\n            }\n\n            if (j == 1) {\n              if (!row.data().projectId) {\n                $(val1).addClass('danger');\n                checkPass = false;\n                return false;\n              } else {\n                $(val1).removeClass('danger');\n              }\n            } //把input变为字符串\n\n\n            if (!jqob1.has('button').length && jqob1.has('input').length) {\n              var txt = $.trim(jqob1.children(\"input\").val());\n\n              if (txt) {\n                if (j == 2) {\n                  table.cell(jqob1).data(txt);\n                  row.data()[\"label\"] = txt;\n                }\n\n                if (j == 3) {\n                  var startval = Date.parse(txt);\n                  startDate = new Date(startval);\n                  takeEffectTime = startDate; // table.cell(jqob1).data(startDate);\n                }\n\n                if (j == 4) {\n                  var val = Date.parse(txt);\n                  endDate = new Date(val);\n\n                  if (endDate <= startDate) {\n                    growl.warning(\"请选择大于生效日期的日期点\", {});\n                    $(val1).addClass('danger');\n                    checkPass = false;\n                    return false;\n                  }\n\n                  loseEfficacyTime = endDate; // table.cell(jqob1).data(endDate);\n                }\n\n                $(val1).removeClass('danger');\n              } else {\n                $(val1).addClass('danger');\n                checkPass = false;\n                return false;\n              }\n            }\n          });\n\n          if (checkPass) {\n            row.data()[\"takeEffectTime\"] = takeEffectTime;\n            row.data()[\"loseEfficacyTime\"] = loseEfficacyTime;\n            $scope.doAction('saveContracts', row.data(), function (returnObj) {\n              if (!returnObj) {\n                row.data().isEdit = 2;\n              } else {\n                row.data().isEdit = 0;\n                row.data().id = returnObj.id;\n                isEditing = false;\n                row.cells().invalidate().draw(false);\n              }\n            });\n          }\n        });\n        domMain.on('click', '#cancel-btn', function (e) {\n          e.stopPropagation();\n          isEditing = false;\n          var row = table.row('.shown');\n\n          if (row.data()) {\n            row.data()[\"isEdit\"] = 0;\n            ifShow = false;\n            $scope.selCustomor = '';\n            $scope.doAction('cancel', row.data());\n          } else {\n            var tr = $(this).closest('tr');\n            var row = table.row(tr);\n            row.data()[\"isEdit\"] = 0;\n            ifShow = false;\n            $scope.selCustomor = '';\n            $scope.doAction('cancel', row.data());\n          }\n        });\n        domMain.on('click', '#del-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          $scope.doAction('deleteContract', row.data(), function (returnObj) {\n            if (returnObj != 0) {\n              row.data().isEdit = 2;\n              ifShow = false;\n            } else {\n              row.data().isEdit = 0;\n              row.remove().draw(false);\n            }\n          });\n        });\n        domMain.on('click', '#devicelist-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n\n          if (ifShow) {\n            growl.info(\"请先关闭之前设备列表再打开\", {});\n            return;\n          }\n\n          ifShow = true;\n          var innerString = '<div class=\"box\">' + '<div class=\"box-body table-responsive\">' + // '<a ng-click=\"addDevicesToItem()\" class=\"btn btn-default btn-sm\"><i class=\"fa fa-plus\"></i><span class=\"hidden-xs\"> 添加设备</span></a>' +\n          '<div class=\"margin-bottom-10\"><select style=\"width:20%;\" ng-model=\"selected.devicesId\"  ng-change=\"changeDevices();\" class=\"form-control select2\" ng-options=\"value.id as value.label for value in facilitySelList\" selectdata=\"facilitySelList\" select2></select>' + ' <div class=\"pull-right\">' + '<a id=\"savesel-table\" ng-click=\"saveselDevices()\" class=\"btn btn-primary btn-sm margin-right-5\">' + '<i class=\"fa fa-save\"></i><span class=\"hidden-xs\"> 保存</span>' + '</a>' + '<a id=\"close-table\" class=\"btn btn-default btn-sm\">' + '<i class=\"fa fa-times\"></i><span class=\"hidden-xs\"> 关闭</span>' + '</a>' + '</div> </div>' + '<table width=\"100%\" class=\"table\" device-list-table></table>' + '</div>' + '</div>';\n          row.child(innerString).show();\n          tr.addClass('shown');\n          tr.addClass('bg-f5f5f5');\n          tr.next().addClass('bg-f5f5f5');\n          $compile(tr)($scope);\n          $compile(tr.next())($scope);\n          $scope.doAction('showDeviceList', row.data());\n        });\n        domMain.on('click', '#close-table', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          ifShow = false;\n          $scope.doAction('cancel', row.data());\n        });\n      }]\n    };\n  }]); //======================================      项目管理   ===========================================\n\n  directives.initDirective('projectManageTable', ['$timeout', 'ngDialog', '$compile', '$filter', 'growl', function ($timeout, ngDialog, $compile, $filter, growl) {\n    return {\n      restrict: 'A',\n      controller: ['$scope', '$element', '$attrs', function ($scope, $element, $attrs) {\n        var domMain = $element;\n        var table;\n        var ifShow = false;\n        $scope.$on(Event.PROJECTMANAGEINIT, function (event, args) {\n          if (table) {\n            table.destroy();\n            domMain.empty();\n          }\n\n          var defaultColumns = [{\n            data: \"domainPath\",\n            title: ($scope.menuitems['S12'] && $scope.menuitems['S12'].label ? $scope.menuitems['S12'].label : \"客户\") + \"归属\"\n          }, {\n            data: \"customerId\",\n            title: ($scope.menuitems['S12'] && $scope.menuitems['S12'].label ? $scope.menuitems['S12'].label : \"客户\") + \"名称\"\n          }, {\n            data: \"projectName\",\n            title: ($scope.menuitems['S13'] && $scope.menuitems['S13'].label ? $scope.menuitems['S13'].label : \"项目\") + \"名称\"\n          }];\n          var defaultcolumnDefs = [{\n            targets: 0,\n            data: \"domainPath\",\n            render: function render(data, type, full) {\n              var data = escape(data);\n              var str = \"\";\n\n              if (full.isEdit == 2 && type == \"display\") {\n                return '<div class=\"dropdowntree select-sm\" ng-model=\"selEditInfo.domainPath\" change=\"\" key=\"domainPath\" options=\"domainListTree\" mark=\"nodes\" />';\n              } else {\n                if (data && $scope.domainListDic[data]) {\n                  return $scope.domainListDic[data].label;\n                } else {\n                  return \"无\";\n                }\n              }\n            }\n          }, {\n            targets: 1,\n            data: \"customerId\",\n            render: function render(data, type, full) {\n              var returnDate = '';\n              var data = escape(data); // 返回自定义内容    \n\n              if (full.isEdit == 2 && type == \"display\") {\n                var str = ' <select style=\"width:100%;\" ng-model=\"selEditInfo.customerId\" class=\"form-control select2\" selectdata=\"CustomerList\" select2></select>'; // var str = '<select ng-model=\"selCustomor\" id=\"userDomainName\" name=\"customerName\" style=\"width:100%\" class=\"combobox form-control\" ng-change=\"alertFun(selCustomor)\" ng-options=\"item.customerID as item.customerName for item in CustomerList\"><option value=\"\">请选择客户</option><select>'\n\n                return str;\n              } else {\n                if (data && $scope.customerDic[data]) {\n                  return $scope.customerDic[data]['customerName'];\n                } else {\n                  return \"\";\n                }\n              }\n            }\n          }, {\n            targets: 2,\n            data: \"projectName\",\n            render: function render(data, type, full) {\n              // 返回自定义内容    \n              if (full.isEdit == 2 && type == \"display\") return \"<input style='width:100%' class='form-control input-sm' autocomplete='off' type='text' value='\" + escape(data) + \"'>\";else {\n                return escape(data);\n              }\n            }\n          }];\n\n          if (args.option.length > 1 && args.option[1].length > 1) {\n            args.option[1].forEach(function (querykey) {\n              defaultColumns.push({\n                data: querykey.name,\n                title: querykey.label\n              });\n              defaultcolumnDefs.push({\n                \"targets\": defaultColumns.length - 1,\n                \"data\": querykey.name,\n                \"render\": function render(data, type, full) {\n                  var str = \"\";\n                  if (full.values && full.values[querykey.name]) str = full.values[querykey.name];\n                  return str;\n                }\n              });\n            });\n          } else {\n            var defaultCol = [{\n              data: \"projectAddress\",\n              title: \"项目地址\",\n              \"render\": function render(data, type, full, meta) {\n                var addr = data;\n\n                if (full.values != null && full.values != undefined && full.values.standardAddress != null && full.values.standardAddress != undefined) {\n                  addr = full.values.standardAddress.split(\",\").join(\"\") + \" \" + data;\n                }\n\n                return addr;\n              }\n            }, {\n              data: \"installDate\",\n              title: \"项目安装时间\"\n            }, {\n              data: \"debugFinishDate\",\n              title: \"调试完成时间\"\n            }, {\n              data: \"qualityCloseDate\",\n              title: \"质保截止时间\"\n            }];\n\n            if ($scope.menuitems['S46']) {\n              defaultCol.push({\n                data: \"distributorId\",\n                title: \"经销商名称\"\n              });\n            }\n\n            defaultColumns = defaultColumns.concat(defaultCol);\n            var defaultColDef = [{\n              targets: 3,\n              data: \"projectAddress\",\n              render: function render(data, type, full) {\n                // 返回自定义内容    \n                if (full.isEdit == 2 && type == \"display\") return \"<input style='width:100%' class='form-control input-sm' autocomplete='off' type='text' value='\" + escape(data) + \"'>\";else {\n                  return escape(data);\n                }\n              }\n            }, {\n              targets: 4,\n              data: \"installDate\",\n              render: function render(data, type, full) {\n                // 返回自定义内容    \n                var str = '';\n                if (full.isEdit > 0) return \"<input style='width:100%' autocomplete='off' class='form-control input-sm' type='text' readonly='readonly' value='\" + $filter('date')(data, 'yyyy-MM-dd') + \"' date-time-picker>\";else str = $filter('date')(data, 'yyyy-MM-dd');\n                return str;\n              }\n            }, {\n              targets: 5,\n              data: \"debugFinishDate\",\n              render: function render(data, type, full) {\n                // 返回自定义内容    \n                var str = '';\n                if (full.isEdit > 0) return \"<input style='width:100%' autocomplete='off' class='form-control input-sm' type='text' readonly='readonly' value='\" + $filter('date')(data, 'yyyy-MM-dd') + \"' date-time-picker>\";else {\n                  if (data) {\n                    str = $filter('date')(data, 'yyyy-MM-dd');\n                  }\n\n                  return str;\n                }\n              }\n            }, {\n              targets: 6,\n              data: \"qualityCloseDate\",\n              render: function render(data, type, full) {\n                // 返回自定义内容    \n                var str = '';\n                if (full.isEdit > 0) return \"<input style='width:100%' autocomplete='off' class='form-control input-sm' type='text' readonly='readonly' value='\" + $filter('date')(data, 'yyyy-MM-dd') + \"' date-time-picker>\";else str = $filter('date')(data, 'yyyy-MM-dd');\n                return str;\n              }\n            }];\n\n            if ($scope.menuitems['S46']) {\n              defaultColDef.push({\n                targets: 7,\n                data: \"distributorId\",\n                render: function render(data, type, full) {\n                  // var data = escape(data);\n                  var str = ''; // 返回自定义内容    \n\n                  if (full.isEdit == 2 && type == \"display\") {\n                    var str = ' <select style=\"width:100%;\" ng-model=\"selEditInfo.distributorId\"  class=\"form-control select2\" selectdata=\"distributorList\" select2></select>';\n                    return str;\n                  } else {\n                    if (data && $scope.distributorDic[data]) {\n                      return $scope.distributorDic[data].distributorName;\n                    } else {\n                      if (data == -1) {\n                        str = '无';\n                      }\n\n                      return str;\n                    }\n                  }\n                }\n              });\n            }\n\n            defaultcolumnDefs = defaultcolumnDefs.concat(defaultColDef);\n          }\n\n          defaultColumns.push({\n            data: \"risingTime\",\n            title: \"\",\n            visible: false\n          });\n          defaultColumns.push($.ProudSmart.datatable.optionCol3);\n          defaultcolumnDefs.push({\n            \"targets\": defaultColumns.length - 1,\n            \"data\": \"option\",\n            \"render\": function render(data, type, full) {\n              // 返回自定义内容\n              var str = \"<div class='btn-group btn-group-sm'>\";\n\n              if (full.isEdit == 2) {\n                str += \"<button id='save-btn' class='btn btn-primary' ><i class='fa fa-save hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 保存</span></button>\";\n                str += \"<button id='cancel-btn' class='btn btn-default' ><i class='fa fa-save hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 取消</span></button>\";\n                str += \"</div>\";\n              } else {\n                if ($scope.menuitems['A03_S13']) {\n                  str += \"<button id='edit-btn' class='btn btn-primary' ><i class='fa fa-edit hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 编辑</span></button>\";\n                }\n\n                if ($scope.menuitems['A04_S13']) {\n                  str += \"<button id='del-btn' class='btn btn-default' ><i class='fa fa-trash hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 删除</span></button>\";\n                }\n\n                if ($scope.menuitems['A01_S13']) {\n                  str += \"<button type='button' class='btn btn-default dropdown-toggle' data-toggle='dropdown'> 更多<span class='caret'></span></button>\";\n                  str += \"<ul class='dropdown-menu' role='menu'>\";\n\n                  if ($scope.menuitems['A01_S13']) {\n                    str += \"<li><a href='#/facility/project/\" + full.id + \"'>设备信息</a></li></ul>\";\n                  }\n                }\n\n                str += \"</div>\";\n              }\n\n              return str;\n            }\n          });\n          table = domMain.DataTable({\n            dom: args.option && args.option[0].length >= 1 ? $.ProudSmart.datatable.footerdom : '',\n            language: $.ProudSmart.datatable.language,\n            select: $.ProudSmart.datatable.select,\n            data: args.option[0],\n            order: [[defaultColumns.length - 2, \"desc\"]],\n            columns: defaultColumns,\n            columnDefs: defaultcolumnDefs,\n            rowCallback: function rowCallback(nRow, aData, iDataIndex) {\n              $compile(nRow)($scope);\n            }\n          });\n        });\n        /**\n         * 监听表格初始化后，添加按钮\n         */\n\n        domMain.on('init.dt', function () {\n          var parentDom = $(\".special-btn\").parent(); // parentDom.html('<a ng-click=\"addproject()\" class=\"btn btn-default btn-sm\"><i class=\"fa fa-plus\"></i><span class=\"hidden-xs\"> 添加项目</span></a>');\n\n          $compile(parentDom)($scope);\n        }); // domMain.on('click', 'td', function(e) {\n        //   e.preventDefault();\n        //   var tr = $(this).closest('tr');\n        //   var row = table.row(tr);\n        //   var rowData = row.data();\n        // }); 取消了点击事件\n\n        domMain.on('click', '#edit-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr); // if (!isEditing) {\n          // isEditing = true;\n          // row.data().isEdit = 2;\n\n          row.data().installDate = $filter('date')(row.data().installDate, 'yyyy-MM-dd');\n          row.data().debugFinishDate = $filter('date')(row.data().debugFinishDate, 'yyyy-MM-dd');\n          row.data().qualityCloseDate = $filter('date')(row.data().qualityCloseDate, 'yyyy-MM-dd');\n\n          if (row.data().values.standardAddress) {\n            $scope.provinces = $scope.$parent.provinces;\n            $scope.cityDics = $scope.$parent.cityDics;\n            $scope.districtDics = $scope.$parent.districtDics;\n            var arr = row.data().values.standardAddress.split(\",\");\n            row.data().province = arr[0];\n\n            if (arr[1]) {\n              row.data().city = arr[0] + \",\" + arr[1];\n            }\n\n            if (arr[2]) {\n              row.data().county = row.data().values.standardAddress;\n            } //          if (arr[1]) {\n            //            row.data().city = $scope.cityDics[arr[0]].find(function(item) {\n            //              return arr[1] == item.label;\n            //            }).id;\n            //          }\n            //          if (arr[2]) {\n            //            row.data().county = $scope.districtDics[row.data().city].find(function(item) {\n            //              return arr[2] == item.label;\n            //            }).id;\n            //          }\n            //          $scope.cityList = $scope.cityDics[arr[0]];\n            //          $scope.districtList = $scope.districtDics[row.data().city];\n\n          } else {\n            row.data().province = \"\";\n            row.data().city = \"\";\n            row.data().county = \"\";\n          }\n\n          ;\n          $.extend($scope.projectInfo, row.data());\n          ngDialog.open({\n            template: '../partials/dialogue/project_management_dia.html',\n            className: 'ngdialog-theme-plain',\n            scope: $scope\n          }); // $scope.selEditInfo = {\n          //   \"domainPath\": row.data().domainPath, //客户归属\n          //   \"customerId\": row.data().customerId, //客户id\n          //   \"distributorId\": row.data().distributorId, //经销商id\n          // }\n          // row.cells().invalidate();\n          // $compile(tr)($scope);\n          // }\n          // else {\n          //   if (row.data().isEdit == 0) {\n          //     growl.warning(\"当前有正编辑的项目\", {});\n          //     return;\n          //   }\n          // }\n        });\n        domMain.on('click', '#save-btn', function (e) {\n          e.stopPropagation();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          var newDate = '';\n          var checkPass = true;\n          $.each(tr.children(), function (j, val1) {\n            var jqob1 = $(val1);\n\n            if (j == 0) {\n              if (!$scope.selEditInfo.domainPath) {\n                $(val1).addClass('danger');\n                checkPass = false;\n                return false;\n              } else {\n                $(val1).removeClass('danger');\n                row.data()[\"domainPath\"] = $scope.selEditInfo.domainPath;\n              }\n            }\n\n            if (j == 1) {\n              if (!$scope.selEditInfo.customerId) {\n                $(val1).addClass('danger');\n                checkPass = false;\n                return false;\n              } else {\n                $(val1).removeClass('danger');\n                row.data()[\"customerId\"] = $scope.selEditInfo.customerId;\n              }\n            }\n\n            if (j == 3) {\n              if (!$scope.selEditInfo.distributorId) {\n                $(val1).addClass('danger');\n                checkPass = false;\n                return false;\n              } else {\n                $(val1).removeClass('danger');\n                row.data()[\"distributorId\"] = $scope.selEditInfo.distributorId;\n              }\n            } //把input变为字符串\n\n\n            if (!jqob1.has('button').length && jqob1.has('input').length) {\n              var txt = $.trim(jqob1.children(\"input\").val());\n\n              if (txt) {\n                if (j == 2) {\n                  var reg = /^\\s*$/g; //空为true\n\n                  if (reg.test(txt)) {\n                    $(val1).addClass('danger');\n                    checkPass = false;\n                    return false;\n                  } else {\n                    row.data()[\"projectName\"] = txt;\n                    checkPass = true;\n                  }\n                }\n\n                if (j == 4) {\n                  var reg = /^\\s*$/g; //空为true\n\n                  if (reg.test(txt)) {\n                    $(val1).addClass('danger');\n                    checkPass = false;\n                    return false;\n                  } else {\n                    row.data()[\"projectAddress\"] = txt;\n                    checkPass = true;\n                  }\n                }\n\n                if (j == 5 || j == 6 || j == 7) {\n                  var val = Date.parse(txt);\n                  newDate = new Date(val); // row.data()[\"installDate\"] = newDate;\n\n                  table.cell(jqob1).data(newDate); //修改DataTables对象的数据\n                }\n\n                $(val1).removeClass('danger');\n                table.cell(jqob1).data(txt); //修改DataTables对象的数据\n              } else {\n                $(val1).addClass('danger');\n                checkPass = false;\n                return false;\n              }\n            }\n          });\n\n          if (checkPass) {\n            $scope.doAction('saveProject', row.data(), function (returnObj) {\n              if (returnObj.code != 0) {\n                row.data().isEdit = 2;\n                row.data().id = 0;\n              } else {\n                row.data().isEdit = 0;\n                row.data().id = returnObj.data.id; // isEditing = false;\n\n                row.cells().invalidate().draw(false);\n                $compile(tr)($scope);\n              }\n            });\n          }\n        });\n        domMain.on('click', '#cancel-btn', function (e) {\n          e.stopPropagation(); // isEditing = false;\n\n          var row = table.row('.shown');\n\n          if (row.data()) {\n            row.data().isEdit = 0; // row.child.hide();\n            // row.cells().invalidate();\n\n            $scope.doAction('cancel', row.data());\n          } else {\n            var tr = $(this).closest('tr');\n            var row = table.row(tr);\n            row.data().isEdit = 0; // row.child.hide();\n            // row.cells().invalidate();\n\n            $scope.doAction('cancel', row.data());\n          }\n        });\n        domMain.on('click', '#del-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          $scope.doAction('deleteProject', row.data(), function (returnObj) {\n            if (returnObj != 0) {// row.data().isEdit = 2\n            } else {\n              row.remove().draw(false);\n            }\n          });\n        }); // domMain.on('click', '#pro-btn', function(e) {\n        //   e.preventDefault();\n        //   var tr = $(this).closest('tr');\n        //   var row = table.row(tr);\n        //   var rowData = row.data();\n        //   location.href = \"index.html#/contractTerms///\" + rowData.id;\n        // });\n        // domMain.on('click', '#devicelist-btn', function(e) {\n        //   e.preventDefault();\n        //   var tr = $(this).closest('tr');\n        //   var row = table.row(tr);\n        //   if (ifShow) {\n        //     growl.info(\"请先关闭之前设备列表再打开\", {});\n        //     return;\n        //   }\n        //   ifShow = true;\n        //   var innerString = '';\n        //   innerString = '<div class=\"box\">' +\n        //     '<div class=\"box-body table-responsive\">' +\n        //     '<div class=\"pull-right\">' +\n        //     '<a id=\"close-table\" class=\"btn btn-default btn-sm\">' +\n        //     '<i class=\"fa fa-times\"></i><span class=\"hidden-xs\">关闭</span>' +\n        //     '</a>' +\n        //     '</div>' +\n        //     '<table width=\"100%\" class=\"table\" device-project-table></table>' +\n        //     '</div>' +\n        //     '</div>';\n        //   row.child(innerString).show();\n        //   tr.addClass('shown');\n        //   tr.addClass('selected');\n        //   tr.next().addClass('bg-f5f5f5');\n        //   $compile(tr)($scope);\n        //   $compile(tr.next())($scope);\n        //   $scope.doAction('deviceProject', row.data());\n        // });\n        // domMain.on('click', '#close-table', function(e) {\n        //   e.preventDefault();\n        //   var tr = $(this).closest('tr');\n        //   var row = table.row(tr);\n        //   ifShow = false;\n        //   $scope.doAction('cancel', row.data());\n        // });\n      }]\n    };\n  }]); //======================================     合同条款过滤设备 ==========================================\n\n  directives.initDirective('faciDeviceTable', ['$timeout', '$compile', '$filter', function ($timeout, $compile, $filter) {\n    return {\n      restrict: 'A',\n      controller: ['$scope', '$element', '$attrs', function ($scope, $element, $attrs) {\n        var domMain = $element;\n        var table;\n        var isEditing = false;\n        $scope.$on(Event.SELDEVICEINIT + \"_faciDivice\", function (event, args) {\n          if (table) {\n            table.destroy();\n            domMain.empty();\n          }\n\n          isEditing = false;\n          table = domMain.DataTable({\n            dom: args && args.length > 0 ? $.ProudSmart.datatable.footerdom : '',\n            language: $.ProudSmart.datatable.language,\n            select: $.ProudSmart.datatable.select,\n            data: args,\n            order: [[1, \"desc\"]],\n            columns: [$.ProudSmart.datatable.selectCol, {\n              data: \"custermerId\",\n              title: \"客户\"\n            }, {\n              data: \"modelId\",\n              title: \"型号\"\n            }, {\n              data: \"label\",\n              title: \"名称\"\n            }, {\n              data: \"sn\",\n              title: \"序列号\"\n            }],\n            columnDefs: [{\n              orderable: false,\n              targets: 0,\n              render: function render(data, type, full) {\n                if (type == \"display\") {\n                  if (full.check == 1001) {\n                    return '<input class=\"itemCheckBox\" checked type=\"checkbox\" >';\n                  } else {\n                    return '<input class=\"itemCheckBox\" type=\"checkbox\" ng-checked=\"full.check == 1001\">';\n                  }\n                }\n\n                return \"\"; // var str = '<input type=\"checkbox\" style=\"width: 19px;height: 25px;\" boxClass=\"icheckbox_minimal-blue\" value=\"' + full.userID + '\" ng-disabled=\"full.manageCheck == 2001\" name=\"oddBox\" class=\"minimal\" ng-checked=\"full.check == 1001\"> ';\n                // if (full.check == 1001) {\n                //   str = '<input type=\"checkbox\" style=\"width: 19px;height: 25px;\" boxClass=\"icheckbox_minimal-blue\" value=\"' + full.userID + '\" ng-disabled=\"full.manageCheck == 2001\" name=\"oddBox\" class=\"minimal\" checked=checked> ';\n                // }\n                // return str;\n              }\n            }, {\n              targets: 1,\n              data: \"customerId\",\n              render: function render(data, type, full) {\n                var returnData = '';\n\n                for (var i in $scope.CustomerList) {\n                  if ($scope.CustomerList[i].customerID == data) {\n                    returnData = $scope.CustomerList[i].customerName;\n                  }\n                }\n\n                return returnData;\n              }\n            }, {\n              targets: 2,\n              data: \"modelId\",\n              render: function render(data, type, full) {\n                var returnType = '';\n\n                for (var i in $scope.modelListSelect) {\n                  var obj = $scope.modelListSelect[i];\n\n                  if (obj.id == data) {\n                    return returnType = obj.label;\n                  }\n                }\n\n                return returnType;\n              }\n            }],\n            rowCallback: function rowCallback(nRow, aData, iDataIndex) {\n              if (aData.check) {\n                $(nRow).addClass(\"selected\");\n              } else {\n                $(nRow).removeClass(\"selected\");\n              }\n\n              $compile(nRow)($scope);\n            }\n          });\n        }); //全选\n\n        domMain.on('change', '#allselect-btn', function (e) {\n          e.stopPropagation();\n\n          if (e.target.checked) {\n            // table.rows().select();\n            var tableRows = table.rows({\n              selected: true\n            });\n\n            for (var i = 0; i < tableRows.nodes().length; i++) {\n              var row = table.row(tableRows.nodes()[i]);\n              row.data().check = 1001;\n            }\n\n            ;\n            table.rows().invalidate().draw(false);\n          } else {\n            var tableRows = table.rows({\n              selected: true\n            });\n\n            for (var i = 0; i < tableRows.nodes().length; i++) {\n              var row = table.row(tableRows.nodes()[i]);\n              row.data().check = 0;\n            }\n\n            ; // table.rows().deselect();\n\n            table.rows().invalidate().draw(false);\n          }\n        });\n        domMain.on('click', \"td\", function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          var rowData = row.data();\n\n          if (rowData.check != 1001) {\n            rowData.check = 1001;\n          } else {\n            rowData.check = 0;\n          }\n\n          row.cells().invalidate();\n        });\n      }]\n    };\n  }]); //======================================      合同条款设备   ============================================\n\n  directives.initDirective('deviceListTable', ['$timeout', '$compile', '$filter', function ($timeout, $compile, $filter) {\n    return {\n      restrict: 'A',\n      controller: ['$scope', '$element', '$attrs', function ($scope, $element, $attrs) {\n        var domMain = $element;\n        var table;\n        var isEditing = false;\n        $scope.$on(Event.SELDEVICEINIT, function (event, args) {\n          if (table) {\n            table.destroy();\n            domMain.empty();\n          }\n\n          isEditing = false;\n          table = domMain.DataTable({\n            dom: args.option[0] && args.option[0].length > 0 ? $.ProudSmart.datatable.footerdom : '',\n            language: $.ProudSmart.datatable.language,\n            // select: $.ProudSmart.datatable.select,\n            data: args.option[0],\n            // searching: false,\n            // order: [\n            //   [0, \"desc\"]\n            // ],\n            columns: [{\n              data: \"modelId\",\n              title: \"设备模板\"\n            }, {\n              data: \"label\",\n              title: \"设备名称\"\n            }, {\n              data: \"sn\",\n              title: \"设备序列号\"\n            }, $.ProudSmart.datatable.optionCol1],\n            columnDefs: [{\n              targets: 0,\n              width: '20%',\n              data: \"modelId\",\n              render: function render(data, type, full) {\n                // 返回自定义内容    \n                var returnType = '';\n\n                if (full.isEdit == 3) {\n                  returnType = '<select style=\"width:100%;\" ng-model=\"selected.devicesId\"  class=\"form-control select2\" ng-options=\"value.id as value.label for value in facilitySelList\" selectdata=\"facilitySelList\" select2></select>';\n                } else {\n                  for (var i in $scope.modelListSelect) {\n                    var obj = $scope.modelListSelect[i];\n\n                    if (obj.id == data) {\n                      returnType = obj.label;\n                      break;\n                    }\n                  }\n                }\n\n                return returnType;\n              }\n            }, {\n              targets: 1,\n              data: \"label\",\n              render: function render(data, type, full) {\n                // 返回自定义内容    \n                if (full.isEdit == 2 && type == \"display\") return \"<input maxlength='20' style='width:100%' class='form-control input-sm' type='text' value='\" + escape(data) + \"'>\";else return escape(data);\n              }\n            }, {\n              \"targets\": 3,\n              \"data\": \"option\",\n              \"render\": function render(data, type, full) {\n                var str = \"<div class='input-group'>\";\n\n                if (full.isEdit == 2 || full.isEdit == 3) {\n                  str += \"<a id='save-btn'  class='btn btn-default btn-sm' ><i class='fa fa-save hidden-lg hidden-md hidden-sm '></i><span class='hidden-xs'> 保存</span></a>\";\n                  str += \"<a id='cancel-btn' class='btn btn-default btn-sm' ><i class='fa fa-times  hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 取消</span></a>\";\n                } else {\n                  str += \"<a id='delDevice-btn' class='btn btn-default btn-sm' ><i class='fa fa-minus hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 移出</span></a>\";\n                }\n\n                str += \"</div>\";\n                return str;\n              }\n            }],\n            rowCallback: function rowCallback(nRow, aData, iDataIndex) {\n              if (aData.check) {\n                $(nRow).addClass(\"selected\");\n              } else {\n                $(nRow).removeClass(\"selected\");\n              }\n\n              $compile(nRow)($scope);\n            }\n          });\n        });\n        /**\n         * 监听表格初始化后，添加按钮\n         */\n\n        domMain.on('init.dt', function () {// var parentDom = $(\".special-btn\").parent();\n          // parentDom.html('<a ng-click=\"addDevicesToItem()\" class=\"btn btn-default btn-sm\"><i class=\"fa fa-plus\"></i><span class=\"hidden-xs\"> 添加设备</span></a>');\n          // $compile(parentDom)($scope);\n        });\n        domMain.on('click', 'td', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          var rowData = row.data();\n        });\n        domMain.on('click', '#delDevice-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          $scope.doActionss('removeDevice', row.data());\n          row.remove().draw(false);\n        });\n      }]\n    };\n  }]); //======================================      项目设备   ============================================\n\n  directives.initDirective('deviceProjectTable', ['$timeout', '$compile', '$filter', function ($timeout, $compile, $filter) {\n    return {\n      restrict: 'A',\n      controller: ['$scope', '$element', '$attrs', function ($scope, $element, $attrs) {\n        var domMain = $element;\n        var table;\n        var isEditing = false;\n        $scope.$on(Event.PRODEVICEINIT, function (event, args) {\n          if (table) {\n            table.destroy();\n            domMain.empty();\n          }\n\n          isEditing = false;\n          table = domMain.DataTable({\n            dom: args.option[0] && args.option[0].length > 0 ? $.ProudSmart.datatable.footerdom : '',\n            language: $.ProudSmart.datatable.language,\n            data: args.option[0],\n            order: [[0, \"desc\"]],\n            columns: [{\n              data: \"modelId\",\n              title: \"设备模板\"\n            }, {\n              data: \"deviceName\",\n              title: \"设备名称\"\n            }, {\n              data: \"serialNo\",\n              title: \"设备序列号\"\n            }],\n            columnDefs: [{\n              targets: 0,\n              data: \"modelId\",\n              render: function render(data, type, full) {\n                // 返回自定义内容    \n                var returnType = '';\n\n                for (var i in $scope.modelListSelect) {\n                  var obj = $scope.modelListSelect[i];\n\n                  if (obj.id == data) {\n                    return returnType = obj.label;\n                  }\n                }\n\n                return returnType;\n              }\n            }]\n          });\n        });\n      }]\n    };\n  }]); //======================================      故障知识   ===========================================\n\n  directives.initDirective('faultKnowledgeTable', ['$timeout', '$compile', '$filter', 'growl', function ($timeout, $compile, $filter, growl) {\n    return {\n      restrict: 'A',\n      controller: ['$scope', '$element', '$attrs', function ($scope, $element, $attrs) {\n        var domMain = $element;\n        var table;\n        var isEditing = false;\n        $scope.$on(Event.FAULTKNOWLEDGEINIT, function (event, args) {\n          if (table) {\n            table.destroy();\n            domMain.empty();\n          }\n\n          isEditing = false;\n          table = domMain.DataTable({\n            dom: args.option && args.option.length > 0 ? $.ProudSmart.datatable.footerdom : '',\n            language: $.ProudSmart.datatable.language,\n            data: args.option[0],\n            order: [[0, \"asc\"]],\n            columns: [{\n              data: \"faultNo\",\n              title: \"故障编号\"\n            }, {\n              data: \"label\",\n              title: \"故障名称\"\n            }, {\n              data: \"category\",\n              title: \"故障类别\"\n            }, {\n              data: \"desc\",\n              title: \"故障关键字\"\n            }, {\n              data: \"severity\",\n              title: \"严重级别\",\n              width: \"15%\"\n            }, $.ProudSmart.datatable.optionCol2, {\n              data: \"id\",\n              title: \"\",\n              visible: false\n            }],\n            columnDefs: [{\n              targets: 0,\n              data: \"faultNo\",\n              render: function render(data, type, full) {\n                //返回自定义名字\n                if (full.isEdit == 2 && type == \"display\") return \"<input maxlength='20' style='width:100%' autocomplete='off' class='form-control input-sm' type='text' value='\" + escape(data) + \"' name = 'faultNo'>\";else {\n                  return escape(data);\n                }\n              }\n            }, {\n              targets: 1,\n              data: \"label\",\n              render: function render(data, type, full) {\n                //返回自定义名字\n                if (full.isEdit == 2 && type == \"display\") return \"<input maxlength='20' style='width:100%' autocomplete='off' class='form-control input-sm' type='text' value='\" + escape(data) + \"' name = 'label'>\";else {\n                  return escape(data);\n                }\n              }\n            }, {\n              targets: 2,\n              data: \"category\",\n              render: function render(data, type, full) {\n                // 返回自定义内容    \n                if (full.isEdit == 2 && type == \"display\") return \"<input maxlength='50' style='width:100%' autocomplete='off' class='form-control input-sm' type='text' value='\" + escape(data) + \"'  name = 'category'>\";else {\n                  return escape(data);\n                }\n              }\n            }, {\n              targets: 3,\n              data: \"desc\",\n              render: function render(data, type, full) {\n                // 返回自定义内容  \n                if (full.isEdit == 2 && type == \"display\") return \"<input maxlength='50' style='width:100%' autocomplete='off' class='form-control input-sm' type='text' value='\" + escape(data) + \"' name = 'desc'>\";else {\n                  return escape(data);\n                }\n              }\n            }, {\n              targets: 4,\n              data: \"severity\",\n              render: function render(data, type, full) {\n                // 返回自定义内容   \n                if (full.isEdit == 2 && type == \"display\") {\n                  var str = '<select ng-model=\"selSeverity\" ng-change=\"alertFun(selSeverity)\" id=\"severity\" name=\"severity\" style=\"width:100%\" class=\"combobox form-control\" ng-options=\"item.severNo as item.severName for item in severiesList\"><option value=\"\">请选择...</option><select>';\n                  return str;\n                } else {\n                  var severityStr = \"无数据\";\n                  var severityBg = \"alerts-warning\";\n\n                  if (data == 4) {\n                    severityStr = \"严重\";\n                    severityBg = \"alerts-critical\";\n                  } else if (data == 3) {\n                    severityStr = \"重要\";\n                    severityBg = \"alerts-major\";\n                  } else if (data == 2) {\n                    severityStr = \"次要\";\n                    severityBg = \"alerts-minor\";\n                  } else if (data == 1) {\n                    severityStr = \"警告\";\n                    severityBg = \"alerts-warning\";\n                  }\n\n                  return \"<span class='label \" + severityBg + \"'>\" + severityStr + \"</span>\";\n                }\n              }\n            }, {\n              \"targets\": 5,\n              \"data\": \"option\",\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                var str = '';\n\n                if (full.isEdit == 2) {\n                  str += '<div class=\"btn-group btn-group-sm\">' + '<a id=\"save-btn\" class=\"btn btn-default\"><i class=\"fa fa-check  hidden-lg hidden-md hidden-sm \"></i><span class=\"hidden-xs ng-binding\">保存</span></a>' + '<a id=\"cancel-btn\" class=\"btn btn-default\" ><i class=\"fa fa-close hidden-lg hidden-md hidden-sm\"></i><span class=\"hidden-xs ng-binding\">取消</span></a></div>';\n                } else {\n                  str += '<div class=\"btn-group btn-group-sm\">';\n\n                  if ($scope.menuitems['A02_S10']) {\n                    str += '<a id=\"edit-btn\" class=\"btn btn-primary\"><i class=\"fa fa-check  hidden-lg hidden-md hidden-sm \"></i><span class=\"hidden-xs ng-binding\">编辑</span></a>';\n                  }\n\n                  if ($scope.menuitems['A03_S10']) {\n                    str += '<a id=\"del-btn\" class=\"btn btn-default\" ><i class=\"fa fa-close hidden-lg hidden-md hidden-sm\"></i><span class=\"hidden-xs ng-binding\">删除</span></a></div>';\n                  }\n                }\n\n                return str;\n              }\n            }],\n            rowCallback: function rowCallback(nRow, aData, iDataIndex) {\n              $compile(nRow)($scope);\n            }\n          });\n        });\n\n        function format(d) {\n          var returnStr;\n\n          if (d.isEdit > 0) {\n            returnStr = '<table width=\"100%\" class=\"table table-inner\">';\n\n            for (var i in d) {\n              returnStr += '<tr role=\"row\">';\n\n              if (i == 'phenomenon') {\n                returnStr += '<td style=\"width:19%;\">故障现象:</td>';\n                returnStr += '<td><textarea rows=\"7\" cols=\"20\" autocomplete=\"off\" datatype=\"' + d.phenomenon + '\" style=\"width:75%;resize: none;\" class=\"form-control input-sm\" name=\"phenomenon\" value=\"' + d.phenomenon + '\">' + d.phenomenon + '</textarea></td>';\n              } else if (i == 'cause') {\n                returnStr += '<td style=\"width:19%;\">产生原因:</td>';\n                returnStr += '<td><textarea rows=\"7\" cols=\"20\" autocomplete=\"off\" datatype=\"' + d.cause + '\" style=\"width:75%;resize: none;\" class=\"form-control input-sm\" name=\"cause\" value=\"' + d.cause + '\">' + d.cause + '</textarea></td>';\n              } else if (i == 'processingMethod') {\n                returnStr += '<td style=\"width:19%;\">处理方法:</td>';\n                returnStr += '<td><textarea rows=\"7\" cols=\"20\" autocomplete=\"off\" datatype=\"' + d.processingMethod + '\" style=\"width:75%;resize: none;\" class=\"form-control input-sm\" name=\"processingMethod\" value=\"' + d.processingMethod + '\">' + d.processingMethod + '</textarea></td>';\n              }\n\n              returnStr += '</tr>';\n            }\n\n            returnStr += '</table>';\n          } else {\n            returnStr = '<table width=\"100%\" class=\"table table-inner\">';\n\n            for (var i in d) {\n              returnStr += '<tr role=\"row\">';\n\n              if (i == 'phenomenon') {\n                returnStr += '<td style=\"width:19%;\">故障现象:</td>';\n                returnStr += '<td><div style=\"width: 90%;height:auto;\">' + d.phenomenon + '</div></td>';\n              } else if (i == 'cause') {\n                returnStr += '<td style=\"width:19%;\">产生原因:</td>';\n                returnStr += '<td><div style=\"width: 90%;height:auto;\">' + d.cause + '</div></td>';\n              } else if (i == 'processingMethod') {\n                returnStr += '<td style=\"width:19%;\">处理方法:</td>';\n                returnStr += '<td><div style=\"width: 90%;height:auto;\">' + d.processingMethod + '</div></td>';\n              }\n\n              returnStr += '</tr>';\n            }\n\n            returnStr += '</table>';\n          }\n\n          return returnStr;\n        }\n        /**\n         * 监听表格初始化后，添加按钮\n         */\n\n\n        domMain.on('init.dt', function () {// var parentDom = $(\".special-btn\").parent();\n          // parentDom.html('<a ng-click=\"addFaultKnowledge()\" class=\"btn btn-default btn-sm\"><i class=\"fa fa-plus\"></i><span class=\"hidden-xs\"> 添加故障知识</span></a>');\n          // $compile(parentDom)($scope);\n        });\n        domMain.on('click', 'td', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n\n          if ($(this).context.cellIndex == 5 && row.data().isEdit == 0) {\n            return;\n          }\n\n          var rowData = row.data();\n\n          if (rowData) {\n            if (row.child.isShown()) {\n              //之前展开\n              // This row is already open - close it\n              if (row.data().isEdit == 0 || row.data().isEdit == undefined) {\n                //如果是展示，直接合上\n                row.child.hide();\n                tr.removeClass('shown');\n              } else if (row.data().isEdit == 2) {\n                //如果是编辑，则仍是展开状态\n                if (!tr.hasClass('shown')) {\n                  row.child(format(rowData)).show();\n                  tr.addClass('shown');\n                }\n              }\n            } else {\n              //之前关闭，则需要展开\n              // Open this row\n              var data = row.data();\n\n              if (data.isEdit == 0 || data.isEdit == undefined) {\n                row.child(format(data)).show();\n              } else if (data.isEdit == 2) {\n                if (!tr.hasClass('shown')) {\n                  row.child(format(rowData)).show();\n                  tr.addClass('shown');\n                }\n              }\n            }\n          }\n        });\n        domMain.on('click', '#edit-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n\n          if (!isEditing) {\n            isEditing = true;\n            row.data().isEdit = 2;\n            $scope.selSeverity = row.data().severity; // row.cells().invalidate().draw(false); //第二页编辑在第一页显示\n\n            row.cells().invalidate();\n            $compile(tr)($scope); //会重复执行两遍\n          } else {\n            if (row.data().isEdit == 0) {\n              growl.warning(\"当前有正编辑的故障知识\", {});\n              return;\n            }\n          }\n        });\n        domMain.on('click', '#save-btn', function (e) {\n          e.stopPropagation();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          var tds = $(this).parents(\"tr\").children();\n          var checkPass = true;\n          var selectRow = null;\n\n          for (var i in row.data()) {\n            if (i == 'isEdit' && row.data()[i] == 2) {\n              selectRow = row.data();\n            }\n          }\n\n          $.each(tds, function (j, val1) {\n            var jqob1 = $(val1); //把input变为字符串\n\n            if (j == 4) {\n              if (!selectRow.severity) {\n                $(val1).addClass('danger');\n                isEditing = true;\n                return false;\n              } else {\n                isEditing = false;\n                $(val1).removeClass('danger');\n              }\n            }\n\n            if (!jqob1.has('button').length && jqob1.has('input').length) {\n              var txt = $.trim(jqob1.children(\"input,textarea\").val());\n\n              if (txt) {\n                $(val1).removeClass('danger');\n                isEditing = false;\n                table.cell(jqob1).data(txt);\n              } else {\n                $(val1).addClass('danger');\n                isEditing = true;\n                return false;\n              }\n            }\n          });\n\n          if (!selectRow) {\n            growl.warning(\"请填写完整故障知识\", {});\n            return;\n          }\n\n          var ipts = tr.parent().find('.input-sm');\n\n          if (isEditing == false) {\n            $.each(ipts, function (i, val) {\n              var txt = $(val).val();\n              var attrname = $(val).attr('name');\n\n              if (txt.length > 3000) {\n                growl.warning(\"您输的字符超限，请控制在3000字符以内\", {});\n                isEditing = true;\n                return false; //跳出循环\n              } else {\n                selectRow[attrname] = txt;\n                isEditing = false;\n              }\n            });\n          } // var txts = tr.parent().find('textarea');\n          // $.each(txts, function(i, val) {\n          //     var txt = $(val).val();\n          //     var attrname = $(val).attr('name');\n          //     selectRow[0][attrname] = txt;\n          //     if (txt.length > 70) {\n          //         growl.warning(\"您输的字符超限，请控制在70字以内\", {});\n          //         checkPass = false;\n          //         return;\n          //     }\n          // });\n\n\n          if (isEditing == false) {\n            $scope.doAction('savefaultKnowledge', selectRow, function (returnObj) {\n              if (!returnObj) {\n                selectRow.isEdit = 2;\n                selectRow.id = 0;\n              } else {\n                selectRow.isEdit = 0;\n                selectRow.id = returnObj.id;\n                isEditing = false;\n                tr.removeClass('shown');\n                row.cells().invalidate().draw(false);\n                row.child.hide();\n              }\n            });\n          }\n        });\n        domMain.on('click', '#cancel-btn', function (e) {\n          e.stopPropagation();\n          isEditing = false;\n          var row = table.row('.shown');\n\n          if (row.data()) {\n            row.data().isEdit = 0; // row.child.hide();\n            // row.cells().invalidate();\n\n            $scope.doAction('cancel', row.data());\n          } else {\n            var tr = $(this).closest('tr');\n            var row = table.row(tr);\n            row.data().isEdit = 0; // row.child.hide();\n            // row.cells().invalidate();\n\n            $scope.doAction('cancel', row.data());\n          }\n        });\n        domMain.on('click', '#del-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          $scope.doAction('deletefaultKnowledge', row.data(), function (returnObj) {\n            if (returnObj != 0) {\n              selectRow.isEdit = 2;\n            } else {\n              row.remove().draw(false);\n            }\n          });\n        });\n      }]\n    };\n  }]);\n});"],"sourceRoot":"/source/"}