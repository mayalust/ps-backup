{"version":3,"sources":["app-oc/js/directives/energy-dom.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","define","directives","BootstrapDialog","jszip","datatables","initDirective","timeout","compile","scope","ngModel","options","label","change","fontsize","width","dtMark","dtKey","key","placeholder","restrict","link","element","attr","mark","cssStyle","$","css","search","select","addClass","wraps","optionsWatcher","n","o","s","children","container","childrenDom","jQuery","isArray","clone","concat","find","remove","append","traverse","level","forEach","child","wrap","handler","checkhasViewId","viewId","hasOwnProperty","checkViewId","chd","i","data","inx","lb","text","push","on","event","$apply","elem","removeClass","trigger","stopPropagation","hasClass","animate","height","opacity","display","position","preventDefault","docClick","off","$watch","undefined","selectedTraverse","length","$timeout","ngDialog","$compile","resourceUIService","energyConsumeUIService","$filter","growl","$q","add","delete","edit","user","tableCtrl","$parent","energyStrucInfo","TEXT","description","des_text","des_close","getAllName","rs","getDevicesByCondition","returnObj","code","allDeveicesList","getDeviceTypeNames","allModelsList","querykpisByModelId","deviceId","modelObj","id","substring","indexOf","item","getKpisByModelId","modelId","kpis","render","type","searchlist","tree","ifCommit","commit","target","depth","parentIcon","parentRmvBtn","parentDom","parentUser","parentData","dom","btn","icon","userIcon","rubish","addSource","name","infoBtn","infoBtnClick","offset","top","left","prepend","infoBtnLeave","editSource","removeBtn","addBtn","addSourceBtn","editBtn","editSourceBtn","cover","inner","ConsumeMetersList","findEnergyConsumeMeters","energyConsumeId","prop","$broadcast","foldClick","max-height","intro","editSourceleave","fnlist","domainPath","style","border-radius","font-size","font-weight","padding","fn","deleteDomainByDomainID","success","$remove","index","removeAttr","close","size","dialog","title","open","template","className","namelist","des","modelDefinitionId","input","value","warning","addDomain","parentID","newAdd","after","modelSelect","apply","maxlength","onChange","error","disabled","nodesInput","consumeMeters","energyType","dataSourceType","saveEnergyConsumeMeters","view","energyTypeList","dataSourceTypeList","addClick","unshift","createTime","Date","delClick","splice","energyTypeClick","str","button","filter","param","modifyDomainInfo","typeOptions","show","ifShow","Array","$on","controller","$scope","$element","$attrs","table","domMain","window","JSZip","Event","ENTERPRISEINIT","args","destroy","empty","columns","ProudSmart","datatable","optionCol3","DataTable","option","footerdom","language","order","columnDefs","targets","full","escape","draft","effect","ineffect","state","rowCallback","nRow","aData","iDataIndex","arrLength","dataTable","Buttons","buttons","extend","exportOptions","appendTo","e","tr","this","closest","row","selectedCount","location","href","trim","doAction","effectTime","rows","invalidate","draw","checked","tableRows","selected","count","nodes","deselect","selectedDelete","successCount","errorCount","enterpriseIdAry","ifGo","rowData","each","visible","valueCode","hash","userLoginUIService","userType","statisticsType","MONTH","QUARTER","YEAR","no","yes","severityStr","severityBg","commitTime","processing","serverSide","ordering","aaSorting","ajax","pipeline"],"mappings":"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","file":"app-oc/js/directives/energy-dom.js","sourcesContent":["function _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\ndefine(['directives/directives', 'bootstrap-dialog', 'jszip', 'datatables.net', 'datatables.net-bs', 'datatables.net-select', 'datatables.net-buttons-bs', 'datatables.buttons.html5'], function (directives, BootstrapDialog, jszip, datatables) {\n  'use strict'; //======================================    能耗结构tree    ===========================================\n\n  directives.initDirective('energytree', ['$timeout', function (timeout, compile) {\n    var directives = {};\n    directives.scope = {\n      ngModel: \"=\",\n      options: \"=\",\n      label: \"=\",\n      change: \"&\",\n      fontsize: \"=\",\n      width: \"=\",\n      dtMark: \"=\",\n      dtKey: \"=\",\n      key: \"@\",\n      placeholder: \"@\"\n    };\n    directives.restrict = \"C\";\n    directives.link = link;\n\n    function link(scope, element, attr) {\n      // if(element.context.children.length>0) return;  行内选择时使用\n      var ready = function ready() {\n        var mark;\n        var placeholder = scope[\"placeholder\"] == \"\" ? \"\" : scope[\"placeholder\"] ? scope[\"placeholder\"] : \"请选择...\";\n        var label = scope['label'] ? scope['label'] : 'text';\n        var dtKey = scope.dtKey;\n        var dtMark = scope.dtMark;\n        var key;\n\n        if (dtKey) {\n          key = dtKey;\n        } else {\n          key = attr.key ? attr.key : \"id\";\n        }\n\n        if (dtMark) {\n          mark = dtMark;\n        } else {\n          mark = attr[\"mark\"] ? attr[\"mark\"] : \"children\";\n        }\n\n        var cssStyle = \"form-control\";\n        $(element).css(\"width\", scope.width);\n\n        if (attr[\"class\"]) {\n          if (attr[\"class\"].search(\"input-sm\") > -1 || attr[\"class\"].search(\"select-sm\") > -1) {\n            cssStyle = \"form-control input-sm\";\n          }\n        }\n\n        var select = $(\"<select></select>\").addClass(cssStyle);\n        var wraps = [];\n        select.on(\"mousedown\", function (event) {\n          event.preventDefault();\n        });\n        select.on(\"click\", function (event) {\n          scope.$apply(function () {\n            var elem = $(element).find('[id*=container]');\n\n            if (elem.hasClass(\"noview\")) {\n              elem.removeClass(\"noview\");\n              select.addClass(\"extend\");\n              timeout(function () {\n                $('body').on(\"click.body\", docClick);\n              });\n            } // docClick函数定义放在if内部在IE下面会报错\n\n\n            function docClick() {\n              elem.addClass(\"noview\");\n              $('body').off(\"click.body\");\n              select.removeClass(\"extend\");\n            }\n          });\n        });\n        element.append(select);\n\n        function ngModelWatcher(n, o, s) {\n          wraps.forEach(function (wrap) {\n            wrap.removeClass(\"active\");\n          });\n\n          if (n == undefined) {\n            select.children().remove();\n            select.append($(\"<option id='selectlabel' value='selectlabel'>\" + placeholder + \"</option>\"));\n          }\n\n          if (n != undefined && scope.options) {\n            var children;\n\n            if (jQuery.isArray(scope.options)) {\n              children = scope.options;\n            } else {\n              children = scope.options[mark];\n            }\n\n            var selectedTraverse = function selectedTraverse(children) {\n              children.forEach(function (child) {\n                if (child[key] == n) {\n                  select.children().remove();\n                  select.append($(\"<option id='selectlabel' value='selectlabel'>\" + (child.label ? child.label : '请选择...') + \"</option>\"));\n                  wraps.forEach(function (wrap) {\n                    if (wrap.attr(key) == n) {\n                      wrap.addClass(\"active\");\n                    }\n                  });\n                } else {\n                  if (child[mark]) {\n                    selectedTraverse(child[mark]);\n                  }\n                }\n              });\n            };\n\n            selectedTraverse(children);\n          }\n\n          if (scope.change && n != o) {\n            //手动触发change方法\n            scope.change({\n              data: n\n            });\n          }\n        }\n\n        ; //traverse函数定义放在if内部在IE下会报错\n\n        function traverse(children, container, level) {\n          children.forEach(function (child) {\n            var wrap = $(\"<div></div>\").addClass(\"wrap\");\n            var handler = $(\"<div></div>\").addClass(\"glyphicon\");\n            var label = $(\"<span></span>\").addClass(\"labeltxt\");\n            var childrenDom = $(\"<div></div>\").addClass(\"children\");\n            var find = false;\n            var children = child[mark];\n\n            var checkhasViewId = function checkhasViewId(child) {\n              if (child.viewId == scope.ngModel) {\n                return true;\n              } else {\n                if (child.hasOwnProperty(mark)) {\n                  var checkViewId = function checkViewId(chd) {\n                    return checkhasViewId(chd);\n                  };\n\n                  for (var i in child[mark]) {\n                    if (checkViewId(child[mark][i])) {\n                      return true;\n                    }\n                  }\n                }\n              }\n\n              return false;\n            };\n\n            handler.data(\"children\", children);\n            var lb = scope['label'] ? scope['label'] : 'label';\n            child.label = child[lb];\n            label.text(child.label ? child.label : child.text);\n\n            for (var i = 0; i <= level; i++) {\n              (function (clone, inx) {\n                if (inx == level - 1) {\n                  clone.addClass(\"last\");\n                }\n\n                clone.css(\"left\", 10 + inx * 8 + \"px\");\n                wrap.append(clone);\n              })($(\"<div></div>\").addClass(\"vline\"), i);\n            }\n\n            wrap.append(handler);\n            wrap.append(label);\n            wrap.attr(key, child[key]);\n            wrap.css(\"padding-left\", level * 8 + \"px\");\n            wraps.push(wrap);\n            container.append(wrap);\n\n            if (child[key] == scope.ngModel || child[key] == attr[\"model\"]) {\n              select.children().remove();\n              select.append($(\"<option id='selectlabel' value='selectlabel'>\" + (child.label ? child.label : '请选择...') + \"</option>\"));\n            }\n\n            wrap.on(\"click\", function (event) {\n              scope.$apply(function () {\n                select.children().remove();\n                select.append($(\"<option id='selectlabel' value='selectlabel'>\" + (child.label ? child.label : '请选择...') + \"</option>\"));\n                wraps.forEach(function (elem) {\n                  elem.removeClass(\"active\");\n                });\n                wrap.addClass(\"active\");\n\n                if (attr.hasOwnProperty(\"model\")) {\n                  attr[\"model\"] = child[key];\n                  $(element).attr(\"model\", child[key]);\n                } else {\n                  scope.ngModel = child[key];\n                }\n\n                $('body').trigger(\"click.body\");\n              });\n            });\n\n            if (children) {\n              if (checkhasViewId(child) == false) {\n                childrenDom.addClass(\"hidechildren\");\n                handler.addClass(\"glyphicon-plus\");\n              } else {\n                handler.addClass(\"glyphicon-minus\");\n              }\n\n              handler.on(\"click\", function (event) {\n                event.stopPropagation();\n\n                if (handler.hasClass(\"glyphicon-minus\")) {\n                  handler.removeClass(\"glyphicon-minus\").addClass(\"glyphicon-plus\");\n                  childrenDom.css(\"overflow\", \"hidden\");\n                  childrenDom.animate({\n                    \"height\": \"100%\",\n                    \"opacity\": 0\n                  }, 300, function () {\n                    childrenDom.css({\n                      \"display\": \"none\"\n                    }).css(\"overflow\", \"auto\");\n                  });\n                } else {\n                  handler.removeClass(\"glyphicon-plus\").addClass(\"glyphicon-minus\");\n                  childrenDom.css(\"overflow\", \"hidden\").css(\"display\", \"block\");\n                  childrenDom.animate({\n                    \"height\": \"100%\",\n                    \"position\": \"absolute\",\n                    \"opacity\": 1\n                  }, 300);\n                }\n              });\n              container.append(childrenDom);\n              traverse(children, childrenDom, level + 1);\n            }\n          });\n        }\n\n        ;\n\n        function optionsWatcher(n, o, s) {\n          if (n) {\n            var options = n;\n            var container = $(\"<div></div>\").attr(\"id\", \"container\").addClass(\"noview\").css(\"border-top\", \"1px solid #ddd\");\n            var childrenDom = $(\"<div></div>\").addClass(\"children\");\n            var children;\n\n            if (jQuery.isArray(options)) {\n              children = options;\n            } else {\n              children = options[mark];\n            }\n\n            if (attr[\"showclear\"]) {\n              //显示空选项\n              var clone = {\n                key: null\n              };\n              clone[label] = placeholder;\n              children = [clone].concat(children);\n            }\n\n            select.find('[id*=selectlabel]').remove();\n\n            if (options[key] && (options[key] == scope.ngModel || options[key] == attr[\"model\"])) {\n              select.append($(\"<option id='selectlabel'>\" + (options.label ? options.label : '请选择...') + \"</option>\"));\n            } else {\n              select.append($(\"<option id='selectlabel'>\" + placeholder + \"</option>\"));\n            }\n\n            container.append(childrenDom);\n            element.find('[id*=container]').remove();\n            element.append(container);\n\n            if (children) {\n              traverse(children, childrenDom, 1);\n            }\n          } else {\n            element.find('[id*=container]').remove();\n          }\n        }\n\n        ;\n\n        if (attr.hasOwnProperty(\"ngModel\") && attr.ngModel) {\n          scope.$watch(\"ngModel\", ngModelWatcher);\n        }\n\n        if (attr.hasOwnProperty(\"options\") && attr.options) {\n          if (scope.options && (jQuery.isArray(scope.options) && scope.options.length > 0 || scope.options[mark])) {\n            optionsWatcher(scope.options);\n          } else {\n            scope.$watch(\"options\", optionsWatcher);\n          }\n        }\n      };\n\n      timeout(ready);\n    }\n\n    return directives;\n  }]); //======================================    能耗结构信息    ===========================================\n\n  directives.initDirective('energyStructureTable', ['$timeout', 'ngDialog', '$compile', 'resourceUIService', 'energyConsumeUIService', '$filter', 'growl', '$q', function ($timeout, ngDialog, $compile, resourceUIService, energyConsumeUIService, $filter, growl, $q) {\n    return {\n      restrict: 'A',\n      scope: {\n        ngModel: \"=\",\n        add: \"&\",\n        delete: \"&\",\n        edit: \"&\",\n        user: \"&\"\n      },\n      link: function link(scope, element, attr, tableCtrl) {\n        var parentSelectList = scope.$parent.$parent.energyStrucInfo;\n        var TEXT = {\n          \"SUBMIT\": \"确定\",\n          \"CANCEL\": \"取消\"\n        };\n        var description = $(\"<div></div>\").css(\"z-index\", 1999).css(\"background-color\", \"#fff\").css(\"box-shadow\", \"1px 1px 10px rgba(0,0,0,.3)\").css(\"padding\", \"15px 20px\").css(\"margin\", \"-5px 0 0 25px\").css(\"display\", \"block\").css(\"width\", \"300px\").css(\"position\", \"fixed\");\n        var des_text = $(\"<p></p>\").text('').css(\"color\", \"#666\").css(\"margin\", 0).css(\"line-height\", \"16px\").css(\"font-size\", \"12px\").css(\"font-weight\", \"normal\");\n        var des_close = $(\"<div></div>\").append($(\"<span class='close'>x</span>\"));\n        var des_title = $(\"<p></p>\").text(\"描述 :\").css(\"font-weight\", \"bold\").css(\"color\", \"#333\").css(\"margin\", \"10px auto\").css(\"line-height\", \"16px\").css(\"font-size\", \"12px\");\n        description.append(des_close).append(des_text);\n\n        var ready = function ready() {\n          $(element).css(\"position\", \"relative\");\n\n          var ngModelWatcher = function ngModelWatcher(n, o, s) {\n            var getAllName = function getAllName(data) {\n              var rs = [];\n\n              var traverse = function traverse(data) {\n                rs.push(data.label);\n\n                var loop = function loop(elem) {\n                  traverse(elem);\n                };\n\n                if (data.hasOwnProperty(\"children\")) {\n                  for (var i in data.children) {\n                    loop(data.children[i]);\n                  }\n                }\n              };\n\n              traverse(data);\n              return rs;\n            }; //获取所有设备\n\n\n            var queryAllDevicesList = function () {\n              resourceUIService.getDevicesByCondition({}, function (returnObj) {\n                if (returnObj.code == 0) {\n                  returnObj.data.forEach(function (obj) {\n                    obj.text = obj.label;\n                  });\n                  scope.allDeveicesList = returnObj.data;\n                }\n              });\n            }(); //获取所有设备模板\n\n\n            var queryAllModelsList = function () {\n              var filterModels = [];\n              var filterAry = [];\n              energyConsumeUIService.getDeviceTypeNames('devicetype', function (returnObj) {\n                if (returnObj.code == 0) {\n                  returnObj.data.forEach(function (obj) {\n                    obj.text = obj.label;\n                  });\n                  scope.allModelsList = returnObj.data;\n                }\n              });\n            }(); //获取设备下的设备模型Id，再得到kpi值\n\n\n            scope.querykpisByModelId = function (deviceId) {\n              var modelObj = {};\n\n              if (_typeof(deviceId) === 'object') {\n                deviceId = deviceId.id.substring(deviceId.id.indexOf(':') + 1);\n              }\n\n              modelObj = scope.allDeveicesList.find(function (item) {\n                return item.id == deviceId;\n              });\n\n              if (!modelObj) {\n                return;\n              }\n\n              resourceUIService.getKpisByModelId(modelObj.modelId, function (returnObj) {\n                if (returnObj.code == 0) {\n                  returnObj.data.forEach(function (item) {\n                    item.text = item.label;\n                  });\n                  scope.kpis = returnObj.data;\n                }\n              });\n            };\n\n            var render = function render(data, type, searchlist) {\n              var tree = data;\n              var ifCommit = data.commit == 'yes' ? true : false;\n              $(element).children().remove();\n\n              var traverse = function traverse(target, data, depth, parentIcon, parentRmvBtn, parentDom, parentUser, parentData) {\n                depth++;\n                var children;\n                var dom = $(\"<div></div>\").css(\"border-bottom\", \"1px solid #ddd\").css(\"position\", \"relative\").css(\"overflow\", \"hidden\").css(\"opacity\", 0).css(\"max-height\", 0).css(\"line-height\", \"40px\");\n                var btn = $(\"<button></button>\").css(\"line-height\", \"24px\").css(\"color\", \"#fff\").css(\"border\", \"0\").css(\"background-color\", \"#009dea\").css(\"float\", \"left\").css(\"margin\", \"4px 10px 0px 3px\");\n                var icon = $(\"<span></span>\").addClass(\"glyphicon glyphicon-minus\");\n                var userIcon = $(\"<span></span>\").addClass(\"glyphicon glyphicon-user\").css(\"margin\", \"0 17px\").css(\"color\", \"#ccc\");\n                var rubish = $(\"<div></div>\").addClass(\"glyphicon glyphicon-trash\");\n                var add = $(\"<div></div>\").addClass(\"glyphicon glyphicon-plus\");\n                var addSource = $(\"<div></div>\").addClass(\"glyphicon glyphicon-tag\");\n                var person = $(\"<span></span>\").addClass(\"glyphicon glyphicon-user\");\n                var text = $(\"<span></span>\").css(\"margin-left\", 10).text(data.name);\n                var infoBtn = $(\"<span></span>\").addClass(\"glyphicon glyphicon-question-sign\").css(\"font-size\", \"16px\").css(\"color\", \"#eee\").css(\"margin-left\", \"20px\");\n\n                var infoBtnClick = function infoBtnClick(event) {\n                  event.stopPropagation();\n                  description.remove();\n                  var offset = $(event.target).offset();\n                  description.css({\n                    opacity: 0,\n                    top: offset.top - 20,\n                    left: offset.left + 5\n                  });\n                  description.text(data.description);\n                  $(\"body\").prepend(description);\n                  description.animate({\n                    opacity: 1\n                  }, 300);\n                  $(\"body\").on(\"click.infoleave\", infoBtnLeave);\n                };\n\n                var infoBtnLeave = function infoBtnLeave(event) {\n                  event.stopPropagation();\n                  $(\"body\").off();\n                  description.remove();\n                };\n\n                var edit = $(\"<span></span>\").addClass(\"proudsmart ps-edit\");\n                var editSource = $(\"<span></span>\").addClass(\"proudsmart ps-edit\");\n                var removeBtn = $(\"<button></button>\").css(\"color\", \"#dd695c\").css(\"border\", \"1px solid #ddd\").css(\"margin\", 0).css(\"background-color\", \"#fff\").css(\"line-height\", \"24px\").css(\"position\", \"relative\").css(\"overflow\", \"visible\").css(\"float\", \"right\").css(\"z-index\", 7).css(\"margin\", \"4px 3px 0px 2px\");\n                var addBtn = removeBtn.clone();\n                var addSourceBtn = removeBtn.clone();\n                var editBtn = removeBtn.clone();\n                var editSourceBtn = removeBtn.clone();\n                var cover = $(\"<div></div>\").css(\"background-color\", \"#0f58a9\").css(\"opacity\", .2).css(\"position\", \"absolute\").css(\"height\", \"40px\").css(\"top\", 0).css(\"width\", \"100%\");\n                var inner = $(\"<div></div>\").css(\"margin-left\", (type != \"search\" ? depth * 20 : 0) + \"px\");\n                addBtn.append(add);\n                addSourceBtn.append(addSource);\n                addBtn.css(\"z-index\", 3).css(\"color\", \"#1eb8b8\");\n                addSourceBtn.css(\"z-index\", 1).css(\"color\", \"rgb(92, 95, 221)\");\n                editBtn.append(edit);\n                editBtn.css(\"z-index\", 5).css(\"color\", \"#009fea\");\n                editSourceBtn.append(editSource);\n                editSourceBtn.css(\"z-index\", 2).css(\"color\", \"#009fea\");\n                removeBtn.append(rubish); //获取当前节点下的所有计量点\n\n                var ConsumeMetersList = [];\n\n                var getConsumeMeters = function (data) {\n                  energyConsumeUIService.findEnergyConsumeMeters([{\n                    energyConsumeId: data.id\n                  }], function (returnObj) {\n                    if (returnObj.code == 0) {\n                      // returnObj.data.forEach(function(item) {\n                      //   item.energyConsumeId = data.id;\n                      // });\n                      ConsumeMetersList = returnObj.data;\n                    }\n                  });\n                }(data);\n\n                if (type == \"search\") {\n                  //查找\n                  var find = searchlist.find(function (elem) {\n                    return elem.name == data.name;\n                  });\n\n                  if (!find) {\n                    //查找没有找打\n                    dom.css(\"display\", \"none\");\n                  } else {\n                    //找到了，高亮显示\n                    btn.prop(\"disabled\", true);\n                    dom.on(\"click\", function (event) {\n                      scope.$broadcast(\"HIGHLIGHTDATA\", data);\n                    });\n                  }\n\n                  btn.css(\"display\", \"none\");\n                } else if (type == \"highlight\") {\n                  //找到了，高亮显示\n                  if (searchlist) {\n                    if (data.id == searchlist.id) {\n                      dom.css(\"background-color\", \"#d1edaa\");\n                    }\n                  }\n                }\n\n                btn.append(icon);\n\n                if (data.description) {\n                  infoBtn.css(\"cursor\", \"pointer\").css(\"color\", \"#ccc\").on(\"click\", infoBtnClick);\n                }\n\n                if (!parentData) {\n                  //没有父节点，不许编辑\n                  dom.css(\"background-color\", \"#eee\");\n                  editBtn.css(\"display\", \"none\");\n                  removeBtn.css(\"display\", \"none\");\n                }\n\n                var foldClick = function foldClick(event) {\n                  if (children.css(\"max-height\") == \"0px\") {\n                    $timeout(function () {\n                      icon.removeClass().addClass(\"glyphicon glyphicon-minus\");\n                      children.animate({\n                        \"max-height\": 800,\n                        \"opacity\": 1\n                      }, 300);\n                    });\n                  } else {\n                    $timeout(function () {\n                      icon.removeClass().addClass(\"glyphicon glyphicon-plus\");\n                      children.animate({\n                        \"max-height\": 0,\n                        \"opacity\": 0\n                      }, 300);\n                    });\n                  }\n                };\n\n                var addClick = function addClick(event) {\n                  event.stopPropagation();\n\n                  var cancel = function cancel(event) {\n                    ngDialog.close();\n                  };\n\n                  var namelist = [];\n\n                  if (data.children == undefined) {\n                    data.children = [];\n                  }\n\n                  namelist = getAllName(tree);\n                  var inx = 0;\n                  var name = \"新建能耗节点\";\n\n                  while (namelist.indexOf(name) != -1) {\n                    inx++;\n                    name = \"新建能耗节点_\" + inx;\n                  }\n\n                  var confirm = function confirm(event) {\n                    var id = data.id;\n                    var name = '',\n                        des = '',\n                        modelDefinitionId = '';\n\n                    if (!event.input[0].value.id) {\n                      growl.warning(\"请选择类型\", {});\n                      return;\n                    }\n\n                    if (event.input[0].value.id == 'model') {\n                      name = event.input[2].value;\n                      modelDefinitionId = event.input[1].value.id;\n\n                      if (!modelDefinitionId) {\n                        growl.warning(\"请选择设备模板\", {});\n                        return;\n                      } else if (!name) {\n                        growl.warning(\"请填写节点名称\", {});\n                        return;\n                      }\n                    } else if (event.input[0].value.id == 'input') {\n                      name = event.input[3].value;\n                      des = event.input[4].value;\n\n                      if (!name) {\n                        growl.warning(\"请填写节点名称\", {});\n                        return;\n                      }\n                    }\n\n                    var success = function success(returnObj) {\n                      if (returnObj.code != 0) {\n                        return;\n                      }\n\n                      var newAdd = returnObj.data;\n                      data.children.push(newAdd);\n                      userIcon.css(\"display\", \"none\");\n                      btn.css(\"display\", \"inline\");\n                      icon.removeClass().addClass(\"glyphicon glyphicon-minus\");\n\n                      if (children == undefined) {\n                        children = $(\"<div></div>\").css(\"overflow\", \"hidden\").css(\"position\", \"relative\");\n                      }\n\n                      dom.after(children);\n                      btn.off(\"click\");\n                      btn.on(\"click\", foldClick);\n                      removeBtn.prop(\"disabled\", true);\n                      removeBtn.css(\"color\", \"#aaa\");\n                      dom.css(\"font-weight\", \"bold\");\n                      traverse(children, newAdd, depth, btn, removeBtn, dom, userIcon, data.children);\n                      scope.add({\n                        event: data\n                      });\n\n                      if (children.css(\"max-height\") == \"0px\") {\n                        $timeout(function () {\n                          icon.removeClass().addClass(\"glyphicon glyphicon-minus\");\n                          children.animate({\n                            \"max-height\": 400,\n                            \"opacity\": 1\n                          }, 300, function () {});\n                        });\n                      }\n\n                      ;\n                      growl.success(\"能耗节点添加成功\", {});\n                      ngDialog.close();\n                    };\n\n                    var error = function error(returnObj) {\n                      growl.warning(\"添加节点能耗失败\", {});\n                    };\n\n                    energyConsumeUIService.addDomain([{\n                      'parentID': id,\n                      'modelDefinitionId': event.input[0].value.id == 'model' ? modelDefinitionId : undefined,\n                      'name': name,\n                      'description': des\n                    }], success);\n                  };\n\n                  var fnlist = [{\n                    label: TEXT.SUBMIT,\n                    icon: 'btn btn-primary',\n                    style: {\n                      width: '50%',\n                      'border-radius': 0,\n                      'font-size': '18px',\n                      'font-weight': 'bold',\n                      'padding': 10\n                    },\n                    fn: confirm\n                  }, {\n                    label: TEXT.CANCEL,\n                    icon: 'btn btn-default',\n                    style: {\n                      width: '50%',\n                      'border-radius': 0,\n                      'font-size': '18px',\n                      'font-weight': 'bold',\n                      'padding': 10\n                    },\n                    fn: cancel\n                  }];\n                  var modelSelect = [{\n                    value: '',\n                    label: '设备模板',\n                    type: 'select',\n                    placeholder: '设备模板',\n                    apply: false,\n                    options: scope.allModelsList,\n                    change: function change(event) {}\n                  }, {\n                    value: '',\n                    label: '节点名称',\n                    type: 'input',\n                    placeholder: '节点名称',\n                    apply: false,\n                    maxlength: 32,\n                    onChange: function onChange(event) {\n                      if (namelist.indexOf(event.value) != -1) {\n                        event.error = \"此节点名称已被占用\";\n                        fnlist[0].disabled = true;\n                      } else {\n                        event.error = null;\n                        fnlist[0].disabled = false;\n                      }\n                    }\n                  }];\n                  var nodesInput = [{\n                    value: name,\n                    label: '节点名称',\n                    type: 'input',\n                    placeholder: '填写节点名称',\n                    apply: false,\n                    maxlength: 32,\n                    onChange: function onChange(event) {\n                      if (namelist.indexOf(event.value) != -1) {\n                        event.error = \"此节点名称已被占用\";\n                        fnlist[0].disabled = true;\n                      } else {\n                        event.error = null;\n                        fnlist[0].disabled = false;\n                      }\n                    }\n                  }, {\n                    value: '节点描述',\n                    label: '节点描述',\n                    type: 'textarea',\n                    apply: false,\n                    maxlength: 200,\n                    placeholder: '填写节点描述'\n                  }];\n                  scope.dialog = {\n                    title: {\n                      label: '能耗节点信息'\n                    },\n                    input: [{\n                      value: '',\n                      label: '选择类型',\n                      type: 'select',\n                      placeholder: '选择类型',\n                      apply: true,\n                      options: [{\n                        id: 'model',\n                        label: '设备模板'\n                      }, {\n                        id: 'input',\n                        label: '手动输入'\n                      }],\n                      change: function change(event) {\n                        if (event.value.id == 'model') {\n                          modelSelect[0].apply = true;\n                          modelSelect[1].apply = true;\n                          nodesInput.forEach(function (item) {\n                            item.apply = false;\n                            item.value = '';\n                          });\n                        } else {\n                          modelSelect[0].apply = false;\n                          modelSelect[0].value = '';\n                          modelSelect[1].apply = false;\n                          modelSelect[1].value = '';\n                          nodesInput.forEach(function (item) {\n                            item.apply = true;\n                          });\n                        }\n                      }\n                    }, modelSelect[0], modelSelect[1], nodesInput[0], nodesInput[1]],\n                    fnlist: fnlist\n                  };\n                  ngDialog.open({\n                    template: '../partials/dialogue/enterprise_dia_copy.html',\n                    className: 'ngdialog-theme-plain',\n                    scope: scope\n                  });\n                };\n\n                var addSourceClick = function addSourceClick(event) {\n                  event.stopPropagation();\n\n                  var confirm = function confirm(event) {\n                    var consumeMeters = [];\n                    consumeMeters = scope.dialog.title.consumeMeters;\n\n                    if (consumeMeters.length == 0) {\n                      growl.warning(\"需要至少添加一条计量点\", {});\n                      return;\n                    }\n\n                    for (var i in consumeMeters) {\n                      if (consumeMeters[i].energyType == '' || consumeMeters[i].dataSourceType == '') {\n                        growl.warning(\"请完整输入计量点\", {});\n                        return;\n                      }\n                    }\n\n                    energyConsumeUIService.saveEnergyConsumeMeters([data.id, consumeMeters], function (returnObj) {\n                      if (returnObj.code == 0) {\n                        growl.success(\"能耗计量点保存成功\", {});\n                        ngDialog.close();\n                      }\n                    });\n                  };\n\n                  var cancel = function cancel(event) {\n                    ngDialog.close();\n                  };\n\n                  var fnlist = [{\n                    label: TEXT.SUBMIT,\n                    icon: 'btn btn-primary',\n                    style: {\n                      width: '50%',\n                      'border-radius': 0,\n                      'font-size': '18px',\n                      'font-weight': 'bold',\n                      'padding': 10\n                    },\n                    fn: confirm\n                  }, {\n                    label: TEXT.CANCEL,\n                    icon: 'btn btn-default',\n                    style: {\n                      width: '50%',\n                      'border-radius': 0,\n                      'font-size': '18px',\n                      'font-weight': 'bold',\n                      'padding': 10\n                    },\n                    fn: cancel\n                  }];\n                  scope.dialog = {\n                    title: {\n                      label: '能耗计量点',\n                      consumeMeters: ConsumeMetersList\n                    },\n                    view: ifCommit ? true : false,\n                    select: {\n                      energyTypeList: scope.$parent.$parent.energyTypeList,\n                      dataSourceTypeList: scope.$parent.$parent.dataSourceTypeList\n                    },\n                    event: {\n                      addClick: function addClick() {\n                        scope.dialog.title.consumeMeters.unshift({\n                          energyType: '',\n                          dataSourceType: '',\n                          energyConsumeId: data.id,\n                          createTime: new Date(),\n                          id: -1\n                        });\n                      },\n                      delClick: function delClick(obj) {\n                        for (var i in scope.dialog.title.consumeMeters) {\n                          if (obj.createTime == scope.dialog.title.consumeMeters[i].createTime) {\n                            scope.dialog.title.consumeMeters.splice(i, 1);\n                          }\n                        }\n\n                        ;\n                      },\n                      energyTypeClick: function energyTypeClick(str) {\n                        return; // var ary = [];\n                        // scope.$parent.$parent.energyStrucInfo.energyTypeList.forEach(function(item) {\n                        //   if (item.valueCode != str) {\n                        //     ary.push(item);\n                        //   }\n                        // });\n                        // scope.$parent.$parent.energyStrucInfo.energyTypeList = ary;\n                        //  \n                        // scope.$apply();\n                      }\n                    },\n                    button: fnlist\n                  };\n\n                  if (scope.dialog.title.consumeMeters) {\n                    //如果此dialog有计量点就查询出可能设备上的kpi值\n                    scope.dialog.title.consumeMeters.forEach(function (item) {\n                      if (item.deviceId) {\n                        scope.querykpisByModelId(item.deviceId);\n                      }\n                    });\n                  }\n\n                  ngDialog.open({\n                    template: '../partials/dialogue/energy_source_dia.html',\n                    className: 'ngdialog-theme-plain',\n                    scope: scope\n                  });\n                };\n\n                var removeClick = function removeClick() {\n                  event.stopPropagation();\n                  var id = data.id;\n                  var domainPath = data.domainPath;\n\n                  var confirm = function confirm() {\n                    var success = function success(event) {\n                      if (event.code == 0) {\n                        growl.success(\"能耗节点已删除成功\", {});\n                        parentData.$remove(function (index, elem) {\n                          return elem.id == data.id;\n                        });\n\n                        if (parentData.length == 0) {\n                          parentRmvBtn.removeAttr(\"disabled\");\n                          parentRmvBtn.css(\"color\", \"#dd695c\");\n                        } else {\n                          parentRmvBtn.prop(\"disabled\", true);\n                          parentRmvBtn.css(\"color\", \"#aaa\");\n                        }\n\n                        ngDialog.close();\n\n                        var animFinished = function animFinished() {\n                          dom.remove();\n\n                          if (target.children().size() == 0) {\n                            target.remove();\n                            parentDom.css(\"font-weight\", \"normal\");\n                            parentDom.css(\"background-color\", \"#fff\"); // parentRmvBtn.css(\"display\", \"block\");\n\n                            parentIcon.css(\"display\", \"none\");\n                            parentUser.css(\"display\", \"inline\");\n                          }\n                        };\n\n                        dom.animate({\n                          \"opacity\": 0,\n                          \"max-height\": 0\n                        }, 300, animFinished);\n                        scope.delete({\n                          event: data\n                        });\n                      }\n                    };\n\n                    energyConsumeUIService.deleteDomainByDomainID(id, success);\n                  };\n\n                  var cancel = function cancel() {\n                    ngDialog.close();\n                  };\n\n                  var fnlist = [{\n                    label: '确定',\n                    icon: 'btn btn-success',\n                    style: {\n                      'width': '50%',\n                      'border-radius': 0,\n                      'font-size': '18px',\n                      'font-weight': 'bold',\n                      'padding': 10\n                    },\n                    fn: confirm\n                  }, {\n                    label: '取消',\n                    icon: 'btn btn-default',\n                    style: {\n                      'width': '50%',\n                      'border-radius': 0,\n                      'font-size': '18px',\n                      'font-weight': 'bold',\n                      'padding': 10\n                    },\n                    fn: cancel\n                  }];\n                  scope.dialog = {\n                    title: {\n                      label: '提示'\n                    },\n                    description: {\n                      label: '确认删除该能耗节点吗？'\n                    },\n                    fnlist: fnlist\n                  };\n                  ngDialog.open({\n                    template: '../partials/dialogue/common_dia_prompt.html',\n                    className: 'ngdialog-theme-plain',\n                    scope: scope\n                  });\n                };\n\n                var editClick = function editClick() {\n                  event.stopPropagation();\n                  var id = data.id;\n                  var namelist = getAllName(tree);\n                  namelist.$remove(function (index, elem) {\n                    return elem == data.name;\n                  });\n                  var modelObj = scope.allModelsList.filter(function (item) {\n                    return item.id == data.modelDefinitionId;\n                  });\n\n                  var confirm = function confirm(event) {\n                    var name = '',\n                        des = '',\n                        modelDefinitionId = '';\n\n                    if (!event.input[0].value) {\n                      growl.warning(\"请选择类型\", {});\n                      return;\n                    }\n\n                    if (event.input[0].value.id == 'model') {\n                      name = event.input[2].value;\n                      modelDefinitionId = event.input[1].value.id;\n\n                      if (!modelDefinitionId) {\n                        growl.warning(\"请选择设备模板\", {});\n                        return;\n                      } else if (!name) {\n                        growl.warning(\"请填写节点名称\", {});\n                        return;\n                      }\n                    } else if (event.input[0].value.id == 'input') {\n                      name = event.input[3].value;\n                      des = event.input[4].value;\n\n                      if (!name) {\n                        growl.warning(\"请填写节点名称\", {});\n                        return;\n                      }\n                    }\n\n                    var param = {\n                      'name': name,\n                      'description': des,\n                      'modelDefinitionId': modelDefinitionId ? modelDefinitionId : '',\n                      'id': data.id,\n                      'parentID': data.parentID\n                    };\n                    energyConsumeUIService.modifyDomainInfo(param, function (returnObj) {\n                      if (returnObj.code == 0) {\n                        if (returnObj.data.description) {\n                          infoBtn.css(\"cursor\", \"pointer\").css(\"color\", \"#ccc\").on(\"click\", infoBtnClick);\n                        } else {\n                          infoBtn.css(\"cursor\", \"default\").css(\"color\", \"#eee\").off(\"click\");\n                        }\n\n                        text.text(returnObj.data.name);\n                        des_text.text(returnObj.data.description);\n                        data.name = returnObj.data.name;\n                        data.description = returnObj.data.description;\n                        growl.success(\"能耗节点修改成功\", {});\n                        ngDialog.close();\n                      } else {\n                        return;\n                      }\n                    });\n                  };\n\n                  var cancel = function cancel(event) {\n                    ngDialog.close();\n                  };\n\n                  var fnlist = [{\n                    label: '确定',\n                    icon: 'btn btn-primary',\n                    style: {\n                      width: '50%',\n                      'border-radius': 0,\n                      'font-size': '18px',\n                      'font-weight': 'bold',\n                      'padding': 10\n                    },\n                    fn: confirm\n                  }, {\n                    label: '取消',\n                    icon: 'btn btn-default',\n                    style: {\n                      width: '50%',\n                      'border-radius': 0,\n                      'font-size': '18px',\n                      'font-weight': 'bold',\n                      'padding': 10\n                    },\n                    fn: cancel\n                  }];\n                  var modelSelect = [{\n                    value: modelObj[0],\n                    label: '设备模板',\n                    type: 'select',\n                    placeholder: '设备模板',\n                    apply: data.modelDefinitionId ? true : false,\n                    options: scope.allModelsList,\n                    change: function change(event) {}\n                  }, {\n                    value: data.name,\n                    label: '节点名称',\n                    type: 'input',\n                    placeholder: '节点名称',\n                    apply: data.modelDefinitionId ? true : false\n                  }];\n                  var nodesInput = [{\n                    value: data.name,\n                    label: '节点名称',\n                    type: 'input',\n                    placeholder: '填写节点名称',\n                    apply: data.modelDefinitionId ? false : true,\n                    maxlength: 32,\n                    onChange: function onChange(event) {\n                      if (namelist.indexOf(event.value) != -1) {\n                        event.error = \"此节点名称已被占用\";\n                        fnlist[0].disabled = true;\n                      } else {\n                        event.error = null;\n                        fnlist[0].disabled = false;\n                      }\n                    }\n                  }, {\n                    value: data.description,\n                    label: '节点描述',\n                    type: 'textarea',\n                    apply: data.modelDefinitionId ? false : true,\n                    maxlength: 200,\n                    placeholder: '填写节点描述'\n                  }];\n                  var typeOptions = [{\n                    id: 'model',\n                    label: '设备模板'\n                  }, {\n                    id: 'input',\n                    label: '手动输入'\n                  }];\n                  scope.dialog = {\n                    title: {\n                      label: '能耗节点信息'\n                    },\n                    input: [{\n                      value: data.modelDefinitionId ? typeOptions[0] : typeOptions[1],\n                      label: '选择类型',\n                      type: 'select',\n                      placeholder: '选择类型',\n                      apply: true,\n                      options: typeOptions,\n                      change: function change(event) {\n                        if (event.value.id == 'model') {\n                          modelSelect[0].apply = true;\n                          modelSelect[1].apply = true;\n                          nodesInput.forEach(function (item) {\n                            item.apply = false;\n                            item.value = '';\n                          });\n                        } else {\n                          modelSelect[0].apply = false;\n                          modelSelect[0].value = '';\n                          modelSelect[1].apply = false;\n                          modelSelect[1].value = '';\n                          nodesInput.forEach(function (item) {\n                            item.apply = true;\n                          });\n                        }\n                      }\n                    }, modelSelect[0], modelSelect[1], nodesInput[0], nodesInput[1]],\n                    fnlist: fnlist\n                  };\n                  ngDialog.open({\n                    template: '../partials/dialogue/enterprise_dia_copy.html',\n                    className: 'ngdialog-theme-plain',\n                    scope: scope\n                  });\n\n                  var ready = function ready() {\n                    scope.edit({\n                      event: data\n                    });\n                  };\n\n                  scope.$apply(ready);\n                };\n\n                var userClick = function userClick() {\n                  var ready = function ready() {\n                    scope.user({\n                      user: data\n                    });\n                  };\n\n                  scope.$apply(ready);\n                };\n\n                var intro = $('<div></div>').css(\"padding\", \"2px 10px\").css(\"top\", \"0px\").css(\"right\", \"32px\").css(\"pointer-events\", \"none\").css(\"border-radius\", \"2px\").css(\"background-color\", \"#000\").css(\"position\", \"absolute\").css(\"font-weight\", \"bold\").css(\"width\", \"100px\").css(\"color\", \"#fff\");\n\n                var addenter = function addenter() {\n                  intro.text(\"添加子节点\");\n                  addBtn.append(intro);\n                };\n\n                var addSourcEnter = function addSourcEnter() {\n                  intro.text(\"能耗计量点\");\n                  addSourceBtn.append(intro);\n                };\n\n                var addleave = function addleave() {\n                  intro.remove();\n                };\n\n                var addSourcLeave = function addSourcLeave() {\n                  intro.remove();\n                };\n\n                var removeenter = function removeenter() {\n                  intro.text(\"删除子节点\");\n                  removeBtn.append(intro);\n                };\n\n                var removeleave = function removeleave() {\n                  intro.remove();\n                };\n\n                var editenter = function editenter() {\n                  intro.text(\"编辑子节点\");\n                  editBtn.append(intro);\n                };\n\n                var editSourcenter = function editSourcenter() {\n                  intro.text(\"编辑计量点\");\n                  editSourceBtn.append(intro);\n                };\n\n                var editleave = function editleave() {\n                  intro.remove();\n                };\n\n                var editSourceleave = function editSourceleave() {\n                  intro.remove();\n                };\n\n                removeBtn.on(\"click\", removeClick);\n                addBtn.on(\"click\", addClick);\n                addSourceBtn.on(\"click\", addSourceClick);\n                addBtn.on(\"mouseenter\", addenter);\n                addSourceBtn.on(\"mouseenter\", addSourcEnter);\n                addBtn.on(\"mouseleave\", addleave);\n                addSourceBtn.on(\"mouseleave\", addSourcLeave);\n                removeBtn.on(\"mouseenter\", removeenter);\n                removeBtn.on(\"mouseleave\", removeleave);\n                editBtn.on(\"click\", editClick); // editSourceBtn.on(\"click\", editSourceClick);\n\n                editBtn.on(\"mouseenter\", editenter);\n                editSourceBtn.on(\"mouseenter\", editSourcenter);\n                editBtn.on(\"mouseleave\", editSourceleave);\n                editSourceBtn.on(\"mouseleave\", editSourceleave); //userBtn.on(\"click\", userClick);\n\n                target.append(dom);\n\n                if (type != 'search') {\n                  inner.append(btn).append(userIcon);\n                }\n\n                ;\n                inner.append(text).append(infoBtn);\n                dom.animate({\n                  \"opacity\": 1,\n                  \"max-height\": \"50px\"\n                }, 300);\n                cover.animate({\n                  \"opacity\": \"0\"\n                }, 700, function () {\n                  cover.remove();\n                });\n\n                if (data.hasOwnProperty(\"children\")) {\n                  userIcon.css(\"display\", \"none\");\n                  btn.css(\"display\", \"block\");\n                  dom.css(\"font-weight\", \"bold\"); //dom.css(\"background-color\", \"#eee\");\n\n                  if (data.show = false) {\n                    dom.css(\"max-height\", 0);\n                  }\n\n                  ;\n                  children = $(\"<div></div>\").css(\"overflow\", \"hidden\");\n\n                  var hasChild = function hasChild(data, target) {\n                    var traverse = function traverse(data) {\n                      if (data == target) {\n                        return true;\n                      } else if (data.hasOwnProperty(\"children\")) {\n                        for (var i in data.children) {\n                          if (traverse(data.children[i])) {\n                            return true;\n                          }\n                        }\n\n                        return false;\n                      } else {\n                        return false;\n                      }\n                    };\n\n                    return traverse(data);\n                  };\n\n                  if (type == 'search') {\n                    icon.removeClass().addClass(\"glyphicon glyphicon-minus\");\n                  } else if (type == 'highlight') {\n                    if (hasChild(data, searchlist) && data != searchlist) {\n                      icon.removeClass().addClass(\"glyphicon glyphicon-minus\");\n                    } else {\n                      children.css(\"max-height\", 0);\n                      icon.removeClass().addClass(\"glyphicon glyphicon-plus\");\n                    }\n\n                    ;\n                  } else {\n                    if (depth > 1) {\n                      children.css(\"max-height\", 0);\n                      icon.removeClass().addClass(\"glyphicon glyphicon-plus\");\n                    }\n                  }\n\n                  if (scope.$parent.$parent.energyStrucInfo.ifShow && ifCommit) {\n                    //企业用户且为提交状态\n                    // removeBtn.prop(\"disabled\", true);\n                    removeBtn.attr(\"display\", \"none\");\n                    editBtn.prop(\"disabled\", true);\n                    addBtn.prop(\"disabled\", true);\n                    removeBtn.css(\"color\", \"#aaa\");\n                    editBtn.css(\"color\", \"#aaa\");\n                    addBtn.css(\"color\", \"#aaa\");\n                  }\n\n                  target.append(children);\n\n                  for (var i in data.children) {\n                    traverse(children, data.children[i], depth, btn, removeBtn, dom, userIcon, data.children);\n                  }\n\n                  removeBtn.prop(\"disabled\", true);\n                  removeBtn.css(\"color\", \"#aaa\");\n                  btn.on(\"click\", foldClick);\n                } else {\n                  userIcon.css(\"display\", \"inline\");\n                  btn.css(\"display\", \"none\");\n                  removeBtn.removeAttr(\"disabled\");\n                  removeBtn.css(\"color\", \"#dd695c\");\n\n                  if (scope.$parent.$parent.energyStrucInfo.ifShow && ifCommit) {\n                    //企业用户且为提交状态\n                    removeBtn.prop(\"disabled\", true);\n                    editBtn.prop(\"disabled\", true);\n                    addBtn.prop(\"disabled\", true);\n                    removeBtn.css(\"color\", \"#aaa\");\n                    editBtn.css(\"color\", \"#aaa\");\n                    addBtn.css(\"color\", \"#aaa\");\n                  }\n                }\n\n                inner.append(removeBtn).append(editBtn).append(addBtn).append(addSourceBtn); // inner.append(removeBtn).append(addSourceBtn);\n                // inner.append(removeBtn).append(editSourceBtn).append(addSourceBtn);\n\n                dom.append(inner);\n                dom.append(cover);\n              };\n\n              if (data instanceof Array) {\n                for (var i in data) {\n                  traverse($(element), data[i], -1);\n                }\n              } else {\n                traverse($(element), data, -1);\n              }\n            };\n\n            if (n != undefined) {\n              scope.$on(\"FILTERDATA\", function (event, data) {\n                render(n, \"search\", data);\n              });\n              scope.$on(\"HIGHLIGHTDATA\", function (event, data) {\n                render(n, 'highlight', data);\n              });\n              scope.$on(\"FILTERDATA_allData\", function (event, data) {\n                render(n, \"normal\", data);\n              });\n              scope.$on(\"commit\", function (event, data) {\n                n.commit = 'yes';\n                render(n);\n              });\n              render(n);\n            }\n          };\n\n          scope.$watch(\"ngModel\", ngModelWatcher);\n        };\n\n        $timeout(ready);\n      }\n    };\n  }]); //======================================    能源折标系数   ===========================================\n\n  directives.initDirective('energyConvertTable', ['$timeout', 'ngDialog', '$compile', '$filter', 'growl', function ($timeout, ngDialog, $compile, $filter, growl) {\n    return {\n      restrict: 'A',\n      controller: ['$scope', '$element', '$attrs', function ($scope, $element, $attrs) {\n        var domMain = $element;\n        var table;\n        var ifShow = false;\n        window.JSZip = jszip;\n        $scope.$on(Event.ENTERPRISEINIT + \"_convert\", function (event, args) {\n          if (table) {\n            table.destroy();\n            domMain.empty();\n          }\n\n          var columns = [{\n            data: \"convertStandardYear\",\n            title: \"生效年度\"\n          }, {\n            data: \"state\",\n            title: \"生效状态\"\n          }, {\n            data: \"modifyTime\",\n            title: \"修改日期\"\n          }, {\n            data: \"effectTime\",\n            title: \"生效日期\"\n          }, $.ProudSmart.datatable.optionCol3];\n          table = domMain.DataTable({\n            dom: '<\"row\"<\"col-sm-6 margin-bottom-10\">>' + (args.option && args.option[0].length >= 1 ? $.ProudSmart.datatable.footerdom : ''),\n            language: $.ProudSmart.datatable.language,\n            // select: $.ProudSmart.datatable.select,\n            data: args.option[0],\n            order: [[1, \"desc\"]],\n            columns: columns,\n            columnDefs: [{\n              \"targets\": 0,\n              \"data\": \"convertStandardYear\",\n              \"render\": function render(data, type, full) {\n                return escape(data);\n              }\n            }, {\n              \"targets\": 1,\n              \"data\": \"state\",\n              \"render\": function render(data, type, full) {\n                var stateTypeDic = {\n                  \"draft\": \"草稿\",\n                  \"effect\": \"生效\",\n                  \"ineffect\": \"失效\"\n                };\n\n                if (data) {\n                  return stateTypeDic[data];\n                } else if (data == null) {\n                  return \"草稿\";\n                }\n              }\n            }, {\n              \"targets\": 2,\n              \"data\": \"modifyTime\",\n              \"render\": function render(data, type, full) {\n                return $filter('date')(data, 'yyyy-MM-dd HH:mm:ss');\n              }\n            }, {\n              \"targets\": 3,\n              \"data\": \"effectTime\",\n              \"render\": function render(data, type, full) {\n                return $filter('date')(data, 'yyyy-MM-dd HH:mm:ss');\n              }\n            }, {\n              \"targets\": 4,\n              \"data\": \"option\",\n              \"render\": function render(data, type, full) {\n                var str = \"<div class='btn-group btn-group-sm'>\";\n\n                if (full.state == \"effect\") {\n                  str += \"<button id='edit-btn' ng-disabled='true' class='btn btn-primary btn-sm' ><i class='fa fa-edit hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 编辑</span></button>\";\n                  str += \"<button id='del-btn' ng-disabled='true' class='btn btn-default btn-sm'><i class='fa fa-edit hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'>删除</span></button>\";\n                  str += \"<button  type='button' class='btn btn-default btn-sm dropdown-toggle' data-toggle='dropdown'> 更多<span class='caret'></span></button>\";\n                  str += \"<ul class='dropdown-menu' role='menu'>\";\n                  str += \"<li><a id='view-btn'>查看</a></li>\";\n                  str += \"</ul></div>\";\n                } else {\n                  str += \"<button id='edit-btn' class='btn btn-primary btn-sm' ><i class='fa fa-edit hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 编辑</span></button>\";\n                  str += \"<button id='del-btn' class='btn btn-default btn-sm'><i class='fa fa-edit hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'>删除</span></button>\";\n                  str += \"<button  type='button' class='btn btn-default btn-sm dropdown-toggle' data-toggle='dropdown'> 更多<span class='caret'></span></button>\";\n                  str += \"<ul class='dropdown-menu' role='menu'>\";\n                  str += \"<li><a id='effect-btn'>生效</a></li>\";\n                  str += \"<li><a id='view-btn'>查看</a></li>\";\n                  str += \"</ul></div>\";\n                }\n\n                return str;\n              }\n            }],\n            rowCallback: function rowCallback(nRow, aData, iDataIndex) {\n              $compile(nRow)($scope);\n            }\n          });\n          var arrLength = [];\n\n          for (var i = 0; i < columns.length - 1; i++) {\n            arrLength.push(i);\n          }\n\n          if (args.option && args.option[0].length >= 1) {\n            new $.fn.dataTable.Buttons(table, {\n              buttons: [{\n                extend: 'excel',\n                title: '能源折标系数导出',\n                text: '<i class=\"fa fa-download\"></i><span class=\"hidden-xs\"> 导出查询结果</span>',\n                exportOptions: {\n                  columns: arrLength\n                }\n              }]\n            });\n            table.buttons().container().appendTo('.dataTables_wrapper .col-sm-6 ');\n          }\n        });\n        /**\n         * 监听表格初始化后，添加按钮\n         */\n\n        domMain.on('click', 'td', function (e) {\n          e.preventDefault();\n          $(domMain).find(\"tbody tr\").removeClass(\"selected\");\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          tr.addClass('selected');\n          $scope.selectedCount = row.data().id;\n          $scope.$apply();\n        });\n        domMain.on('click', '#edit-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          location.href = \"#/energySignatureInfo/\" + $.trim(row.data().id);\n        });\n        domMain.on('click', '#effect-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          $scope.doAction('effect', [row.data().id], function (returnObj) {\n            if (returnObj.code == 0) {\n              row.data().state = returnObj.data.state;\n              row.data().effectTime = returnObj.data.effectTime;\n              $(domMain).find(\"tbody tr\").removeClass(\"selected\");\n              table.rows().invalidate().draw(false);\n            }\n          });\n        });\n        domMain.on('click', '#del-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          $scope.doAction('delete', [row.data().id], function (returnObj) {\n            if (returnObj.code == 0) {\n              row.remove().draw(false);\n            }\n          });\n        });\n        domMain.on('click', '#view-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          location.href = \"#/energySignatureInfo/\" + $.trim(row.data().id) + '/View';\n        });\n        domMain.on('change', '#allselect-btn', function (e) {\n          e.stopPropagation();\n\n          if (e.target.checked) {\n            table.rows().select();\n            var tableRows = table.rows({\n              selected: true\n            });\n            $scope.selectedCount = tableRows.count();\n            $scope.$apply();\n\n            for (var i = 0; i < tableRows.nodes().length; i++) {\n              var row = table.row(tableRows.nodes()[i]);\n              row.data().selected = true;\n            }\n\n            ;\n            table.rows().invalidate().draw(false);\n          } else {\n            var tableRows = table.rows({\n              selected: true\n            });\n\n            for (var i = 0; i < tableRows.nodes().length; i++) {\n              var row = table.row(tableRows.nodes()[i]);\n              row.data().selected = false;\n            }\n\n            ;\n            table.rows().deselect();\n            $scope.selectedCount = 0;\n            $scope.$apply();\n            table.rows().invalidate().draw(false);\n          }\n        });\n        domMain.on('change', '.itemCheckBox', function (e) {\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n\n          if (e.target.checked) {\n            row.data().selected = true;\n          } else {\n            row.data().selected = false;\n          }\n\n          var tableRows = table.rows({\n            selected: true\n          });\n\n          if (tableRows.count() == 0) {\n            $('#allselect-btn').attr(\"checked\", false);\n          }\n\n          $scope.selectedCount = tableRows.count();\n          $scope.$apply();\n        }); //多项删除\n\n        $scope.selectedDelete = function () {\n          var tableRows = table.rows({\n            selected: true\n          });\n          var selectedCount = tableRows.count();\n          var nodes = tableRows.nodes();\n\n          if (selectedCount == 0) {\n            growl.warning(\"当前没有选中的产品信息\", {});\n            return;\n          }\n\n          var successCount = 0;\n          var errorCount = 0;\n          var enterpriseIdAry = [];\n          var ifGo = false;\n\n          for (var i = 0; i < nodes.length; i++) {\n            var row = table.row(nodes[i]);\n            var rowData = row.data();\n\n            if (rowData.id > 0) {\n              enterpriseIdAry.push(rowData.id);\n              successCount++;\n            } else {\n              errorCount++;\n            }\n\n            if (selectedCount == successCount + errorCount) {\n              ifGo = true; // growl.success(\"成功确认\" + successCount + \"个,失败\" + errorCount + \"个\", {});\n            }\n          }\n\n          ;\n\n          if (ifGo) {\n            $scope.doAction(\"delete\", enterpriseIdAry, function (returnObj) {\n              if (returnObj.code == 0) {\n                for (var i = 0; i < nodes.length; i++) {\n                  var row = table.row(nodes[i]);\n                  row.remove().draw(false);\n                }\n\n                $(\".itemCheckBox\").each(function () {\n                  $(this).attr(\"checked\", false);\n                });\n                $(\"#allselect-btn\").attr(\"checked\", false);\n                table.rows().deselect();\n              } else if (!returnObj) {\n                $(\".itemCheckBox\").each(function () {\n                  $(this).attr(\"checked\", false);\n                });\n                $(\"#allselect-btn\").attr(\"checked\", false);\n                table.rows().deselect();\n              }\n            });\n          }\n        };\n      }]\n    };\n  }]); //======================================    能源折标的编辑增删   ===========================================\n\n  directives.initDirective('energyEditConvert', ['$timeout', 'ngDialog', '$compile', '$filter', 'growl', function ($timeout, ngDialog, $compile, $filter, growl) {\n    return {\n      restrict: 'A',\n      controller: ['$scope', '$element', '$attrs', function ($scope, $element, $attrs) {\n        var domMain = $element;\n        var table;\n        var ifShow = false;\n        $scope.$on(Event.ENTERPRISEINIT + \"_convertedit\", function (event, args) {\n          if (table) {\n            table.destroy();\n            domMain.empty();\n          }\n\n          var columns = [{\n            data: \"energyType\",\n            title: \"能源类型\"\n          }, {\n            data: \"valentweight\",\n            title: \"当量系数\"\n          }, {\n            data: \"equal\",\n            title: \"等量系数\"\n          }, {\n            data: \"createTime\",\n            title: \"\",\n            visible: false\n          }, $.ProudSmart.datatable.optionCol3];\n          table = domMain.DataTable({\n            dom: args.option[0] && args.option[0].length > 0 ? $.ProudSmart.datatable.footerdom : '',\n            language: $.ProudSmart.datatable.language,\n            data: args.option[0],\n            order: [[3, \"desc\"]],\n            columns: columns,\n            columnDefs: [{\n              \"targets\": 0,\n              \"data\": \"energyType\",\n              \"render\": function render(data, type, full) {\n                var energyTypeList = $scope.energyTypeList;\n\n                for (var i in energyTypeList) {\n                  if (energyTypeList[i].valueCode == data) {\n                    return energyTypeList[i].label;\n                  }\n                }\n              }\n            }, {\n              \"targets\": 1,\n              \"data\": \"valentweight\",\n              \"render\": function render(data, type, full) {\n                return escape(data);\n              }\n            }, {\n              \"targets\": 2,\n              \"data\": \"equal\",\n              \"render\": function render(data, type, full) {\n                return escape(data);\n              }\n            }, {\n              \"targets\": 4,\n              \"data\": \"option\",\n              \"render\": function render(data, type, full) {\n                var str = \"<div class='btn-group btn-group-sm'>\";\n\n                if (location.hash.search(\"/View\") > -1) {\n                  str += \"<button id='edit-btn' ng-disabled='true' class='btn btn-primary btn-sm' ><i class='fa fa-edit hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 编辑</span></button>\";\n                  str += \"<button id='del-btn' ng-disabled='true' class='btn btn-default btn-sm'><i class='fa fa-edit hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'>删除</span></button>\";\n                } else {\n                  str += \"<button id='edit-btn' class='btn btn-primary btn-sm' ><i class='fa fa-edit hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 编辑</span></button>\";\n                  str += \"<button id='del-btn' class='btn btn-default btn-sm'><i class='fa fa-edit hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'>删除</span></button>\";\n                }\n\n                str += \"</div>\";\n                return str;\n              }\n            }],\n            rowCallback: function rowCallback(nRow, aData, iDataIndex) {\n              $compile(nRow)($scope);\n            }\n          });\n        });\n        /**\n         * 监听表格初始化后，添加按钮\n         */\n\n        domMain.on('click', '#edit-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          $.extend($scope.dialog.input, row.data());\n          ngDialog.open({\n            template: '../partials/dialogue/energy_signatrue_dia.html',\n            className: 'ngdialog-theme-plain',\n            scope: $scope\n          });\n        });\n        domMain.on('click', '#del-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          $scope.doAction('deleteDetail', [row.data().id], function (returnObj) {\n            if (returnObj.code == 0) {\n              row.remove().draw(false);\n            }\n          });\n        });\n        domMain.on('change', '#allselect-btn', function (e) {\n          e.stopPropagation();\n\n          if (e.target.checked) {\n            table.rows().select();\n            var tableRows = table.rows({\n              selected: true\n            });\n            $scope.selectedCount = tableRows.count();\n            $scope.$apply();\n\n            for (var i = 0; i < tableRows.nodes().length; i++) {\n              var row = table.row(tableRows.nodes()[i]);\n              row.data().selected = true;\n            }\n\n            ;\n            table.rows().invalidate().draw(false);\n          } else {\n            var tableRows = table.rows({\n              selected: true\n            });\n\n            for (var i = 0; i < tableRows.nodes().length; i++) {\n              var row = table.row(tableRows.nodes()[i]);\n              row.data().selected = false;\n            }\n\n            ;\n            table.rows().deselect();\n            $scope.selectedCount = 0;\n            $scope.$apply();\n            table.rows().invalidate().draw(false);\n          }\n        });\n        domMain.on('change', '.itemCheckBox', function (e) {\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n\n          if (e.target.checked) {\n            row.data().selected = true;\n          } else {\n            row.data().selected = false;\n          }\n\n          var tableRows = table.rows({\n            selected: true\n          });\n\n          if (tableRows.count() == 0) {\n            $('#allselect-btn').attr(\"checked\", false);\n          }\n\n          $scope.selectedCount = tableRows.count();\n          $scope.$apply();\n        }); //多项删除\n\n        $scope.selectedDelete = function () {\n          var tableRows = table.rows({\n            selected: true\n          });\n          var selectedCount = tableRows.count();\n          var nodes = tableRows.nodes();\n\n          if (selectedCount == 0) {\n            growl.warning(\"当前没有选中的产品信息\", {});\n            return;\n          }\n\n          var successCount = 0;\n          var errorCount = 0;\n          var enterpriseIdAry = [];\n          var ifGo = false;\n\n          for (var i = 0; i < nodes.length; i++) {\n            var row = table.row(nodes[i]);\n            var rowData = row.data();\n\n            if (rowData.id > 0) {\n              enterpriseIdAry.push(rowData.id);\n              successCount++;\n            } else {\n              errorCount++;\n            }\n\n            if (selectedCount == successCount + errorCount) {\n              ifGo = true; // growl.success(\"成功确认\" + successCount + \"个,失败\" + errorCount + \"个\", {});\n            }\n          }\n\n          ;\n\n          if (ifGo) {\n            $scope.doAction(\"delete\", enterpriseIdAry, function (returnObj) {\n              if (returnObj.code == 0) {\n                for (var i = 0; i < nodes.length; i++) {\n                  var row = table.row(nodes[i]);\n                  row.remove().draw(false);\n                }\n\n                $(\".itemCheckBox\").each(function () {\n                  $(this).attr(\"checked\", false);\n                });\n                $(\"#allselect-btn\").attr(\"checked\", false);\n                table.rows().deselect();\n              } else if (!returnObj) {\n                $(\".itemCheckBox\").each(function () {\n                  $(this).attr(\"checked\", false);\n                });\n                $(\"#allselect-btn\").attr(\"checked\", false);\n                table.rows().deselect();\n              }\n            });\n          }\n        };\n      }]\n    };\n  }]); //======================================    能耗录入管理   ===========================================\n\n  directives.initDirective('recordTaskTable', ['$timeout', 'ngDialog', '$compile', 'userLoginUIService', '$filter', 'growl', function ($timeout, ngDialog, $compile, userLoginUIService, $filter, growl) {\n    return {\n      restrict: 'A',\n      controller: ['$scope', '$element', '$attrs', function ($scope, $element, $attrs) {\n        var domMain = $element;\n        var table;\n        var ifShow = false;\n        $scope.$on(Event.ENTERPRISEINIT + \"_recordTask\", function (event, args) {\n          if (table) {\n            table.destroy();\n            domMain.empty();\n          }\n\n          ;\n          var columns = [{\n            data: \"statisticsPeriod\",\n            title: \"统计周期\"\n          }, {\n            data: \"enterpriseName\",\n            title: \"企业名称\",\n            visible: $scope.userType != 101\n          }, {\n            data: \"statisticsType\",\n            title: \"统计周期类型\"\n          }, {\n            data: \"createTime\",\n            title: \"创建时间\"\n          }, {\n            data: \"modifyTime\",\n            title: \"更新时间\"\n          }, {\n            data: \"commitTime\",\n            title: userLoginUIService.user.userType == 100 ? \"审核时间\" : \"提交时间\"\n          }, {\n            data: \"overdue\",\n            title: \"是否超期\"\n          }, {\n            data: \"state\",\n            title: \"记录状态\"\n          }, $.ProudSmart.datatable.optionCol3];\n          table = domMain.DataTable({\n            dom: args.option && args.option[0].length >= 1 ? $.ProudSmart.datatable.footerdom : '',\n            language: $.ProudSmart.datatable.language,\n            // select: $.ProudSmart.datatable.select,\n            data: args.option[0],\n            order: [[0, \"desc\"]],\n            columns: columns,\n            columnDefs: [{\n              \"targets\": 0,\n              \"render\": function render(data, type, full) {\n                return escape(data);\n              }\n            }, {\n              \"targets\": 1,\n              \"render\": function render(data, type, full) {\n                return escape(data);\n              }\n            }, {\n              \"targets\": 2,\n              \"render\": function render(data, type, full) {\n                var statisticeDic = {\n                  'MONTH': '月',\n                  'QUARTER': '季度',\n                  'YEAR': '年'\n                };\n\n                if (!full.statisticsType) {\n                  return \"-\";\n                } else {\n                  return statisticeDic[full.statisticsType];\n                }\n              }\n            }, {\n              \"targets\": 3,\n              \"render\": function render(data, type, full) {\n                return $filter('date')(data, 'yyyy-MM-dd HH:mm:ss');\n              }\n            }, {\n              \"targets\": 4,\n              \"render\": function render(data, type, full) {\n                return $filter('date')(data, 'yyyy-MM-dd HH:mm:ss');\n              }\n            }, {\n              \"targets\": 5,\n              \"render\": function render(data, type, full) {\n                return $filter('date')(data, 'yyyy-MM-dd HH:mm:ss');\n              }\n            }, {\n              \"targets\": 6,\n              \"render\": function render(data, type, full) {\n                var timeDic = {\n                  'no': '未超期',\n                  'yes': '超期'\n                };\n                return timeDic[data];\n              }\n            }, {\n              \"targets\": 7,\n              \"render\": function render(data, type, full) {\n                var severityStr = \"\";\n                var severityBg = \"\";\n\n                if (userLoginUIService.user.userType == 100) {\n                  //政府\n                  if (data == 'pass') {\n                    severityStr = \"已审核\";\n                    severityBg = \"label-success\";\n                  } else if (data == 'commit') {\n                    severityStr = \"未审核\";\n                    severityBg = \"label-default\";\n                  }\n                } else {\n                  if (data == 'commit' || data == 'pass') {\n                    severityStr = \"已提交\";\n                    severityBg = \"label-success\";\n                  } else {\n                    severityStr = \"草稿\";\n                    severityBg = \"label-default\";\n                  }\n                }\n\n                return \"<span class='label \" + severityBg + \"'>\" + severityStr + \"</span>\";\n              }\n            }, {\n              \"targets\": 8,\n              \"data\": \"option\",\n              \"render\": function render(data, type, full) {\n                var str = \"<div class='btn-group btn-group-sm'>\";\n\n                if ($scope.userType == 1000) {\n                  //企业\n                  if (full.state == \"commit\" || full.state == \"pass\") {\n                    str += \"<button id='edit-btn' disabled='true' class='btn btn-primary btn-sm' ><i class='fa fa-edit hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 编辑</span></button>\";\n                    str += \"<button id='commit-btn' disabled='true' class='btn btn-default btn-sm'><i class='fa fa-edit hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'>提交</span></button>\";\n                  } else {\n                    str += \"<button id='edit-btn' class='btn btn-primary btn-sm' ><i class='fa fa-edit hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 编辑</span></button>\";\n                    str += \"<button id='commit-btn' class='btn btn-default btn-sm'><i class='fa fa-edit hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'>提交</span></button>\";\n                  }\n\n                  str += \"<button id='view-btn' class='btn btn-default btn-sm'><i class='fa fa-edit hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'>查看</span></button>\";\n                  str += \"</div>\";\n                } else if ($scope.userType = 100) {\n                  //政府操作员\n                  if (full.state == \"commit\") {\n                    //未审核\n                    str += \"<button id='edit-btn' class='btn btn-primary btn-sm' ><i class='fa fa-edit hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 编辑</span></button>\";\n                    str += \"<button id='commit-btn' class='btn btn-default btn-sm'><i class='fa fa-edit hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'>审核</span></button>\"; // str += \"<button  type='button' class='btn btn-default btn-sm dropdown-toggle' data-toggle='dropdown'> 更多<span class='caret'></span></button>\";\n                  } else if (full.state == \"pass\") {\n                    //政府审核\n                    str += \"<button id='edit-btn' disabled='true' class='btn btn-primary btn-sm' ><i class='fa fa-edit hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 编辑</span></button>\";\n                    str += \"<button id='commit-btn' disabled='true'  class='btn btn-default btn-sm'><i class='fa fa-edit hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'>审核</span></button>\";\n                  }\n\n                  str += \"<button id='view-btn' class='btn btn-default btn-sm'><i class='fa fa-edit hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'>查看</span></button>\";\n                  str += \"</div>\";\n                }\n\n                return str;\n              }\n            }],\n            rowCallback: function rowCallback(nRow, aData, iDataIndex) {\n              $compile(nRow)($scope);\n            }\n          });\n        });\n        /**\n         * 监听表格初始化后，添加按钮\n         */\n\n        domMain.on('click', 'td', function (e) {\n          e.preventDefault();\n          $(domMain).find(\"tbody tr\").removeClass(\"selected\");\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          tr.addClass('selected');\n          $scope.selectedCount = row.data();\n          $scope.$apply();\n        });\n        domMain.on('click', '#edit-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          $scope.doAction('edit', row.data(), function (returnObj) {\n            if (returnObj.code == 0) {\n              row.data().state = returnObj.data.state;\n              $(domMain).find(\"tbody tr\").removeClass(\"selected\");\n              table.rows().invalidate().draw(false);\n            }\n          });\n        });\n        domMain.on('click', '#commit-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          $scope.doAction('commit', row.data().id, function (returnObj) {\n            if (returnObj.code == 0) {\n              row.data().state = returnObj.data.state;\n              row.data().commitTime = returnObj.data.commitTime;\n              $(domMain).find(\"tbody tr\").removeClass(\"selected\");\n              table.rows().invalidate().draw(false);\n            }\n          });\n        });\n        domMain.on('click', '#del-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          $scope.doAction('delete', [row.data().id], function (returnObj) {\n            if (returnObj.code == 0) {\n              row.remove().draw(false);\n            }\n          });\n        });\n        domMain.on('click', '#view-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          $scope.doAction('view', row.data());\n        });\n        domMain.on('change', '#allselect-btn', function (e) {\n          e.stopPropagation();\n\n          if (e.target.checked) {\n            table.rows().select();\n            var tableRows = table.rows({\n              selected: true\n            });\n            $scope.selectedCount = tableRows.count();\n            $scope.$apply();\n\n            for (var i = 0; i < tableRows.nodes().length; i++) {\n              var row = table.row(tableRows.nodes()[i]);\n              row.data().selected = true;\n            }\n\n            ;\n            table.rows().invalidate().draw(false);\n          } else {\n            var tableRows = table.rows({\n              selected: true\n            });\n\n            for (var i = 0; i < tableRows.nodes().length; i++) {\n              var row = table.row(tableRows.nodes()[i]);\n              row.data().selected = false;\n            }\n\n            ;\n            table.rows().deselect();\n            $scope.selectedCount = 0;\n            $scope.$apply();\n            table.rows().invalidate().draw(false);\n          }\n        });\n        domMain.on('change', '.itemCheckBox', function (e) {\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n\n          if (e.target.checked) {\n            row.data().selected = true;\n          } else {\n            row.data().selected = false;\n          }\n\n          var tableRows = table.rows({\n            selected: true\n          });\n\n          if (tableRows.count() == 0) {\n            $('#allselect-btn').attr(\"checked\", false);\n          }\n\n          $scope.selectedCount = tableRows.count();\n          $scope.$apply();\n        }); //多项删除\n\n        $scope.selectedDelete = function () {\n          var tableRows = table.rows({\n            selected: true\n          });\n          var selectedCount = tableRows.count();\n          var nodes = tableRows.nodes();\n\n          if (selectedCount == 0) {\n            growl.warning(\"当前没有选中的产品信息\", {});\n            return;\n          }\n\n          var successCount = 0;\n          var errorCount = 0;\n          var enterpriseIdAry = [];\n          var ifGo = false;\n\n          for (var i = 0; i < nodes.length; i++) {\n            var row = table.row(nodes[i]);\n            var rowData = row.data();\n\n            if (rowData.id > 0) {\n              enterpriseIdAry.push(rowData.id);\n              successCount++;\n            } else {\n              errorCount++;\n            }\n\n            if (selectedCount == successCount + errorCount) {\n              ifGo = true; // growl.success(\"成功确认\" + successCount + \"个,失败\" + errorCount + \"个\", {});\n            }\n          }\n\n          ;\n\n          if (ifGo) {\n            $scope.doAction(\"delete\", enterpriseIdAry, function (returnObj) {\n              if (returnObj.code == 0) {\n                for (var i = 0; i < nodes.length; i++) {\n                  var row = table.row(nodes[i]);\n                  row.remove().draw(false);\n                }\n\n                $(\".itemCheckBox\").each(function () {\n                  $(this).attr(\"checked\", false);\n                });\n                $(\"#allselect-btn\").attr(\"checked\", false);\n                table.rows().deselect();\n              } else if (!returnObj) {\n                $(\".itemCheckBox\").each(function () {\n                  $(this).attr(\"checked\", false);\n                });\n                $(\"#allselect-btn\").attr(\"checked\", false);\n                table.rows().deselect();\n              }\n            });\n          }\n        };\n      }]\n    };\n  }]); //======================================    执行历史信息    ===========================================\n\n  directives.initDirective('historyTable', ['$timeout', 'ngDialog', '$compile', '$filter', 'growl', function ($timeout, ngDialog, $compile, $filter, growl) {\n    return {\n      restrict: 'A',\n      controller: ['$scope', '$element', '$attrs', function ($scope, $element, $attrs) {\n        var domMain = $element;\n        var table;\n        var ifShow = false;\n        $scope.$on(Event.ENTERPRISEINIT + \"_history\", function (event, args) {\n          if (table) {\n            table.destroy();\n            domMain.empty();\n          }\n\n          var columns = [{\n            data: \"name\",\n            title: \"指令名称\"\n          }, {\n            data: \"operateResult\",\n            title: \"执行状态\"\n          }, {\n            data: \"operateDescr\",\n            title: \"指令参数描述\"\n          }, {\n            data: \"msgContent\",\n            title: \"执行反馈描述\"\n          }, {\n            data: \"createTime\",\n            title: \"执行时间\"\n          }];\n          table = domMain.DataTable({\n            dom: '<\"row\"<\"col-sm-6 margin-bottom-10\">>' + $.ProudSmart.datatable.footerdom,\n            language: $.ProudSmart.datatable.language,\n            select: $.ProudSmart.datatable.select,\n            processing: true,\n            serverSide: true,\n            ordering: true,\n            aaSorting: [[4, \"desc\"]],\n            ajax: $scope.pipeline(),\n            columns: columns,\n            columnDefs: [{\n              \"targets\": 0,\n              \"data\": \"name\",\n              \"render\": function render(data, type, full) {\n                return escape(data);\n              }\n            }, {\n              \"targets\": 1,\n              \"data\": \"operateResult\",\n              \"render\": function render(data, type, full) {\n                return escape(data);\n              }\n            }, {\n              \"targets\": 2,\n              \"data\": \"operateDescr\",\n              \"render\": function render(data, type, full) {\n                return \"<div style='width:400px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;' data-toggle='tooltip' title='\" + escape(data) + \"'>\" + escape(data) + \"</div>\";\n              }\n            }, {\n              \"targets\": 3,\n              \"data\": \"statisticsType\",\n              \"render\": function render(data, type, full) {\n                return escape(data);\n              }\n            }, {\n              \"targets\": 4,\n              \"data\": \"createTime\",\n              \"render\": function render(data, type, full) {\n                var str = '';\n                str = $filter('date')(data, 'yyyy-MM-dd HH:mm:ss');\n                return str;\n              }\n            }],\n            rowCallback: function rowCallback(nRow, aData, iDataIndex) {\n              $compile(nRow)($scope);\n            }\n          });\n        });\n      }]\n    };\n  }]);\n});"],"sourceRoot":"/source/"}