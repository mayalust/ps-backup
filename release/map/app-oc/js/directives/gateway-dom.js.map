{"version":3,"sources":["app-oc/js/directives/gateway-dom.js"],"names":["define","directives","BootstrapDialog","datatables","initDirective","$timeout","$compile","growl","restrict","controller","$scope","$element","$attrs","table","domMain","$on","Event","CMDBINFOSINIT","event","args","destroy","empty","DataTable","dom","data","length","$","ProudSmart","datatable","footerdom","language","select","singleSelect","order","columns","title","optionCol2","visible","rowCallback","nRow","aData","iDataIndex","columnDefs","targets","render","type","full","escape","str","on","e","dt","indexes","rows","doActionUn","name","search","value","draw","stopPropagation","tr","this","closest","row","preventDefault","flg","remove","isEditing","selectCol","optionCol3","selected","addClass","removeClass","orderable","isEdit","rootModelDic","selectModel","label","menuitems","managedStatus","parentDom","parent","html","target","checked","tableRows","i","nodes","invalidate","deselect","selectedHandler","count","attr","prop","doAction","cells","modelSelect","labelinput","find","val","id","domainSelect","externalDevIdinput","sn","Array","prototype","push","apply","action","addItem","returnObj","onlineStatus","activeAllIns","selectedCount","show","closable","message","selectedGateitem","buttons","cssClass","dialogRef","successCount","errorCount","rowData","doActiveHanddler","status","node","success","close","warning","activeSelectedIns","pageLength","selLength","baseConfig","customerConfig","display","projectConfig","simulated","customersDic","customerName","projectsDic","projectName","settings","len","changeManagedStatus","delGateWay","gatewayHandler"],"mappings":"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","file":"app-oc/js/directives/gateway-dom.js","sourcesContent":["define(['directives/directives', 'bootstrap-dialog', 'datatables.net', 'datatables.net-bs', 'datatables.net-select'], function (directives, BootstrapDialog, datatables) {\n  'use strict';\n\n  directives.initDirective('notConfirmedTable', ['$timeout', '$compile', 'growl', function ($timeout, $compile, growl) {\n    return {\n      restrict: 'A',\n      controller: ['$scope', '$element', '$attrs', function ($scope, $element, $attrs) {\n        var domMain = $element;\n        var table;\n        $scope.$on(Event.CMDBINFOSINIT + \"not\", function (event, args) {\n          if (table) {\n            table.destroy();\n            domMain.empty();\n          }\n\n          table = domMain.DataTable({\n            dom: args.data && args.data.length > 0 ? $.ProudSmart.datatable.footerdom : '',\n            language: $.ProudSmart.datatable.language,\n            data: args.data,\n            select: $.ProudSmart.datatable.singleSelect,\n            order: [[4, \"desc\"]],\n            columns: [{\n              data: \"label\",\n              title: \"设备名称\"\n            }, {\n              data: \"externalDevId\",\n              title: \"设备地址\"\n            }, {\n              data: \"sn\",\n              title: \"设备序列号\"\n            }, $.ProudSmart.datatable.optionCol2, {\n              data: \"createTime\",\n              title: \"\",\n              visible: false\n            }],\n            rowCallback: function rowCallback(nRow, aData, iDataIndex) {},\n            columnDefs: [{\n              targets: 0,\n              data: \"label\",\n              render: function render(data, type, full) {\n                // 返回自定义内容\n                return escape(data);\n              }\n            }, {\n              targets: 1,\n              data: \"externalDevId\",\n              render: function render(data, type, full) {\n                return escape(data);\n              }\n            }, {\n              targets: 2,\n              data: \"sn\",\n              render: function render(data, type, full) {\n                return escape(data);\n              }\n            }, {\n              targets: 3,\n              data: \"option\",\n              render: function render(data, type, full) {\n                // 返回自定义内容\n                var str = \"<div class='btn-group btn-group-sm'>\";\n                str += \"<button id='play-btn' class='btn btn-primary' ><i class='fa fa-play hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 识别</span></button>\";\n                str += \"<button id='del-btn' class='btn btn-default' ><i class='fa fa-minus hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 删除</span></button>\";\n                str += \"</div>\";\n                return str;\n              }\n            }]\n          }); //单选模式下的监听变化\n\n          table.on('select', function (e, dt, type, indexes) {\n            if (type === 'row') {\n              var data = table.rows(indexes).data()[0];\n              $scope.doActionUn('select', data); // 具体的业务处理逻辑，调用外部controller内的方法\n            }\n          });\n        });\n        /**\n         * 监听表格初始化后，添加按钮\n         */\n\n        domMain.on('init.dt', function () {});\n        $scope.$on(\"table-search-handle\", function (event, args) {\n          if (args.name == $attrs.name) table.search(args.value).draw();\n        });\n        domMain.on('click', '#play-btn', function (e) {\n          e.stopPropagation();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          $scope.doActionUn('save', row.data());\n        });\n        domMain.on('click', '#del-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          $scope.doActionUn(\"delete\", row.data(), function (flg) {\n            if (flg) row.remove().draw(false);\n          });\n        });\n      }]\n    };\n  }]);\n  directives.initDirective('cmdb3Table', ['$timeout', '$compile', 'growl', function ($timeout, $compile, growl) {\n    return {\n      restrict: 'A',\n      controller: ['$scope', '$element', '$attrs', function ($scope, $element, $attrs) {\n        var domMain = $element;\n        var table;\n        var isEditing = false;\n        $scope.$on(Event.CMDBINFOSINIT + \"GATEACTIVE\", function (event, args) {\n          if (table) {\n            table.destroy();\n            domMain.empty();\n          }\n\n          isEditing = false;\n          table = domMain.DataTable({\n            dom: args.data && args.data.length > 0 ? $.ProudSmart.datatable.footerdom : '',\n            language: $.ProudSmart.datatable.language,\n            select: $.ProudSmart.datatable.select,\n            data: args.data,\n            order: [[7, \"desc\"]],\n            columns: [$.ProudSmart.datatable.selectCol, {\n              data: \"label\",\n              title: \"设备名称\"\n            }, {\n              data: \"externalDevId\",\n              title: \"设备地址\"\n            }, {\n              data: \"managedStatus\",\n              title: \"管理状态\"\n            }, {\n              data: \"modelId\",\n              title: \"设备模板\"\n            }, {\n              data: \"sn\",\n              title: \"设备序列号\"\n            }, $.ProudSmart.datatable.optionCol3, {\n              data: \"createTime\",\n              title: \"\",\n              visible: false\n            }],\n            rowCallback: function rowCallback(nRow, aData, iDataIndex) {\n              if (aData.selected) {\n                $(nRow).addClass(\"selected\");\n              } else {\n                $(nRow).removeClass(\"selected\");\n              }\n\n              $compile(nRow)($scope);\n            },\n            columnDefs: [{\n              orderable: false,\n              targets: 0,\n              render: function render(data, type, full) {\n                if (type == \"display\") {\n                  if (data) {\n                    return '<input class=\"itemCheckBox\" checked type=\"checkbox\">';\n                  } else {\n                    return '<input class=\"itemCheckBox\" type=\"checkbox\">';\n                  }\n                }\n\n                return \"\";\n              }\n            }, {\n              targets: 1,\n              data: \"label\",\n              render: function render(data, type, full) {\n                // 返回自定义内容\n                if (full.isEdit > 0 && type == \"display\") {\n                  isEditing = true;\n                  return \"<input class='form-control input-sm'  type='text' value='\" + (data ? escape(data) : '') + \"'>\";\n                } else {\n                  return escape(data);\n                }\n              }\n            }, {\n              targets: 2,\n              data: \"externalDevId\",\n              render: function render(data, type, full) {\n                // 返回自定义内容\n                if (full.isEdit == 2 && type == \"display\") return \"<input class='form-control input-sm'  type='text' value='\" + data + \"'>\";else return escape(data);\n              }\n            }, {\n              targets: 3,\n              data: \"managedStatus\",\n              render: function render(data, type, full) {\n                return data == \"deactive\" ? '未启用' : '已启用';\n              }\n            }, {\n              targets: 4,\n              data: \"modelId\",\n              render: function render(data, type, full) {\n                var str = \"\";\n\n                if (data != null && data != \"\" && $scope.rootModelDic) {\n                  var selectModel = $scope.rootModelDic[data];\n                  if (selectModel) str = selectModel.label;else str = \"默认模板类型\";\n                }\n\n                if (full.isEdit > 0 && type == \"display\") {\n                  return \"<div class='dropdowntree select-sm' placeholder='请选择...' model='\" + data + \"'  change='' options='rootModel' mark='nodes' />\";\n                } else {\n                  return str;\n                }\n              }\n            }, {\n              targets: 5,\n              data: \"sn\",\n              render: function render(data, type, full) {\n                if (full.isEdit == 2 && type == \"display\") return \"<input id='sn' name='sn' maxlength='20' style='width:100%' class='form-control input-sm' type='text' value='\" + escape(data) + \"'>\";else return escape(data);\n              }\n            }, {\n              targets: 6,\n              data: \"option\",\n              render: function render(data, type, full) {\n                // 返回自定义内容\n                var str = \"<div class='btn-group btn-group-sm'>\";\n\n                if (full.isEdit > 0) {\n                  str += \"<button id='save-btn' class='btn btn-primary' ><i class='fa fa-save hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 保存</span></button>\";\n                  str += \"<button id='del-btn' class='btn btn-default' ><i class='fa fa-save hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 取消</span></button>\";\n                  str += \"</div>\";\n                } else {\n                  if ($scope.menuitems['D10_S03']) {\n                    str += \"<button id='edit-btn' class='btn btn-primary' ><i class='fa fa-edit hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 管理</span></button>\";\n                  }\n\n                  if (full.managedStatus != 'deactive') {\n                    if ($scope.menuitems['D07_S03']) {\n                      str += \"<button id='disable-btn' class='btn btn-default' ><i class='fa fa-stop hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 停用</span></button>\";\n                    }\n\n                    if ($scope.menuitems['D08_S03']) {\n                      str += \"<button id='del-btn' class='btn btn-default' disabled><i class='fa fa-trash hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 注销</span></button>\";\n                    }\n                  } else {\n                    if ($scope.menuitems['D06_S03']) {\n                      str += \"<button id='enable-btn' class='btn btn-default' ><i class='fa fa-play hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 启用</span></button>\";\n                    }\n\n                    if ($scope.menuitems['D08_S03']) {\n                      str += \"<button id='del-btn' class='btn btn-default'><i class='fa fa-trash hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 注销</span></button>\";\n                    }\n                  }\n\n                  str += \"</div>\";\n                }\n\n                return str;\n              }\n            }]\n          });\n        });\n        /**\n         * 监听表格初始化后，添加按钮\n         */\n\n        domMain.on('init.dt', function () {\n          var parentDom = $(\".special-btn\").parent();\n          var extendBtn = '<div class=\"btn-group btn-group-sm\">' + '<a ng-click=\"addIns()\" class=\"btn btn-default\"><i class=\"fa fa-plus\"></i><span class=\"hidden-xs\"> 添加设备</span></a>' + '<a ng-click=\"activeSelectedIns()\" class=\"btn btn-default\"><i class=\"fa fa-play\"></i><span class=\"hidden-xs\"> 启用所选设备</span></a>' + '<a ng-click=\"activeAllIns()\" class=\"btn btn-default\"><i class=\"fa fa-forward\"></i><span class=\"hidden-xs\"> 启用全部设备</span></a>' + '</div>';\n          parentDom.html(extendBtn);\n          $compile(parentDom)($scope);\n        });\n        $scope.$on(\"table-search-handle\", function (event, args) {\n          if (args.name == $attrs.name) table.search(args.value).draw();\n        });\n        domMain.on('change', '#allselect-btn', function (e) {\n          e.stopPropagation();\n\n          if (e.target.checked) {\n            table.rows().select();\n            var tableRows = table.rows({\n              selected: true\n            });\n\n            for (var i = 0; i < tableRows.nodes().length; i++) {\n              var row = table.row(tableRows.nodes()[i]);\n              row.data().selected = true;\n            }\n\n            ;\n            table.rows().invalidate().draw(false);\n          } else {\n            var tableRows = table.rows({\n              selected: true\n            });\n\n            for (var i = 0; i < tableRows.nodes().length; i++) {\n              var row = table.row(tableRows.nodes()[i]);\n              row.data().selected = false;\n            }\n\n            ;\n            table.rows().deselect();\n            table.rows().invalidate().draw(false);\n          }\n\n          $scope.selectedHandler(\"device\");\n        });\n        domMain.on('change', '.itemCheckBox', function (e) {\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n\n          if (e.target.checked) {\n            row.data().selected = true;\n          } else {\n            row.data().selected = false;\n          }\n\n          var tableRows = table.rows({\n            selected: true\n          });\n\n          if (tableRows.count() != table.rows()[0].length) {\n            $('#allselect-btn').attr('checked', false);\n            $('#allselect-btn').prop('checked', false);\n          } else if (tableRows.count() == table.rows()[0].length) {\n            $('#allselect-btn').attr('checked', true);\n            $('#allselect-btn').prop('checked', true);\n          }\n\n          $scope.selectedHandler(\"device\");\n        });\n        domMain.on('click', '#disable-btn', function (e) {\n          e.stopPropagation();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          $scope.doAction(\"deviceDeActive\", row.data(), function (flg) {\n            if (flg) {\n              row.data().managedStatus = \"deactive\";\n              row.cells().invalidate().draw(false);\n            }\n          });\n        });\n        domMain.on('click', '#enable-btn', function (e) {\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          $scope.doAction(\"deviceActive\", row.data(), function (flg) {\n            if (flg) {\n              row.data().managedStatus = \"active\";\n              row.cells().invalidate().draw(false);\n            }\n          });\n        });\n        domMain.on('click', '#save-btn', function (e) {\n          e.stopPropagation();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          var modelSelect = $('div[name=\"modelId\"]').attr(\"model\");\n          row.data()['modelId'] = modelSelect;\n          var labelinput = $(tr).find('input[name=\"label\"]');\n          row.data()['label'] = $(labelinput).val();\n\n          if (row.data().isEdit == 2 && row.data().id == 0) {\n            var domainSelect = $('div[name=\"domainPath\"]').attr(\"model\");\n            row.data()['domainPath'] = domainSelect;\n            var externalDevIdinput = $(tr).find('input[name=\"externalDevId\"]');\n            var sn = $(tr).find('input[name=\"sn\"]');\n            row.data()['externalDevId'] = $(externalDevIdinput).val();\n            row.data()['sn'] = $(sn).val();\n            Array.prototype.push.apply(row.data(), action.addItem(\"gatewayInfo/config\"));\n            $scope.doAction('gateSave', row.data(), function (returnObj) {\n              if (returnObj == false) {\n                row.data().isEdit = 2;\n              } else {\n                row.data().isEdit = 0;\n                row.data().id = returnObj.id;\n                row.data().managedStatus = \"deactive\";\n                row.data().onlineStatus = returnObj.onlineStatus;\n                row.cells().invalidate().draw(false);\n              }\n            });\n          } else {\n            if (row.data().isEdit == 4) {\n              $scope.doAction('gateSave', row.data(), function (returnObj) {\n                if (returnObj == false) {\n                  row.data().isEdit = 4;\n                } else {\n                  row.data().isEdit = 0;\n                  isEditing = false;\n                  row.cells().invalidate().draw(false);\n                }\n              });\n            }\n          }\n        });\n        domMain.on('click', '#del-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n\n          if (row.data().isEdit == 4) {\n            row.data().isEdit = 0;\n            row.cells().invalidate();\n            isEditing = false;\n          } else {\n            $scope.doAction(\"deviceDel\", row.data(), function (flg) {\n              if (flg) {\n                isEditing = false;\n                row.remove().draw(false);\n              }\n            });\n          }\n        });\n        domMain.on('click', '#edit-btn', function (e) {\n          e.preventDefault();\n\n          if (!isEditing) {\n            var tr = $(this).closest('tr');\n            var row = table.row(tr);\n            $scope.doAction(\"deviceEdit\", row.data());\n          }\n        });\n\n        $scope.activeAllIns = function () {\n          var tableRows = table.rows();\n          var selectedCount = 0;\n          var nodes = tableRows.nodes();\n\n          for (var i = 0; i < nodes.length; i++) {\n            var row = table.row(nodes[i]);\n            var rowData = row.data();\n\n            if (rowData.managedStatus == 'deactive') {\n              selectedCount++;\n            }\n          }\n\n          ;\n\n          if (selectedCount == 0) {\n            growl.warning(\"当前没有未启用设备\", {});\n            return;\n          }\n\n          BootstrapDialog.show({\n            title: '提示',\n            closable: false,\n            //size:BootstrapDialog.SIZE_WIDE,\n            message: '确认从 ' + escape($scope.selectedGateitem.name) + ' 网关启用全部设备吗？',\n            buttons: [{\n              label: '确定',\n              cssClass: 'btn-success',\n              action: function action(dialogRef) {\n                var successCount = 0;\n                var errorCount = 0;\n\n                for (var i = 0; i < nodes.length; i++) {\n                  var row = table.row(nodes[i]);\n                  var rowData = row.data();\n\n                  if (rowData.managedStatus == 'deactive') {\n                    $scope.doActiveHanddler(rowData, function (status, node) {\n                      if (status) {\n                        table.row(node).data().managedStatus = \"active\";\n                        table.row(node).cells().invalidate().draw(false);\n                        successCount++;\n                      } else {\n                        errorCount++;\n                      }\n\n                      if (selectedCount == successCount + errorCount) {\n                        table.rows().deselect();\n                        growl.success(\"成功启用设备\" + successCount + \"台,失败\" + errorCount + \"台\", {});\n                      }\n                    }, nodes[i]);\n                  }\n                }\n\n                ;\n                dialogRef.close();\n              }\n            }, {\n              label: '取消',\n              action: function action(dialogRef) {\n                dialogRef.close();\n              }\n            }]\n          });\n        };\n\n        $scope.activeSelectedIns = function () {\n          var tableRows = table.rows({\n            selected: true\n          });\n          var selectedCount = tableRows.count();\n          var nodes = tableRows.nodes();\n\n          if (selectedCount == 0) {\n            growl.warning(\"当前没有选中的设备\", {});\n            return;\n          }\n\n          BootstrapDialog.show({\n            title: '提示',\n            closable: false,\n            //size:BootstrapDialog.SIZE_WIDE,\n            message: '确认从 ' + escape($scope.selectedGateitem.name) + ' 网关启用 ' + selectedCount + ' 台设备吗？',\n            buttons: [{\n              label: '确定',\n              cssClass: 'btn-success',\n              action: function action(dialogRef) {\n                var successCount = 0;\n                var errorCount = 0;\n\n                for (var i = 0; i < nodes.length; i++) {\n                  var row = table.row(nodes[i]);\n                  var rowData = row.data();\n                  $scope.doActiveHanddler(rowData, function (status, node) {\n                    if (status) {\n                      table.row(node).data().managedStatus = \"active\";\n                      table.row(node).cells().invalidate().draw(false);\n                      successCount++;\n                    } else {\n                      errorCount++;\n                    }\n\n                    if (selectedCount == successCount + errorCount) {\n                      table.rows().deselect();\n                      growl.success(\"成功启用设备\" + successCount + \"台,失败\" + errorCount + \"台\", {});\n                    }\n                  }, nodes[i]);\n                }\n\n                ;\n                dialogRef.close();\n              }\n            }, {\n              label: '取消',\n              action: function action(dialogRef) {\n                dialogRef.close();\n              }\n            }]\n          });\n        };\n      }]\n    };\n  }]);\n  directives.initDirective('gatewayTable', ['$timeout', '$compile', 'growl', function ($timeout, $compile, growl) {\n    return {\n      restrict: 'A',\n      controller: ['$scope', '$element', '$attrs', function ($scope, $element, $attrs) {\n        var domMain = $element;\n        var table;\n        var isEditing = false;\n        $scope.$on(Event.CMDBINFOSINIT + \"GATES\", function (event, args) {\n          if (table) {\n            table.destroy();\n            domMain.empty();\n          }\n\n          isEditing = false;\n          table = domMain.DataTable({\n            dom: args.data && args.data.length > 0 ? $.ProudSmart.datatable.footerdom : '',\n            language: $.ProudSmart.datatable.language,\n            select: $.ProudSmart.datatable.select,\n            data: args.data,\n            \"pageLength\": $scope.selLength,\n            order: [[8, \"desc\"]],\n            columns: [$.ProudSmart.datatable.selectCol, {\n              data: \"name\",\n              title: \"网关名称\"\n            }, {\n              data: \"externalGwId\",\n              title: \"网关标识\"\n            }, {\n              data: \"managedStatus\",\n              title: \"管理状态\"\n            }, {\n              data: \"onlineStatus\",\n              title: \"在线状态\"\n            }, {\n              data: \"customerId\",\n              title: ($scope.menuitems[\"S12\"] && $scope.menuitems[\"S12\"].label ? $scope.menuitems[\"S12\"].label : \"客户\") + \"名称\",\n              visible: $scope.baseConfig.customerConfig.display\n            }, {\n              data: \"projectId\",\n              title: ($scope.menuitems[\"S13\"] && $scope.menuitems[\"S13\"].label ? $scope.menuitems[\"S13\"].label : \"项目\") + \"名称\",\n              visible: $scope.baseConfig.projectConfig.display\n            }, $.ProudSmart.datatable.optionCol3, {\n              data: \"createTime\",\n              title: \"\",\n              visible: false\n            }],\n            columnDefs: [{\n              orderable: false,\n              targets: 0,\n              render: function render(data, type, full) {\n                if (type == \"display\") {\n                  if (data) {\n                    return '<input class=\"itemCheckBox\" checked type=\"checkbox\">';\n                  } else {\n                    return '<input class=\"itemCheckBox\" type=\"checkbox\">';\n                  }\n                }\n\n                return \"\";\n              }\n            }, {\n              targets: 1,\n              data: \"name\",\n              render: function render(data, type, full) {\n                if (full.isEdit > 0 && type == \"display\") {\n                  isEditing = true;\n                  return \"<input class='form-control input-sm'  type='text' value='\" + (data ? escape(data) : '') + \"'>\";\n                } else {\n                  return escape(data);\n                }\n              }\n            }, {\n              targets: 2,\n              data: \"externalGwId\",\n              render: function render(data, type, full) {\n                // 返回自定义内容\n                if (full.isEdit == 2 && type == \"display\") return \"<input class='form-control input-sm'  type='text' value='\" + (data ? escape(data) : '') + \"'>\";else return escape(data);\n              }\n            }, {\n              targets: 3,\n              data: \"managedStatus\",\n              render: function render(data, type, full) {\n                return data == \"deactive\" ? '未启用' : '已启用';\n              }\n            }, {\n              \"targets\": 4,\n              \"data\": \"onlineStatus\",\n              \"render\": function render(data, type, full) {\n                if (full.simulated && full.managedStatus == \"active\") return \"<span class='label label-primary'>模拟中</span>\"; // 返回自定义内容\n\n                return \"<span class='label \" + (data == \"在线\" ? \"label-primary\" : data == \"离线\" ? \"label-warning\" : \"label-default\") + \"'>\" + data + \"</span>\";\n              }\n            }, {\n              targets: 5,\n              data: \"customerId\",\n              render: function render(data, type, full) {\n                // 返回自定义内容\n                if ($scope.customersDic && $scope.customersDic[data]) {\n                  return $scope.customersDic[data].customerName;\n                }\n\n                return \"\";\n              }\n            }, {\n              targets: 6,\n              data: \"projectId\",\n              render: function render(data, type, full) {\n                // 返回自定义内容\n                if ($scope.projectsDic && $scope.projectsDic[data]) {\n                  return $scope.projectsDic[data].projectName;\n                }\n\n                return \"\";\n              }\n            }, {\n              \"targets\": 7,\n              \"data\": \"option\",\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                if (type != \"display\") return \"\";\n                var str = \"<div class='btn-group btn-group-sm'>\";\n\n                if (full.isEdit > 0) {\n                  str += \"<button id='save-btn' class='btn btn-primary' ><i class='fa fa-save hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 保存</span></button>\";\n                  str += \"<button id='del-btn' class='btn btn-default' ><i class='fa fa-save hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 取消</span></button>\";\n                  str += \"</div>\";\n                } else {\n                  if ($scope.menuitems['A10_S03']) {\n                    str += \"<button id='edit-btn' class='btn btn-primary' ><i class='fa fa-edit hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 管理</span></button>\";\n                  }\n\n                  if (full.managedStatus == 'active') {\n                    if ($scope.menuitems['A06_S03']) {\n                      str += \"<button id='disable-btn' class='btn btn-default' ><i class='fa fa-stop hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 停用</span></button>\";\n                    }\n\n                    if ($scope.menuitems['A07_S03']) {\n                      str += \"<button id='del-btn' class='btn btn-default' disabled><i class='fa fa-trash hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 注销</span></button>\";\n                    }\n                  } else {\n                    if ($scope.menuitems['A05_S03']) {\n                      str += \"<button id='enable-btn' class='btn btn-default' ><i class='fa fa-play hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 启用</span></button>\";\n                    }\n\n                    if ($scope.menuitems['A07_S03']) {\n                      str += \"<button id='del-btn' class='btn btn-default'><i class='fa fa-trash hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 注销</span></button>\";\n                    }\n                  }\n\n                  str += \"</div>\";\n                }\n\n                return str;\n              }\n            }],\n            rowCallback: function rowCallback(nRow, aData, iDataIndex) {\n              if (aData.selected) {\n                $(nRow).addClass(\"selected\");\n              } else {\n                $(nRow).removeClass(\"selected\");\n              }\n\n              $compile(nRow)($scope);\n            }\n          });\n        });\n        /**\n         * 监听表格初始化后，添加按钮\n         */\n\n        domMain.on('init.dt', function () {});\n        domMain.on('length.dt', function (e, settings, len) {\n          $scope.selLength = len;\n        }); //多选模式下存在，控制全选按钮的状态\n\n        domMain.on('change', '#allselect-btn', function (e) {\n          e.stopPropagation();\n\n          if (e.target.checked) {\n            table.rows().select();\n            var tableRows = table.rows({\n              selected: true\n            });\n\n            for (var i = 0; i < tableRows.nodes().length; i++) {\n              var row = table.row(tableRows.nodes()[i]);\n              row.data().selected = true;\n            }\n\n            ;\n            table.rows().invalidate().draw(false);\n          } else {\n            var tableRows = table.rows({\n              selected: true\n            });\n\n            for (var i = 0; i < tableRows.nodes().length; i++) {\n              var row = table.row(tableRows.nodes()[i]);\n              row.data().selected = false;\n            }\n\n            ;\n            table.rows().deselect();\n            table.rows().invalidate().draw(false);\n          }\n\n          $scope.selectedHandler(\"gateway\"); //具体的业务处理，各个功能不同\n        });\n        domMain.on('change', '.itemCheckBox', function (e) {\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n\n          if (e.target.checked) {\n            row.data().selected = true;\n          } else {\n            row.data().selected = false;\n          }\n\n          var tableRows = table.rows({\n            selected: true\n          });\n\n          if (tableRows.count() != table.rows()[0].length) {\n            $('#allselect-btn').attr('checked', false);\n            $('#allselect-btn').prop('checked', false);\n          } else if (tableRows.count() == table.rows()[0].length) {\n            $('#allselect-btn').attr('checked', true);\n            $('#allselect-btn').prop('checked', true);\n          }\n\n          $scope.selectedHandler(\"gateway\"); //具体的业务处理，各个功能不同\n        });\n        domMain.on('click', '#disable-btn', function (e) {\n          e.stopPropagation();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          $scope.changeManagedStatus(row.data(), function (flg) {\n            if (flg) {\n              row.data().managedStatus = \"deactive\";\n              row.cells().invalidate().draw(false);\n            }\n          });\n        });\n        domMain.on('click', '#enable-btn', function (e) {\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          $scope.changeManagedStatus(row.data(), function (flg) {\n            if (flg) {\n              row.data().managedStatus = \"active\";\n              row.data().simulated = false;\n              row.cells().invalidate().draw(false);\n            }\n          });\n        });\n        domMain.on('click', '#save-btn', function (e) {\n          e.stopPropagation();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          var modelSelect = $('div[name=\"modelId\"]').attr(\"model\");\n          row.data()['modelId'] = modelSelect;\n          var labelinput = $(tr).find('input[name=\"label\"]');\n          row.data()['label'] = $(labelinput).val();\n\n          if (row.data().isEdit == 2 && row.data().id == 0) {\n            var domainSelect = $('div[name=\"domainPath\"]').attr(\"model\");\n            row.data()['domainPath'] = domainSelect;\n            var externalDevIdinput = $(tr).find('input[name=\"externalDevId\"]');\n            var sn = $(tr).find('input[name=\"sn\"]');\n            row.data()['externalDevId'] = $(externalDevIdinput).val();\n            row.data()['sn'] = $(sn).val();\n            $scope.doAction('gateSave', row.data(), function (returnObj) {\n              if (returnObj == false) {\n                row.data().isEdit = 2;\n              } else {\n                row.data().isEdit = 0;\n                row.data().id = returnObj.id;\n                row.data().managedStatus = \"deactive\";\n                row.data().onlineStatus = returnObj.onlineStatus;\n                row.data().simulated = false;\n                row.cells().invalidate().draw(false);\n              }\n            });\n          } else {\n            if (row.data().isEdit == 4) {\n              $scope.doAction('gateSave', row.data(), function (returnObj) {\n                if (returnObj == false) {\n                  row.data().isEdit = 4;\n                } else {\n                  row.data().isEdit = 0;\n                  isEditing = false;\n                  row.cells().invalidate().draw(false);\n                }\n              });\n            }\n          }\n        });\n        domMain.on('click', '#del-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n\n          if (row.data().isEdit == 4) {\n            row.data().isEdit = 0;\n            row.cells().invalidate();\n            isEditing = false;\n          } else {\n            $scope.delGateWay(row.data(), function (flg) {\n              if (flg) {\n                isEditing = false;\n                row.remove().draw(false);\n              }\n            });\n          }\n        });\n        domMain.on('click', '#edit-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          $scope.gatewayHandler('update', row.data().id);\n        });\n\n        $scope.activeAllIns = function () {\n          var tableRows = table.rows();\n          var selectedCount = 0;\n          var nodes = tableRows.nodes();\n\n          for (var i = 0; i < nodes.length; i++) {\n            var row = table.row(nodes[i]);\n            var rowData = row.data();\n\n            if (rowData.managedStatus == 'deactive') {\n              selectedCount++;\n            }\n          }\n\n          ;\n\n          if (selectedCount == 0) {\n            growl.warning(\"当前没有未启用设备\", {});\n            return;\n          }\n\n          BootstrapDialog.show({\n            title: '提示',\n            closable: false,\n            //size:BootstrapDialog.SIZE_WIDE,\n            message: '确认从 ' + escape($scope.selectedGateitem.name) + ' 网关启用全部设备吗？',\n            buttons: [{\n              label: '确定',\n              cssClass: 'btn-success',\n              action: function action(dialogRef) {\n                var successCount = 0;\n                var errorCount = 0;\n\n                for (var i = 0; i < nodes.length; i++) {\n                  var row = table.row(nodes[i]);\n                  var rowData = row.data();\n\n                  if (rowData.managedStatus == 'deactive') {\n                    $scope.doActiveHanddler(rowData, function (status, node) {\n                      if (status) {\n                        table.row(node).data().managedStatus = \"active\";\n                        table.row(node).cells().invalidate().draw(false);\n                        successCount++;\n                      } else {\n                        errorCount++;\n                      }\n\n                      if (selectedCount == successCount + errorCount) {\n                        table.rows().deselect();\n                        growl.success(\"成功启用设备\" + successCount + \"台,失败\" + errorCount + \"台\", {});\n                      }\n                    }, nodes[i]);\n                  }\n                }\n\n                ;\n                dialogRef.close();\n              }\n            }, {\n              label: '取消',\n              action: function action(dialogRef) {\n                dialogRef.close();\n              }\n            }]\n          });\n        };\n\n        $scope.activeSelectedIns = function () {\n          var tableRows = table.rows({\n            selected: true\n          });\n          var selectedCount = tableRows.count();\n          var nodes = tableRows.nodes();\n\n          if (selectedCount == 0) {\n            growl.warning(\"当前没有选中的设备\", {});\n            return;\n          }\n\n          BootstrapDialog.show({\n            title: '提示',\n            closable: false,\n            //size:BootstrapDialog.SIZE_WIDE,\n            message: '确认从 ' + escape($scope.selectedGateitem.name) + ' 网关启用 ' + selectedCount + ' 台设备吗？',\n            buttons: [{\n              label: '确定',\n              cssClass: 'btn-success',\n              action: function action(dialogRef) {\n                var successCount = 0;\n                var errorCount = 0;\n\n                for (var i = 0; i < nodes.length; i++) {\n                  var row = table.row(nodes[i]);\n                  var rowData = row.data();\n                  $scope.doActiveHanddler(rowData, function (status, node) {\n                    if (status) {\n                      table.row(node).data().managedStatus = \"active\";\n                      table.row(node).cells().invalidate().draw(false);\n                      successCount++;\n                    } else {\n                      errorCount++;\n                    }\n\n                    if (selectedCount == successCount + errorCount) {\n                      table.rows().deselect();\n                      growl.success(\"成功启用设备\" + successCount + \"台,失败\" + errorCount + \"台\", {});\n                    }\n                  }, nodes[i]);\n                }\n\n                ;\n                dialogRef.close();\n              }\n            }, {\n              label: '取消',\n              action: function action(dialogRef) {\n                dialogRef.close();\n              }\n            }]\n          });\n        };\n      }]\n    };\n  }]);\n});"],"sourceRoot":"/source/"}