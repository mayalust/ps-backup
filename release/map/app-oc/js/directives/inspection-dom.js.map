{"version":3,"sources":["app-oc/js/directives/inspection-dom.js"],"names":["define","directives","datatables","daterangepicker","jszip","initDirective","$timeout","$compile","$filter","growl","restrict","controller","$scope","$element","$attrs","table","domMain","$on","Event","INSPECTIONRECORDS","event","args","destroy","DataTable","dom","data","length","$","ProudSmart","datatable","footerdom","language","option","order","columns","title","columnDefs","targets","render","type","full","on","parentDom","parent","e","preventDefault","tr","this","closest","row","child","isShown","hide","removeClass","show","INSPECTIONSTANDARD","visible","baseConfig","projectConfig","display","optionCol2","str","allModelsList","allModels","i","id","label","menuitems","rowCallback","nRow","aData","iDataIndex","text","stopPropagation","rowData","updateParam","item","standardContext","spotCheckMethod","spotCheckTool","spotCheckCategory","position","modelId","serialNum","domainPath","damainPath","addInspection","doAction","css","window","JSZip","DEVICEDATAINIT","empty","orderable","fn","dataTable","Buttons","buttons","extend","selectedItem","rootModelDic","container","appendTo","info"],"mappings":"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","file":"app-oc/js/directives/inspection-dom.js","sourcesContent":["define(['directives/directives', 'datatables.buttons.html5', 'bootstrap-daterangepicker', 'jszip'], function (directives, datatables, daterangepicker, jszip) {\n  'use strict';\n\n  directives.initDirective('inspectionRecordsTable', ['$timeout', '$compile', '$filter', 'growl', function ($timeout, $compile, $filter, growl) {\n    return {\n      restrict: 'A',\n      controller: ['$scope', '$element', '$attrs', function ($scope, $element, $attrs) {\n        var domMain = $element;\n        var table;\n        $scope.$on(Event.INSPECTIONRECORDS, function (event, args) {\n          if (table) {\n            table.destroy();\n          }\n\n          table = domMain.DataTable({\n            dom: args.data && args.data.length > 0 ? $.ProudSmart.datatable.footerdom : '',\n            language: $.ProudSmart.datatable.language,\n            data: args.option[0],\n            order: [[0, \"asc\"]],\n            columns: [{\n              data: \"teamName\",\n              title: \"巡检班组\"\n            }, {\n              data: \"userName\",\n              title: \"巡检人\"\n            }, {\n              data: \"inspectionDate\",\n              title: \"巡检日期\"\n            }, {\n              data: \"deviceName\",\n              title: \"设备名称\"\n            }, {\n              data: \"deviceStatus\",\n              title: \"设备状态\"\n            }, {\n              data: \"inspectionContext\",\n              title: \"巡检内容\"\n            }, {\n              data: \"imageUrl\",\n              title: \"图片\"\n            }],\n            columnDefs: [{\n              targets: 2,\n              data: \"inspectionDate\",\n              render: function render(data, type, full) {\n                // 返回自定义内容    \n                var str = $filter('date')(data, 'yyyy-MM-dd HH:mm:ss');\n                return str;\n              }\n            }] // , {\n            //   targets: 6,\n            //   data: \"imageUrl\",\n            //   render: function(data, type, full) {\n            //     // 返回自定义内容   \n            //     var str = '<a target=\"blank\" href= \"' + $.trim((data)) + '\" ><img style=\"width:70px;height:70px;\" src = \"' + $.trim((data)) + '\" alt=\"\"/>';\n            //     return str;\n            //   }\n            // }\n\n          });\n\n          function format(d) {\n            var returnStr;\n            returnStr = '<table width=\"100%\" class=\"table table-inner\">';\n\n            for (var i in d) {\n              returnStr += '<tr role=\"row\">';\n\n              if (i == 'imageUrl') {\n                returnStr += '<td style=\"width:19%;\">图片:</td>';\n                returnStr += '<td><div style=\"width: 90%;height:auto;\">';\n                $.each(d.imageUrl, function (key, value) {\n                  returnStr += '<a target=\"blank\" href= \"http://192.168.1.114' + $.trim(value) + '\" ><img style=\"width:70px;height:70px; margin-right:5px;\" src = \"' + $.trim(value) + '\" alt=\"\"/>';\n                });\n                returnStr += '</div></td>';\n              }\n\n              returnStr += '</tr>';\n            }\n\n            returnStr += '</table>';\n          }\n\n          domMain.on('init.dt', function () {\n            var parentDom = $(\".special-btn\").parent();\n            $compile(parentDom)($scope);\n          });\n          domMain.on('click', 'td', function (e) {\n            e.preventDefault();\n            var tr = $(this).closest('tr');\n            var row = table.row(tr);\n            var rowData = row.data();\n\n            if (rowData) {\n              if (row.child.isShown()) {\n                //之前展开\n                // This row is already open - close it\n                row.child.hide();\n                tr.removeClass('shown');\n              } else {\n                //之前关闭，则需要展开\n                // Open this row\n                row.child.show(); // row.child(format(rowData)).show();\n              }\n            }\n          });\n        });\n      }]\n    };\n  }]);\n  directives.initDirective('inspectionStandardTable', ['$timeout', '$compile', '$filter', 'growl', function ($timeout, $compile, $filter, growl) {\n    return {\n      restrict: 'A',\n      controller: ['$scope', '$element', '$attrs', function ($scope, $element, $attrs) {\n        var domMain = $element;\n        var table;\n        var isEditing = false;\n        var itemAttrs;\n        $scope.$on(Event.INSPECTIONSTANDARD, function (event, args) {\n          if (table) {\n            table.destroy();\n          } // isEditing = false;\n          // itemAttrs = args.option[1];\n\n\n          table = domMain.DataTable({\n            dom: args.option[0] && args.option[0].length > 0 ? $.ProudSmart.datatable.footerdom : '',\n            language: $.ProudSmart.datatable.language,\n            data: args.option[0],\n            order: [[0, \"asc\"]],\n            columns: [{\n              data: \"modelId\",\n              title: \"设备模板\"\n            }, {\n              data: \"spotCheckCategory\",\n              title: \"维保类型\"\n            }, {\n              data: \"item\",\n              title: \"项目名称\",\n              visible: $scope.baseConfig.projectConfig.display\n            }, {\n              data: \"serialNum\",\n              title: \"序号\"\n            }, {\n              data: \"spotCheckMethod\",\n              title: \"方法\"\n            }, {\n              data: \"spotCheckTool\",\n              title: \"工具\"\n            }, $.ProudSmart.datatable.optionCol2],\n            columnDefs: [{\n              targets: 0,\n              data: \"modelId\",\n              render: function render(data, type, full) {\n                // 返回自定义内容\n                var str = \"\";\n                var allModelsList = $scope.allModels;\n\n                for (var i in allModelsList) {\n                  if (allModelsList[i].id == data) {\n                    str = allModelsList[i].label;\n                    break;\n                  }\n                }\n\n                return str;\n              }\n            }, {\n              targets: 6,\n              data: \"option\",\n              render: function render(data, type, full) {\n                // 返回自定义内容\n                var str = \"<div class='btn-group btn-group-sm'>\";\n\n                if ($scope.menuitems['A02_S49']) {\n                  str += \"<button id='update-btn'   class='btn btn-primary' ><i class='fa fa-edit hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 编辑</span></button>\";\n                }\n\n                if ($scope.menuitems['A03_S49']) {\n                  str += \"<button id='delete-btn'   class='btn btn-default' ><i class='fa fa-trash hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 删除</span></button>\";\n                }\n\n                return str;\n              }\n            }],\n            rowCallback: function rowCallback(nRow, aData, iDataIndex) {\n              $compile(nRow)($scope);\n            }\n          });\n        });\n        /**\n         * 监听表格初始化后，添加按钮\n         */\n\n        domMain.on('click', 'td', function (e) {\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          var rowData = row.data();\n          var name = $(this).text();\n        });\n        domMain.on('click', '#update-btn', function (e) {\n          e.stopPropagation();\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          var rowData = row.data();\n          $scope.updateParam = {\n            \"item\": rowData.item,\n            \"standardContext\": rowData.standardContext,\n            \"spotCheckMethod\": rowData.spotCheckMethod,\n            \"spotCheckTool\": rowData.spotCheckTool,\n            \"spotCheckCategory\": rowData.spotCheckCategory,\n            \"position\": rowData.position,\n            \"modelId\": rowData.modelId,\n            \"serialNum\": rowData.serialNum,\n            \"id\": rowData.id,\n            \"domainPath\": rowData.damainPath\n          };\n          $scope.addInspection(rowData);\n          /* var innerString =\n             '<div class=\"tab-content\">' +\n             '<form role=\"form\" class=\"form-horizontal tab-pane active\" name=\"myForm\" style=\"font-size: 14px\">' +\n             '<div class=\"box-body\">' +\n             '<div class=\"form-group col-sm-12\">' +\n             '<div class=\"col-sm-4\">' +\n              '<label><span class=\"text-danger\">*</span>巡检项目：</label>' +\n             '<input autocomplete=\"off\" class=\"form-control\" type=\"text\" style=\"width: 100%;\" ng-model=\"updateParam.item\" value=\"{{updateParam.item}}\" />' +\n              '</div>' +\n             '<div class=\"col-sm-4\">' +\n              '<label><span class=\"text-danger\">*</span>巡检部位：</label>' +\n             '<input autocomplete=\"off\" class=\"form-control\" type=\"text\" style=\"width: 100%;\" ng-model=\"updateParam.position\" value=\"{{updateParam.position}}\" />' +\n              '</div>' +\n             '<div class=\"col-sm-4\">' +\n              '<label><span class=\"text-danger\">*</span>设备模板：</label>' +\n             '<select id=\"selectedAlertType\" class=\"form-control\" style=\"width: 100%;\" ng-model=\"updateParam.modelId\" ng-options=\"value.id as value.label for value in allModels\">' +\n             '<option value=\"\">请选择...</option>' +\n             '</select>' +\n             '</div>' +\n              '</div>' +\n             '<div class=\"form-group col-sm-12 margin-top-15\">' +\n             '<div class=\"col-sm-4\">' +\n              '<label><span class=\"text-danger\">*</span>点检方法：</label>' +\n             '<input autocomplete=\"off\" class=\"form-control\" type=\"text\" style=\"width: 100%;\" ng-model=\"updateParam.spotCheckMethod\" value=\"{{updateParam.spotCheckMethod}}\" />' +\n              '</div>' +\n             '<div class=\"col-sm-4\">' +\n              '<label><span class=\"text-danger\">*</span>点检工具：</label>' +\n             '<input autocomplete=\"off\" class=\"form-control\" type=\"text\" style=\"width: 100%;\" ng-model=\"updateParam.spotCheckTool\" value=\"{{updateParam.spotCheckTool}}\" />' +\n              '</div>' +\n             '<div class=\"col-sm-4\">' +\n              '<label><span class=\"text-danger\">*</span>点检类别：</label>' +\n             '<input autocomplete=\"off\" class=\"form-control\" type=\"text\" style=\"width: 100%;\" ng-model=\"updateParam.spotCheckCategory\" value=\"{{updateParam.spotCheckCategory}}\" />' +\n              '</div>' +\n             ' </div>' +\n             '<div class=\"form-group col-sm-12 margin-top-15\">' +\n             '<label class=\"col-sm-4\"><span class=\"text-danger\">*</span>巡检内容：</label>' +\n             '<div class=\"col-sm-12\">' +\n             '<textarea id=\"discription\" class=\"form-control\" style=\"width: 100%; height: 100px; resize: none;\" ng-model=\"updateParam.standardContext\" value=\"{{updateParam.standardContext}} class=\"form-control ng-pristine ng-valid ng-empty ng-valid-maxlength ng-touched\" style=\"height: 100px; resize: none;\" name=\"discription\" maxlength=\"500\" type=\"text\" placeholder=\"最多可输入500字\"></textarea>' +\n              '</div>' +\n             '</div>' +\n             '<div class=\"form-group col-sm-12 margin-top-15\">' +\n              '<div class=\"align-center\">' +\n             '<a id=\"save-btn\" style=\"margin-right: 15px;\" class=\"btn btn-default btn-sm\">' +\n             '<i ng-if=\"!saveloading\" class=\"fa fa-save\"></i>' +\n             '<i ng-if=\"saveloading\" class=\"fa fa-spinner fa-spin fa-fw\"></i>' +\n             '<span class=\"hidden-xs ng-binding\"> 保存</span></a>' +\n             '<a id=\"cancel-btn\" class=\"btn btn-default btn-sm\"><i class=\"fa fa-close\"></i><span class=\"hidden-xs ng-binding\"> 取消</span></a>' +\n             '</div>' +\n              '</div>' +\n             '</div>' +\n             '</form>' +\n              '</div>';*/\n\n          /*row.child(innerString).show();\n          tr.addClass('shown');\n          tr.next().addClass('bg-f5f5f5');\n          $compile(tr)($scope);\n          $compile(tr.next())($scope);\n          $scope.doAction('update', row.data());*/\n        });\n        domMain.on('click', '#delete-btn', function (e) {\n          e.stopPropagation();\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          $scope.doAction('delete', row.data());\n        });\n        domMain.on('click', '#save-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          tr.removeClass('shown');\n          $scope.doAction('save-btn', row.data());\n        });\n        domMain.on('click', \"#cancel-btn\", function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          var rowData = row.data();\n          tr.css(\"display\", \"none\");\n          $scope.doAction('cancel-btn', row.data());\n        });\n      }]\n    };\n  }]);\n  directives.initDirective('deviceDataTable', ['$timeout', '$compile', '$filter', 'growl', function ($timeout, $compile, $filter, growl) {\n    return {\n      restrict: 'A',\n      controller: ['$scope', '$element', '$attrs', function ($scope, $element, $attrs) {\n        var domMain = $element;\n        var table;\n        window.JSZip = jszip;\n        $scope.$on(Event.DEVICEDATAINIT, function (event, args) {\n          if (table) {\n            table.destroy();\n            domMain.empty();\n          }\n\n          table = domMain.DataTable({\n            dom: args.option[0] && args.option[0].length > 0 ? '<\"row\"<\"col-sm-6 margin-bottom-10\">>' + $.ProudSmart.datatable.footerdom : '',\n            //'<\"pull-right margin-bottom-10\" B >'\n            columnDefs: [{\n              targets: 3,\n              data: \"arisingTime\",\n              render: function render(data, type, full) {\n                // 返回自定义内容\n                var str = $filter('date')(data, 'yyyy-MM-dd HH:mm:ss');\n                return str;\n              }\n            }],\n            language: $.ProudSmart.datatable.language,\n            data: args.option[0],\n            order: [[3, \"desc\"]],\n            columns: [{\n              data: \"deviceName\",\n              title: \"名称\"\n            }, {\n              data: \"instance\",\n              title: \"实例\"\n            }, {\n              data: \"kpiName\",\n              title: \"测点名称\"\n            }, {\n              data: \"arisingTime\",\n              title: \"上报时间\"\n            }, {\n              data: \"kpiValue\",\n              orderable: false,\n              title: \"指标值\"\n            }]\n          });\n\n          if (args.option[0] && args.option[0].length > 0) {\n            new $.fn.dataTable.Buttons(table, {\n              buttons: [{\n                extend: 'excel',\n                title: $scope.selectedItem.modelId ? $scope.rootModelDic[$scope.selectedItem.modelId].label : '查询结果',\n                text: '<i class=\"fa fa-download\"></i><span class=\"hidden-xs\"> 导出查询结果</span>'\n              }]\n            });\n            table.buttons().container().appendTo('.dataTables_wrapper .col-sm-6 ');\n          }\n          /**\n           * 监听表格初始化后，添加按钮\n           */\n\n\n          domMain.on('click', 'td', function (e) {\n            var tr = $(this).closest('tr');\n            var row = table.row(tr);\n            var rowData = row.data();\n            var name = $(this).text();\n          });\n          domMain.on('click', \"#cancel-btn\", function (e) {\n            e.preventDefault();\n            var tr = $(this).closest('tr');\n            var row = table.row(tr);\n            var rowData = row.data();\n            tr.css(\"display\", \"none\");\n            $scope.doAction('cancel-btn', row.data());\n          });\n          $(\".buttons-excel\").on(\"click\", function (e) {\n            growl.info(\"数据正在导出中，请稍后……\", {});\n          });\n        });\n      }]\n    };\n  }]);\n});"],"sourceRoot":"/source/"}