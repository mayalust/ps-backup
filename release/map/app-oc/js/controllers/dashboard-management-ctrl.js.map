{"version":3,"sources":["app-oc/js/controllers/dashboard-management-ctrl.js"],"names":["define","controllers","initController","scope","q","rootScope","$location","$routeParams","timeout","userRoleUIService","resourceUIService","userLoginUIService","Info","growl","userEnterpriseService","viewFlexService","userDomainService","window","freeboardservice","dialogue","ngDialog","charRoot","views","domainlist","domaintree","widget","config","allRoles","treeData","TEXT","viewType","viewId","createTree","data","hierarchy","self","this","all","viewTitle","children","root","loop","elem","viewHierarchy","addTo","target","parent","Object","defineProperty","enumerable","_children","push","find","el","i","editAlertView","view","namelist","filter","map","newTitle","$$","duplicateName","run","rootModel","stateToArr","arr","split","value","indexOf","replacer","alertOption","label","severities","getViewById_back","event","code","dt","domainPath","content","JSON","parse","dialog","title","input","type","maxlength","composory","events","change","item","error","right","undefined","key","mark","options","disabled","fontsize","width","modelIds","pageSize","minlength","test","toString","length","messageFilter","states","description","button","icon","disabledFn","some","fn","close","param","index","$attr","stringify","getData","updateView","addView","newView","createTime","updateTime","creatorName","success","domainID","deferred","defer","hasOwnProperty","then","domainObj","pushbefore","promise","queryDomainInfo","getViewById","open","template","className","checkAllLoaded","queryDomainTree","user","userID","getRootModel","getModels","Array","prototype","apply","duplicateClick","duplicateNameBase","fnlist","style","border-radius","font-size","font-weight","padding","getDomainId","finished","resourceType","projectId","templateStr","insertAfter","message","err","placeholder","onChange","element","releaseView","viewTitles","viewIds","releasedIds","callback","releaseViews","successObj","failObj","releaseGroup","releaseStatus","removeAllChecked","releaseClick","setComponentClick","values","component","params","sethomeClick","source","maindashboard","viewName","saveManageDashboard","homeview","deleteClickCommon","deleteView","remove","editViewInfo","$clone","addNewClick","location","href","deleteClick","designClick","modelId","gotoDashboard","keyValue","resourceId","editClick","available","call","lb","viewClick","encodeURIComponent","domain","format","name","id","str","deleteGroup","deleteViews","fail","itm","creator","_CONFIG_","dashboard","header","columnDefs","buttons","active","configure","designView","configAlert","nav","navClick","path","complete","getManagedViewsByTypeAndRole","defers","dataTable","projectIds","allviews","findRoleRes","resId","roleRes","roleId","bindRoles","roleID","roleName","resolve","projects","loopView","getModelByIds","rowclass","row","attr","at","OPTIONS","modes","default","init","attributesLoadDefer","modelObj","cacheAsyncData","loadResource","getAllDomainName","getResourceByIds","checkPowerCss","flg","css","menuitems","checkPowerVisible","bol","queryDomainTree_back","tree","rs","traverse","domainInfos","CREAT","class","margin","click","DESIGNVIEW","RELEASE","selected","DELETE","COMPONENT","filterable","sortable","TEMPLATE","SETHOME","VIEWTITLE","HIERARCHY","RESTYPE","DESCRIPTION","OWNER","filterFormat","RELEASESTATUS","CREATETIME","UPDATETIME","DOMAIN","BTN_DESIGN","BTN_EDIT","BTN_DELETE","visible","BTN_VIEW","BTN_DUPLICATE","BTN_RELEASE","BTN_HOME","queryEnterpriseUser","queryEnterpriseRole","bgColorFn","bgColor","background-color"],"mappings":"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","file":"app-oc/js/controllers/dashboard-management-ctrl.js","sourcesContent":["define(['controllers/controllers', 'Array'], function (controllers) {\n  'use strict';\n\n  controllers.initController('dashboardmanageCtrl', ['$scope', '$q', '$rootScope', '$location', '$routeParams', '$timeout', 'userRoleUIService', 'resourceUIService', 'userLoginUIService', 'Info', 'growl', 'userEnterpriseService', 'viewFlexService', 'userDomainService', \"$window\", \"freeboardservice\", 'dialogue', \"ngDialog\", function (scope, q, rootScope, $location, $routeParams, timeout, userRoleUIService, resourceUIService, userLoginUIService, Info, growl, userEnterpriseService, viewFlexService, userDomainService, window, freeboardservice, dialogue, ngDialog) {\n    var type, serviceView, charRoot, views, domainlist, domaintree, enterpriseUsers, widget, config, allRoles;\n    var treeData;\n    var TEXT = {\n      \"SUBMIT\": \"确定\",\n      \"CANCEL\": \"取消\"\n    };\n    var viewType = $routeParams.viewType;\n    scope.viewId = $routeParams.viewId;\n\n    var createTree = function createTree(data, hierarchy) {\n      var self = this;\n      var all = {\n        viewId: 0,\n        viewTitle: \"根层级\",\n        children: []\n      };\n      var root = {\n        children: [all]\n      };\n\n      var loop = function loop(elem) {\n        elem.viewHierarchy = elem.viewHierarchy ? elem.viewHierarchy : 0;\n\n        var addTo = function addTo() {};\n\n        var checkSelfViewId = function checkSelfViewId() {\n          if (self) {\n            return elem.viewId != self.viewId;\n          } else {\n            return true;\n          }\n        };\n\n        if (checkSelfViewId()) {\n          addTo = function addTo(target) {\n            elem.parent = target;\n            Object.defineProperty(elem, \"parent\", {\n              enumerable: false\n            });\n\n            if (!target.children) {\n              target.children = [];\n            }\n\n            target.children.push(elem);\n          };\n        } else {\n          addTo = function addTo(target) {\n            elem.parent = target;\n            Object.defineProperty(elem, \"parent\", {\n              enumerable: false\n            });\n\n            if (!target._children) {\n              target._children = [];\n            }\n\n            target._children.push(elem);\n          };\n        }\n\n        var find = data.find(function (el) {\n          return el.viewId == elem.viewHierarchy;\n        });\n\n        if (find) {\n          elem.parent = find;\n          addTo(find);\n        } else {\n          addTo(all);\n        }\n      };\n\n      for (var i in data) {\n        delete data[i].children;\n        delete data[i]._children;\n      }\n\n      for (var i in data) {\n        loop(data[i]);\n      }\n\n      return root;\n    };\n\n    var createlist = function createlist(tree) {\n      var rs = [];\n\n      var traverse = function traverse(data) {\n        rs.push(data);\n\n        if (data.hasOwnProperty(\"domainInfos\")) {\n          for (var i in data.domainInfos) {\n            traverse(data.domainInfos[i]);\n          }\n        }\n      };\n\n      traverse(tree);\n      return rs;\n    };\n\n    var editAlertView = function editAlertView(view) {\n      var namelist = views.filter(function (elem) {\n        if (view) {\n          return elem.viewTitle != view.viewTitle;\n        } else {\n          return true;\n        }\n      }).map(function (elem) {\n        return elem.viewTitle;\n      });\n      var newTitle = $$.duplicateName(\"创建告警组\", namelist);\n\n      var run = function run(domainlist, rootModel) {\n        var stateToArr = function stateToArr(target, data) {\n          if (data) {\n            var arr = data.split(\",\");\n\n            var loop = function loop(elem) {\n              elem.value = arr.indexOf(elem.replacer + \"\") > -1;\n            };\n\n            for (var i in target) {\n              loop(target[i]);\n            }\n          }\n\n          return target;\n        };\n\n        var getData = function getData(data) {\n          var param = {};\n\n          var loop = function loop(index, elem) {\n            var type = elem.type;\n            var value;\n\n            if (type == \"checkbox\") {\n              value = [];\n\n              for (var i in elem.options) {\n                if (elem.options[i].value) {\n                  value.push(elem.options[i].replacer);\n                }\n              }\n\n              value = value.toString();\n            } else {\n              value = elem.value;\n            }\n\n            param.$attr(elem.data, value);\n          };\n\n          for (var i in data) {\n            loop(i, data[i]);\n          }\n\n          param.content = JSON.stringify(param.content);\n          return param;\n        };\n\n        var alertOption = [{\n          label: \"新产生\",\n          replacer: 0\n        }, {\n          label: \"已确认\",\n          replacer: 5\n        }, {\n          label: \"处理中\",\n          replacer: 10\n        }, {\n          label: \"已解决\",\n          replacer: 20\n        }];\n        var severities = [{\n          label: \"警告\",\n          replacer: 1,\n          value: false\n        }, {\n          label: \"次要\",\n          replacer: 2,\n          value: false\n        }, {\n          label: \"重要\",\n          replacer: 3,\n          value: false\n        }, {\n          label: \"严重\",\n          replacer: 4,\n          value: false\n        }];\n\n        var getViewById_back = function getViewById_back(event) {\n          if (event.code == \"0\") {\n            var dt,\n                domainPath = null;\n\n            if (event.data) {\n              if (event.data.content != null) {\n                dt = JSON.parse(event.data.content);\n              } else {\n                dt = {};\n              }\n\n              domainPath = event.data.domainPath;\n            }\n\n            scope.dialog = {\n              title: charRoot + \"信息\",\n              input: [{\n                \"label\": \"告警视图名称\",\n                \"value\": view ? view.viewTitle : newTitle,\n                \"data\": \"viewTitle\",\n                \"type\": \"input\",\n                \"maxlength\": 32,\n                \"composory\": true,\n                \"events\": {\n                  \"change\": function change(item) {\n                    if (namelist.indexOf(item.value) != -1) {\n                      item.error = \"告警视图以存在，请更换视图名称\";\n                      scope.dialog.input[0].right = false;\n                    } else if (item.value == \"\") {\n                      item.error = \"视图名称不可为空\";\n                      scope.dialog.input[0].right = false;\n                    } else {\n                      item.error = undefined;\n                      scope.dialog.input[0].right = true;\n                    }\n                  }\n                }\n              }, {\n                \"label\": \"管理域\",\n                \"value\": domainPath,\n                \"data\": \"domainPath\",\n                \"type\": \"tree\",\n                \"key\": \"domainPath\",\n                \"mark\": \"domainInfos\",\n                \"options\": domaintree,\n                \"composory\": true,\n                \"disabled\": view != undefined,\n                \"right\": domainPath ? true : false,\n                \"fontsize\": \"12px\",\n                \"width\": \"200px\",\n                \"events\": {\n                  \"change\": function change(item) {\n                    if (item) {\n                      scope.dialog.input[1].right = true;\n                    }\n\n                    ;\n                  }\n                }\n              }, {\n                \"label\": \"设备模板\",\n                \"value\": view ? dt.modelIds : null,\n                \"data\": \"content/modelIds\",\n                \"type\": \"multiple\",\n                \"options\": rootModel,\n                \"fontsize\": \"12px\",\n                \"width\": \"200px\"\n              }, {\n                \"value\": view ? dt.pageSize : 1000,\n                \"label\": \"取得告警数量\",\n                \"data\": \"content/pageSize\",\n                \"type\": \"number\",\n                \"maxlength\": 99999999,\n                \"minlength\": 0,\n                \"events\": {\n                  \"change\": function change(item) {\n                    var regExp = /^[0-9]*$/;\n\n                    if (item.value) {\n                      var test = regExp.test(item.value);\n\n                      if (item.value.toString().length > 8) {\n                        item.error = \"长度不能大于8位数\";\n                        scope.dialog.input[3].right = false;\n                      } else {\n                        if (test) {\n                          item.error = undefined;\n                          scope.dialog.input[3].right = true;\n                        } else {\n                          item.error = \"请输入整数\";\n                          scope.dialog.input[3].right = false;\n                        }\n                      }\n                    }\n                  }\n                }\n              }, {\n                \"label\": \"内容关键词\",\n                \"value\": view ? dt.messageFilter : \"\",\n                \"data\": \"content/messageFilter\",\n                \"maxlength\": 32,\n                \"type\": \"input\"\n              }, {\n                \"label\": \"告警状态\",\n                \"data\": \"content/states\",\n                \"type\": \"checkbox\",\n                \"options\": stateToArr(alertOption, view ? dt.states : \"\")\n              }, {\n                \"label\": \"告警级别\",\n                \"data\": \"content/severities\",\n                \"type\": \"checkbox\",\n                \"options\": stateToArr(severities, view ? dt.severities : \"\")\n              }, {\n                \"label\": \"视图描述\",\n                \"value\": view ? view.description : null,\n                \"data\": \"description\",\n                \"type\": \"textarea\",\n                \"maxlength\": 200,\n                \"composory\": false,\n                \"width\": \"200px\"\n              }],\n              button: [{\n                label: TEXT.SUBMIT,\n                icon: \"btn btn-primary\",\n                disabledFn: function disabledFn() {\n                  return scope.dialog.input.some(function (elem) {\n                    return elem.right == false;\n                  });\n                },\n                fn: function fn() {\n                  ngDialog.close();\n                  var param = getData(scope.dialog.input);\n                  var fn;\n                  param.viewType = viewType;\n\n                  if (view) {\n                    param.viewId = view.viewId;\n                    fn = viewFlexService.updateView;\n                  } else {\n                    fn = viewFlexService.addView;\n                  }\n\n                  fn(param, function (event) {\n                    if (event.code == \"0\") {\n                      var newView = event.data;\n\n                      if (view) {\n                        view.viewTitle = event.data.viewTitle;\n                        view.content = event.data.content;\n                        view.createTime = event.data.createTime;\n                        view.updateTime = event.data.updateTime;\n                        view.description = event.data.description;\n                        view.creatorName = event.data.creatorName;\n                        growl.success(\"告警视图修改成功\", {});\n                      } else {\n                        //views[views.length - 1].insertAfter(event.data);\n                        var arr = event.data.domainPath.split(\"/\");\n                        var domainID,\n                            deferred = q.defer();\n\n                        if (arr.length > 2) {\n                          domainID = arr[arr.length - 2];\n                        }\n\n                        ;\n\n                        if (!scope[domainID]) {\n                          scope[domainID] = deferred.promise;\n                          userDomainService.queryDomainInfo(domainID, function (event) {\n                            if (event.code == \"0\") {\n                              scope[domainID] = event.data;\n                              newView.domainObj = scope[domainID];\n                              views.pushbefore(newView);\n                              growl.success(\"创建告警视图成功\", {});\n                            }\n                          });\n                        } else {\n                          if (scope[domainID].hasOwnProperty(\"$$state\")) {\n                            scope[domainID].then(function () {\n                              newView.domainObj = scope[domainID];\n                              views.pushbefore(newView);\n                              growl.success(\"创建告警视图成功\", {});\n                            });\n                          } else {\n                            newView.domainObj = scope[domainID];\n                            views.pushbefore(newView);\n                            growl.success(\"创建告警视图成功\", {});\n                          }\n                        }\n\n                        ;\n                      }\n\n                      ;\n                    }\n                  });\n                }\n              }, {\n                label: TEXT.CANCEL,\n                icon: \"btn btn-default\",\n                fn: function fn() {\n                  ngDialog.close();\n                }\n              }]\n            };\n          }\n        };\n\n        if (view) {\n          viewFlexService.getViewById(view.viewId, getViewById_back);\n        } else {\n          getViewById_back({\n            code: 0,\n            data: null\n          });\n        }\n\n        ;\n        ngDialog.open({\n          template: '../partials/dialogue/config_alert_dia.html',\n          className: 'ngdialog-theme-plain',\n          scope: scope\n        });\n      };\n\n      var checkAllLoaded = function checkAllLoaded() {\n        if (window['domainlist'] == undefined) {\n          userDomainService.queryDomainTree(userLoginUIService.user.userID, function (event) {\n            if (event.code == 0) {\n              window['domainlist'] = event.data;\n              checkAllLoaded();\n            }\n          });\n        } else if (window['rootModel'] == undefined) {\n          var getRootModel_back = function getRootModel_back(event) {\n            if (event.code == 0) {\n              /** window['rootModel'] = [event.data] */\n              ;\n              window['rootModel'] = [];\n\n              var getModels_back = function getModels_back(event) {\n                Array.prototype.push.apply(window['rootModel'], event.data);\n                checkAllLoaded();\n              };\n\n              resourceUIService.getModels(getModels_back);\n            }\n          };\n\n          resourceUIService.getRootModel(getRootModel_back);\n        } else {\n          run(window['domainlist'], window['rootModel']);\n        }\n      };\n\n      checkAllLoaded();\n      ngDialog.close();\n    };\n\n    var dashboard_run = function dashboard_run(callback) {\n      /**\n      var path = \"../localdb/freeboard.json\";\n      var standardDashboard, machineDashboard;\n      var Info_back = function(info){\n        standardDashboard = info.standardDashboard;\n        machineDashboard = info.machineDashboard;\n        var getManageDashboard_back = function(event){\n          if(event.code == 0) {\n            if(event.data != null) {\n              if(typeof event.data.content) {\n                var dat = JSON.parse(event.data.content);\n                var dashboardView = event.data;\n                dashboardView.JSON = dat;\n                if(event.data.viewType == \"dashboard\") {\n                  if(checkVersion(dat) == \"version1_machine\") {\n                    scope.maindashboard = machineDashboard;\n                  } else if(checkVersion(dat) == \"version1_standard\") {\n                    scope.maindashboard = standardDashboard;\n                  } else {\n                    scope.maindashboard = dashboardView.JSON;\n                  }\n                } else {\n                  scope.maindashboard = standardDashboard;\n                }\n              }\n            } else {\n              scope.maindashboard = standardDashboard;\n            }\n            callback();\n          }\n        };\n        viewFlexService.getManageDashboard(getManageDashboard_back)\n      };\n      Info.get(path, Info_back);\n       */\n      callback();\n    };\n\n    var configure_run = function configure_run(callback) {\n      callback();\n    };\n\n    var configAlert_run = function configAlert_run(callback) {\n      callback();\n    };\n\n    var designView_run = function designView_run(callback) {\n      callback();\n    };\n\n    var deleteGroup_common = function deleteGroup_common(event) {\n      var self = event;\n      var filter = event.filter(function (elem) {\n        return elem.creator == userLoginUIService.user.userID;\n      });\n      var viewIds = filter.map(function (elem) {\n        return elem.viewId;\n      });\n      var viewTitles = filter.map(function (elem) {\n        return elem.viewTitle;\n      });\n      var fnlist = [{\n        label: TEXT.SUBMIT,\n        icon: 'btn btn-success',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        fn: function fn() {\n          ngDialog.close();\n          viewFlexService.deleteViews(viewIds, function (event) {\n            if (event.code == 0) {\n              var success = event.$attr(\"data/successObj\");\n              var fail = event.$attr(\"data/failObj\");\n              growl.success(charRoot + \"删除成功\" + success.length + \"个,失败\" + (self.length - success.length) + \"个\", {});\n\n              var loop = function loop(itm) {\n                if (success.indexOf(itm.viewId) != -1) {\n                  itm.remove();\n                }\n              };\n\n              for (var i in self) {\n                loop(self[i]);\n              }\n\n              ;\n            }\n          });\n        }\n      }, {\n        label: TEXT.CANCEL,\n        icon: 'btn btn-default',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        fn: function fn() {\n          ngDialog.close();\n        }\n      }];\n      scope.dialog = {\n        title: {\n          label: '提示'\n        },\n        description: {\n          label: '确认要删除此' + charRoot + '吗？'\n        },\n        fnlist: fnlist\n      };\n      ngDialog.open({\n        template: '../partials/dialogue/common_dia_prompt.html',\n        className: 'ngdialog-theme-plain',\n        scope: scope\n      });\n    };\n\n    var deleteGroup_configure = function deleteGroup_configure(event) {\n      var self = event;\n      var viewIds = event.map(function (elem) {\n        return elem.viewId;\n      });\n      var viewTitles = event.map(function (elem) {\n        return elem.viewTitle;\n      });\n      var fnlist = [{\n        label: TEXT.SUBMIT,\n        icon: 'btn btn-success',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        fn: function fn() {\n          ngDialog.close();\n          viewFlexService.deleteViews(viewIds, function (event) {\n            if (event.code == 0) {\n              var success = event.$attr(\"data/successObj\");\n              var fail = event.$attr(\"data/failObj\");\n              growl.success(charRoot + \"删除成功\" + success.length + \"个,失败\" + fail.length + \"个\", {});\n\n              var loop = function loop(view) {\n                var lp = function lp(viewId) {\n                  if (view.viewHierarchy == viewId) {\n                    view.viewHierarchy = 0;\n                    viewFlexService.updateView(view, function (event) {\n                      growl.success(charRoot + \" [ \" + event.data.viewTitle + \" ] 的父节点被放回根节点。\", {});\n                    });\n                  }\n                };\n\n                for (var i in success) {\n                  lp(success[i]);\n                }\n              };\n\n              for (var i in views) {\n                loop(views[i]);\n              }\n\n              createTree(views); // growl.success(charRoot + \"删除成功\", {});\n\n              var loopCur = function loopCur(itm) {\n                if (success.indexOf(itm.viewId) != -1) {\n                  itm.remove();\n                }\n              };\n\n              for (var i in self) {\n                loopCur(self[i]);\n              }\n\n              ;\n            }\n          });\n        }\n      }, {\n        label: TEXT.CANCEL,\n        icon: 'btn btn-default',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        fn: function fn() {\n          ngDialog.close();\n        }\n      }];\n      scope.dialog = {\n        title: {\n          label: '提示'\n        },\n        description: {\n          label: '该视图下的子节点将会被移动到根节点下，确认删除？'\n        },\n        fnlist: fnlist\n      };\n      ngDialog.open({\n        template: '../partials/dialogue/common_dia_prompt.html',\n        className: 'ngdialog-theme-plain',\n        scope: scope\n      });\n    };\n\n    var duplicateClick = function duplicateClick(event) {\n      var self = event;\n      var duplicateNameBase = event.viewTitle;\n      var content = event.content;\n      var namelist = views.map(function (elem) {\n        return elem.viewTitle;\n      });\n      var duplicateName = $$.duplicateName(duplicateNameBase, namelist);\n      var fnlist = [{\n        label: '创建',\n        icon: 'btn btn-primary',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        fn: function fn(event) {\n          var viewTitle = event.input[0].value;\n          var viewId = self.viewId;\n\n          var getViewById_back = function getViewById_back(event) {\n            if (event.code == 0) {\n              var param = event.data;\n              param.viewTitle = viewTitle;\n              delete param.viewId;\n              delete param.updateTime;\n              viewFlexService.addView(param, function (event) {\n                if (event.code == 0) {\n                  growl.success(\"复制视图成功\", {});\n                  var item = event.data;\n\n                  var getDomainId = function getDomainId(domainPath) {\n                    var arr = domainPath.split(\"/\");\n\n                    if (arr.length > 2) {\n                      return arr[arr.length - 2];\n                    }\n                  };\n\n                  var domainID = getDomainId(item.domainPath);\n\n                  var finished = function finished() {\n                    if (item.template) {\n                      if (item.template.resourceType == \"project\") {\n                        if (item.template.projectId) {\n                          if (scope[\"allprojects\"]) {\n                            item.templateStr = scope[\"allprojects\"][item.template.projectId].label;\n                          }\n                        }\n                      }\n                    } else {\n                      item.templateStr = \"普通\";\n                    }\n\n                    item.domainObj = scope[domainID];\n                    self.insertAfter(item);\n                    createTree(views);\n                    ngDialog.close();\n                  };\n\n                  if (scope[domainID]) {\n                    finished();\n                  } else {\n                    userDomainService.queryDomainInfo(domainID, function (event) {\n                      if (event.code == \"0\") {\n                        finished();\n                      }\n                    });\n                  }\n\n                  ;\n                }\n              });\n            } else {\n              growl.error(event.message);\n            }\n          };\n\n          var error = function error(err) {\n            growl.error(err);\n          };\n\n          viewFlexService.getViewById(viewId, getViewById_back, error);\n        }\n      }, {\n        label: '取消',\n        icon: 'btn btn-default',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        fn: function fn() {\n          ngDialog.close();\n        }\n      }];\n      scope.dialog = {\n        title: {\n          label: '复制视图'\n        },\n        input: [{\n          value: duplicateName,\n          label: '新视图名称',\n          placeholder: '新视图名称',\n          maxlength: 32,\n          onChange: function onChange(event) {\n            var value = this.value;\n            var find = views.find(function (element) {\n              return element.viewTitle == value;\n            });\n\n            if (find) {\n              event.error = \"此视图名已被占用，请更换.\";\n              fnlist[0].disabled = true;\n            } else {\n              if (value == \"\") {\n                event.error = \"视图名称不可为空.\";\n                fnlist[0].disabled = true;\n              } else {\n                event.error = null;\n                fnlist[0].disabled = false;\n              }\n            }\n          }\n        }],\n        fnlist: fnlist\n      };\n      ngDialog.open({\n        template: '../partials/dialogue/common_dia.html',\n        className: 'ngdialog-theme-plain',\n        scope: scope\n      });\n    };\n\n    var releaseView = function releaseView(viewTitles, viewIds, releasedIds, callback) {\n      var fnlist = [{\n        label: TEXT.SUBMIT,\n        icon: 'btn btn-success',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        fn: function fn() {\n          dialogue.close();\n          viewFlexService.releaseViews(viewIds, function (event) {\n            if (event.code == 0) {\n              if (viewIds.length == 1) {\n                growl.success(\"发布\" + charRoot + \"成功\", {});\n              } else {\n                growl.success(\"发布\" + charRoot + \",成功\" + event.data.successObj.length + \"个,失败\" + event.data.failObj.length + \"个\", {});\n              }\n\n              callback(event.data.successObj);\n            }\n          });\n        }\n      }, {\n        label: TEXT.CANCEL,\n        icon: 'btn btn-default',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        fn: function fn() {\n          dialogue.close();\n        }\n      }];\n      dialogue.open({\n        title: {\n          label: '提示'\n        },\n        description: {\n          label: '确认要发布' + charRoot + '吗？'\n        },\n        fnlist: fnlist\n      });\n    };\n\n    var releaseGroup = function releaseGroup(event) {\n      var self = event;\n      var viewIds = event.filter(function (elem) {\n        return elem.releaseStatus == 0;\n      }).map(function (elem) {\n        return elem.viewId;\n      });\n      var releasedIds = event.filter(function (elem) {\n        return elem.releaseStatus == 1;\n      }).map(function (elem) {\n        return elem.viewId;\n      });\n      var viewTitles = event.map(function (elem) {\n        return elem.viewTitle;\n      });\n      releaseView(viewTitles, viewIds, releasedIds, function (data) {\n        for (var i in self) {\n          self[i].releaseStatus = 1;\n        }\n\n        views.removeAllChecked(); // \n      });\n    };\n\n    var releaseClick = function releaseClick(event) {\n      var self = event;\n      var viewId = event.viewId;\n      var viewTitle = event.viewTitle;\n      releaseView([viewTitle], [viewId], event.viewType, function (data) {\n        // \n        self.releaseStatus = 1;\n      });\n    };\n\n    var addNew_config = function addNew_config(event) {\n      location.href = \"../app-configure/index.html#/configure/\" + 0;\n    };\n\n    var configure_edit = function configure_edit(event) {\n      var self = event;\n      var fnlist = [{\n        label: TEXT.SUBMIT,\n        icon: 'btn btn-primary',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        fn: function fn(event) {\n          var viewHierarchy = event.input[1].value;\n          var description = event.input[2].value;\n          description = description ? description : \"\";\n          var param = {\n            viewType: \"configure\",\n            viewId: self.viewId,\n            viewTitle: event.input[0].value,\n            viewHierarchy: viewHierarchy,\n            description: description\n          };\n          viewFlexService.updateView(param, function (event) {\n            if (event.code == 0) {\n              growl.success(\"组态视图修改成功\", {});\n              ngDialog.close();\n              self.viewTitle = event.data.viewTitle;\n              self.description = event.data.description;\n              self.viewHierarchy = viewHierarchy;\n              self.createTime = event.data.createTime;\n              self.updateTime = event.data.updateTime;\n              createTree(views);\n            }\n          });\n        }\n      }, {\n        label: TEXT.CANCEL,\n        icon: 'btn btn-default',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        fn: function fn() {\n          ngDialog.close();\n        }\n      }];\n      var viewHierarchy = event.viewHierarchy ? event.viewHierarchy : 0;\n      var available = createTree.call(self, views, self.viewHierarchy);\n      scope.dialog = {\n        title: {\n          label: charRoot + '信息'\n        },\n        input: [{\n          value: event.viewTitle,\n          composory: true,\n          type: \"input\",\n          label: '组态视图名称',\n          placeholder: '组态视图名称',\n          maxlength: 32,\n          onChange: function onChange(event) {\n            var value = this.value;\n            var find = views.find(function (element) {\n              return element.viewTitle == value && element.viewTitle != event.viewTitle;\n            });\n\n            if (find) {\n              event.error = \"此视图名已被占用，请更换.\";\n              fnlist[0].disabled = true;\n            } else {\n              if (value == \"\") {\n                event.error = \"视图名称不可为空.\";\n                fnlist[0].disabled = true;\n              } else {\n                event.error = null;\n                fnlist[0].disabled = false;\n              }\n            }\n          }\n        }, {\n          value: viewHierarchy,\n          type: \"tree\",\n          lb: \"viewTitle\",\n          fontsize: \"12px\",\n          width: \"200px\",\n          key: \"viewId\",\n          mark: \"children\",\n          composory: false,\n          label: '选择父级视图',\n          placeholder: '层级结构，例如 0/1',\n          options: available\n        }, {\n          value: event.description,\n          type: \"textarea\",\n          maxlength: 200,\n          composory: false,\n          label: '描述信息',\n          placeholder: '描述信息'\n        }],\n        fnlist: fnlist\n      };\n      ngDialog.open({\n        template: '../partials/dialogue/common_dia.html',\n        className: 'ngdialog-theme-plain',\n        scope: scope\n      });\n    };\n\n    var setComponentClick = function setComponentClick(event, value) {\n      var values = value ? {\n        component: true\n      } : {\n        component: false\n      };\n      var params = {\n        viewId: event.viewId,\n        values: values\n      };\n      viewFlexService.updateView(params, function (event) {\n        if (event.code == \"0\") {\n          growl.success(\"修改成功\");\n        }\n      });\n    };\n\n    var sethomeClick = function sethomeClick(event, source) {\n      var self = event;\n      scope.maindashboard = event;\n      var content = JSON.parse(event.content);\n      var viewTitle = event.viewTitle;\n      content.viewId = event.viewId;\n      var param = {\n        viewTitle: 'dashboard',\n        viewName: 'dashboard',\n        viewType: \"dashboard\",\n        content: JSON.stringify(content)\n      };\n      viewFlexService.saveManageDashboard(param, function (event) {\n        if (event.code == 0) {\n          if (event.data != null) {\n            growl.success(\"设定[\" + viewTitle + \"]为运营首页\", {});\n            scope.maindashboard = JSON.parse(event.data.content);\n\n            for (var i in source) {\n              source[i].homeview = false;\n            }\n\n            self.homeview = true;\n          } else {\n            growl.error(\"错误:运营首页保存失败\", {});\n          }\n        } else {\n          growl.error(\"错误:\" + event.message, {});\n        }\n      });\n    };\n\n    var deleteClickCommon = function deleteClickCommon(event) {\n      var self = event;\n      var viewId = event.viewId;\n      var viewTitle = event.viewTitle;\n      var fnlist = [{\n        label: TEXT.SUBMIT,\n        icon: 'btn btn-success',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        fn: function fn() {\n          ngDialog.close();\n          viewFlexService.deleteView(viewId, function (event) {\n            if (event.code == 0) {\n              growl.success(charRoot + \"删除成功\", {});\n              self.remove();\n            }\n          });\n        }\n      }, {\n        label: TEXT.CANCEL,\n        icon: 'btn btn-default',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        fn: function fn() {\n          ngDialog.close();\n        }\n      }];\n      scope.dialog = {\n        title: {\n          label: '提示'\n        },\n        description: {\n          label: '确认要删除' + charRoot + '吗？'\n        },\n        fnlist: fnlist\n      };\n      ngDialog.open({\n        template: '../partials/dialogue/common_dia_prompt.html',\n        className: 'ngdialog-theme-plain',\n        scope: scope\n      });\n    };\n\n    var deleteClickConfigure = function deleteClickConfigure(event) {\n      var self = event;\n      var viewId = event.viewId;\n      var viewTitle = event.viewTitle;\n      var fnlist = [{\n        label: TEXT.SUBMIT,\n        icon: 'btn btn-primary',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        fn: function fn() {\n          dialogue.close();\n          viewFlexService.deleteView([viewId], function (event) {\n            if (event.code == 0) {\n              var loop = function loop(view) {\n                if (view.viewHierarchy == viewId) {\n                  view.viewHierarchy = 0;\n                  viewFlexService.updateView(view, function (event) {\n                    growl.success(charRoot + \" [ \" + event.data.viewTitle + \" ] 的父节点被放回根节点。\", {});\n                  });\n                }\n              };\n\n              for (var i in views) {\n                loop(views[i]);\n              }\n\n              createTree(views);\n              growl.success(charRoot + \"删除成功\", {});\n              self.remove();\n            }\n          });\n        }\n      }, {\n        label: TEXT.CANCEL,\n        icon: 'btn btn-default',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        fn: function fn() {\n          dialogue.close();\n        }\n      }];\n      dialogue.open({\n        title: {\n          label: '提示'\n        },\n        description: {\n          label: '该视图下的子节点将会被移动到根节点下，确认删除？'\n        },\n        fnlist: fnlist\n      });\n    };\n\n    var editViewInfo = function editViewInfo(event) {\n      var self = event;\n      var fnlist = [{\n        label: TEXT.SUBMIT,\n        icon: 'btn btn-primary',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        disabledFn: function disabledFn() {\n          return this.disabled;\n        },\n        fn: function fn(event) {\n          ngDialog.close();\n          var view = self.$clone();\n          view.viewTitle = scope.dialog.input[0].value;\n          view.description = scope.dialog.input[1].value;\n          viewFlexService.updateView(view, function (event) {\n            if (event.code == \"0\") {\n              self.viewTitle = event.data.viewTitle;\n              self.description = event.data.description;\n              self.updateTime = event.data.updateTime;\n              growl.success(charRoot + \"修改成功\");\n            }\n          });\n        }\n      }, {\n        label: TEXT.CANCEL,\n        icon: 'btn btn-default',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        fn: function fn() {\n          ngDialog.close();\n        }\n      }];\n      scope.dialog = {\n        title: {\n          label: charRoot + '信息'\n        },\n        input: [{\n          value: event.viewTitle,\n          composory: true,\n          type: \"input\",\n          label: charRoot + '名称',\n          placeholder: charRoot + '名称',\n          maxlength: 32,\n          onChange: function onChange(event) {\n            var value = this.value;\n            var namelist = views.filter(function (elem) {\n              return elem.viewId != self.viewId;\n            }).map(function (elem) {\n              return elem.viewTitle;\n            });\n\n            if (namelist.indexOf(value) != -1) {\n              event.error = \"此视图名已被占用，请更换.\";\n              fnlist[0].disabled = true;\n            } else {\n              if (value == \"\") {\n                event.error = \"视图名称不可为空.\";\n                fnlist[0].disabled = true;\n              } else {\n                event.error = null;\n                fnlist[0].disabled = false;\n              }\n            }\n          }\n        }, {\n          value: event.description,\n          type: \"textarea\",\n          maxlength: 200,\n          composory: false,\n          label: '描述信息',\n          placeholder: '新视图名称'\n        }],\n        fnlist: fnlist\n      };\n      ngDialog.open({\n        template: '../partials/dialogue/common_dia.html',\n        className: 'ngdialog-theme-plain',\n        scope: scope\n      });\n    };\n\n    var viewConfigAlert = function viewConfigAlert(view) {\n      var run = function run() {\n        if (view) {\n          var stateToArr = function stateToArr(target, data) {\n            var arr = data.split(\",\");\n\n            var loop = function loop(elem) {\n              elem.value = arr.indexOf(elem.replacer + \"\") > -1;\n            };\n\n            for (var i in target) {\n              loop(target[i]);\n            }\n\n            return target;\n          };\n\n          var getData = function getData(data) {\n            var param = {};\n\n            var loop = function loop(index, elem) {\n              var type = elem.type;\n              var value;\n\n              if (type == \"checkbox\") {\n                value = [];\n\n                for (var i in elem.options) {\n                  if (elem.options[i].value) {\n                    value.push(elem.options[i].replacer);\n                  }\n                }\n\n                value = value.toString();\n              } else {\n                value = elem.value;\n              }\n\n              param.$attr(elem.data, value);\n            };\n\n            for (var i in data) {\n              loop(i, data[i]);\n            }\n\n            param.content = JSON.stringify(param.content);\n            return param;\n          };\n\n          var alertOption = [{\n            label: \"新产生\",\n            replacer: 0\n          }, {\n            label: \"已确认\",\n            replacer: 5\n          }, {\n            label: \"处理中\",\n            replacer: 10\n          }, {\n            label: \"已解决\",\n            replacer: 20\n          }];\n          var severities = [{\n            label: \"警告\",\n            replacer: 1,\n            value: false\n          }, {\n            label: \"次要\",\n            replacer: 2,\n            value: false\n          }, {\n            label: \"重要\",\n            replacer: 3,\n            value: false\n          }, {\n            label: \"严重\",\n            replacer: 4,\n            value: false\n          }];\n\n          var getViewById_back = function getViewById_back(event) {\n            if (event.code == \"0\") {\n              var dt = JSON.parse(event.data.content);\n              scope.dialog = {\n                title: charRoot + \"信息\",\n                input: [{\n                  \"label\": \"告警组名称\",\n                  \"value\": view ? view.viewTitle : newTitle,\n                  \"data\": \"viewTitle\",\n                  \"type\": \"text\"\n                }, {\n                  \"label\": \"视图描述\",\n                  \"value\": view ? view.description : \"\",\n                  \"data\": \"viewTitle\",\n                  \"type\": \"text\"\n                }, {\n                  \"label\": \"管理域\",\n                  \"value\": view ? dt.domain : null,\n                  \"data\": \"content/domain\",\n                  \"type\": \"text\",\n                  \"format\": function format(value) {\n                    var find = domainlist.find(function (elem) {\n                      return elem.domainPath == view.domainPath;\n                    });\n                    return find ? find.name : \"-\";\n                  }\n                }, {\n                  \"label\": \"设备模板\",\n                  \"value\": view ? dt.modelIds : null,\n                  \"data\": \"content/modelIds\",\n                  \"type\": \"text\",\n                  \"format\": function format(value) {\n                    var filter = rootModel.filter(function (elem) {\n                      return dt.modelIds.indexOf(elem.id) != -1;\n                    }).map(function (elem) {\n                      return elem.label;\n                    });\n                    return filter.toString();\n                  }\n                }, {\n                  \"value\": view ? dt.pageSize : 1000,\n                  \"label\": \"取得告警数量\",\n                  \"data\": \"content/pageSize\",\n                  \"type\": \"number\"\n                }, {\n                  \"label\": \"内容关键词\",\n                  \"value\": view ? dt.messageFilter : \"\",\n                  \"data\": \"content/messageFilter\",\n                  \"type\": \"text\",\n                  \"format\": function format(value) {\n                    return value ? value : \"-\";\n                  }\n                }, {\n                  \"label\": \"告警状态\",\n                  \"value\": stateToArr(alertOption, view ? dt.states : \"\"),\n                  \"data\": \"content/states\",\n                  \"type\": \"text\",\n                  \"format\": function format() {\n                    var str = this.value.filter(function (elem) {\n                      return elem.value == true;\n                    }).map(function (elem) {\n                      return elem.label;\n                    });\n                    return str.length > 0 ? str.toString() : \"-\";\n                  }\n                }, {\n                  \"label\": \"告警级别\",\n                  \"value\": stateToArr(severities, view ? dt.severities : \"\"),\n                  \"data\": \"content/severities\",\n                  \"type\": \"text\",\n                  \"format\": function format() {\n                    var str = this.value.filter(function (elem) {\n                      return elem.value == true;\n                    }).map(function (elem) {\n                      return elem.label;\n                    });\n                    return str.length > 0 ? str.toString() : \"-\";\n                  }\n                }],\n                button: [{\n                  label: \"返回\",\n                  icon: \"btn btn-primary\",\n                  fn: function fn() {\n                    ngDialog.close();\n                  }\n                }]\n              };\n            }\n          };\n\n          viewFlexService.getViewById(view.viewId, getViewById_back);\n        }\n      };\n\n      var checkAllLoaded = function checkAllLoaded() {\n        if (window['domainlist'] == undefined) {\n          userDomainService.queryDomainTree(userLoginUIService.user.userID, function (event) {\n            if (event.code == 0) {\n              window['domainlist'] = event.data;\n              checkAllLoaded();\n            }\n          });\n        } else if (window['rootModel'] == undefined) {\n          var getRootModel_back = function getRootModel_back(event) {\n            if (event.code == 0) {\n              /** window['rootModel'] = [event.data]*/\n              ;\n              window['rootModel'] = [];\n\n              var getModels_back = function getModels_back(event) {\n                Array.prototype.push.apply(window['rootModel'], event.data);\n                checkAllLoaded();\n              };\n\n              resourceUIService.getModels(getModels_back);\n            }\n          };\n\n          resourceUIService.getRootModel(getRootModel_back);\n        } else {\n          run(window['domainlist'], window['rootModel']);\n        }\n      };\n\n      checkAllLoaded();\n      ngDialog.open({\n        template: '../partials/dialogue/config_alert_dia.html',\n        className: 'ngdialog-theme-plain',\n        scope: scope\n      });\n    };\n\n    var addNewClick = function (viewType) {\n      if (viewType == 'dashboard') {\n        return function () {\n          window.open(\"../app-freeboard/index.html#/freeboard/view/dashboard\", \"_blank\");\n        };\n      } else if (viewType == 'configAlert') {\n        return function () {\n          editAlertView();\n        };\n      } else if (viewType == 'configure') {\n        return addNew_config;\n      } else if (viewType == 'designView') {\n        return function () {\n          window.open(\"../app-freeboard/index.html#/editor/view/editor\", \"_blank\");\n        };\n      }\n    }(viewType);\n\n    var deleteClick = function (viewType) {\n      if (viewType == 'dashboard') {\n        return deleteClickCommon;\n      } else if (viewType == 'configAlert') {\n        return deleteClickCommon;\n      } else if (viewType == 'configure') {\n        return deleteClickConfigure;\n      } else if (viewType == 'designView') {\n        return deleteClickCommon;\n      }\n    }(viewType);\n\n    var designClick = function (viewType) {\n      if (viewType == 'dashboard') {\n        return function (event) {\n          var template = event.template;\n\n          var gotoDashboard = function gotoDashboard() {\n            window.open(\"../app-freeboard/index.html#/freeboard/view/dashboard/\" + event.viewId + \"/0\", \"_blank\");\n            /**\n            if(event.viewId == scope.maindashboard.viewId) {\n              window.location.href = \"../app-freeboard/index.html#/freeboard/view/dashboard/\" + event.viewId + \"/1\";\n            } else {\n             }\n             */\n          };\n\n          var gotoTemplate = function gotoTemplate(modelId) {\n            var params = {\n              modelId: modelId\n            };\n            window.open(\"../app-freeboard/index.html#/template/model/dashboard/\" + JSON.stringify(params), \"_blank\");\n          };\n\n          if (template) {\n            if (template.keyValue == \"default\") {\n              gotoTemplate(template.resourceId);\n            } else {\n              gotoDashboard();\n            }\n          } else {\n            gotoDashboard();\n          } //window.location.href = \"../app-freeboard/index.html#/freeboard/view/dashboard/\" + event.viewId + \"/0\";\n\n          /**\n          if(event.viewId == scope.maindashboard.viewId) {\n            window.location.href = \"../app-freeboard/index.html#/freeboard/view/dashboard/\" + event.viewId + \"/1\";\n          } else {\n            window.location.href = \"../app-freeboard/index.html#/freeboard/view/dashboard/\" + event.viewId + \"/0\";\n          }\n           */\n\n        };\n      } else if (viewType == 'configAlert') {\n        return editAlertView;\n      } else if (viewType == 'configure') {\n        return function (event) {\n          window.open(\"../app-configure/index.html#/configure/\" + event.viewId, \"_blank\");\n        };\n      } else if (viewType == 'designView') {\n        return function (event) {\n          window.open(\"../app-freeboard/index.html#/editor/view/editor/\" + event.viewId, \"_blank\");\n        };\n      }\n    }(viewType);\n\n    var editClick = function (viewType) {\n      if (viewType == 'dashboard') {\n        return editViewInfo;\n      } else if (viewType == 'configAlert') {\n        return editAlertView;\n      } else if (viewType == 'configure') {\n        return configure_edit;\n      } else if (viewType == 'designView') {\n        return editViewInfo;\n      }\n    }(viewType);\n\n    var viewClick = function (viewType) {\n      if (viewType == 'dashboard') {\n        return function (event) {\n          window.open(\"../app-free-style/index.html#/\" + event.viewId);\n        };\n      } else if (viewType == 'configure') {\n        return function (event) {\n          var param = [{\n            viewId: event.viewId\n          }];\n          window.open('../app-free-style/index.html#/topoview/index/' + encodeURIComponent(JSON.stringify(param)), '_blank');\n        };\n      } else if (viewType == 'designView') {\n        return function (event) {\n          window.open(\"../app-free-style/index.html#/\" + event.viewId);\n        };\n      } else if (viewType == 'configAlert') {\n        return viewConfigAlert;\n      }\n    }(viewType);\n\n    var deleteGroup = function (viewType) {\n      if (viewType == 'configure') {\n        return deleteGroup_configure;\n      } else {\n        return deleteGroup_common;\n      }\n    }(viewType);\n\n    var _CONFIG_ = {\n      dashboard: {\n        label: \"仪表板视图\",\n        viewType: \"dashboard\",\n        charRoot: \"仪表板视图\",\n        header: ['CREAT', 'RELEASE', 'DELETE'],\n        columnDefs: ['VIEWTITLE', 'OWNER', 'RESTYPE', 'RELEASESTATUS', 'COMPONENT', 'CREATETIME', 'UPDATETIME', 'DOMAIN', 'OPTIONS'],\n        buttons: ['BTN_DESIGN', 'BTN_EDIT', 'BTN_DELETE', 'BTN_DUPLICATE', 'BTN_RELEASE', 'BTN_VIEW'],\n        active: viewType == 'dashboard',\n        run: dashboard_run\n      },\n      configure: {\n        label: \"组态视图\",\n        charRoot: \"组态视图\",\n        viewType: \"configure\",\n        header: ['CREAT', 'RELEASE', 'DELETE'],\n        columnDefs: ['VIEWTITLE', 'DESCRIPTION', 'OWNER', 'RESTYPE', 'RELEASESTATUS', 'HIERARCHY', 'CREATETIME', 'UPDATETIME', 'DOMAIN', 'OPTIONS'],\n        buttons: ['BTN_DESIGN', 'BTN_EDIT', 'BTN_DELETE', 'BTN_DUPLICATE', 'BTN_RELEASE', 'BTN_VIEW'],\n        active: viewType == 'configure',\n        run: configure_run\n      },\n      designView: {\n        label: \"分析视图\",\n        charRoot: \"分析视图\",\n        viewType: \"designView\",\n        active: viewType == 'designView',\n        header: ['CREAT', 'RELEASE', 'DELETE'],\n        columnDefs: ['VIEWTITLE', 'DESCRIPTION', 'OWNER', 'RELEASESTATUS', 'CREATETIME', 'UPDATETIME', 'DOMAIN', 'OPTIONS'],\n        buttons: ['BTN_DESIGN', 'BTN_EDIT', 'BTN_DELETE', 'BTN_DUPLICATE', 'BTN_RELEASE', 'BTN_VIEW'],\n        run: designView_run\n      },\n      configAlert: {\n        label: \"告警视图\",\n        charRoot: \"告警视图\",\n        viewType: \"configAlert\",\n        header: ['CREAT', 'RELEASE', 'DELETE'],\n        columnDefs: ['VIEWTITLE', 'DESCRIPTION', 'OWNER', 'RELEASESTATUS', 'CREATETIME', 'UPDATETIME', 'DOMAIN', 'OPTIONS'],\n        buttons: ['BTN_DESIGN', 'BTN_DELETE', 'BTN_DUPLICATE', 'BTN_RELEASE'],\n        active: viewType == 'configAlert',\n        run: configAlert_run\n      }\n    };\n\n    var previewGraph = function previewGraph(viewId) {//window.open(\"../app-free-style/index.html#/\" + viewId);\n\n      /**\n      scope.instance = {};\n      viewFlexService.getViewById(viewId, function(event){\n        if(event.code == \"0\"){\n          var content = event.data.content, dt;\n          if(content != null){\n            var clone = JSON.parse(content);\n            scope.bgColor = clone.$attr(\"setting/color\");\n            var input = {\n              layout : clone.data ? clone.data : clone.layout,\n              setting : clone.setting\n            };\n            delete clone.data;\n            if(input.layout){\n              var editData = new freeboardservice.replaceCiKpi(input, function(){\n                timeout(function(){\n                  scope.instance.setMode(true);\n                  scope.instance.renderLayout(editData);\n                });\n              });\n            } else {\n              scope.error = \"此视图为多页面视图，不支持预览模式\"\n            };\n          }\n        }\n      })\n       */\n    };\n\n    scope.nav = _CONFIG_;\n\n    if (scope.viewId) {\n      previewGraph(scope.viewId);\n    } else {\n      charRoot = _CONFIG_[viewType].charRoot;\n\n      scope.navClick = function (key) {\n        $location.path(\"views/\" + key);\n      };\n\n      var complete = function complete() {\n        var getManagedViewsByType_back = function getManagedViewsByType_back(event) {\n          var viewType = config.viewType;\n          var defers = [];\n          var dataTable = {};\n          var projectIds = [];\n          var allviews = event.data;\n\n          if (event.code == 0) {\n            var loop = function loop(elem) {\n              var defer = q.defer();\n\n              if (viewType == \"configure\") {\n                if (elem.template) {\n                  if (elem.template.resourceType == \"project\") {\n                    projectIds.push(elem.template.resourceId);\n                  }\n                }\n              }\n\n              ;\n              var viewId = elem.viewId;\n\n              if (elem.value) {\n                elem.component = elem.value.component;\n              }\n\n              if (elem.template) {\n                elem.keyValue = elem.template.keyValue;\n              }\n\n              userRoleUIService.findRoleRes({\n                resId: viewId\n              }, function (event) {\n                if (event.code == 0) {\n                  var roleRes = event.data.map(function (el) {\n                    return el.roleId;\n                  });\n\n                  if (roleRes.length > 0) {\n                    elem.bindRoles = allRoles.filter(function (elem) {\n                      return roleRes.indexOf(elem.roleID) != -1;\n                    }).map(function (elem) {\n                      return elem.roleName;\n                    }).toString();\n                  }\n\n                  defer.resolve(\"success\");\n                }\n              });\n              return defer.promise;\n            };\n\n            for (var i in allviews) {\n              defers.push(loop(allviews[i]));\n            }\n\n            q.all(defers).then(function (event) {\n              var run = function run(projects) {\n                scope[\"allprojects\"] = projects;\n\n                var loopView = function loopView(view) {\n                  if (view.template) {\n                    if (view.template.resourceType == \"device\") {\n                      resourceUIService.getModelByIds([view.template.resourceId], function (data) {\n                        view.templateStr = \"模版 : 已删除\";\n\n                        if (data.data) {\n                          if (data.data[0]) {\n                            view.templateStr = \"模版 : \" + (data.data ? data.data[0].label : \"-\");\n                          }\n                        }\n                      });\n                    } else if (view.template.resourceType == \"project\") {\n                      if (projects) {\n                        var find = projects[view.template.resourceId];\n\n                        if (find) {\n                          view.templateStr = \"项目 : \" + find.label;\n                        }\n                      }\n                    } else {\n                      view.templateStr = \"普通\";\n                    }\n\n                    ;\n                  } else {\n                    view.templateStr = \"普通\";\n                  }\n\n                  ;\n                };\n\n                for (var i in allviews) {\n                  loopView(allviews[i]);\n                }\n\n                views = allviews;\n                dataTable.source = allviews;\n\n                dataTable.rowclass = function (row) {\n                  if (row.creator != userLoginUIService.user.userID) {\n                    return \"self\";\n                  }\n                };\n\n                window.header = [], window.columnDefs = [], window.buttons = [];\n\n                var loop = function loop(attr) {\n                  var arr = config[attr];\n\n                  var loop = function loop(at) {\n                    window[attr].push(widget[at]);\n                  };\n\n                  for (var i in arr) {\n                    loop(arr[i]);\n                  }\n                };\n\n                var arr = ['header', 'columnDefs', 'buttons'];\n\n                for (var i in arr) {\n                  loop(arr[i]);\n                }\n\n                ;\n                widget.OPTIONS.modes.default.options = window['buttons'];\n                dataTable.header = window['header'];\n                dataTable.columnDefs = window['columnDefs'];\n\n                for (var i in widget.columnDefs) {\n                  init(widget.columnDefs[i]);\n                }\n\n                ;\n                scope.dataTable = dataTable;\n\n                var getAllDomainName = function getAllDomainName(views) {\n                  var defers = [];\n\n                  var loop = function loop(item) {\n                    var deferred = q.defer(),\n                        attributesLoadDefer = [];\n                    var arr = item.domainPath.split(\"/\");\n                    var domainID;\n\n                    if (arr.length > 2) {\n                      domainID = arr[arr.length - 2];\n                    }\n\n                    ;\n\n                    var loadResource = function loadResource() {\n                      var deferred = q.defer();\n\n                      if (item.values) {\n                        item.component = item.values.component;\n                      }\n\n                      if (item.template) {\n                        var modelId = item.template.resourceId;\n\n                        if (!scope['model_' + modelId]) {\n                          $$.cacheAsyncData.call(resourceUIService.getModelByIds, [[modelId]], function (event) {\n                            if (event && event.code == 0) {\n                              scope['model_' + modelId] = event.data[0];\n                              item.modelObj = scope['model_' + modelId];\n                            }\n\n                            deferred.resolve(\"success\");\n                          });\n                        } else {\n                          if (scope['model_' + modelId].hasOwnProperty(\"$$state\")) {\n                            scope['model_' + modelId].then(function () {\n                              item.modelObj = scope['model_' + modelId];\n                              deferred.resolve(\"success\");\n                            });\n                          } else {\n                            item.modelObj = scope['model_' + modelId];\n                            deferred.resolve(\"success\");\n                          }\n                        }\n                      } else {\n                        deferred.resolve(\"success\");\n                      }\n\n                      return deferred.promise;\n                    };\n\n                    var loadDomain = function loadDomain() {\n                      var deferred = q.defer();\n\n                      if (!scope[domainID]) {\n                        scope[domainID] = deferred.promise;\n                        userDomainService.queryDomainInfo(domainID, function (event) {\n                          if (event.code == \"0\") {\n                            scope[domainID] = event.data;\n                            item.domainObj = scope[domainID];\n                          }\n\n                          deferred.resolve(\"success\");\n                        });\n                      } else {\n                        if (scope[domainID].hasOwnProperty(\"$$state\")) {\n                          scope[domainID].then(function () {\n                            item.domainObj = scope[domainID];\n                            deferred.resolve(\"success\");\n                          });\n                        } else {\n                          item.domainObj = scope[domainID];\n                          deferred.resolve(\"success\");\n                        }\n                      }\n\n                      ;\n                      return deferred.promise;\n                    };\n\n                    attributesLoadDefer.push(loadResource(), loadDomain());\n                    q.all(attributesLoadDefer).then(function (event) {\n                      deferred.resolve(\"success\");\n                    });\n                    return deferred.promise;\n                  };\n\n                  for (var i in views) {\n                    defers.push(loop(views[i]));\n                  }\n\n                  return defers;\n                };\n\n                q.all(getAllDomainName(views)).then(function () {});\n              };\n\n              if (projectIds.length > 0) {\n                resourceUIService.getResourceByIds(projectIds, function (event) {\n                  if (event) {\n                    run(event);\n                  }\n                });\n              } else {\n                run();\n              }\n\n              ;\n            });\n          } else {\n            growl.error(event.message);\n            views = [];\n          }\n        }; //viewFlexService.getManagedViewsByType(viewType, userLoginUIService.user.domainPath, getManagedViewsByType_back);\n\n\n        viewFlexService.getManagedViewsByTypeAndRole(viewType, getManagedViewsByType_back);\n        /** viewFlexService.getAllMyViews(getAllMyViews_back) */\n      };\n\n      var checkPowerCss = function checkPowerCss(flg) {\n        var css = \"\";\n\n        if (flg == \"CREAT\") {\n          if (charRoot == \"告警视图\" && !scope.menuitems[\"A1_S77\"]) {\n            css = \"ng-hide\";\n          }\n\n          if (charRoot == \"组态视图\" && !scope.menuitems[\"A03_S22\"]) {\n            css = \"ng-hide\";\n          }\n\n          if (charRoot == \"分析视图\" && !scope.menuitems[\"A02_S78\"]) {\n            css = \"ng-hide\";\n          }\n\n          if (charRoot == \"仪表板视图\" && !scope.menuitems[\"A04_S21\"]) {\n            css = \"ng-hide\";\n          }\n        } else if (flg == \"RELEASE\") {\n          if (charRoot == \"告警视图\" && !scope.menuitems[\"A2_S77\"]) {\n            css = \"ng-hide\";\n          }\n\n          if (charRoot == \"组态视图\" && !scope.menuitems[\"A04_S22\"]) {\n            css = \"ng-hide\";\n          }\n\n          if (charRoot == \"分析视图\" && !scope.menuitems[\"A03_S78\"]) {\n            css = \"ng-hide\";\n          }\n\n          if (charRoot == \"仪表板视图\" && !scope.menuitems[\"A04_S21\"]) {\n            css = \"ng-hide\";\n          }\n        } else if (flg == \"DELETE\") {\n          if (charRoot == \"告警视图\" && !scope.menuitems[\"A3_S77\"]) {\n            css = \"ng-hide\";\n          }\n\n          if (charRoot == \"组态视图\" && !scope.menuitems[\"A05_S22\"]) {\n            css = \"ng-hide\";\n          }\n\n          if (charRoot == \"分析视图\" && !scope.menuitems[\"A04_S78\"]) {\n            css = \"ng-hide\";\n          }\n\n          if (charRoot == \"仪表板视图\" && !scope.menuitems[\"A05_S21\"]) {\n            css = \"ng-hide\";\n          }\n        }\n\n        return css;\n      };\n\n      var checkPowerVisible = function checkPowerVisible(flg) {\n        var bol = true;\n\n        if (flg == \"BTN_DESIGN\") {\n          if (charRoot == \"分析视图\" && !scope.menuitems[\"A05_S78\"]) {\n            bol = false;\n          }\n\n          if (charRoot == \"组态视图\" && !scope.menuitems[\"A01_S22\"]) {\n            bol = false;\n          }\n\n          if (charRoot == \"仪表板视图\" && !scope.menuitems[\"A01_S21\"]) {\n            bol = false;\n          }\n\n          if (charRoot == \"告警视图\" && !scope.menuitems[\"A4_S77\"]) {\n            bol = false;\n          }\n        } else if (flg == \"BTN_DELETE\") {\n          if (charRoot == \"告警视图\" && !scope.menuitems[\"A3_S77\"]) {\n            bol = false;\n          }\n\n          if (charRoot == \"组态视图\" && !scope.menuitems[\"A05_S22\"]) {\n            bol = false;\n          }\n\n          if (charRoot == \"分析视图\" && !scope.menuitems[\"A04_S78\"]) {\n            bol = false;\n          }\n\n          if (charRoot == \"仪表板视图\" && !scope.menuitems[\"A05_S21\"]) {\n            bol = false;\n          }\n        } else if (flg == \"BTN_EDIT\") {\n          if (charRoot == \"告警视图\" && !scope.menuitems[\"A4_S77\"]) {\n            bol = false;\n          }\n\n          if (charRoot == \"分析视图\" && !scope.menuitems[\"A01_S78\"]) {\n            bol = false;\n          }\n\n          if (charRoot == \"组态视图\" && !scope.menuitems[\"A06_S22\"]) {\n            bol = false;\n          }\n\n          if (charRoot == \"仪表板视图\" && !scope.menuitems[\"A06_S21\"]) {\n            bol = false;\n          }\n        } else if (flg == \"BTN_DUPLICATE\") {\n          if (charRoot == \"告警视图\" && !scope.menuitems[\"A5_S77\"]) {\n            bol = false;\n          }\n\n          if (charRoot == \"组态视图\" && !scope.menuitems[\"A07_S22\"]) {\n            bol = false;\n          }\n\n          if (charRoot == \"分析视图\" && !scope.menuitems[\"A06_S78\"]) {\n            bol = false;\n          }\n\n          if (charRoot == \"仪表板视图\" && !scope.menuitems[\"A07_S21\"]) {\n            bol = false;\n          }\n        } else if (flg == \"BTN_RELEASE\") {\n          if (charRoot == \"告警视图\" && !scope.menuitems[\"A2_S77\"]) {\n            bol = false;\n          }\n\n          if (charRoot == \"组态视图\" && !scope.menuitems[\"A04_S22\"]) {\n            bol = false;\n          }\n\n          if (charRoot == \"分析视图\" && !scope.menuitems[\"A03_S78\"]) {\n            bol = false;\n          }\n\n          if (charRoot == \"仪表板视图\" && !scope.menuitems[\"A04_S21\"]) {\n            bol = false;\n          }\n        } else if (flg == \"BTN_VIEW\") {\n          if (charRoot == \"告警视图\") {\n            bol = false;\n          }\n\n          if (charRoot == \"组态视图\" && !scope.menuitems[\"A08_S22\"]) {\n            bol = false;\n          }\n\n          if (charRoot == \"分析视图\" && !scope.menuitems[\"A07_S78\"]) {\n            bol = false;\n          }\n\n          if (charRoot == \"仪表板视图\" && !scope.menuitems[\"A08_S21\"]) {\n            bol = false;\n          }\n        }\n\n        return bol; //return false;\n      };\n\n      var queryDomainTree_back = function queryDomainTree_back(event) {\n        if (event.code == \"0\") {\n          domainlist = createlist(event.data[0]);\n          domaintree = {\n            domainInfos: event.data\n          };\n          widget = {\n            CREAT: {\n              label: \"创建\" + charRoot,\n              icon: \"fa fa-plus\",\n              type: \"button\",\n              class: \"btn btn-primary btn-sm \" + checkPowerCss(\"CREAT\"),\n              style: {\n                margin: \"2px\"\n              },\n              events: {\n                click: addNewClick\n              }\n            },\n            DESIGNVIEW: {\n              label: \"管理性能视图\",\n              icon: \"glyphicon glyphicon-new-window\",\n              type: \"button\",\n              class: \"btn btn-default btn-sm\",\n              style: {\n                margin: \"2px\"\n              },\n              events: {\n                click: function click() {\n                  location.href = \"#/designView2\";\n                }\n              }\n            },\n            RELEASE: {\n              label: \"发布\",\n              icon: \"glyphicon glyphicon-new-window\",\n              type: \"button\",\n              class: \"btn btn-default btn-sm \" + checkPowerCss(\"RELEASE\"),\n              disabled: function disabled(event) {\n                if (event) {\n                  var some = event.some(function (elem) {\n                    return elem.selected == true && elem.releaseStatus != true;\n                  });\n                  return !some;\n                } else {\n                  return true;\n                }\n              },\n              style: {\n                margin: \"2px\"\n              },\n              events: {\n                click: releaseGroup\n              }\n            },\n            DELETE: {\n              label: \"删除\",\n              icon: \"fa fa-minus\",\n              type: \"button\",\n              disabled: function disabled(event) {\n                if (event) {\n                  var some = event.some(function (elem) {\n                    return elem.selected == true;\n                  });\n                  return !some;\n                } else {\n                  return true;\n                }\n              },\n              class: \"btn btn-default btn-sm \" + checkPowerCss(\"DELETE\"),\n              style: {\n                margin: \"2px\"\n              },\n              events: {\n                click: deleteGroup\n              }\n            },\n            COMPONENT: {\n              label: \"组件\",\n              data: \"component\",\n              type: \"toggle\",\n              filterable: false,\n              sortable: false,\n              format: function format(value, row) {\n                if (value == \"default\") {\n                  return \"是\";\n                } else {\n                  return \"否\";\n                }\n              },\n              events: {\n                click: setComponentClick\n              }\n            },\n            TEMPLATE: {\n              label: \"默认仪表板\",\n              data: \"keyValue\",\n              type: \"text\",\n              filterable: false,\n              sortable: true,\n              format: function format(value, row) {\n                if (value == \"default\") {\n                  return \"是\";\n                } else {\n                  return \"否\";\n                }\n              },\n              modes: {\n                default: {\n                  type: \"text\"\n                }\n              }\n            },\n            SETHOME: {\n              label: \"首页设置\",\n              data: \"homeview\",\n              type: \"sethome\",\n              filterable: false,\n              sortable: false,\n              width: 30,\n              events: {\n                click: sethomeClick\n              }\n            },\n            VIEWTITLE: {\n              label: \"视图名称\",\n              data: \"viewTitle\",\n              type: \"text\",\n              filterable: true,\n              sortable: true,\n              modes: {\n                default: {\n                  type: \"text\"\n                }\n              }\n            },\n            HIERARCHY: {\n              label: \"视图层级\",\n              data: \"viewHierarchy\",\n              type: \"text\",\n              filterable: false,\n              sortable: true,\n              modes: {\n                default: {\n                  type: \"text\"\n                }\n              },\n              format: function format(value, row) {\n                if (treeData == undefined) {\n                  treeData = createTree(views);\n                }\n\n                var rs = '';\n                var parent = row.parent;\n\n                while (parent) {\n                  if (parent.viewId != 0) {\n                    rs = parent.viewTitle + \"/\" + rs;\n                  }\n\n                  parent = parent.parent;\n                }\n\n                rs = \"/\" + rs;\n                return rs;\n              }\n            },\n            RESTYPE: {\n              label: \"视图类型\",\n              data: \"templateStr\",\n              type: \"text\",\n              modes: {\n                default: {\n                  type: \"text\"\n                }\n              },\n              filterable: false,\n              sortable: true\n            },\n            DESCRIPTION: {\n              label: \"视图描述\",\n              data: \"description\",\n              type: \"text\",\n              modes: {\n                default: {\n                  type: \"text\"\n                }\n              },\n              format: function format(str) {\n                if (str == null) {\n                  return '-';\n                } else {\n                  return str;\n                }\n              },\n              filterable: false,\n              sortable: true\n            },\n            OWNER: {\n              label: \"绑定角色\",\n              data: \"bindRoles\",\n              type: \"select\",\n              options: allRoles,\n              filterFormat: {\n                label: \"roleName\",\n                value: \"roleName\"\n              },\n              modes: {\n                default: {\n                  type: \"text\"\n                }\n              },\n              filterable: true,\n              sortable: false\n            },\n            RELEASESTATUS: {\n              label: \"发布状态\",\n              data: \"releaseStatus\",\n              type: \"text\",\n              modes: {\n                default: {\n                  type: \"text\"\n                }\n              },\n              format: function format(str) {\n                if (str == null) {\n                  return '未发布';\n                } else if (str == 0) {\n                  return '未发布';\n                } else if (str == 1) {\n                  return '已发布';\n                } else {\n                  return '-';\n                }\n              },\n              filterable: false,\n              sortable: true\n            },\n            CREATETIME: {\n              label: \"创建时间\",\n              data: \"createTime\",\n              type: \"date\",\n              format: \"yy-mm-dd hh:nn:ss\",\n              filterable: false,\n              sortable: true,\n              modes: {\n                default: {\n                  type: \"date\"\n                }\n              }\n            },\n            UPDATETIME: {\n              label: \"更新时间\",\n              data: \"updateTime\",\n              type: \"date\",\n              format: \"yy-mm-dd hh:nn:ss\",\n              filterable: false,\n              sortable: true,\n              modes: {\n                default: {\n                  type: \"date\"\n                }\n              }\n            },\n            DOMAIN: {\n              label: \"管理域\",\n              type: \"tree\",\n              sortable: true,\n              filterable: true,\n              data: \"domainPath\",\n              key: \"id\",\n              mark: \"domainInfos\",\n              options: domaintree,\n              format: function format(value, row) {\n                if (row.domainObj) {\n                  return row.domainObj.label;\n                } else {\n                  return \"-\";\n                }\n\n                ;\n              },\n              modes: {\n                default: {\n                  type: \"text\"\n                }\n              }\n            },\n            OPTIONS: {\n              label: \"操作\",\n              width: 141,\n              type: \"buttonGroup\",\n              filterable: false,\n              sortable: false,\n              modes: {\n                default: {\n                  options: []\n                }\n              }\n            },\n            BTN_DESIGN: {\n              label: viewType == 'configAlert' ? \"编辑\" : \"设计\",\n              disabled: function disabled(event) {\n                return !checkPowerVisible(\"BTN_DESIGN\");\n              },\n              type: \"button\",\n              class: \"btn btn-primary\",\n              events: {\n                click: designClick\n              }\n            },\n            BTN_EDIT: {\n              label: \"编辑\",\n              type: \"button\",\n              class: \"btn btn-default\",\n              disabled: function disabled(event) {\n                return !checkPowerVisible(\"BTN_EDIT\");\n              },\n              events: {\n                click: editClick\n              }\n            },\n            BTN_DELETE: {\n              label: \"删除\",\n              type: \"button\",\n              visible: function visible(event) {\n                return checkPowerVisible(\"BTN_DELETE\");\n              },\n              events: {\n                click: deleteClick\n              }\n            },\n            BTN_VIEW: {\n              label: \"预览\",\n              type: \"button\",\n              visible: function visible(event) {\n                return checkPowerVisible(\"BTN_VIEW\");\n              },\n              events: {\n                click: viewClick\n              }\n            },\n            BTN_DUPLICATE: {\n              label: \"复制\",\n              type: \"button\",\n              visible: function visible(event) {\n                return checkPowerVisible(\"BTN_DUPLICATE\");\n              },\n              events: {\n                click: duplicateClick\n              }\n            },\n            BTN_RELEASE: {\n              label: \"发布\",\n              type: \"button\",\n              visible: function visible(event) {\n                return checkPowerVisible(\"BTN_RELEASE\") && event.releaseStatus != true;\n              },\n              events: {\n                click: releaseClick\n              }\n            },\n            BTN_HOME: {\n              label: \"设为首页\",\n              type: \"button\",\n              visible: function visible(event) {\n                return !event.homeview;\n              },\n              events: {\n                click: sethomeClick\n              }\n            }\n          };\n          config = _CONFIG_[viewType];\n\n          var queryEnterpriseUser_back = function queryEnterpriseUser_back(event) {\n            if (event.code == 0) {\n              enterpriseUsers = event.data;\n              config.run(complete);\n            }\n          };\n\n          userEnterpriseService.queryEnterpriseUser(queryEnterpriseUser_back);\n        }\n      };\n\n      timeout(function () {\n        var queryEnterpriseRole_back = function queryEnterpriseRole_back(event) {\n          if (event.code == 0) {\n            allRoles = event.data;\n            userDomainService.queryDomainTree(userLoginUIService.user.userID, queryDomainTree_back);\n          }\n        };\n\n        userEnterpriseService.queryEnterpriseRole(queryEnterpriseRole_back);\n      }, 1000);\n    }\n\n    scope.bgColorFn = function (bgColor) {\n      return {\n        \"background-color\": bgColor ? bgColor : \"#eee\"\n      };\n    };\n\n    function checkVersion(data) {\n      var version = \"version2\";\n      var mode = \"standard\";\n      data.traverse(function (attr, element) {\n        for (var i in element) {\n          if (i == \"rows\") {\n            version = \"version1\";\n          }\n\n          if (element.kpi == 3236) {\n            mode = \"machine\";\n          }\n        }\n      });\n      return version + \"_\" + mode;\n    }\n  }]);\n});"],"sourceRoot":"/source/"}