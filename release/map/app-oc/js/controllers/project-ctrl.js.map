{"version":3,"sources":["app-oc/js/controllers/project-ctrl.js"],"names":["define","controllers","BootstrapDialog","initController","$scope","userEnterpriseService","customerUIService","userDomainService","customerProjectUIService","ngDialog","$location","$routeParams","$timeout","resourceUIService","userLoginUIService","Info","growl","initHistory","conItem","customerId","projectId","label","selectedDitem","projectLists","selecteditem","contectLists","ifTables","shy","shy1","ifAdd","routePaths","routePathNodes","queryDitem","types","customerList","selected","modelId","id","deviceId","relatedDeviceList","ifshowTable","customor","selTableProject","selTableProjectId","clearSearchDevices","custermerId","domainPath","sn","ifshow","getcontectList","item","$broadcast","Event","CONTECTITEMSINIT","option","addcontectitem","i","selCustomor","jQuery","find","length","AdminLTE","boxWidget","collapse","isEdit","warning","newObj","projectName","customerName","takeEffectTime","loseEfficacyTime","createTime","Date","unshift","doAction","type","select","callback","splice","saveContractTerms","returnObj","code","data","success","show","title","closable","message","buttons","cssClass","action","dialogRef","deleteContractTerms","obj","filterBlankOrDelete","close","selProName","ifShowSelectDevice","getByContractTermsId","contactList","selectedContactDevices","selectedContactObj","push","facilitySelObj","facilitySelList","j","facilityList","SELDEVICEINIT","linkProject","location","href","doActionss","addDevicesToItem","console","dir","modelListSelect","modelList","getModels","rootModelDic","parentModelId","addNodes","parentNode","modeid","nodes","key","rootModel","initRoutePath","node","arr","treeAry","handler","devicesContractList","changeDevices","devicesId","b","romverDevice","contact","dev","tmp","k","deleteContractTermsToDevice","saveselDevices","selDevices","undefined","saveContractTermsToDevice","searchDevices","getDevicesByCondition","res","findCustomersByCondition","customersObj","forEach","text","CustomerList","projectObj","getselectedProject","alertFunCustom","name","customerID","parseInt","alertFunProId","proname","cancelData","contractId","getChange","queryState","searchData","param","size","findContractTerms","init","getAllProjects","queryDomainTree","user","userID","domainListTree","domainListDic","getRootModel","isAuthenticated","$on","evt","d","distributorUIService","projectUIService","projectInfo","province","city","county","values","projectAddress","installDate","debugFinishDate","distributorId","qualityCloseDate","risingTime","selEditInfo","provinces","$parent","cityDics","districtDics","projectItem","orCondition","customer","distributor","ifShowSelect","queryLabel","selectedProject","selCustomer","customerDic","distributorDic","showIndex","closeDialog","closeTable","provinceClick","provinceId","cityList","cityClick","cityId","districtList","getprojectList","PROJECTMANAGEINIT","extendTableColumns","addproject","open","template","className","scope","saveData","standardAddress","getAddressPoint","updateProject","$","extend","addProject","deleteProjectById","alertFun","time","date","setFullYear","getFullYear","newDate","Format","findProjectsByCondition","findDistributorsByCondition","distributorName","distributorList","concat","menuitems","baseConfig","projectConfig","extendModelGroupId","getAttrsByModelId","menuitemsWatch","$watch","o","n","getExtendContent","inputObj","callbackFun","latitude","longitude","split","join","address","lat","toFixed","lng","faultKnowledgeUIService","faultKnowledgeLists","ifRouteParams","severiesList","severNo","severName","selSeverity","number","severity","getfaultKnowledgeList","FAULTKNOWLEDGEINIT","getfaultKnowledges","getByFaultNo","isArray","getAllFaultKnowledges","addFaultKnowledge","faultNo","category","desc","phenomenon","cause","processingMethod","saveFaultKnowledge","deleteFaultKnowledge"],"mappings":"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","file":"app-oc/js/controllers/project-ctrl.js","sourcesContent":["define(['controllers/controllers', 'bootstrap-dialog'], function (controllers, BootstrapDialog) {\n  'use strict'; //合同条款管理\n\n  controllers.initController('contractTermsCtrl', ['$scope', 'userEnterpriseService', 'customerUIService', 'userDomainService', 'customerProjectUIService', 'ngDialog', '$location', '$routeParams', '$timeout', 'resourceUIService', 'userLoginUIService', 'Info', 'growl', function ($scope, userEnterpriseService, customerUIService, userDomainService, customerProjectUIService, ngDialog, $location, $routeParams, $timeout, resourceUIService, userLoginUIService, Info, growl) {\n    $scope.selecteditem = true; //是否有已选中的合同条款\n\n    $scope.contectLists = []; //存储合同条款列表，用于添加\n\n    $scope.ifTables = true;\n    $scope.shy = true;\n    $scope.shy1 = false;\n    $scope.ifAdd = 0; //链接跳转不允许添加\n\n    $scope.routePaths = [];\n    $scope.routePathNodes = {};\n    $scope.queryDitem = null; //选择设备项\n\n    $scope.selectedDitem = {\n      \"types\": [],\n      //存储所有设备模板\n      \"label\": [],\n      //存储所有设备\n      \"customerList\": [],\n      //客户展示信息\n      \"projectLists\": [] //项目级联信息\n\n    }; // $scope.ifShowSelectDevice = false;\n    // $scope.selectedConItem = {}; //选择到的合同条款与设备关联\n\n    $scope.selected = {\n      //根据模板选取的所有设备组，用于存储\n      'modelId': '',\n      'id': '',\n      'deviceId': []\n    };\n    $scope.relatedDeviceList = []; //用于存储关联班组的设备id组\n    // $scope.editData = 3; //3为新增，2为修改\n\n    $scope.ifshowTable = true;\n    $scope.customor = {\n      \"id\": \"\"\n    }; //绑定图表中选中的客户Id，用于过滤项目\n\n    $scope.selTableProject = []; //在table中选择客户所对应的项目列表\n\n    $scope.selTableProjectId = ''; //在table中选择项目的id\n    //查询及展示数据字段\n\n    function initHistory() {\n      $scope.conItem = {\n        'customerId': '',\n        //客户Id\n        'projectId': '',\n        //项目Id\n        'label': '' //合同条款名称\n\n      };\n      $scope.selectedDitem.projectLists = [];\n    }\n\n    ; //清空查询设备数据\n\n    $scope.clearSearchDevices = function () {\n      $scope.queryDitem = {\n        custermerId: $scope.selected.customerId,\n        domainPath: null,\n        sn: null,\n        modelId: null\n      };\n      $scope.ifshow = 0;\n    };\n\n    var getcontectList = function getcontectList(item) {\n      $scope.$broadcast(Event.CONTECTITEMSINIT, {\n        \"option\": [item]\n      });\n    }; //过滤由于添加信息后未删除的空项 || 删除与id相同的项\n\n\n    function filterBlankOrDelete(obj, id) {\n      for (var i in obj) {\n        if (id) {\n          if (obj[i].id == id) {\n            obj.splice(i, 1);\n          }\n        } else {\n          if (obj[i].id == 0) {\n            obj.splice(i, 1);\n          }\n        }\n      }\n    }\n\n    ; //添加合同条款\n\n    $scope.addcontectitem = function () {\n      $scope.selCustomor = '';\n      $scope.selTableProjectId = '';\n\n      if (jQuery(\"#contectcollapse\").find(\".fa.fa-plus\").length > 0) {\n        jQuery.AdminLTE.boxWidget.collapse(jQuery(\"#contectcollapse\"));\n      }\n\n      for (var i in $scope.contectLists) {\n        if ($scope.contectLists[i].id == 0 && $scope.contectLists[i].isEdit == 2) {\n          //新加跳转第一项\n          $scope.selCustomor = {\n            \"id\": \"\"\n          }; //在table中的数据清空\n\n          $scope.selTableProjectId = ''; //在table中的数据清空\n\n          getcontectList($scope.contectLists);\n          return;\n        } else if ($scope.contectLists[i].id != 0 && $scope.contectLists[i].isEdit == 2) {\n          //编辑原地不动\n          growl.warning(\"已存在正在编辑的合同条款\", {});\n          return;\n        }\n      }\n\n      var newObj = {\n        'customerId': '',\n        'projectId': '',\n        'projectName': '',\n        'customerName': '',\n        'label': '',\n        'takeEffectTime': '',\n        'loseEfficacyTime': '',\n        'createTime': new Date(),\n        'id': 0,\n        'isEdit': 2\n      };\n      $scope.customor.id = '';\n      $scope.selTableProjectId = '';\n      $scope.selTableProject = '';\n      $scope.contectLists.unshift(newObj);\n      getcontectList($scope.contectLists);\n    };\n\n    $scope.doAction = function (type, select, callback) {\n      if (type == \"cancel\") {\n        for (var i = $scope.contectLists.length - 1; i > -1; i--) {\n          if ($scope.contectLists[i].id == 0) {\n            $scope.contectLists.splice(i, 1);\n          } else {\n            $scope.contectLists[i][\"isEdit\"] = 0;\n          }\n        }\n\n        $scope.$broadcast(Event.CONTECTITEMSINIT, {\n          \"option\": [$scope.contectLists]\n        });\n      } else if (type == \"saveContracts\") {\n        if (select != \"\" && select != null) {\n          customerProjectUIService.saveContractTerms(select, function (returnObj) {\n            if (returnObj.code == 0) {\n              callback(returnObj.data);\n              growl.success(\"已成功保存合同条款\", {});\n              return;\n            }\n          });\n        }\n      } else if (type == \"deleteContract\") {\n        BootstrapDialog.show({\n          title: '提示',\n          closable: false,\n          message: '确定删除此合同条款吗？',\n          buttons: [{\n            label: '确定',\n            cssClass: 'btn-success',\n            action: function action(dialogRef) {\n              customerProjectUIService.deleteContractTerms(select.id, function (returnObj) {\n                if (returnObj.code == 0) {\n                  callback(returnObj.code);\n                  growl.success(\"成功删除此合同条款\", {});\n                  filterBlankOrDelete($scope.contectLists, select.id);\n                  return;\n                }\n              });\n              dialogRef.close();\n            }\n          }, {\n            label: '取消',\n            action: function action(dialogRef) {\n              dialogRef.close();\n            }\n          }]\n        });\n      } else if (type == \"showDeviceList\") {\n        $scope.selProName = select.label;\n        $scope.ifShowSelectDevice = \"1010\";\n        getByContractTermsId(select.id);\n        $scope.selected = select;\n        $scope.selected.id = select.id; //所选合同管理id\n\n        $scope.selected[\"devicesId\"] = \"\"; //所选合同管理id\n      }\n    }; //通过合同Id链接项目\n\n\n    $scope.linkProject = function (id) {\n      location.href = \"index.html#/projectManagement///\" + id;\n    }; //移除设备\n\n\n    $scope.doActionss = function (type, select, callback) {\n      if (type == 'removeDevice') {\n        for (var i in $scope.selectedContactDevices) {\n          if ($scope.selectedContactDevices[i].id == select.id) {\n            $scope.facilitySelList.push($scope.selectedContactDevices[i]);\n            $scope.selectedContactDevices.splice(i, 1);\n            break;\n          }\n        }\n\n        growl.warning(\"记得点击保存按钮，要不然不会生效哦！\", {});\n        return true;\n        /*BootstrapDialog.show({\n          title: '提示',\n          closable: false,\n          message: '确定移出此设备吗？',\n          buttons: [{\n            label: '确定',\n            cssClass: 'btn-success',\n            action: function(dialogRef) {\n              customerProjectUIService.deleteContractTermsToDevice(select.id, function(returnObj) {\n                if(returnObj.code == 0) {\n                  growl.success(\"成功移出此合同条款与设备的关联\", {});\n                  getByContractTermsId($scope.selected.id);\n                  return;\n                } else {\n                  growl.warning(\"失败移出合同条款与设备的关联\", {});\n                  return;\n                }\n              })\n              dialogRef.close();\n            }\n          }, {\n            label: '取消',\n            action: function(dialogRef) {\n              dialogRef.close();\n            }\n          }]\n        });*/\n      }\n    }; //合同管理关联设备，添加设备\n\n\n    $scope.addDevicesToItem = function () {\n      var newDevices = [{\n        \"modelId\": 0,\n        \"label\": '',\n        \"sn\": '',\n        \"isEdit\": 3\n      }];\n      $scope.$broadcast(Event.SELDEVICEINIT, {\n        \"option\": [newDevices]\n      });\n      console.dir($scope.selectedContactDevices);\n      /*if(!$scope.selected.modelId) {\n        $scope.selectedDitem.label = [];\n      }\n      $scope.relatedDeviceList = [];\n      ngDialog.open({\n        template: 'templateDevice',\n        className: 'ngdialog-theme-plain',\n        scope: $scope\n      });\n      $scope.queryDitem.custermerId = $scope.selected.customerId;*/\n    };\n\n    $scope.selectedContactDevices = [];\n    $scope.selectedContactObj = {};\n    $scope.contactList = []; //根据合同条款id获取相关设备\n\n    function getByContractTermsId(id) {\n      customerProjectUIService.getByContractTermsId(id, function (returnObj) {\n        if (returnObj.code == 0) {\n          var selected = returnObj.data;\n          $scope.contactList = returnObj.data;\n          $scope.selectedContactDevices = [];\n          $scope.selectedContactObj = {};\n\n          for (var i in selected) {\n            $scope.selectedContactDevices.push($scope.facilitySelObj[selected[i].deviceId]);\n            $scope.selectedContactObj[selected[i].deviceId] = selected[i];\n          }\n\n          var facilitySelList = [];\n\n          for (var j in $scope.facilityList) {\n            if (!$scope.selectedContactObj[$scope.facilityList[j].id]) {\n              facilitySelList.push($scope.facilityList[j]);\n            }\n          }\n\n          $scope.facilitySelList = facilitySelList;\n          $timeout(function () {\n            $scope.$broadcast(Event.SELDEVICEINIT, {\n              \"option\": [$scope.selectedContactDevices]\n            });\n          });\n        }\n      });\n    }\n\n    ; //=========================   start devices   ========================\n    //根据用户Id查用户域\n\n    var domainTreeQuery = function domainTreeQuery() {\n      userDomainService.queryDomainTree(userLoginUIService.user.userID, function (data) {\n        $scope.domainListTree = data.domainListTree;\n        $scope.domainListDic = data.domainListDic;\n      });\n    }; //设备模板目录树拼接\n\n\n    function handler(returnObj) {\n      if (returnObj.code == 0) {\n        resourceUIService.rootModelDic = {};\n\n        for (var i in returnObj.data) {\n          var obj = returnObj.data[i];\n          if (!$scope.routePathNodes[obj.parentModelId]) $scope.routePathNodes[obj.parentModelId] = [];\n          $scope.routePathNodes[obj.parentModelId].push(obj);\n          if (!$scope.routePathNodes[obj.id]) $scope.routePathNodes[obj.id] = [];\n          resourceUIService.rootModelDic[obj.id] = obj;\n        }\n\n        var addNodes = function addNodes(parentNode) {\n          for (var modeid in $scope.routePathNodes) {\n            if (modeid == parentNode.id) {\n              parentNode.nodes = $scope.routePathNodes[modeid];\n\n              for (var i in parentNode.nodes) {\n                addNodes(parentNode.nodes[i]);\n              }\n\n              if (parentNode.nodes.length == 0) {\n                parentNode.nodes = null;\n              }\n            }\n          }\n        };\n\n        var initRoutePath = function initRoutePath(node, arr) {\n          for (var i in node.nodes) {\n            if ($routeParams.modelId == node.nodes[i].id) {\n              if (node.id != arr[0].id) arr.push(node);\n              break;\n            } else {\n              initRoutePath(node.nodes[i], arr);\n            }\n          }\n        };\n\n        addNodes(resourceUIService.rootModel);\n\n        for (var key in $scope.routePathNodes) {\n          if (key != resourceUIService.rootModel.id && !resourceUIService.rootModelDic[key]) {\n            for (var i in $scope.routePathNodes[key]) {\n              addNodes($scope.routePathNodes[key][i]);\n              if (!resourceUIService.rootModel.nodes) resourceUIService.rootModel.nodes = [];\n              $scope.routePathNodes[key][i].parentModelId = resourceUIService.rootModel.id;\n              resourceUIService.rootModel.nodes.push($scope.routePathNodes[key][i]);\n            }\n          }\n        }\n\n        resourceUIService.rootModelDic[resourceUIService.rootModel.id] = resourceUIService.rootModel;\n        $scope.rootModelDic = resourceUIService.rootModelDic;\n        $scope.rootModel = resourceUIService.rootModel;\n\n        if ($routeParams.modelId) {\n          if ($scope.routePathNodes[$routeParams.modelId]) {\n            initRoutePath(resourceUIService.rootModel, $scope.routePaths);\n            var parentNode = $scope.routePaths[$scope.routePaths.length - 1];\n\n            for (var i in parentNode.nodes) {\n              if ($routeParams.modelId == parentNode.nodes[i].id) {\n                $scope.treeAry = parentNode.nodes;\n                break;\n              }\n            }\n          } else {\n            $scope.treeAry = resourceUIService.rootModel.nodes;\n          }\n        } else {\n          $scope.treeAry = resourceUIService.rootModel.nodes;\n        }\n      }\n    }\n\n    ;\n    $scope.modelListSelect = \"\"; //查询所有的设备模板\n\n    var modelList = function modelList() {\n      resourceUIService.getModels(function (returnObj) {\n        if (returnObj.code == 0) {\n          $scope.modelListSelect = returnObj.data;\n          handler(returnObj);\n        }\n      });\n    };\n\n    $scope.devicesContractList = [];\n\n    $scope.changeDevices = function () {\n      var devicesId = $scope.selected.devicesId;\n\n      for (var b in $scope.facilitySelList) {\n        if ($scope.facilitySelList[b].id == devicesId) {\n          $scope.selectedContactDevices.push($scope.facilitySelList[b]);\n          $scope.facilitySelList.splice(b, 1);\n          break;\n        }\n      } // $scope.selectedContactDevices = returnObj.data;\n\n\n      $scope.$broadcast(Event.SELDEVICEINIT, {\n        \"option\": [$scope.selectedContactDevices]\n      });\n      growl.warning(\"记得点击保存按钮，要不然不会生效哦！\", {});\n    };\n\n    var romverDevice = function romverDevice() {\n      var contact = $scope.contactList; //获取已经存在的所有设备\n\n      var dev = $scope.selectedContactDevices; //现在保存的\n\n      var arr = [];\n\n      for (var i in contact) {\n        var tmp = -1;\n        var obj = {};\n\n        for (var j in dev) {\n          if (contact[i].deviceId != dev[j].id && $scope.selectedContactObj[dev[j].id]) {\n            tmp = j;\n            break;\n          }\n        }\n\n        if (tmp != -1) {\n          arr.push(contact[i]);\n        }\n      }\n\n      console.dir(arr);\n\n      if ($scope.selectedContactDevices.length <= 0 && contact.length > 0) {\n        arr = contact;\n      }\n\n      if (arr.length > 0) {\n        for (var k in arr) {\n          customerProjectUIService.deleteContractTermsToDevice(arr[k].id, function (returnObj) {\n            if (returnObj.code == 0) {}\n          });\n        }\n      }\n    }; //点击选择设备之后保存设备\n\n\n    $scope.saveselDevices = function () {\n      $scope.selDevices = [];\n      var dev = $scope.selectedContactDevices;\n\n      for (var j in dev) {\n        if ($scope.selectedContactObj[dev[j].id] == undefined) {\n          $scope.selDevices.push(dev[j].id);\n        }\n      }\n\n      var arr = [];\n      arr = [$scope.selected.id, $scope.selDevices];\n\n      if ($scope.selDevices.length > 0) {\n        customerProjectUIService.saveContractTermsToDevice(arr, function (returnObj) {\n          if (returnObj.code == 0) {\n            growl.success(\"添加设备到合同条款成功\", {});\n            romverDevice(); // getByContractTermsId($scope.selected.id);\n            // $scope.facilitySelList = [];\n            // ngDialog.close();\n          }\n        });\n      } else {\n        // growl.warning(\"您没有新添加的设备，赶紧加一个新设备吧！\", {});\n        romverDevice();\n      }\n    }; //搜索设备\n\n\n    $scope.facilityList = [];\n    $scope.facilitySelList = [];\n    $scope.facilitySelObj = {};\n\n    $scope.searchDevices = function () {\n      // $scope.ifshow = 1001;\n\n      /* if(!$scope.queryDitem) {\n         $scope.queryDitem = {\n           custermerId: null,\n           domainPath: null,\n           sn: null,\n           modelId: null\n         };\n       }*/\n      $scope.facilitySelObj = {};\n      resourceUIService.getDevicesByCondition({}, function (res) {\n        if (res.code == 0) {\n          $scope.facilityList = res.data; //          $scope.facilitySelList = res.data;\n\n          for (var i in res.data) {\n            $scope.facilitySelObj[res.data[i].id] = res.data[i];\n          }\n          /* for(var i in faciList) {\n             var index = -1;\n             faciList[i][\"check\"] = \"\";\n             for(var j in $scope.selectedContactDevices) {\n               if($scope.selectedContactDevices[j].deviceId == faciList[i].id) {\n                 index = j;\n               }\n             }\n             if(index == -1) {\n               $scope.facilityList.push(faciList[i]);\n             }\n           }*/\n          // $scope.$broadcast(Event.SELDEVICEINIT + \"_faciDivice\", $scope.facilityList);\n\n        }\n      });\n    }; //=========================   end devices   ========================\n    //获取客户\n\n\n    (function () {\n      customerUIService.findCustomersByCondition({}, function (returnObj) {\n        if (returnObj.code == 0) {\n          var newObj = [];\n          $scope.customersObj = {};\n          returnObj.data.forEach(function (obj) {\n            $scope.customersObj[obj.id] = obj;\n            obj.text = obj.customerName;\n            obj.id = obj.id;\n            newObj.push(obj);\n          });\n          $scope.CustomerList = newObj;\n          $scope.selectedDitem.customerList = returnObj.data;\n        }\n      });\n    })();\n\n    $scope.projectObj = {}; //获取所有项目\n\n    function getAllProjects() {\n      customerProjectUIService.getAllProjects(function (returnObj) {\n        if (returnObj.code == 0) {\n          $scope.projectLists = returnObj.data;\n          returnObj.data.forEach(function (item) {\n            $scope.projectObj[item.id] = item;\n          });\n        }\n      });\n    }\n\n    ; //通过客户过滤项目\n\n    $scope.getselectedProject = function (customerId) {\n      $scope.selectedDitem.projectLists = [];\n      var arr = [];\n\n      if (!customerId) {\n        return;\n      } else {\n        for (var i in $scope.projectLists) {\n          var projectObj = $scope.projectLists[i];\n\n          if (projectObj.customerId == customerId) {\n            arr.push(projectObj);\n          }\n        }\n\n        if (!$scope.conItem.customerId) {\n          return arr;\n        } else {\n          $scope.selectedDitem.projectLists = arr;\n        }\n      }\n    };\n\n    $scope.alertFunCustom = function () {\n      var name = '';\n      var id = $scope.customor.id;\n      $scope.selTableProject = $scope.getselectedProject(id);\n\n      for (var k in $scope.CustomerList) {\n        if ($scope.CustomerList[k].customerID == id) {\n          name = $scope.CustomerList[k].customerName;\n        }\n      }\n\n      for (var i in $scope.contectLists) {\n        if ($scope.contectLists[i].isEdit == 2) {\n          $scope.contectLists[i].customerName = name;\n          $scope.contectLists[i].customerId = parseInt(id);\n          break;\n        }\n      }\n    };\n\n    $scope.alertFunProId = function (id) {\n      var proname = '';\n\n      for (var i in $scope.selTableProject) {\n        if ($scope.selTableProject[i].id == id) {\n          proname = $scope.selTableProject[i].label;\n        }\n      }\n\n      for (var j in $scope.contectLists) {\n        if ($scope.contectLists[j].isEdit == 2) {\n          $scope.contectLists[j].projectName = proname;\n          $scope.contectLists[j].projectId = id;\n          break;\n        }\n      }\n    };\n\n    $scope.cancelData = function () {\n      if ($routeParams.customerId || $routeParams.deviceId || $routeParams.contractId) {\n        return;\n      } else {\n        initHistory(); // $scope.ifshowTable = false;\n      }\n    }; // 清空其他选择项\n\n\n    $scope.getChange = function () {\n      if ($scope.queryState == 1) {\n        $scope.conItem.projectId = \"\";\n        $scope.conItem.label = \"\";\n      } else if ($scope.queryState == 2) {\n        $scope.conItem.customerId = \"\";\n        $scope.conItem.label = \"\";\n      } else if ($scope.queryState == 3) {\n        $scope.conItem.projectId = \"\";\n        $scope.conItem.customerId = \"\";\n      }\n    }; //查询合同条款\n\n\n    $scope.searchData = function () {\n      $scope.ifshowTable = true;\n      var param = {\n        'customerId': \"\" ? \"\" : $routeParams.customerId ? $routeParams.customerId : $scope.conItem.customerId,\n        'label': $scope.conItem.label ? $scope.conItem.label : \"\",\n        'deviceId': \"\" ? \"\" : $routeParams.deviceId ? $routeParams.deviceId : $scope.conItem.deviceId,\n        'projectId': \"\" ? \"\" : $routeParams.contractId ? $routeParams.contractId : $scope.conItem.projectId,\n        'size': 5000\n      };\n      customerProjectUIService.findContractTerms(param, function (returnObj) {\n        if (returnObj.code == 0) {\n          if (jQuery(\"#contectcollapse\").find(\".fa.fa-plus\").length > 0) {\n            jQuery.AdminLTE.boxWidget.collapse(jQuery(\"#contectcollapse\"));\n          }\n\n          for (var i in returnObj.data) {\n            returnObj.data[i].isEdit = 0;\n          }\n\n          $scope.contectLists = returnObj.data;\n          $timeout(function () {\n            $scope.$broadcast(Event.CONTECTITEMSINIT, {\n              \"option\": [returnObj.data]\n            });\n          });\n        }\n      });\n    };\n\n    var init = function init() {\n      initHistory(); // customerListInit();\n\n      getAllProjects();\n      domainTreeQuery();\n      $scope.clearSearchDevices();\n      resourceUIService.getRootModel(function (returnObj) {\n        if (returnObj.code == 0) {\n          resourceUIService.rootModel = returnObj.data;\n          $scope.routePaths.push(returnObj.data);\n          modelList();\n        }\n      });\n      $scope.searchDevices();\n\n      if ($routeParams.customerId || $routeParams.deviceId || $routeParams.contractId) {\n        $scope.ifAdd = 2010;\n        $scope.searchData();\n      } else {\n        $scope.ifAdd = 0;\n        $scope.searchData();\n        $timeout(function () {\n          $scope.$broadcast(Event.CONTECTITEMSINIT, {\n            \"option\": []\n          });\n        });\n      }\n    };\n    /**\n     * 监听登录状态\n     */\n\n\n    if (!userLoginUIService.user.isAuthenticated) {\n      $scope.$on('loginStatusChanged', function (evt, d) {\n        if (userLoginUIService.user.isAuthenticated) {\n          init();\n        }\n      });\n    } else {\n      init();\n    }\n  }]); //项目管理\n\n  controllers.initController('projectManagementCtrl', ['$scope', 'resourceUIService', 'customerProjectUIService', 'distributorUIService', 'userDomainService', 'projectUIService', 'ngDialog', '$location', '$routeParams', '$timeout', 'customerUIService', 'userLoginUIService', 'Info', 'growl', function ($scope, resourceUIService, customerProjectUIService, distributorUIService, userDomainService, projectUIService, ngDialog, $location, $routeParams, $timeout, customerUIService, userLoginUIService, Info, growl) {\n    var routeParamsObj = null;\n    $scope.provinces = $scope.$parent.provinces;\n    $scope.cityDics = $scope.$parent.cityDics;\n    $scope.districtDics = $scope.$parent.districtDics;\n    $scope.projectItem = {\n      \"orCondition\": \"\",\n      \"id\": \"\",\n      \"customerId\": 0,\n      //客户id\n      \"domainPath\": \"\",\n      //客户归属\n      \"distributorId\": 0,\n      //经销商id\n      \"projectName\": \"\" //项目名称\n\n    }; //查询/展示字段\n\n    function initHistory() {\n      $scope.projectInfo = {\n        \"id\": 0,\n        \"province\": \"\",\n        \"city\": \"\",\n        \"county\": \"\",\n        \"values\": {},\n        \"projectAddress\": \"\",\n        //项目地址\n        \"customerId\": \"\",\n        //客户id\n        \"installDate\": \"\",\n        //安装日期\n        \"domainPath\": null,\n        //客户归属\n        \"debugFinishDate\": \"\",\n        //调试完成日期\n        \"distributorId\": \"\",\n        //经销商id\n        \"projectName\": \"\",\n        //项目名称\n        \"qualityCloseDate\": \"\",\n        //质保截止日期\n        \"risingTime\": new Date()\n      };\n      $scope.selEditInfo = {\n        \"domainPath\": \"\",\n        //客户归属\n        \"customerId\": \"\",\n        //客户id\n        \"distributorId\": \"\" //经销商id\n\n      };\n    }\n\n    ;\n    $scope.show = {\n      //判断显示隐藏\n      customer: true,\n      distributor: true\n    };\n\n    if ($routeParams.customerId || $routeParams.distributorId || $routeParams.projectId) {\n      $scope.ifShowSelect = false;\n    } else {\n      $scope.ifShowSelect = true;\n    }\n\n    if ($routeParams.customerId) {\n      $scope.show.customer = false;\n      $scope.show.distributor = true;\n      $scope.projectItem.customerId = parseInt($routeParams.customerId);\n      $scope.queryLabel = '客户名称';\n      $scope.queryState = 2;\n    } else if ($routeParams.distributorId) {\n      $scope.show.distributor = false;\n      $scope.show.customer = true;\n      $scope.projectItem.distributorId = parseInt($routeParams.distributorId);\n      $scope.queryLabel = '经销商名称';\n      $scope.queryState = 3;\n    }\n\n    $scope.selectedProject = true; //是否有已选中的项目\n\n    $scope.projectLists = []; //存储项目，用于添加\n\n    $scope.ifshowTable = false; //false 为关闭table，true为显示\n\n    $scope.selCustomer = ''; //选中的客户id\n\n    $scope.customerDic = {}; // 客户\n\n    $scope.distributorDic = {}; //经销商\n\n    var showIndex = 0; //确定执行时间\n    //弹出框的关闭事件\n\n    $scope.closeDialog = function () {\n      ngDialog.close();\n    };\n\n    $scope.cancelData = function () {\n      if ($routeParams.customerId || $routeParams.deviceId || $routeParams.projectId) {\n        return;\n      } else {\n        initHistory();\n      }\n    };\n\n    $scope.closeTable = function () {\n      $scope.ifShowSelectDevice = 0;\n    };\n\n    $scope.provinceClick = function (provinceId) {\n      $scope.projectInfo.county = \"\";\n\n      if ($scope.cityDics[provinceId]) {\n        $scope.cityList = $scope.cityDics[provinceId];\n      }\n    };\n\n    $scope.cityClick = function (cityId) {\n      if ($scope.districtDics[cityId]) {\n        $scope.districtList = $scope.districtDics[cityId];\n      }\n    };\n\n    var getprojectList = function getprojectList(item) {\n      $scope.$broadcast(Event.PROJECTMANAGEINIT, {\n        \"option\": [item, $scope.extendTableColumns]\n      });\n    }; //过滤由于添加信息后未删除的空项 || 删除与id相同的项\n\n\n    function filterBlankOrDelete(obj, id) {\n      for (var i in obj) {\n        if (id) {\n          if (obj[i].id == id) {\n            obj.splice(i, 1);\n          }\n        } else {\n          if (obj[i].id == 0) {\n            obj.splice(i, 1);\n          }\n        }\n      }\n    }\n\n    ; //添加项目\n\n    $scope.addproject = function () {\n      $scope.provinces = $scope.$parent.provinces;\n      $scope.cityDics = $scope.$parent.cityDics;\n      $scope.districtDics = $scope.$parent.districtDics;\n      initHistory(); // if ($routeParams.customerId) {\n      //   $scope.projectInfo.domainPath = $scope.customerDic[$routeParams.customerId].domainPath;\n      //   $scope.projectInfo.customerId = parseInt($routeParams.customerId);\n      // } else if ($routeParams.distributorId) {\n      //   $scope.projectInfo.distributorId = parseInt($routeParams.distributorId);\n      // }\n\n      ngDialog.open({\n        template: '../partials/dialogue/project_management_dia.html',\n        className: 'ngdialog-theme-plain',\n        scope: $scope\n      });\n    };\n\n    $scope.saveData = function () {\n      var projectInfo = $scope.projectInfo;\n      projectInfo.qualityCloseDate = new Date(projectInfo.qualityCloseDate);\n      projectInfo.debugFinishDate = new Date(projectInfo.debugFinishDate);\n      projectInfo.installDate = new Date(projectInfo.installDate);\n      projectInfo.values.standardAddress = projectInfo.county ? projectInfo.county : projectInfo.city ? projectInfo.city : projectInfo.province;\n\n      if (projectInfo.debugFinishDate < projectInfo.installDate) {\n        growl.warning(\"调试完成时间需大于项目安装时间\", {});\n        return;\n      }\n\n      if (projectInfo.qualityCloseDate < projectInfo.installDate) {\n        growl.warning(\"质保截止时间需大于项目安装时间\", {});\n        return;\n      }\n\n      if (projectInfo.qualityCloseDate < projectInfo.debugFinishDate) {\n        growl.warning(\"质保截止时间需大于调试完成时间\", {});\n        return;\n      }\n\n      if (projectInfo.projectAddress == undefined) {\n        growl.warning(\"详细地址输入格式不正确，请重新输入\", {});\n        return;\n      }\n\n      if (projectInfo.id > 0) {\n        getAddressPoint(projectInfo, function (projectInfo) {\n          projectUIService.updateProject(projectInfo, function (returnObj) {\n            if (returnObj.code == 0) {\n              growl.success(\"项目信息修改完成\", {});\n              var projectLists = $scope.projectLists;\n\n              for (var i in projectLists) {\n                if (projectLists[i].id == projectInfo.id) {\n                  $.extend(projectLists[i], projectInfo);\n                  break;\n                }\n              }\n\n              $timeout(function () {\n                getprojectList($scope.projectLists);\n              });\n              ngDialog.close();\n            }\n          });\n        });\n      } else if (projectInfo.id == 0) {\n        getAddressPoint(projectInfo, function (projectInfo) {\n          projectUIService.addProject(projectInfo, function (returnObj) {\n            if (returnObj.code == 0) {\n              growl.success(\"项目信息创建成功\", {}); // returnObj.data.isEdit = 0;\n\n              $scope.projectLists.push(returnObj.data);\n              $timeout(function () {\n                getprojectList($scope.projectLists);\n              });\n              ngDialog.close();\n            }\n          });\n        });\n      }\n    };\n\n    $scope.doAction = function (type, select, callback) {\n      if (type == \"cancel\") {\n        for (var i = $scope.projectLists.length - 1; i > -1; i--) {\n          if ($scope.projectLists[i].id == 0) {\n            $scope.projectLists.splice(i, 1);\n          }\n        }\n\n        getprojectList($scope.projectLists);\n      } else if (type == \"saveProject\") {\n        //        filterBlankOrDelete($scope.projectLists);\n        if (select != \"\" && select != null) {\n          projectUIService.updateProject(select, function (returnObj) {\n            callback(returnObj);\n\n            if (returnObj.code == 0) {\n              growl.success(\"项目信息修改完成\", {});\n            }\n          });\n        }\n      } else if (type == \"deleteProject\") {\n        BootstrapDialog.show({\n          title: '提示',\n          closable: false,\n          message: '确认删除该项目记录？',\n          buttons: [{\n            label: '确定',\n            cssClass: 'btn-success',\n            action: function action(dialogRef) {\n              projectUIService.deleteProjectById(select.id, function (returnObj) {\n                if (returnObj.code == 0) {\n                  callback(returnObj.code);\n                  growl.success(\"项目信息已删除\", {});\n                  filterBlankOrDelete($scope.projectLists, select.id);\n                  return;\n                }\n              });\n              dialogRef.close();\n            }\n          }, {\n            label: '取消',\n            action: function action(dialogRef) {\n              dialogRef.close();\n            }\n          }]\n        });\n      } else if (type == \"deviceProject\") {\n        $scope.ifShowSelectDevice = 1001;\n        $scope.selProName = select.label; // getDevicesByProjectId(select.id);\n      }\n    }; //获取客户\n\n\n    function customerListInit() {\n      customerUIService.findCustomersByCondition({}, function (returnObj) {\n        if (returnObj.code == 0) {\n          showIndex++;\n          var newObj = [];\n          returnObj.data.forEach(function (obj) {\n            obj.text = obj.customerName;\n            obj.id = obj.id;\n            newObj.push(obj);\n          });\n          $scope.CustomerList = newObj;\n          $scope.customerDic = returnObj.customerDic;\n\n          if (showIndex == 3) {\n            $scope.searchData();\n          }\n        }\n      });\n    }\n\n    ; //获取经销商\n\n    function distributorListInit() {\n      distributorUIService.findDistributorsByCondition({}, function (returnObj) {\n        if (returnObj.code == 0) {\n          var newObj = [];\n          returnObj.data.forEach(function (obj) {\n            $scope.distributorDic[obj.id] = obj;\n            obj.text = obj.distributorName;\n            obj.id = obj.id;\n            newObj.push(obj);\n          });\n          $scope.distributorList = newObj.concat({\n            text: '无',\n            id: -1\n          });\n        }\n      });\n    }\n\n    ;\n    $scope.modelListSelect = []; //查询所有的设备模板\n\n    var modelList = function modelList() {\n      resourceUIService.getModels(function (returnObj) {\n        if (returnObj.code == 0) {\n          $scope.modelListSelect = returnObj.data;\n        }\n      });\n    };\n\n    $scope.alertFun = function (time) {\n      if ($scope.projectInfo.debugFinishDate) {\n        var date = new Date($scope.projectInfo.debugFinishDate);\n        var qualityCloseDate = date.setFullYear(date.getFullYear() + 1);\n        var newDate = new Date(qualityCloseDate).Format(\"yyyy-MM-dd\");\n        $scope.projectInfo.qualityCloseDate = newDate;\n      }\n    }; // 清空其他选择项\n\n\n    $scope.getChange = function () {\n      $scope.projectItem.orCondition = !$scope.queryState ? $scope.projectItem.orCondition : null;\n      $scope.projectItem.projectName = $scope.queryState == 1 ? $scope.projectItem.projectName : null;\n      $scope.projectItem.customerId = $scope.queryState == 2 ? $scope.projectItem.customerId : null;\n      $scope.projectItem.distributorId = $scope.queryState == 3 ? $scope.projectItem.distributorId : null;\n      $scope.projectItem.domainPath = $scope.queryState == 4 ? $scope.projectItem.domainPath : null;\n    };\n\n    $scope.searchData = function () {\n      var param = {\n        \"orCondition\": \"\" ? \"\" : $scope.projectItem.orCondition,\n        'customerId': \"\" ? \"\" : $scope.projectItem.customerId ? $scope.projectItem.customerId : $routeParams.customerId,\n        'domainPath': \"\" ? \"\" : $scope.projectItem.domainPath,\n        'distributorId': \"\" ? \"\" : $scope.projectItem.distributorId ? $scope.projectItem.distributorId : $routeParams.distributorId,\n        'id': \"\" ? \"\" : parseInt($routeParams.projectId) ? parseInt($routeParams.projectId) : $scope.projectItem.id,\n        'projectName': \"\" ? \"\" : $scope.projectItem.projectName\n      };\n      projectUIService.findProjectsByCondition(param, function (returnObj) {\n        if (returnObj.code == 0) {\n          $scope.projectLists = returnObj.data;\n          $timeout(function () {\n            getprojectList($scope.projectLists);\n          });\n        }\n      });\n    }; //根据用户Id查用户域\n\n\n    var domainTreeQuery = function domainTreeQuery() {\n      userDomainService.queryDomainTree(userLoginUIService.user.userID, function (data) {\n        showIndex++;\n        $scope.domainListTree = data.domainListTree;\n        $scope.domainListDic = data.domainListDic;\n\n        if (showIndex == 3) {\n          $scope.searchData();\n        }\n      });\n    };\n\n    $scope.extendTableColumns = [];\n\n    var getExtendContent = function getExtendContent() {\n      if (!$scope.menuitems[\"isloaded\"]) {\n        var menuitemsWatch = $scope.$watch('menuitems', function (o, n) {\n          if ($scope.menuitems[\"isloaded\"]) {\n            if ($scope.baseConfig && $scope.baseConfig.projectConfig && $scope.baseConfig.projectConfig.extendModelGroupId) {\n              resourceUIService.getAttrsByModelId($scope.baseConfig.projectConfig.extendModelGroupId, function (returnObj) {\n                if (returnObj.code == 0) $scope.extendTableColumns = returnObj.data;\n                showIndex++;\n\n                if (showIndex == 3) {\n                  $scope.searchData();\n                }\n              });\n            } else {\n              showIndex++;\n\n              if (showIndex == 3) {\n                $scope.searchData();\n              }\n            }\n\n            menuitemsWatch();\n          }\n        }, true);\n      } else {\n        if ($scope.baseConfig && $scope.baseConfig.projectConfig && $scope.baseConfig.projectConfig.extendModelGroupId) {\n          resourceUIService.getAttrsByModelId($scope.baseConfig.projectConfig.extendModelGroupId, function (returnObj) {\n            if (returnObj.code == 0) $scope.extendTableColumns = returnObj.data;\n            showIndex++;\n\n            if (showIndex == 3) {\n              $scope.searchData();\n            }\n          });\n        } else {\n          showIndex++;\n\n          if (showIndex == 3) {\n            $scope.searchData();\n          }\n        }\n      }\n    };\n\n    var init = function init() {\n      initHistory();\n      distributorListInit();\n      modelList();\n      customerListInit();\n      domainTreeQuery();\n      getExtendContent();\n    };\n\n    var getAddressPoint = function getAddressPoint(inputObj, callbackFun) {\n      inputObj.values.latitude = \"\";\n      inputObj.values.longitude = \"\";\n      userLoginUIService.getAddressPoint(inputObj.values.standardAddress.split(\",\").join(\"\") + inputObj.projectAddress, function (address) {\n        inputObj.values.latitude = address.location.lat.toFixed(6);\n        inputObj.values.longitude = address.location.lng.toFixed(6);\n\n        if (callbackFun) {\n          callbackFun(inputObj);\n        }\n      });\n    };\n    /**\n     * 监听登录状态\n     */\n\n\n    if (!userLoginUIService.user.isAuthenticated) {\n      $scope.$on('loginStatusChanged', function (evt, d) {\n        if (userLoginUIService.user.isAuthenticated) {\n          init();\n        }\n      });\n    } else {\n      init();\n    }\n  }]); //故障知识\n\n  controllers.initController('faultKnowledgeCtrl', ['$scope', 'faultKnowledgeUIService', 'ngDialog', '$location', '$routeParams', '$timeout', 'userEnterpriseService', 'userLoginUIService', 'Info', 'growl', function ($scope, faultKnowledgeUIService, ngDialog, $location, $routeParams, $timeout, userEnterpriseService, userLoginUIService, Info, growl) {\n    $scope.selecteditem = true; //是否有已选中的故障知识\n\n    $scope.faultKnowledgeLists = []; //存储故障知识列表，用于添加\n\n    $scope.ifRouteParams = 0; //是否是跳转，如果是跳转隐藏添加按钮\n\n    $scope.severiesList = [{\n      \"severNo\": 1,\n      \"severName\": \"警告\"\n    }, {\n      \"severNo\": 2,\n      \"severName\": \"次要\"\n    }, {\n      \"severNo\": 3,\n      \"severName\": \"重要\"\n    }, {\n      \"severNo\": 4,\n      \"severName\": \"严重\"\n    }];\n    $scope.selSeverity = \"\"; //选择到的严重级别\n\n    $scope.alertFun = function (number) {\n      for (var i in $scope.faultKnowledgeLists) {\n        if ($scope.faultKnowledgeLists[i].isEdit == 2) {\n          $scope.faultKnowledgeLists[i].severity = number;\n        }\n      }\n    };\n\n    var getfaultKnowledgeList = function getfaultKnowledgeList(item) {\n      $scope.$broadcast(Event.FAULTKNOWLEDGEINIT, {\n        \"option\": [item]\n      });\n    }; //过滤由于添加信息后未删除的空项 || 删除与id相同的项\n\n\n    function filterBlankOrDelete(obj, id) {\n      for (var i in obj) {\n        if (id) {\n          if (obj[i].id == id) {\n            obj.splice(i, 1);\n          }\n        } else {\n          if (obj[i].id == 0) {\n            obj.splice(i, 1);\n          }\n        }\n      }\n    }\n\n    ; //添加故障知识\n\n    $scope.addFaultKnowledge = function () {\n      $scope.selSeverity = \"\";\n\n      for (var i in $scope.faultKnowledgeLists) {\n        if ($scope.faultKnowledgeLists[i].id == 0 && $scope.faultKnowledgeLists[i].isEdit == 2) {\n          //新加跳转第一项\n          getfaultKnowledgeList($scope.faultKnowledgeLists);\n          return;\n        } else if ($scope.faultKnowledgeLists[i].id != 0 && $scope.faultKnowledgeLists[i].isEdit == 2) {\n          //编辑原地不动\n          growl.warning(\"目前已存在正在编辑的故障知识\", {});\n          return;\n        }\n      }\n\n      var newObj = {\n        \"faultNo\": \"\",\n        \"category\": \"\",\n        \"label\": \"\",\n        \"desc\": \"\",\n        \"phenomenon\": \"\",\n        \"cause\": \"\",\n        \"processingMethod\": \"\",\n        \"severity\": 0,\n        'id': 0,\n        'isEdit': 2\n      };\n      $scope.faultKnowledgeLists.push(newObj);\n      getfaultKnowledgeList($scope.faultKnowledgeLists);\n    };\n\n    $scope.doAction = function (type, select, callback) {\n      if (type == \"savefaultKnowledge\") {\n        if (select != \"\" && select != null) {\n          faultKnowledgeUIService.saveFaultKnowledge(select, function (returnObj) {\n            if (returnObj.code == 0) {\n              callback(returnObj.data);\n              growl.success(\"已成功保存故障知识\", {});\n            }\n          });\n        }\n      } else if (type == \"deletefaultKnowledge\") {\n        BootstrapDialog.show({\n          title: '提示',\n          closable: false,\n          message: '确定删除此故障知识吗？',\n          buttons: [{\n            label: '确定',\n            cssClass: 'btn-success',\n            action: function action(dialogRef) {\n              faultKnowledgeUIService.deleteFaultKnowledge(select.id, function (returnObj) {\n                if (returnObj.code == 0) {\n                  callback(returnObj.code);\n                  growl.success(\"成功删除此故障知识\", {});\n                  filterBlankOrDelete($scope.faultKnowledgeLists, select.id);\n                }\n              });\n              dialogRef.close();\n            }\n          }, {\n            label: '取消',\n            action: function action(dialogRef) {\n              dialogRef.close();\n            }\n          }]\n        });\n      } else if (type == \"cancel\") {\n        for (var i = $scope.faultKnowledgeLists.length - 1; i > -1; i--) {\n          if ($scope.faultKnowledgeLists[i].id == 0) {\n            $scope.faultKnowledgeLists.splice(i, 1);\n          } else {\n            $scope.faultKnowledgeLists[i][\"isEdit\"] = 0;\n          }\n        }\n\n        $scope.$broadcast(Event.FAULTKNOWLEDGEINIT, {\n          \"option\": [$scope.faultKnowledgeLists]\n        });\n      }\n    }; //获取故障知识\n\n\n    function getfaultKnowledges(id) {\n      if (!id) {\n        //获取所有\n        faultKnowledgeUIService.getAllFaultKnowledges(function (returnObj) {\n          if (returnObj.code == 0) {\n            $scope.faultKnowledgeLists = [];\n\n            for (var i in returnObj.data) {\n              var obj = returnObj.data[i];\n              obj.isEdit = 0;\n              $scope.faultKnowledgeLists.push(obj);\n            }\n\n            $scope.$broadcast(Event.FAULTKNOWLEDGEINIT, {\n              \"option\": [$scope.faultKnowledgeLists]\n            });\n          }\n        });\n      } else {\n        faultKnowledgeUIService.getByFaultNo(id, function (returnObj) {\n          if (returnObj.code == 0) {\n            $scope.faultKnowledgeLists = [];\n\n            if (isArray(returnObj.data)) {\n              $scope.faultKnowledgeLists = returnObj.data;\n            } else {\n              $scope.faultKnowledgeLists.push(returnObj.data);\n            }\n\n            $scope.$broadcast(Event.FAULTKNOWLEDGEINIT, {\n              \"option\": [$scope.faultKnowledgeLists]\n            });\n          }\n        });\n      }\n    }\n\n    if ($routeParams.faultNo) {\n      $scope.ifRouteParams = 2011;\n      getfaultKnowledges($routeParams.faultNo);\n    } else {\n      getfaultKnowledges();\n    }\n  }]);\n});"],"sourceRoot":"/source/"}