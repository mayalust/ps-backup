{"version":3,"sources":["app-oc/js/controllers/user-list-ctrl.js"],"names":["define","controllers","initController","scope","$state","rootScope","routeParams","location","ngDialog","configUIService","resourceUIService","userInitService","userLoginUIService","userEnterpriseService","userUIService","growl","userRoleUIService","userFunctionService","userDomainService","cmd","TEXT","cache","navigateTo","panel","path","cancelClick","row","source","i","userlist","setWholeDisabled","disabled","isEdit","renderUserList","domainlist","domaintree","enterpriseUsers","ifShow","userTypeList","queryAllRoles","allRolesData","allRolesDataDic","userList","saveClick","cached","userName","officePhone","domainID","oldUser","$clone","modifyUser","event","code","data","success","deleteClick","fnlist","label","icon","style","width","border-radius","font-size","font-weight","padding","fn","close","deleteUser","userID","remove","dialog","title","description","open","template","className","userEditClick","specialtyProps","getRootScope","find","length","elem","typeCode","arr","$","extend","concat","modelId","name","closingDate","Date","toISOString","replace","userType","clone","namelist","filter","map","loginlist","loginName","fd","item","userSelf","user","userInfo","apply","undefined","value","right","type","composory","options","events","change","error","fdname","param","layer","getDomainsByFilter","returnObj","findval","domainPath","subDomain","id","input","key","mark","baseConfig","extendDomain","forEach","maxlength","indexOf","test","blur","checkLoginName","e","split","specialties","ele","push","format","Format","resetdis","newData","ckTime","checkDate","reset","placeholder","valid","checkValidmobile","button","disabledFn","every","rs","match","errorStatus","self","obj","loop","substring","lastIndexOf","args","slice","call","arguments","start","shift","exec","addNewClick","emaillist","emailAddress","mobilelist","mobilePhone","$$","duplicateName","checkDisabled","target","currentType","toString","userTypeFilter","menuitems","val","note","message","emailReg","numReg","domain","role","newUser","roleID","status","domains","enterpriseUserRegister","queryRoleByUser","roles","pushbefore","warning","assignCharacter","list","inx","assignRole","allLoaded","finished","roleArr","some","applied","titles","characters","rls","complete","rem","tmp","j","removeRole","res","join","cacheAsyncData","traverse","selected","appendRole","_error","queryEnterpriseRole","eventAllRoles","roleName","search","roleList","el","setEnable","callback","editableUser","users","enableUsers","removeAllChecked","msg","successObj","failObj","setEnableGroupClick","setEnableClick","setDisable","diseditableUser","disableUsers","info","setDisableGroupClick","setDisableClick","assignCharacterClick","allDomain","allDomainDic","defaultDeviceIds","allDomainTree","accredit","all","check","allDevice","domainAllot","window","href","defaultDomainAction","select","domainObj","domainIds","domainList","selDomainPath","domainPathStr","splice","jQuery","inArray","domainIdsAllot","devices","deviceIds","deviceDomainId","queryDevice","department","selecedDeviceStr","queryUserDeviceByDeviceDomains","resultObj","deviceId","getDevicesByCondition","customNameArr","getdomainNameHandler","customName","resetPwd","sendModifyPassword","loadedCount","userListHandler","roleId","headerArr","optList","class","margin","click","visible","defs","editable","sortable","filterable","modes","default","edit","filterFormat","col","cursor","header","columnDefs","getExtendDomainsByFilter","domainListDic","nodes","domainInfos","allDomainInit","getConfigsByGroupName","JSON","parse","queryUserByCondition","renderRoleList","checkRole","str","permissionAssignment","currentRole","k","removeUser","appendUser","_error2","getAssociateRole2User","associateRole2User","editClick","onChange","oldRole","modifyRole","newRole","addRole","deleteGroupClick","roleIChecked","delectRole","deleteRole","queryEnterpriseRole_back","n","removeEmpty","roleHeader","roleOption","checked","rowclass","init","isAuthenticated","$on","evt","d"],"mappings":"AAAAA,OAAO,CAAC,0BAA2B,SAAU,SAAUC,GACrD,aAEAA,EAAYC,eAAe,eAAgB,CAAC,SAAU,SAAU,aAAc,eAAgB,YAAa,WAAY,kBAAmB,oBAAqB,kBAAmB,qBAAsB,wBAAyB,gBAAiB,QAAS,oBAAqB,sBAAuB,oBAAqB,sBAAuB,SAAUC,EAAOC,EAAQC,EAAWC,EAAaC,EAAUC,EAAUC,EAAiBC,EAAmBC,EAAiBC,EAAoBC,EAAuBC,EAAeC,EAAOC,EAAmBC,EAAqBC,EAAmBC,GACvkB,IAAIC,EACQ,KADRA,EAEQ,KAEZjB,EAAMkB,MAAQ,GAEdlB,EAAMmB,WAAa,SAAUC,GAC3BhB,EAASiB,KAAK,eAAiBD,IAGjCpB,EAAMoB,MAAQjB,EAAYiB,MAAQjB,EAAYiB,MAAQ,OAgBtD,IAiBIE,EAAc,SAAqBC,EAAKC,GAG1C,IAAK,IAAIC,KAFTzB,EAAM0B,SAASC,kBAAiB,GAElBH,EACZA,EAAOC,GAAGG,UAAW,EAGvBL,EAAIM,OAAS,WAGXC,EAAiB,WACnB,IAAIC,EACAC,EACAC,EACAC,EACAC,EAAe,GACfC,EAAgB,GAChBC,EAAe,GACfC,EAAkB,GAClBC,EAAW,GAEXC,EAAY,SAAmBjB,EAAKC,GACtC,IAAIiB,EAASlB,EAAIkB,OACbC,EAAWD,EAAOC,SAClBC,EAAcF,EAAOE,YACrBC,EAAWH,EAAOG,SAGtB,IAAK,IAAInB,KAFTzB,EAAM0B,SAASC,kBAAiB,GAElBH,EACZA,EAAOC,GAAGG,UAAW,EAGvBL,EAAIM,OAAS,iBACNN,EAAIkB,OACX,IAAII,EAAUtB,EAAIuB,SAClBD,EAAQH,SAAWA,EACnBG,EAAQF,YAAcA,EACtBE,EAAQD,SAAWA,EAWnBjC,EAAcoC,WAAWF,EATC,SAA6BG,GACnC,GAAdA,EAAMC,OACR1B,EAAImB,SAAWM,EAAME,KAAKR,SAC1BnB,EAAIoB,YAAcK,EAAME,KAAKP,YAC7BpB,EAAIqB,SAAWI,EAAME,KAAKN,SAC1BhC,EAAMuC,QAAQ,SAAU,QAO1BC,EAAc,SAAqB7B,EAAKC,GAC1C,IAAI6B,EAAS,CAAC,CACZC,MAAOrC,EACPsC,KAAM,kBACNC,MAAO,CACLC,MAAS,MACTC,gBAAiB,EACjBC,YAAa,OACbC,cAAe,OACfC,QAAW,IAEbC,GAAI,WACFzD,EAAS0D,QACTpD,EAAcqD,WAAWzC,EAAI0C,OAAQ,SAAUjB,GAC3B,GAAdA,EAAMC,OACR1B,EAAI2C,SACJtD,EAAMuC,QAAQ,UAAW,SAI9B,CACDG,MAAOrC,EACPsC,KAAM,kBACNC,MAAO,CACLC,MAAS,MACTC,gBAAiB,EACjBC,YAAa,OACbC,cAAe,OACfC,QAAW,IAEbC,GAAI,WACFzD,EAAS0D,WAGb/D,EAAMmE,OAAS,CACbC,MAAO,CACLd,MAAO,MAETe,YAAa,CACXf,MAAO,cAETD,OAAQA,GAEVhD,EAASiE,KAAK,CACZC,SAAU,8CACVC,UAAW,uBACXxE,MAAOA,KAIPyE,EAAgB,SAAuBlD,EAAKC,GAE9C,IACIkD,GADS,IAAI1D,GACW2D,aAAa,WAAW,eAChDC,GAAO,EAEe,EAAtBzC,EAAa0C,SACfD,EAAOzC,EAAayC,KAAK,SAAUE,GACjC,OAAwB,IAAjBA,EAAKC,YAIhB,IAAIC,EAAM,GACVC,EAAEC,OAAOF,EAAK7C,GAETyC,IACHI,EAAMA,EAAIG,OAAO,CAAC,CAChBC,QAAS,IACT9B,MAAO,QACPyB,SAAU,GACVM,KAAM,UAIN9D,EAAI+D,cACN/D,EAAI+D,YAAc,IAAIC,KAAKhE,EAAI+D,aAAaE,cAAcC,QAAQ,KAAM,KAAKA,QAAQ,aAAc,KAGrG,IAWIL,EAASM,EAXTC,EAAQpE,EAAIuB,SACZ8C,EAAW3D,EAAgB4D,OAAO,SAAUf,GAC9C,OAAOA,EAAKpC,UAAYnB,EAAImB,WAC3BoD,IAAI,SAAUhB,GACf,OAAOA,EAAKpC,WAEVqD,EAAY9D,EAAgB4D,OAAO,SAAUf,GAC/C,OAAOA,EAAKkB,WAAazE,EAAIyE,YAC5BF,IAAI,SAAUhB,GACf,OAAOA,EAAKkB,YAId,GAAI9D,EAAQ,CACV,IAAI+D,EAAKjB,EAAIJ,KAAK,SAAUsB,GAC1B,OAAOP,EAAMD,UAAYQ,EAAKnB,WAG5BkB,IACFb,EAAUa,EAAGb,SAGfM,EAAWC,EAAMD,SAAWV,EAAIJ,KAAK,SAAUsB,GAC7C,OAAOP,EAAMD,UAAYQ,EAAKnB,WAIlC,IAAIoB,GAAW,EAEXR,EAAM1B,QAAUxD,EAAmB2F,KAAKnC,SAC1CkC,GAAW,GAGb,IAAIE,EAAW,CACbC,QAAoB,KAAXlB,GAAoC,IAAlBO,EAAMD,UAAoC,GAAlBC,EAAMD,UAAmCa,MAAlBZ,EAAMD,WAA0BxD,GAC1GsE,MAAS,GACTlD,MAAS,GACTmD,OAAS,EACTvD,KAAQ,YACRwD,KAAQ,SACRC,WAAa,EACbC,QAAW,GACXC,OAAU,CACRC,OAAU,SAAgB5D,GACNqD,MAAdrD,EAAKsD,OACPtD,EAAK6D,MAAQV,EAAS/C,MAAQ,OAC9BJ,EAAKuD,OAAQ,IAEbvD,EAAK6D,WAAQR,EACbrD,EAAKuD,OAAQ,MAMrB,GAAe,KAAXrB,GAAkBlD,EAAQ,CAC5B,IAAI8E,EAAShC,EAAIJ,KAAK,SAAUsB,GAC9B,QAAIR,GACKQ,EAAKnB,UAAYY,EAAMD,SAASX,WAO3CsB,EAAS/C,MAAQ0D,EAASA,EAAO3B,KAAO,GACxC,IAAI4B,EAAQ,CACV7B,QAAWM,EAAWA,EAASN,aAAUmB,EACzCW,MAASxB,EAAWC,EAAMD,SAASwB,MAAQ,IAE7C3G,EAAkB4G,mBAAmBF,EAAO,SAAUG,GAC9B,GAAlBA,EAAUnE,OACZoD,EAASO,QAAUQ,EAAUlE,MAG/B,IAAImE,EAAUhB,EAASO,QAAQhC,KAAK,SAAUsB,GAC5C,OAAOA,EAAKoB,YAAc3B,EAAM4B,YAG9BF,IACFhB,EAASG,MAAQa,EAAQG,MAK/BxH,EAAMmE,OAAS,CACbC,MAAO,OACPqD,MAAO,CAAC,CACNjB,MAASb,EAAM2B,WACfhE,MAAS,MACTJ,KAAQ,WACRwD,KAAQ,OACRgB,IAAO,aACPjE,MAAS,IACTkD,WAAa,EACbF,OAAS,EACTG,QAAW5E,EACX2F,KAAQ,QACRrB,OAAS,EACT1E,SAAYuE,EACZU,OAAU,CACRC,OAAU,SAAgB5D,GACxB,GAAIhB,GAA4BqE,MAAlBZ,EAAMD,SAAuB,CACzC1F,EAAMmE,OAAOsD,MAAM7C,KAAK,SAAUsB,GACf,aAAbA,EAAKhD,OACPgD,EAAKM,MAAQ,GACbN,EAAKO,OAAQ,KAGjB,IAAIQ,EAAQ,CACVK,WAAcpE,EAAKsD,MACnBpB,QAAWO,EAAMD,SAASN,QAC1B8B,MAASvB,EAAMD,SAASwB,OAE1B3G,EAAkB4G,mBAAmBF,EAAO,SAAUG,GAC9B,GAAlBA,EAAUnE,OACZoD,EAASO,QAAUQ,EAAUlE,QAK9BA,EAAKsD,OAIRtD,EAAK6D,WAAQR,EACbrD,EAAKuD,OAAQ,IAJbvD,EAAK6D,MAAQ,UACb7D,EAAKuD,OAAQ,MAOlB,CACDD,MAASb,EAAMD,SACfY,MAASpE,EACToB,MAAS,OACTJ,KAAQ,WACRwD,KAAQ,WACR9E,UAAY,EACZ+E,WAAa,EACbF,OAAS,EACTG,QAAW5B,EACX6B,OAAU,CACRC,OAAU,SAAgB5D,GACxB,GAAkB,KAAdA,EAAKsD,MAAc,CACrB,IAAIS,EAAQ,GAEPjH,EAAM4H,YAAe5H,EAAM4H,WAAWC,cACzC7H,EAAMmE,OAAOsD,MAAMK,QAAQ,SAAU5B,GAClB,YAAbA,EAAKhD,OACP+D,EAAMK,WAAapB,EAAKM,SAK9BS,EAAM7B,QAAUlC,EAAKsD,MACrBH,EAASC,OAAQ,EACjBD,EAASI,OAAQ,EACjBJ,EAASG,MAAQ,GACjBH,EAAS/C,MAAQJ,EAAK0D,QAAQhC,KAAK,SAAUsB,GAC3C,OAAOA,EAAKsB,IAAMtE,EAAKsD,QACtBnB,KACH9E,EAAkB4G,mBAAmBF,EAAO,SAAUG,GAC9B,GAAlBA,EAAUnE,OACZoD,EAASO,QAAUQ,EAAUlE,aAIjCmD,EAASC,OAAQ,EACjBD,EAASI,OAAQ,EAGDF,MAAdrD,EAAKsD,OACPtD,EAAK6D,MAAQ,WACb7D,EAAKuD,OAAQ,IAEbvD,EAAK6D,WAAQR,EACbrD,EAAKuD,OAAQ,MAIlBJ,EAAU,CACXC,OAAS,EACThD,MAAS,OACTkD,MAASb,EAAMjD,SACfqF,UAAa,GACb7E,KAAQ,WACRwD,KAAQ,QACRC,WAAa,EACbF,OAAS,EACTI,OAAU,CACRC,OAAU,SAAgB5D,GACN,IAAdA,EAAKsD,OACPtD,EAAK6D,MAAQ,WACb7D,EAAKuD,OAAQ,IAEwB,GAAjCb,EAASoC,QAAQ9E,EAAKsD,QACxBtD,EAAK6D,MAAQ,SACb7D,EAAKuD,OAAQ,IAEbvD,EAAK6D,WAAQR,EACbrD,EAAKuD,OAAQ,MAKpB,CACDnD,MAAS,MACTgD,OAAS,EACTE,MAASb,EAAMK,UACf+B,UAAa,GACbpB,WAAa,EACbF,OAAS,EACTI,OAAU,CACRC,OAAU,SAAgB5D,GACxB,GAAkB,IAAdA,EAAKsD,MACPtD,EAAK6D,MAAQ,UACb7D,EAAKuD,OAAQ,OAEb,IAAsC,GAAlCV,EAAUiC,QAAQ9E,EAAKsD,OACzBtD,EAAK6D,MAAQ,SACb7D,EAAKuD,OAAQ,MACR,CAGQ,mCAEFwB,KAAK/E,EAAKsD,QACnBtD,EAAK6D,WAAQR,EACbrD,EAAKuD,OAAQ,IAEbvD,EAAK6D,MAAQ,gCACb7D,EAAKuD,OAAQ,KAKrByB,KAAQ,SAAchF,GACfA,EAAKsD,QAAStD,EAAK6D,OAIpB7D,EAAKsD,OAASjF,EAAIyE,WACpBrF,EAAcwH,eAAejF,EAAKsD,MAAO,SAAUY,GAC3B,GAAlBA,EAAUnE,OACPmE,EAAUlE,MAIbA,EAAK6D,MAAQ,GACb7D,EAAKuD,OAAQ,IAJbvD,EAAK6D,MAAQ,SACb7D,EAAKuD,OAAQ,QAUzBvD,KAAQ,YACRwD,KAAQ,SACP,CACDF,MAAS,SAAU4B,GACjB,GAAIA,EAAG,CACL,IAAIpD,EAAMoD,EAAEC,MAAM,KACdC,EAAc,GAIlB,OAHAtD,EAAI8C,QAAQ,SAAUS,GACpBD,EAAYE,KAAKD,KAEZD,GAPF,CASP3C,EAAM2C,aAERhF,MAAS,KACTJ,KAAQ,cACRwD,KAAQ,WACRE,QAAWlC,EACX+D,OAAU,CACRjB,GAAI,YACJlE,MAAO,UAER,CACDA,MAAS,OACTkD,MAASb,EAAML,YAAc,IAAIC,KAAKI,EAAML,aAAaoD,OAAO,cAAgB,GAChFpC,MAASX,EAAM1B,QAAUxD,EAAmB2F,KAAKnC,OACjD8D,UAAa,GACb7E,KAAQ,cACRwD,KAAQ,OACRiC,UAAY,EACZ9B,OAAU,CACRC,OAAU,SAAgB5D,GACxB,IAAI0F,EAAU,IAAIrD,KAAKrC,EAAKsD,OAAOkC,OAAO,cACtCG,EAASC,UAAUF,GAIrB1F,EAAKuD,MAFO,GAAVoC,IACF3F,EAAK6D,MAAQ,qBAGb7D,EAAK6D,WAAQR,IAIjBwC,MAAS,SAAe7F,GACtBA,EAAKsD,MAAQ,MAGhB,CACDlD,MAAS,OACTyE,UAAa,GACbvB,MAASb,EAAMhD,YACf8D,OAAS,EACTE,WAAa,EACbzD,KAAQ,cACR8F,YAAe,qBACfnC,OAAU,CACRC,OAAU,SAAgB5D,GACxB,GAAkB,IAAdA,EAAKsD,MACPtD,EAAK6D,WAAQR,EACbrD,EAAKuD,OAAQ,MACR,CACL,IAAIwC,EAAQC,iBAAiBhG,EAAKsD,OAIhCtD,EAAKuD,MAFM,GAATwC,IACF/F,EAAK6D,MAAQ,eAGb7D,EAAK6D,WAAQR,MAMrBG,KAAQ,SACP,CACDpD,MAAS,KACTkD,MAASb,EAAMtB,YACfnB,KAAQ,cACR6E,UAAa,IACbrB,KAAQ,aAEVyC,OAAQ,CAAC,CACP7F,MAAOrC,EACPsC,KAAM,kBACN6F,WAAY,WAQV,OAPYpJ,EAAMmE,OAAOsD,MAAM4B,MAAM,SAAUvE,GAC7C,IAAIwE,EAAKxE,EAAK2B,OAAS3B,EAAK0B,OAAuBD,MAAdzB,EAAK2B,OAAoC,GAAd3B,EAAKwB,MAIrE,OAAOgD,KAIXxF,GAAI,WACF,IAkFazC,EACfkI,EAnFMC,GAAe,EAQnB,GAPAxJ,EAAMmE,OAAOsD,MAAMK,QAAQ,SAAUhD,GAC/BA,EAAKiC,QACPyC,EAAc,MAKE,GAAhBA,EAAmB,CACrB,IAAIC,EAAOzJ,EAAMmE,OAsBbtB,EAAU,GACV6G,EAAM,GAENC,EAAO,SAAc7E,GACvBjC,EAAQiC,EAAK5B,MAAQ4B,EAAK0B,MAET,YAAb1B,EAAK5B,KACPL,EAAQiC,EAAK5B,MAAQ4B,EAAK0B,MAAMoD,UAAU,EAAG9E,EAAK0B,MAAM3B,OAAS,GAAG+E,UAAU9E,EAAK0B,MAAMoD,UAAU,EAAG9E,EAAK0B,MAAM3B,OAAS,GAAGgF,YAAY,KAAO,GAC1H,aAAb/E,EAAK5B,KACVL,EAAQ0E,YACV1E,EAAQiC,EAAK5B,MAAQmD,EAASO,QAAQhC,KAAK,SAAUsB,GACnD,OAAOrD,EAAQ0E,WAAarB,EAAKsB,KAChCF,YAEiB,YAAbxC,EAAK5B,MAAsB4B,EAAK0B,MACzC3D,EAAQiC,EAAK5B,MAAQ4B,EAAK0B,MAAMzB,SACV,eAAbD,EAAK5B,MAAyB4B,EAAK0B,QAC5C3D,EAAQiC,EAAK5B,MAAQ,GACrB4B,EAAK0B,MAAMsB,QAAQ,SAAUS,GACvBA,IACF1F,EAAQiC,EAAK5B,OAASqF,EAAM,SAMpC,IAAK,IAAI9G,KAAKgI,EAAKhC,MACjBkC,EAAKF,EAAKhC,MAAMhG,KAGlBiI,EA3jBZ,WAKE,IAJA,IACIxD,EADA4D,EAAO,GAAGC,MAAMC,KAAKC,WAErBC,EAAQJ,EAAKK,QAEVjE,EAAO4D,EAAKK,SACjB,IAAK,IAAI1I,KAAKyE,EACZgE,EAAMzI,GAAKyE,EAAKzE,GAIpB,OAAOyI,EAgjBShF,CAAO,GAAI3D,EAAKsB,IAClBD,SAAWC,EAAQD,WAoBZvB,EApBoCE,EAAI+F,YAqBvDiC,EAAQ,aAAaa,KAAK/I,IACfkI,EAAM,GAAK,GAtB+C,KAAO1G,EAAQD,SAChFjC,EAAcoC,WAAW2G,EApDa,SAAyC1G,GAC7E,GAAkB,GAAdA,EAAMC,KAAW,CAWnB,IAAK,IAAIxB,KAVKuB,EAAME,KAUNuG,EAAKhC,MARM3C,EASlB2E,EAAKhC,MAAMhG,GARhBF,EAAIuD,EAAK5B,MAAQF,EAAME,KAAK4B,EAAK5B,MAEhB,YAAb4B,EAAK5B,OACP3B,EAAI+F,WAAatE,EAAME,KAAKoE,YAQhC1G,EAAMuC,QAAQ,SAAU,IAZb,IAAc2B,IAiD7BzE,EAAS0D,WAGZ,CACDT,MAAOrC,EACPsC,KAAM,kBACNO,GAAI,WACFzD,EAAS0D,YAIf1D,EAASiE,KAAK,CACZC,SAAU,6CACVC,UAAW,uBACXxE,MAAOA,KASX,IAAIqK,EAAc,SAAqBrH,GACrC,IACI0B,GADS,IAAI1D,GACW2D,aAAa,WAAW,eAChDiB,EAAW3D,EAAgB6D,IAAI,SAAUhB,GAC3C,OAAOA,EAAKpC,WAEVqD,EAAY9D,EAAgB6D,IAAI,SAAUhB,GAC5C,OAAOA,EAAKkB,YAEVsE,EAAYrI,EAAgB6D,IAAI,SAAUhB,GAC5C,OAAOA,EAAKyF,eAEVC,EAAavI,EAAgB6D,IAAI,SAAUhB,GAC7C,OAAOA,EAAK2F,cAEIC,GAAGC,cAAc,OAAQ/E,GACxB8E,GAAGC,cAAc,WAAY5E,GAAW,GAE3D/F,EAAM4K,cAAgB,SAAUC,GAC9B,MAAqB,mBAAVA,EACFA,IAEAA,GAIX,IAAIC,EAAc9K,EAAMqG,SAASX,SAAW1F,EAAMqG,SAASX,SAASqF,WAAa,GAC7EC,EAAiB,GAErB,GAAIF,IAAgB9K,EAAMiL,UAAU,QAAY,CAE9C,IAAK,IAAIvD,KAAOvF,EAAc,CAC5B,IAAI+I,EAAM/I,EAAauF,GAAK3C,SAASgG,WAEL,GAA5BG,EAAIlD,QAAQ8C,IACkC,GAA5CI,EAAItB,UAAUkB,EAAYjG,QAAQA,QACpCmG,EAAexC,KAAKrG,EAAauF,IAKvCvF,EAAe6I,EAGjB,IAAI3E,EAAW,CACbC,OAAS,EACTE,WAASD,EACTjD,MAAS,GACTmD,OAAS,EACTvD,KAAQ,YACRwD,KAAQ,SACRC,WAAa,EACbC,QAAW,GACXC,OAAU,CACRC,OAAU,SAAgB5D,GACNqD,MAAdrD,EAAKsD,OACPtD,EAAK6D,MAAQV,EAAS/C,MAAQ,OAC9BJ,EAAKuD,OAAQ,IAEbvD,EAAK6D,WAAQR,EACbrD,EAAKuD,OAAQ,MAKrBzG,EAAMmE,OAAS,CACbC,MAAO,OACP+G,KAAM,CACJC,QAAW,oCAEb3D,MAAO,CAAC,CACNjB,WAASD,EACTjD,MAAS,MACTJ,KAAQ,WACRwD,KAAQ,OACRD,OAAS,EACTiB,IAAO,aACPjE,MAAS,IACTkD,WAAa,EACbC,QAAW5E,EACX2F,KAAQ,QACRd,OAAU,CACRC,OAAU,SAAgB5D,GACpBhB,EACFlC,EAAMmE,OAAOsD,MAAM7C,KAAK,SAAUsB,GACf,YAAbA,EAAKhD,MAAmC,aAAbgD,EAAKhD,OAClCgD,EAAKM,MAAQ,GACbN,EAAKO,OAAQ,KAIjBzG,EAAMmE,OAAOsD,MAAM7C,KAAK,SAAUsB,GACf,YAAbA,EAAKhD,MAAmC,aAAbgD,EAAKhD,OAClCgD,EAAKM,MAAQ,GACbN,EAAKO,OAAQ,KAKDF,MAAdrD,EAAKsD,OACPtD,EAAK6D,MAAQ,UACb7D,EAAKuD,OAAQ,IAEbvD,EAAK6D,WAAQR,EACbrD,EAAKuD,OAAQ,MAIlB,CACDD,MAAS,GACTF,MAASpE,EACToB,MAAS,OACTJ,KAAQ,WACRwD,KAAQ,WACRC,WAAa,EACbF,OAAS,EACTG,QAAWzE,EACX0E,OAAU,CACRC,OAAU,SAAgB5D,GACxB,GAAIA,EAAKsD,OAA+B,KAAtBtD,EAAKsD,MAAMpB,QAAgB,CAC3C,IAAI6B,EAAQ,GAEPjH,EAAM4H,YAAe5H,EAAM4H,WAAWC,cACzC7H,EAAMmE,OAAOsD,MAAM7C,KAAK,SAAUsB,GACf,YAAbA,EAAKhD,OACP+D,EAAMK,WAAapB,EAAKM,SAK9BS,EAAM7B,QAAUlC,EAAKsD,MAAMpB,QAC3B6B,EAAMC,MAAQhE,EAAKsD,MAAMU,MACzBb,EAASC,OAAQ,EACjBD,EAASI,OAAQ,EACjBJ,EAAS/C,MAAQJ,EAAK0D,QAAQhC,KAAK,SAAUsB,GAC3C,OAAOA,GAAQhD,EAAKsD,QACnBnB,KACH9E,EAAkB4G,mBAAmBF,EAAO,SAAUG,GAC9B,GAAlBA,EAAUnE,OACZoD,EAASO,QAAUQ,EAAUlE,aAIjCmD,EAASC,OAAQ,EACjBD,EAASI,OAAQ,EAGDF,MAAdrD,EAAKsD,OAAoC,IAAdtD,EAAKsD,OAClCtD,EAAK6D,MAAQ,WACb7D,EAAKuD,OAAQ,IAEbvD,EAAK6D,WAAQR,EACbrD,EAAKuD,OAAQ,MAIlBJ,EAAU,CACXG,WAASD,EACTjD,MAAS,OACTmD,OAAS,EACTvD,KAAQ,OACRwD,KAAQ,WACRC,WAAa,EACbC,QAAWxE,EACXyE,OAAU,CACRC,OAAU,SAAgB5D,GACC,GAArBA,EAAKsD,MAAM3B,QACb3B,EAAK6D,MAAQ,WACb7D,EAAKuD,OAAQ,IAEbvD,EAAK6D,WAAQR,EACbrD,EAAKuD,OAAQ,MAIlB,CACDD,WAASD,EACTjD,MAAS,KACTJ,KAAQ,cACRwD,KAAQ,WACRE,QAAWlC,EACX+D,OAAU,CACRjB,GAAI,YACJlE,MAAO,UAER,CACDA,MAAS,OACTkD,MAAS,GACTC,OAAS,EACTsB,UAAa,GACbpB,WAAa,EACbzD,KAAQ,WACR2D,OAAU,CACRC,OAAU,SAAgB5D,GACN,IAAdA,EAAKsD,OACPtD,EAAK6D,MAAQ,WACb7D,EAAKuD,OAAQ,IAEwB,GAAjCb,EAASoC,QAAQ9E,EAAKsD,QACxBtD,EAAK6D,MAAQ,SACb7D,EAAKuD,OAAQ,IAEbvD,EAAK6D,WAAQR,EACbrD,EAAKuD,OAAQ,KAKrBC,KAAQ,SACP,CACDpD,MAAS,MACTkD,MAAS,GACTuB,UAAa,GACbtB,OAAS,EACTE,WAAa,EACbzD,KAAQ,YACRwD,KAAQ,QACRG,OAAU,CACRC,OAAU,SAAgB5D,GACxB,GAAkB,IAAdA,EAAKsD,MACPtD,EAAK6D,MAAQ,UACb7D,EAAKuD,OAAQ,OAEb,IAAsC,GAAlCV,EAAUiC,QAAQ9E,EAAKsD,OACzBtD,EAAK6D,MAAQ,SACb7D,EAAKuD,OAAQ,MACR,CAGQ,mCAEFwB,KAAK/E,EAAKsD,QACnBtD,EAAK6D,WAAQR,EACbrD,EAAKuD,OAAQ,IAEbvD,EAAK6D,MAAQ,gCACb7D,EAAKuD,OAAQ,KAKrByB,KAAQ,SAAchF,GACfA,EAAKsD,QAAStD,EAAK6D,OAIxBpG,EAAcwH,eAAejF,EAAKsD,MAAO,SAAUY,GAC3B,GAAlBA,EAAUnE,OACPmE,EAAUlE,MAIbA,EAAK6D,MAAQ,GACb7D,EAAKuD,OAAQ,IAJbvD,EAAK6D,MAAQ,SACb7D,EAAKuD,OAAQ,SAStB,CACDnD,MAAS,OACTkD,MAAS,GACTuB,UAAa,GACbtB,OAAS,EACTE,WAAa,EACbzD,KAAQ,cACRwD,KAAQ,OACRiC,UAAY,EACZ9B,OAAU,CACRC,OAAU,SAAgB5D,GACxB,IAAI0F,EAAU,IAAIrD,KAAKrC,EAAKsD,OAAOkC,OAAO,cACtCG,EAASC,UAAUF,GAIrB1F,EAAKuD,MAFO,GAAVoC,IACF3F,EAAK6D,MAAQ,qBAGb7D,EAAK6D,WAAQR,IAIjBwC,MAAS,SAAe7F,GACtBA,EAAKsD,MAAQ,GACbtD,EAAK6D,WAAQR,EACbrD,EAAKuD,OAAQ,KAGhB,CACDnD,MAAS,MACTyE,UAAa,GACbvB,MAAS,GACTC,OAAS,EACTE,WAAa,EACbzD,KAAQ,cACR8F,YAAe,eACfnC,OAAU,CACRC,OAAU,SAAgB5D,GACxB,GAAkB,IAAdA,EAAKsD,MAGP,OAFAtD,EAAK6D,MAAQ,QACb7D,EAAKuD,OAAQ,GAMf,GAA+B,GAFlB,YAEFwB,KAAK/E,EAAKsD,OACnBtD,EAAK6D,MAAQ,mBACb7D,EAAKuD,OAAQ,OAEb,IAAuC,GAAnC+D,EAAWxC,QAAQ9E,EAAKsD,OAC1BtD,EAAK6D,MAAQ,UACb7D,EAAKuD,OAAQ,MACR,CACLvD,EAAK6D,WAAQR,EACbrD,EAAKuD,OAAQ,EACb,IAAI4E,EAAW,mEACfrL,EAAMmE,OAAOsD,MAAM7C,KAAK,SAAUsB,GACf,gBAAbA,EAAKhD,OACW,IAAdgD,EAAKM,OAAeN,EAAKM,OAAS6E,EAASpD,KAAK/B,EAAKM,UACvDN,EAAKO,OAAQ,QAQ3BC,KAAQ,SACP,CACDpD,MAAS,KACTyE,UAAa,GACbvB,MAAS,GACTG,WAAa,EACbF,OAAS,EACTuC,YAAe,eACf9F,KAAQ,eACR2D,OAAU,CACRC,OAAU,SAAgB5D,GACxB,GAAkB,IAAdA,EAAKsD,MAGP,OAFAtD,EAAK6D,MAAQ,QACb7D,EAAKuD,OAAQ,GAOf,GAAiC,GAHlB,sDAGFwB,KAAK/E,EAAKsD,OACrBtD,EAAKuD,OAAQ,EACbvD,EAAK6D,MAAQ,iBAEb,IAAsC,GAAlCuD,EAAUtC,QAAQ9E,EAAKsD,OACzBtD,EAAK6D,MAAQ,QACb7D,EAAKuD,OAAQ,MACR,CACLvD,EAAK6D,WAAQR,EACbrD,EAAKuD,OAAQ,EACb,IAAI6E,EAAS,YACbtL,EAAMmE,OAAOsD,MAAM7C,KAAK,SAAUsB,GACf,eAAbA,EAAKhD,OACW,IAAdgD,EAAKM,OAAeN,EAAKM,OAAS8E,EAAOrD,KAAK/B,EAAKM,UACrDN,EAAKO,OAAQ,QAQ3BC,KAAQ,SACP,CACDpD,MAAS,OACTyE,UAAa,GACbvB,MAAS,GACTC,OAAS,EACTE,WAAa,EACbzD,KAAQ,cACR8F,YAAe,qBACfnC,OAAU,CACRC,OAAU,SAAgB5D,GACxB,GAAkB,IAAdA,EAAKsD,MACPtD,EAAK6D,WAAQR,EACbrD,EAAKuD,OAAQ,MACR,CACL,IAAIwC,EAAQC,iBAAiBhG,EAAKsD,OAIhCtD,EAAKuD,MAFM,GAATwC,IACF/F,EAAK6D,MAAQ,eAGb7D,EAAK6D,WAAQR,MAMrBG,KAAQ,SACP,CACDpD,MAAS,KACTkD,MAAS,GACTtD,KAAQ,cACR6E,UAAa,IACbrB,KAAQ,YACP,CACDpD,MAAS,KACTkD,OAAS,EACTtD,KAAQ,SACRwD,KAAQ,WAEVyC,OAAQ,CAAC,CACP7F,MAAOrC,EACPsC,KAAM,kBACN6F,WAAY,WAQV,OAPYpJ,EAAMmE,OAAOsD,MAAM4B,MAAM,SAAUvE,GAC7C,IAAIwE,EAAmB,GAAdxE,EAAK2B,OAAgC,GAAd3B,EAAKwB,MAIrC,OAAOgD,KAIXxF,GAAI,WACF,IAkDIyH,EAlDAC,EAAO,GACP/B,EAAOzJ,EAAMmE,OAgBbsH,EAAU,GAEV9B,EAAO,SAAc7E,GACvB2G,EAAQ3G,EAAK5B,MAAQ4B,EAAK0B,MAET,YAAb1B,EAAK5B,KACPuI,EAAQ3G,EAAK5B,MAAQ4B,EAAK0B,MAAMoD,UAAU,EAAG9E,EAAK0B,MAAM3B,OAAS,GAAG+E,UAAU9E,EAAK0B,MAAMoD,UAAU,EAAG9E,EAAK0B,MAAM3B,OAAS,GAAGgF,YAAY,KAAO,GAC1H,aAAb/E,EAAK5B,KACVuI,EAAQlE,YACVkE,EAAQ3G,EAAK5B,MAAQmD,EAASO,QAAQhC,KAAK,SAAUE,GACnD,OAAO2G,EAAQlE,WAAazC,EAAK0C,KAChCF,YAEiB,QAAbxC,EAAK5B,KACd4B,EAAK0B,MAAMsB,QAAQ,SAAU5B,GAC3BsF,EAAKhD,KAAK,CACRkD,OAAQxF,MAGU,YAAbpB,EAAK5B,KACduI,EAAQ3G,EAAK5B,MAAQ4B,EAAK0B,MAAMzB,SACV,eAAbD,EAAK5B,MAAyB4B,EAAK0B,QAC5CiF,EAAQ3G,EAAK5B,MAAQ,GACrB4B,EAAK0B,MAAMsB,QAAQ,SAAUS,GAC3BkD,EAAQ3G,EAAK5B,OAASqF,EAAM,QAKlC,IAAK,IAAI9G,KAAKgI,EAAKhC,MACjBkC,EAAKF,EAAKhC,MAAMhG,IAKlB,IAAK,IAAIiG,KAAO3F,EACVA,EAAW2F,GAAKF,IAAMiE,EAAQ7I,WAChC2I,EAASxJ,EAAW2F,IAIpB6D,IACFA,EAAS,CACPtH,OAAQ,GACRrB,SAAU2I,EAAO/D,GACjBF,WAAYiE,EAAOjE,WACnBjC,KAAMkG,EAAOlG,cAIVoG,EAAQ7I,gBACR6I,EAAQD,KACfC,EAAQE,OAASF,EAAQE,OAAS,GAAK,EAEnC3L,EAAM4H,YAAc5H,EAAM4H,WAAWC,eACvC4D,EAAQG,QAAUL,EAAOjE,YAGtBmE,EAAQhB,aAAgBgB,EAAQlB,aAKrC5J,EAAckL,uBAAuBJ,EAASF,EAAQC,EA7EhB,SAAyCxI,GAC7E,GAAkB,GAAdA,EAAMC,KAAW,CACnB,IAAIwI,EAAUzI,EAAME,KACpBrC,EAAkBiL,gBAAgB9I,EAAME,KAAKe,OAAQ,SAAUmD,GAC7DqE,EAAQM,MAAQ3E,EAAUlE,OAE5BjB,EAAgB+J,WAAWP,GAC3B7K,EAAMuC,QAAQ,UAAW,IACzB9C,EAAS0D,WAiEXnD,EAAMqL,QAAQ,iBAAkB,MAMnC,CACD3I,MAAOrC,EACPsC,KAAM,kBACNO,GAAI,WACFzD,EAAS0D,YAIf1D,EAASiE,KAAK,CACZC,SAAU,6CACVC,UAAW,uBACXxE,MAAOA,KAIPkM,EAAkB,SAAyBC,GAC7C,IAAIC,EAAM,EACN9C,EAAK,GACL+C,EAAaF,EAEbG,EAAY,WACd,IAAIC,EAAW,WACb,IAAIR,EAAQ/L,EAAMkB,MAAMsK,KAAK1I,SACzB0J,EAAU,GACKL,EAAKM,KAAK,SAAU3H,GACrC,OAAwB,GAAjBA,EAAKY,WAGd,GAAkB,EAAdyG,EAAKtH,OACP,IAAK,IAAIpD,KAAKsK,EACZA,EAAMtK,GAAGiL,SAAU,EAEI,KAAnBX,EAAMtK,GAAGiK,QAAoC,KAAnBK,EAAMtK,GAAGiK,QAErCc,EAAQhE,KAAKuD,EAAMtK,SAGlB,GAAmB,GAAf0K,EAAKtH,OACd,IAAK,IAAIpD,KAAKsK,GACwB,GAAhCzC,EAAGtB,QAAQ+D,EAAMtK,GAAGiK,SACtBK,EAAMtK,GAAGiL,SAAU,EACnBF,EAAQhE,KAAKuD,EAAMtK,KAEI,KAAnBsK,EAAMtK,GAAGiK,QAAoC,KAAnBK,EAAMtK,GAAGiK,QACrCc,EAAQhE,KAAKuD,EAAMtK,IAQ3BzB,EAAMmE,OAAS,CACbC,MAAO,OACPuI,OAAQ,CAAC,QAAS,SAClBhF,KAAM,WACNiF,WAAYJ,EACZrD,OAAQ,CAAC,CACP7F,MAAOrC,EACPsC,KAAM,kBACNO,GAAI,WACF,IAAIsI,EAAM,EACNS,EAAMd,EAAMlG,OAAO,SAAUf,GAC/B,OAAuB,GAAhBA,EAAK4H,UACX5G,IAAI,SAAUhB,GACf,OAAOA,EAAK4G,SAGd,GAAImB,EAAIhI,QAAU,EAChBjE,EAAMqL,QAAQ,cAAe,QAD/B,CAKA,IAsCIa,EAAW,SAAkBX,GAC/B9L,EAAS0D,QAvCM,SAAoBE,GACnC,IAAI8I,EAAM,GAEV,IAAK,IAAItL,KAAKsK,EAAO,CACnB,IAAIiB,GAAO,EAEX,IAAK,IAAIC,KAAKJ,EACZ,GAAId,EAAMtK,GAAGiK,QAAUmB,EAAII,GAAI,CAC7BD,EAAMC,EACN,OAIQ,GAARD,GACFD,EAAIvE,KAAKuD,EAAMtK,GAAGiK,QAIL,EAAbqB,EAAIlI,QACNhE,EAAkBqM,WAAWf,EAAK,GAAGlI,OAAQ8I,EAAK,SAAUI,GAC1D,GAAgB,GAAZA,EAAIlK,KAAW,CACjB,IAAK,IAAIxB,KAAK4K,EACZA,EAAW5K,GAAGiK,OAASmB,EAAIO,KAAK,KAGlC1C,GAAG2C,eAAerD,KAAKnJ,EAAkBiL,gBAAiB,CAACK,EAAK,GAAGlI,QAAS,SAAUjB,GAClE,GAAdA,EAAMC,OACRkJ,EAAK,GAAGJ,MAAQoB,EAAIjK,QAGxBtC,EAAMuC,QAAQ,SAAU,OAc5B+J,KAIW,SAASI,EAASnB,GAC/B,IAAIjG,EAAOiG,EAAKC,GAEZD,EAAKC,IACPD,EAAKC,GAAKmB,UAAW,EAgCrB1M,EAAkB2M,WAAWrB,EAAKC,GAAKnI,OAAQ4I,EA9BjC,SAAiB7J,GACX,GAAdA,EAAMC,OACUD,EAAME,KAAK0B,KAAK,SAAUE,GAC1C,OAAsB,KAAfA,EAAK4G,QAAgC,KAAf5G,EAAK4G,QAAgC,KAAf5G,EAAK4G,QAAgC,KAAf5G,EAAK4G,SAQhFhB,GAAG2C,eAAerD,KAAKnJ,EAAkBiL,gBAAiB,CAAC5F,EAAKjC,QAAS,SAAUjB,GAC/D,GAAdA,EAAMC,OACRiD,EAAK6F,MAAQ/I,EAAME,QAQzBkJ,IACAkB,EAASnB,KAGC,SAAesB,GACzBrB,IACAkB,EAASnB,MAKXW,IAIJQ,CAASnB,MAEV,CACD7I,MAAOrC,EACPsC,KAAM,kBACNO,GAAI,WACFzD,EAAS0D,YAIf1D,EAASiE,KAAK,CACZC,SAAU,iDACVC,UAAW,uBACXxE,MAAOA,KA4BauG,MAApBvG,EAAMkB,MAAMsK,KACd9K,EAAsBgN,oBAzBO,SAAkC1K,GAC/D,GAAkB,GAAdA,EAAMC,KAAW,CACnB,IAAI0K,EAAgB,GACpB3K,EAAME,KAAK4E,QAAQ,SAAU5B,GAC3BA,EAAKsB,GAAKtB,EAAKwF,OACfxF,EAAK5C,MAAQ4C,EAAK0H,UAEdnN,EAAmB2F,KAAKkB,WAAWe,MAAM,KAAKxD,QAAU,IAAmE,EAA9DqB,EAAKoB,WAAWuG,OAAOpN,EAAmB2F,KAAKkB,cAC9GqG,EAAcnF,KAAKtC,KAGvBlG,EAAMkB,MAAMsK,KAAOmC,EAAc7H,IAAI,SAAUhB,GAO7C,OANsC,GAAlCrE,EAAmB2F,KAAKnC,QAA8B,KAAfa,EAAK4G,QAAgC,KAAf5G,EAAK4G,SACjD,KAAf5G,EAAK4G,QAAgC,KAAf5G,EAAK4G,SAC7B5G,EAAK8I,UAAY,MAId9I,IAETyH,OAOFA,MAMW,SAASe,EAASnB,GAyB3BA,EAAKC,GACP1B,GAAG2C,eAAerD,KAAKnJ,EAAkBiL,gBAAiB,CAACK,EAAKC,GAAKnI,QAzBxD,SAAkBjB,GAC/B,GAAkB,KAAdA,EAAMC,KAAa,CACrB,IAUI6K,EAAW3B,EAAKC,GAAKL,MAEzB,IAAK,IAAItK,KAAKqM,EAZW5H,EAalB4H,EAASrM,GAZVqE,OAAAA,EAAAA,EAAMwD,EAAGxD,IAAI,SAAUiI,GACzB,OAAOA,EAAGrC,SAGRxF,IAAqC,GAA7BJ,EAAIkC,QAAQ9B,EAAKwF,SAC3BpC,EAAGd,KAAKtC,EAAKwF,QANN,IAAcxF,EACnBJ,EAiBRsG,IACAkB,EAASnB,KAMTG,IAIJgB,CAASnB,IAGP6B,EAAY,SAAmB7B,EAAM8B,GACvC,IAAIC,EAAe/B,EAAKtG,OAAO,SAAUf,GACvC,OAAsB,GAAfA,EAAK6G,QAAe7G,EAAKb,QAAUxD,EAAmB2F,KAAKnC,SAKhEZ,GAHkB8I,EAAKtG,OAAO,SAAUf,GAC1C,OAAsB,GAAfA,EAAK6G,QAAe7G,EAAKb,QAAUxD,EAAmB2F,KAAKnC,SAEvD,CAAC,CACZX,MAAOrC,EACPsC,KAAM,kBACNC,MAAO,CACLC,MAAO,MACPC,gBAAiB,EACjBC,YAAa,OACbC,cAAe,OACfC,QAAW,IAEbC,GAAI,WACF,IAAIqK,EAAQD,EAAapI,IAAI,SAAUhB,GACrC,OAAOA,EAAKb,SAEdtD,EAAcyN,YAAYD,EAAO,SAAUnL,GACzC,GAAkB,GAAdA,EAAMC,KAAW,CACnB,IAAK,IAAIxB,KAAKyM,EACZA,EAAazM,GAAGkK,OAAS,EAK3B,GAFA1J,EAAgBoM,mBAEZJ,EACFA,QACK,CACL,IAAIK,EAAM,UAAYtL,EAAME,KAAKqL,WAAW1J,OAAS,OAAS7B,EAAME,KAAKsL,QAAQ3J,OAAS,IAC1FjE,EAAMuC,QAAQmL,EAAK,IAGrBjO,EAAS0D,aAId,CACDT,MAAOrC,EACPsC,KAAM,kBACNC,MAAO,CACLC,MAAO,MACPC,gBAAiB,EACjBC,YAAa,OACbC,cAAe,OACfC,QAAW,IAEbC,GAAI,WACFzD,EAAS0D,YAGb/D,EAAMmE,OAAS,CACbC,MAAO,CACLd,MAAO,MAETe,YAAa,CACXf,MAA6B,EAAtB4K,EAAarJ,OAAa,MAAQqJ,EAAarJ,OAAS,mBAAqB,QAAUqJ,EAAa,GAAGxL,SAAW,QAE3HW,OAAQA,GAEVhD,EAASiE,KAAK,CACZC,SAAU,8CACVC,UAAW,uBACXxE,MAAOA,KAIPyO,EAAsB,SAA6BjN,GACrDwM,EAAUxM,IAGRkN,EAAiB,SAAwBnN,GAC3CyM,EAAU,CAACzM,GAAM,WAEfX,EAAMuC,QADI,QACS,OAInBwL,EAAa,SAAoBxC,EAAM8B,GACzC,IAAIC,EAAe/B,EAAKtG,OAAO,SAAUf,GACvC,OAAsB,GAAfA,EAAK6G,QAAe7G,EAAKb,QAAUxD,EAAmB2F,KAAKnC,SAEhE2K,EAAkBzC,EAAKtG,OAAO,SAAUf,GAC1C,OAAsB,GAAfA,EAAK6G,QAAe7G,EAAKb,QAAUxD,EAAmB2F,KAAKnC,SAEhEZ,EAAS,CAAC,CACZC,MAAOrC,EACPsC,KAAM,kBACNC,MAAO,CACLC,MAAO,MACPC,gBAAiB,EACjBC,YAAa,OACbC,cAAe,OACfC,QAAW,IAEbC,GAAI,WACF,IAAIqK,EAAQD,EAAapI,IAAI,SAAUhB,GACrC,OAAOA,EAAKb,SAGd,GAAmB,EAAfkK,EAAMtJ,OACRlE,EAAckO,aAAaV,EAAO,SAAUnL,GAC1C,GAAkB,GAAdA,EAAMC,KAAW,CACnB,IAAK,IAAIxB,KAAKyM,EACZA,EAAazM,GAAGkK,QAAU,EAK5B,GAFA1J,EAAgBoM,mBAEZJ,EACFA,QACK,CACL,IAAIK,EAAM,UAAYtL,EAAME,KAAKqL,WAAW1J,OAAS,QAAU7B,EAAME,KAAKsL,QAAQ3J,OAAS,IAC3FjE,EAAMuC,QAAQmL,EAAK,IAGrBjO,EAAS0D,eAGR,CACL,GAAIkK,EACFA,QACK,CACL,IAAIK,EAAM,UAAYJ,EAAarJ,OAAS,QAAU+J,EAAgB/J,OAAS,IAC/EjE,EAAMuC,QAAQmL,EAAK,IAGrBjO,EAAS0D,WAGZ,CACDT,MAAOrC,EACPsC,KAAM,kBACNC,MAAO,CACLC,MAAO,MACPC,gBAAiB,EACjBC,YAAa,OACbC,cAAe,OACfC,QAAW,IAEbC,GAAI,WACFzD,EAAS0D,WAITmK,EAAarJ,QAAU,EACzBjE,EAAMkO,KAAK,YAAa,KAI1B9O,EAAMmE,OAAS,CACbC,MAAO,CACLd,MAAO,MAETe,YAAa,CACXf,MAA6B,EAAtB4K,EAAarJ,OAAa,OAASqJ,EAAarJ,OAAS,6BAA+B,sBAAwBqJ,EAAa,GAAGxL,SAAW,SAEpJW,OAAQA,GAEVhD,EAASiE,KAAK,CACZC,SAAU,8CACVC,UAAW,uBACXxE,MAAOA,MAIP+O,EAAuB,SAA8BvN,GACvDmN,EAAWnN,IAGTwN,EAAkB,SAAyBzN,GAC7CoN,EAAW,CAACpN,GAAM,WAEhBX,EAAMuC,QADI,QACS,OAQnB8L,EAAuB,SAA8B1N,EAAKC,GAC5D0K,EAAgB,CAAC3K,KAGnBvB,EAAMkP,UAAY,GAClBlP,EAAMmP,aAAe,GACrBnP,EAAMoP,iBAAmB,GACzBpP,EAAMqP,cAAgB,GACtBrP,EAAMsP,SAAW,SACjBtP,EAAMuP,IAAM,CACVC,OAAS,GAEXxP,EAAMyP,UAAY,GAElB,IAAIC,EAAc,SAAqBnO,EAAKC,GAC1CmO,OAAOvP,SAASwP,KAAO,6CAA+CrO,EAAI0C,QAwC5EjE,EAAM6P,oBAAsB,SAAUC,EAAQpJ,GAC5C,GAAY,OAARA,GAAiB1G,EAAM+P,UAAUC,UAAW,CAC9C,IAAK,IAAI/C,KAAKjN,EAAMiQ,WAAY,CAC9B,IAAIC,EAAgBlQ,EAAMmP,aAAanP,EAAM+P,UAAUC,WAAW1I,WAE9D6I,EADanQ,EAAMiQ,WAAWhD,GAAG3F,WACNe,MAAM,KAErC,GAAIrI,EAAMmP,aAAanP,EAAM+P,UAAUC,WAAWxI,IAAMxH,EAAMiQ,WAAWhD,GAAGzF,GAG1E,OAFA5G,EAAMqL,QAAQ,WAAY,SAC1BjM,EAAM+P,UAAUC,UAAY,IAI9B,IAAK,IAAIvO,KAAK0O,EACZ,GAAIA,EAAc1O,IAAM,GAAKzB,EAAMmP,aAAanP,EAAM+P,UAAUC,WAAWxI,GAGzE,OAFA5G,EAAMqL,QAAQ,YAAa,SAC3BjM,EAAM+P,UAAUC,UAAY,IAKhC,IAAgE,GAA5DE,EAAclI,QAAQ,GAAKhI,EAAMiQ,WAAWhD,GAAGzF,IAGjD,OAFA5G,EAAMqL,QAAQ,sBAAuB,SACrCjM,EAAM+P,UAAUC,UAAY,IAKhChQ,EAAMkP,UAAUkB,OAAOC,OAAOC,QAAQtQ,EAAMmP,aAAanP,EAAM+P,UAAUC,WAAYhQ,EAAMkP,WAAY,GACvGlP,EAAMiQ,WAAWzH,KAAKxI,EAAMmP,aAAanP,EAAM+P,UAAUC,YACzDhQ,EAAM+P,UAAUC,UAAY,QACvB,GAAY,OAARtJ,GAGT,IAAK,IAAIjF,KAFTzB,EAAM+P,UAAUC,UAAY,GAEdhQ,EAAMiQ,WAClB,GAAIjQ,EAAMiQ,WAAWxO,GAAG+F,IAAMsI,EAAOtI,GAAI,CACvCxH,EAAMkP,UAAU1G,KAAKxI,EAAMiQ,WAAWxO,IACtCzB,EAAMiQ,WAAWG,OAAO3O,EAAG,GAC3B,YAGC,GAAY,QAARiF,EAAgB,CACzB,IAAIsJ,EAAY,GAEhB,IAAK,IAAIvO,KAAKzB,EAAMiQ,WAClBD,GAAahQ,EAAMiQ,WAAWxO,GAAG+F,GAAK,IAIxC,IAAI+I,EAAiB,GAErB,IAAK,IAAItD,KAAKjN,EAAMwQ,QACdxQ,EAAMwQ,QAAQvD,GAAGuC,OACnBe,EAAe/H,KAAKxI,EAAMwQ,QAAQvD,GAAGzF,IAUzCxH,EAAM+P,UAAUC,UAAYA,EAC5BhQ,EAAM+P,UAAUU,UAAYF,EAC5BvQ,EAAM+P,UAAUW,eAAiBZ,EAAOzH,MAAM,KAAKyH,EAAOzH,MAAM,KAAKxD,OAAS,GAE9ElE,EAAcoC,WAAW/C,EAAM+P,UAVL,SAA6B/M,GACnC,GAAdA,EAAMC,MACRrC,EAAMuC,QAAQ,YAAa,QAiDnCnD,EAAM2Q,YAAc,SAAU/E,EAASvG,GAErCrF,EAAM4Q,WAAahF,EACnB,IAAIiF,EAAmB,GACvBlQ,EAAcmQ,+BAA+B9Q,EAAM+P,UAAU9L,OAAQ2H,EAAS,SAAUmF,GApCxE,IAAqBrH,EAAKmH,EAqCpCE,GAAqC,EAAxBA,EAAU7N,KAAK2B,QAC9BkM,EAAU7N,KAAK4E,QAAQ,SAAUS,GAC/BsI,GAAoBtI,EAAIyI,SAAW,MAvCJtH,EA2CvB,CACVkC,QAASA,EACTtI,MAAO+B,GA7C+BwL,EA8CrCA,EA7CLtQ,EAAkB0Q,sBAAsBvH,EAAK,SAAUtC,GAC/B,GAAlBA,EAAUnE,OACZmE,EAAUlE,KAAK4E,QAAQ,SAAU5B,GAK/B,IAJA,IACIgL,GADS,IAAIlQ,GACUmQ,qBAAqBjL,EAAK0F,QAAS,IAC1DwF,EAAa,GAER3P,EAAI,EAAGA,EAAIyP,EAAcrM,OAAQpD,IACxC2P,GAAcF,EAAczP,GAAK,IAGnCyE,EAAK,WAAgBkL,EACrBlL,EAAK,OAAW,GAEyB,EAArC2K,EAAiB7I,QAAQ9B,EAAKsB,MAChCtB,EAAKsJ,OAAQ,KAGjBxP,EAAMwQ,QAAUpJ,EAAUlE,OAE3B,qCA6BL,IAAImO,EAAW,SAAkB9P,EAAKC,GACpC,IAAI6B,EAAS,CAAC,CACZC,MAAOrC,EACPsC,KAAM,kBACNC,MAAO,CACLC,MAAO,MACPC,gBAAiB,EACjBC,YAAa,OACbC,cAAe,OACfC,QAAW,IAEbC,GAAI,WACFzD,EAAS0D,QAELxC,EAAI0C,QAAUxD,EAAmB2F,KAAKnC,OAChB,IAApB1C,EAAIgJ,cAA0C,MAApBhJ,EAAIgJ,aAChC5J,EAAc2Q,mBAAmB/P,EAAIkJ,YAAa,SAAUsG,GACpC,GAAlBA,EAAU9N,MACZrC,EAAMuC,QAAQ,aAAc,MAIhCxC,EAAc2Q,mBAAmB/P,EAAIgJ,aAAc,SAAUwG,GACrC,GAAlBA,EAAU9N,MACZrC,EAAMuC,QAAQ,aAAc,MAOlCvC,EAAMqL,QAAQ,YAAa,MAG9B,CACD3I,MAAOrC,EACPsC,KAAM,kBACNC,MAAO,CACLC,MAAO,MACPC,gBAAiB,EACjBC,YAAa,OACbC,cAAe,OACfC,QAAW,IAEbC,GAAI,WACFzD,EAAS0D,WAGb/D,EAAMmE,OAAS,CACbC,MAAO,CACLd,MAAO,MAETe,YAAa,CACXf,MAAO,eAETD,OAAQA,GAEVhD,EAASiE,KAAK,CACZC,SAAU,8CACVC,UAAW,uBACXxE,MAAOA,KAIPuR,EAAc,EAuDdC,EAAkB,WACpBvP,EAAgB6F,QAAQ,SAAU1B,GAC5BA,EAAKsF,SACPtF,EAAK2F,MAAQ,GACb3F,EAAKsF,OAAOrD,MAAM,KAAKP,QAAQ,SAAU2J,GACvCrL,EAAK2F,MAAMvD,KAAKlG,EAAgBmP,SAItC,IAAIC,EAAY,GACZC,EAAU,GAEV3R,EAAMiL,UAAU,aAClByG,EAAUlJ,KAAK,CACbjF,KAAM,aACNqO,MAAS,yBACTtO,MAAO,OACPE,MAAO,CACLqO,OAAQ,OAEVnL,KAAM,SACNG,OAAQ,CACNiL,MAAOzH,KAKTrK,EAAMiL,UAAU,aAClByG,EAAUlJ,KAAK,CACbjF,KAAM,aACNqO,MAAS,yBACTtO,MAAO,KACPE,MAAO,CACLqO,OAAQ,OAEVnL,KAAM,SACN9E,SAAU,SAAkBoB,GAI1B,OAHWA,EAAMyJ,KAAK,SAAU3H,GAC9B,OAAwB,GAAjBA,EAAKyI,WAAoC,GAAhBzI,EAAK6G,UAIzC9E,OAAQ,CACNiL,MAAOrD,KAKTzO,EAAMiL,UAAU,aAClByG,EAAUlJ,KAAK,CACbjF,KAAM,aACNqO,MAAS,yBACTtO,MAAO,KACPE,MAAO,CACLqO,OAAQ,OAEVnL,KAAM,SACN9E,SAAU,SAAkBoB,GAI1B,OAHWA,EAAMyJ,KAAK,SAAU3H,GAC9B,OAAwB,GAAjBA,EAAKyI,UAAmC,GAAfzI,EAAK6G,UAIzC9E,OAAQ,CACNiL,MAAO/C,KAKT/O,EAAMiL,UAAU,aAClB0G,EAAQnJ,KAAK,CACXlF,MAAO,KACPoD,KAAM,SACNkL,MAAS,kBACT/K,OAAQ,CACNiL,MAAOrN,KAKTzE,EAAMiL,UAAU,aAClB0G,EAAQnJ,KAAK,CACXlF,MAAO,KACPoD,KAAM,SACNkL,MAAS,kBACThQ,SAAU,SAAkBL,EAAKC,GAC/B,OAAOD,EAAI0C,QAAUxD,EAAmB2F,KAAKnC,QAAwB,GAAd1C,EAAIoK,QAE7D9E,OAAQ,CACNiL,MAAO1O,KAKTpD,EAAMiL,UAAU,aAClB0G,EAAQnJ,KAAK,CACXlF,MAAO,OACPoD,KAAM,SACNkL,MAAS,kBACT/K,OAAQ,CACNiL,MAAO7C,KAKTjP,EAAMiL,UAAU,aAClB0G,EAAQnJ,KAAK,CACXlF,MAAO,OACPoD,KAAM,SACNkL,MAAS,kBACTG,QAAS,SAAiBxQ,EAAKC,GAC7B,OAAOD,EAAI0C,QAAUxD,EAAmB2F,KAAKnC,QAE/C4C,OAAQ,CACNiL,MAAOT,KAKTrR,EAAMiL,UAAU,aAClB0G,EAAQnJ,KAAK,CACXlF,MAAO,QACPoD,KAAM,SACNkL,MAAS,kBACTG,QAAS,SAAiBxQ,EAAKC,GAC7B,OAAOD,EAAI0C,QAAUxD,EAAmB2F,KAAKnC,QAE/C4C,OAAQ,CACNiL,MAAOpC,KAKT1P,EAAMiL,UAAU,aAClB0G,EAAQnJ,KAAK,CACXlF,MAAO,KACPoD,KAAM,SACNkL,MAAS,kBACTG,QAAS,SAAiBxQ,GACxB,OAAsB,GAAfA,EAAIoK,QAEb9E,OAAQ,CACNiL,MAAOpD,KAKT1O,EAAMiL,UAAU,aAClB0G,EAAQnJ,KAAK,CACXlF,MAAO,KACPoD,KAAM,SACNkL,MAAS,kBACTG,QAAS,SAAiBxQ,GACxB,OAAqB,GAAdA,EAAIoK,QAAepK,EAAI0C,QAAUxD,EAAmB2F,KAAKnC,QAElE4C,OAAQ,CACNiL,MAAO9C,KAKb,IAAIgD,EAAO,CAAC,CACV1O,MAAO,OACPG,MAAO,MACPwO,UAAU,EACVC,UAAU,EACVC,YAAY,EACZjP,KAAM,WACNwD,KAAM,OACN0L,MAAO,CACLC,QAAW,CACT3L,KAAM,QAER4L,KAAM,CACJ5L,KAAM,QACNsC,YAAa,uBAGhB,CACD1F,MAAO,MACPG,MAAO,MACPwO,UAAU,EACVC,UAAU,EACVC,YAAY,EACZjP,KAAM,YACNwD,KAAM,OACN0L,MAAO,CACLC,QAAW,CACT3L,KAAM,QAER4L,KAAM,CACJ5L,KAAM,QACNsC,YAAa,uBAGhB,CACD1F,MAAO,MACPG,MAAO,MACPwO,UAAU,EACVC,UAAU,EACVC,YAAY,EACZjP,KAAM,cACNwD,KAAM,OACN+B,OAAQ,SAAgBjC,GACtB,OAAOA,GAAgB,KAEzB4L,MAAO,CACLC,QAAW,CACT3L,KAAM,QAER4L,KAAM,CACJ5L,KAAM,QACNsC,YAAa,uBAGhB,CACD1F,MAAO,KACPG,MAAO,MACPiD,KAAM,OACNwL,UAAU,EACVC,YAAY,EACZjP,KAAM,eACNuF,OAAQ,SAAgBjC,GACtB,OAAOA,GAAgB,KAEzB4L,MAAO,CACLC,QAAW,CACT3L,KAAM,QAER4L,KAAM,CACJ5L,KAAM,UAGT,CACDpD,MAAO,QACPoD,KAAM,YACNwL,UAAU,EACVC,YAAY,EACZI,aAAc,CACZjP,MAAO,WACPkD,MAAO,UAETtD,KAAM,QACN0D,QAASvE,EACToG,OAAQ,SAAgBjC,GACtB,OAAKA,GACDA,EAAQA,EAAMV,IAAI,SAAUhB,GAC9B,GAAIA,GAAyByB,MAAjBzB,EAAK8I,SACf,OAAO9I,EAAK8I,YAGH7C,WANM,IAQrBqH,MAAO,CACLC,QAAW,CACT3L,KAAM,QAER4L,KAAM,CACJ5L,KAAM,QACNsC,YAAa,qBAGhB,CACD1F,MAAO,MACPoD,KAAM,OACNwL,UAAU,EACVC,YAAY,EACZjP,KAAM,aACNwE,IAAK,aACLC,KAAM,QACNf,QAAS5E,EACTyG,OAAQ,SAAgBjC,GACtB,IAAKA,EAAO,MAAO,IACnB,IAAI5B,EAAO7C,EAAWyE,GAEtB,OAAI5B,EACKA,EAAKtB,MAEL,KAGX8O,MAAO,CACLC,QAAW,CACT3L,KAAM,UAGT,CACDpD,MAAO,KACPG,MAAO,OACPiD,KAAM,SACNwL,UAAU,EACVC,YAAY,EACZP,MAAS,SAAgBrQ,GACvB,OAAkB,GAAdA,EAAIoK,OACC,gBAEA,iBAGXnI,MAAO,SAAegP,GACpB,MAAO,CACLC,OAAU,YAGdhK,OAAQ,SAAgBjC,GACtB,OAAa,GAATA,EACK,MAEA,OAGXtD,KAAM,UACL,CACDI,MAAO,KACPoD,KAAM,cACNyL,YAAY,EACZD,UAAU,EACVzO,MAAO,QACP2O,MAAO,CACLC,QAAW,CACTzL,QAAS+K,GAEXW,KAAM,CACJ1L,QAAS,CAAC,CACRtD,MAAO,KACPoD,KAAM,SACNkL,MAAS,kBACT/K,OAAQ,CACNiL,MAAOtP,IAER,CACDc,MAAO,KACPoD,KAAM,SACNkL,MAAS,kBACT/K,OAAQ,CACNiL,MAAOxQ,SAOH,GAAVY,IACF8P,EAAK,GAAK,CACR1O,MAAO,OACPgD,OAAO,EACP2L,UAAU,EACVC,UAAU,EACVhP,KAAM,WACNwD,KAAM,OACN+B,OAAQ,SAAgBjC,GACtB,IAAI5B,EAAOrC,EAASqC,KAAK,SAAUE,GACjC,OAAOA,EAAK0C,IAAMhB,IAGpB,OAAI5B,EACKA,EAAKtB,MACM,IAATkD,EACF,QAEA,KAGX4L,MAAO,CACLC,QAAW,CACT3L,KAAM,QAER4L,KAAM,CACJ5L,KAAM,YAMd1G,EAAM0B,SAAW,CACfF,OAAQS,EACRyQ,OAAQhB,EACRiB,WAAYX,IAMhBtR,EAAsBgN,oBAAoB,SAAUtG,GAClD,GAAsB,GAAlBA,EAAUnE,KAAW,CACvBb,EAAgB,GAChB,IAAIkH,EAAK,GAET,IAAK,IAAI7H,KAAK2F,EAAUlE,KAClBkE,EAAUlE,KAAKzB,IACjB6H,EAAGd,KAAKpB,EAAUlE,KAAKzB,IAI3B6H,EAAGxB,QAAQ,SAAU5B,GACnBA,EAAKsB,GAAKtB,EAAKwF,OACfxF,EAAK5C,MAAQ4C,EAAK0H,SAClBvL,EAAamG,KAAKtC,GAClB5D,EAAgB4D,EAAKsB,IAAMtB,GAEvBzF,EAAmB2F,KAAKkB,WAAWe,MAAM,KAAKxD,QAAU,IAAmE,EAA9DqB,EAAKoB,WAAWuG,OAAOpN,EAAmB2F,KAAKkB,cAC9GlF,EAAcoG,KAAKtC,KAGvBlG,EAAMkB,MAAMsK,KAAOpJ,EAAc0D,IAAI,SAAUhB,GAO7C,OANsC,GAAlCrE,EAAmB2F,KAAKnC,QAA8B,KAAfa,EAAK4G,QAAgC,KAAf5G,EAAK4G,SACjD,KAAf5G,EAAK4G,QAAgC,KAAf5G,EAAK4G,SAC7B5G,EAAK8I,UAAY,MAId9I,IAIU,KAFnByM,GAGEC,OAaNjR,EAAkBqS,yBAAyB,GAzchB,SAA8B5P,GACvDjB,EAAaiB,EAAM6P,cACnB7Q,EAAa,CACX8Q,MAAO9P,EAAME,KACb6P,YAAa/P,EAAME,MAcrBlD,EAAMqP,cAAgBrM,EAAME,KAC5BlD,EAAMmP,aAAenM,EAAM6P,cAC3B7S,EAAMgT,cAAgBhQ,EAAME,KAAK,GAAG6P,YAGjB,KAFnBxB,GAGEC,MA0dJlR,EAAgB2S,sBAAsB,WAhCL,SAAoC7L,GAC7C,GAAlBA,EAAUnE,MAAamE,EAAUlE,KAAK,IACxChB,GAAS,EACTK,EAAW2Q,KAAKC,MAAM/L,EAAUlE,KAAK,GAAGsD,OACxCrE,EAAe+Q,KAAKC,MAAM/L,EAAUlE,KAAK,GAAGsD,OAC5CjE,EAASuF,QAAQ,SAAU5B,GACzBA,EAAKsB,GAAKtB,EAAKnB,YAEU,GAAlBqC,EAAUnE,MAAsC,GAAzBmE,EAAUlE,KAAK2B,SAC/C1C,EAAe,CAAC,CACd4C,SAAU,GACVK,QAAS,IACTC,KAAM,SAER9C,EAAW,CAAC,CACViF,GAAI,IACJzC,SAAU,GACVK,QAAS,IACT9B,MAAO,SAETpB,GAAS,GAKQ,KAFnBqP,GAGEC,MAOJ7Q,EAAcyS,qBAAqB,GA5gBJ,SAAkCpQ,GAC7C,GAAdA,EAAMC,OAWNhB,EAVGjC,EAAMiL,UAAU,QAUDjI,EAAME,KARNF,EAAME,KAAK2C,OAAO,SAAUK,GAC5C,OAAkE,EAA9DA,EAAKoB,WAAWuG,OAAOpN,EAAmB2F,KAAKkB,cAYpC,KAFnBiK,GAGEC,QA6fJ6B,EAAiB,WACnB,IAAIvF,EAAW,GAGXwF,EAAY,SAAmBC,GAEjC,OADWA,EAAM,IACL1O,OAAS,GAGnB2O,EAAuB,SAA8BjS,GACvDrB,EAAUuT,YAAclS,EAAImK,OAC5BtL,EAASiB,KAAK,gCAAkCE,EAAImK,SAGlDQ,EAAkB,SAAyBC,GAC7C,IAAIC,EAAM,EACN9C,EAAK,GAELgD,EAAY,WACd,IAAIC,EAAW,WACb,IAAIR,EAAQ/L,EAAMkB,MAAMsK,KAAK1I,SAI7B,GAAkB,EAAdqJ,EAAKtH,OACP,IAAK,IAAIpD,KAAKsK,EACZA,EAAMtK,GAAGiL,SAAU,OAEhB,GAAmB,GAAfP,EAAKtH,OACd,IAAK,IAAIpD,KAAKsK,GACwB,GAAhCzC,EAAGtB,QAAQ+D,EAAMtK,GAAGwC,UACtB8H,EAAMtK,GAAGiL,SAAU,GAOzB1M,EAAMmE,OAAS,CACbC,MAAO,OACPuI,OAAQ,CAAC,QAAS,SAClBhF,KAAM,WACNiF,WAAYb,EACZ5C,OAAQ,CAAC,CACP7F,MAAOrC,EACPsC,KAAM,kBACNO,GAAI,WACF,IAAIsI,EAAM,EACNS,EAAMd,EAAMlG,OAAO,SAAUf,GAC/B,OAAuB,GAAhBA,EAAK4H,UACX5G,IAAI,SAAUhB,GACf,OAAOA,EAAKb,SAiBV6I,EAAW,SAAkBX,GAC/B9L,EAAS0D,QAfM,SAAoBoI,GACnC,IAAK,IAAIuH,KAAK7G,EACZvD,EAAG8G,OAAOnL,EAAEqL,QAAQzD,EAAI6G,GAAIpK,GAAK,GAGnCzI,EAAkB8S,WAAWrK,EAAI6C,EAAK,GAAGT,OAAQ,SAAUyB,GACzC,GAAZA,EAAIlK,MACNrC,EAAMuC,QAAQ,SAAU,MAa1B+J,CAAWf,KAIA,SAASmB,EAASnB,GAC3BA,EAAKC,IACPD,EAAKC,GAAKmB,UAAW,EAuBrB1M,EAAkB+S,WAAW/G,EAAKV,EAAKC,GAAKV,OArB9B,SAAiB1I,GACzBA,EAAMC,KAWVmJ,IACAkB,EAASnB,IAGC,SAAe0H,GACzBzH,IACAkB,EAASnB,MAKXW,EAASX,GAIbmB,CAASnB,KAEV,CACD7I,MAAOrC,EACPsC,KAAM,kBACNO,GAAI,WACFzD,EAAS0D,YAIf1D,EAASiE,KAAK,CACZC,SAAU,iDACVC,UAAW,uBACXxE,MAAOA,KAaauG,MAApBvG,EAAMkB,MAAMsK,KACd7K,EAAcyS,qBAAqB,GAVN,SAAkCpQ,GAC7C,GAAdA,EAAMC,OACRjD,EAAMkB,MAAMsK,KAAOxI,EAAME,KAAK4C,IAAI,SAAUhB,GAC1C,OAAOA,IAETyH,OAOFA,MAMW,SAASe,EAASnB,GAuB3BA,EAAKC,GACPvL,EAAkBiT,sBAAsB,CACtCpI,OAAQS,EAAKC,GAAKV,QAxBP,SAAkB1I,GAC/B,GAAkB,KAAdA,EAAMC,KAWR,IAAK,IAAIxB,KAAKuB,EAAME,KAVKgD,EAWlBlD,EAAME,KAAKzB,IANiB,GAJvB6H,EAAGxD,IAAI,SAAUiI,GACzB,OAAOA,EAAG9J,SAGJ+D,QAAQ9B,EAAKjC,SACnBqF,EAAGd,KAAKtC,EAAKjC,QANN,IAAciC,EAgB3BkG,IACAkB,EAASnB,KAQTG,IAIJgB,CAASnB,IAGP4H,EAAqB,SAA4BxS,EAAKC,GACxD0K,EAAgB,CAAC3K,KAGfyS,EAAY,SAAmBzS,EAAKC,GACvBsM,EAASjI,OAAO,SAAUf,GACvC,OAAOA,EAAK4G,QAAUnK,EAAImK,SACzB5F,IAAI,SAAUhB,GACf,OAAOA,EAAK8I,WAId5N,EAAMmE,OAAS,CACbC,MAAO,CACLd,MAAO,QAETmE,MAAO,CAAC,CACNnE,MAAS,OACTkD,MAASjF,EAAIqM,SACbjH,WAAa,EACbzD,KAAQ,WACRwD,KAAQ,QACRqB,UAAa,GACbkM,SAAY,SAAkB/N,GAMV,IAAdA,EAAKM,OACPN,EAAKa,MAAQ,WACbb,EAAKO,OAAQ,IAEbP,EAAKa,WAAQR,EACbL,EAAKO,OAAQ,KAGhB,CACDnD,MAAS,OACTkD,MAASjF,EAAI8C,YACbsC,WAAa,EACboB,UAAW,IACX7E,KAAQ,cACRwD,KAAQ,aAEVrD,OAAQ,CAAC,CACPC,MAAOrC,EACPsC,KAAM,kBACN6F,WAAY,WAIV,OAHYpJ,EAAMmE,OAAOsD,MAAM4B,MAAM,SAAUvE,GAC7C,OAAqB,GAAdA,EAAK2B,SAIhB3C,GAAI,WACF,IAGyBgB,EAHrB2E,EAAOzJ,EAAMmE,OACb+P,EAAU3S,EAAIuB,SASlB,IAAK,IAAIrB,KAHTyS,EAAQtR,SAAWnC,EAAmB2F,KAAKxD,SAC3CsR,EAAQ5M,WAAa7G,EAAmB2F,KAAKkB,WAE/BmC,EAAKhC,MAPM3C,EAQlB2E,EAAKhC,MAAMhG,GAPhByS,EAAQpP,EAAK5B,MAAQ4B,EAAK0B,MA0B5B3F,EAAkBsT,WAAWD,EAhBH,SAA6BlR,GACrD,GAAkB,GAAdA,EAAMC,KAAW,CAOnB,IAAK,IAAIxB,KANKuB,EAAME,KAMNuG,EAAKhC,MAJM3C,EAKlB2E,EAAKhC,MAAMhG,GAJhBF,EAAIuD,EAAK5B,MAAQF,EAAME,KAAK4B,EAAK5B,MAOnCtC,EAAMuC,QAAQ,SAAU,IARb,IAAc2B,IAa7BzE,EAAS0D,UAEV,CACDT,MAAOrC,EACPsC,KAAM,kBACNO,GAAI,WACFzD,EAAS0D,YAIf1D,EAASiE,KAAK,CACZC,SAAU,uCACVC,UAAW,uBACXxE,MAAOA,KAIPqK,EAAc,SAAqBrH,GACtB8K,EAAShI,IAAI,SAAUhB,GACpC,OAAOA,EAAK8I,WAId5N,EAAMmE,OAAS,CACbC,MAAO,CACLd,MAAO,QAETmE,MAAO,CAAC,CACNnE,MAAS,OACTkD,MAPc,OAQdG,WAAa,EACbzD,KAAQ,WACRwD,KAAQ,QACRqB,UAAa,GACbkM,SAAY,SAAkB/N,GAOV,IAAdA,EAAKM,OACPN,EAAKa,MAAQ,WACbb,EAAKO,OAAQ,IAEbP,EAAKa,WAAQR,EACbL,EAAKO,OAAQ,KAGhB,CACDnD,MAAS,OACTkD,MAAS,OACTG,WAAa,EACboB,UAAW,IACX7E,KAAQ,cACRwD,KAAQ,aAEVrD,OAAQ,CAAC,CACPC,MAAOrC,EACPsC,KAAM,kBACN6F,WAAY,WAIV,OAHYpJ,EAAMmE,OAAOsD,MAAM4B,MAAM,SAAUvE,GAC7C,OAAqB,GAAdA,EAAK2B,SAIhB3C,GAAI,WACF,IAGyBgB,EAHrB2E,EAAOzJ,EAAMmE,OACbiQ,EAAU,GASd,IAAK,IAAI3S,KAHT2S,EAAQxR,SAAWnC,EAAmB2F,KAAKxD,SAC3CwR,EAAQ9M,WAAa7G,EAAmB2F,KAAKkB,WAE/BmC,EAAKhC,MAPM3C,EAQlB2E,EAAKhC,MAAMhG,GAPhB2S,EAAQtP,EAAK5B,MAAQ4B,EAAK0B,MAkB5B3F,EAAkBwT,QAAQD,EARH,SAA0BpR,GAC/C,GAAkB,GAAdA,EAAMC,KAAW,CACnB,IAAIwI,EAAUzI,EAAME,KACpB4K,EAAS9B,WAAWP,GACpB7K,EAAMuC,QAAQ,UAAW,OAK7B9C,EAAS0D,UAEV,CACDT,MAAOrC,EACPsC,KAAM,kBACNO,GAAI,WACFzD,EAAS0D,YAIf1D,EAASiE,KAAK,CACZC,SAAU,uCACVC,UAAW,uBACXxE,MAAOA,KAIPsU,EAAmB,SAA0B9S,GAC/C,IAAI6B,EAAS,CAAC,CACZC,MAAOrC,EACPsC,KAAM,kBACNC,MAAO,CACLC,MAAO,MACPC,gBAAiB,EACjBC,YAAa,OACbC,cAAe,OACfC,QAAW,IAEbC,GAAI,WACFzD,EAAS0D,QACT,IAAIwQ,EAAe/S,EAAOqE,OAAO,SAAUf,GACzC,OAAwB,GAAjBA,EAAKyI,WAEVnB,EAAM,EACNkC,EAAM,IAEO,SAASkG,EAAWhJ,GACnC,GAAIA,EAAM,CACRY,IAEA,IAAInF,EAAQ,CACVyE,OAAUF,EAAKE,QAEjB7K,EAAkB4T,WAAWxN,EAAO,SAAU/D,GAC3B,GAAbA,EAAKD,OACPuI,EAAKtH,SACLoK,EAAM,UAIRkG,EAAWD,EAAanI,UAKf,IAAPkC,GACF1N,EAAMuC,QAAQ,SAAU,IAK9BqR,CAAWD,EAAanI,MAEzB,CACD9I,MAAOrC,EACPsC,KAAM,kBACNC,MAAO,CACLC,MAAO,MACPC,gBAAiB,EACjBC,YAAa,OACbC,cAAe,OACfC,QAAW,IAEbC,GAAI,WACFzD,EAAS0D,WAGb/D,EAAMmE,OAAS,CACbC,MAAO,CACLd,MAAO,MAETe,YAAa,CACXf,MAAO,eAETD,OAAQA,GAEVhD,EAASiE,KAAK,CACZC,SAAU,8CACVC,UAAW,uBACXxE,MAAOA,KAIPwC,EAAY,SAAmBjB,EAAKC,GACtC,IAAIoE,EAAWkI,EAASjI,OAAO,SAAUf,GACvC,OAAOvD,EAAIqM,UAAY9I,EAAK8I,WAC3B9H,IAAI,SAAUhB,GACf,OAAOA,EAAK8I,WAEVA,EAAWrM,EAAIkB,OAAOmL,SAE1B,GAAgB,IAAZA,EACFhN,EAAMqL,QAAQ,UAAW,SACpB,IAAmC,GAA/BrG,EAASoC,QAAQ4F,GAAiB,CAC3C,IAAIvJ,EAAc9C,EAAIkB,OAAO4B,YACzBqH,EAASnK,EAAImK,OAGjB,IAAK,IAAIjK,KAFTzB,EAAM0B,SAASC,kBAAiB,GAElBH,EACZA,EAAOC,GAAGG,UAAW,EAGvBL,EAAIM,OAAS,iBACNN,EAAIkB,OACX,IAAIyR,EAAU,CACZtG,SAAUA,EACVvJ,YAAaA,EACbqH,OAAQA,GAEV7K,EAAkBsT,WAAWD,EAAS,SAAUlR,GAC5B,GAAdA,EAAMC,MACR1B,EAAIqM,SAAW5K,EAAME,KAAK0K,SAC1BrM,EAAI8C,YAAcrB,EAAME,KAAKmB,YAC7BzD,EAAMuC,QAAQ,SAAU,IACxB8K,UAAS,IAETrN,EAAMqL,QAAQ,UAAW,WAI7BrL,EAAMqL,QAAQ,aAAc,KAI5B7I,EAAc,SAAqB7B,EAAKC,GAC1C,IAAI6B,EAAS,CAAC,CACZC,MAAOrC,EACPsC,KAAM,kBACNC,MAAO,CACLC,MAAO,MACPC,gBAAiB,EACjBC,YAAa,OACbC,cAAe,OACfC,QAAW,IAEbC,GAAI,WACFzD,EAAS0D,QACT,IAAIyQ,EAAa,CACf9I,OAAUnK,EAAImK,QAEhB7K,EAAkB4T,WAAWD,EAAY,SAAUtR,GAChC,GAAbA,EAAKD,OACP1B,EAAI2C,SACJtD,EAAMuC,QAAQ,SAAU,SAK7B,CACDG,MAAOrC,EACPsC,KAAM,kBACNC,MAAO,CACLC,MAAO,MACPC,gBAAiB,EACjBC,YAAa,OACbC,cAAe,OACfC,QAAW,IAEbC,GAAI,WACFzD,EAAS0D,WAGb/D,EAAMmE,OAAS,CACbC,MAAO,CACLd,MAAO,MAETe,YAAa,CACXf,MAAO,eAETD,OAAQA,GAEVhD,EAASiE,KAAK,CACZC,SAAU,8CACVC,UAAW,uBACXxE,MAAOA,KAIP0U,EAA2B,SAAkC1R,GAC/D,GAAkB,GAAdA,EAAMC,KAAW,CAenB,GAAkB,MAAdD,EAAME,KACR,GAAwB,EAApBF,EAAME,KAAK2B,OAAY,CACzB,IAAI2H,EAAU,GAEd,IAAK,IAAImI,KAAK3R,EAAME,KACdF,EAAME,KAAKyR,IAA8B,KAAxB3R,EAAME,KAAKyR,GAAGjJ,QAAyC,KAAxB1I,EAAME,KAAKyR,GAAGjJ,QAEhEc,EAAQhE,KAAKxF,EAAME,KAAKyR,IAI5B7G,EAxBc,SAAqB5K,GACrC,IAAIoG,EAAK,GAET,IAAK,IAAI7H,KAAKyB,GAERzC,EAAmB2F,KAAKkB,WAAWe,MAAM,KAAKxD,QAAU,GAAgB,MAAX3B,EAAKzB,KAA+E,EAAjEyB,EAAKzB,GAAG6F,WAAWuG,OAAOpN,EAAmB2F,KAAKkB,cACpIgC,EAAGd,KAAKtF,EAAKzB,IAIjB,OAAO6H,EAcMsL,CAAYpI,GACvB,IAAIqI,EAAa,GACbC,EAAa,GAEb9U,EAAMiL,UAAU,aAClB4J,EAAWrM,KAAK,CACdjF,KAAM,aACNqO,MAAS,yBACTtO,MAAO,OACPE,MAAO,CACLqO,OAAQ,OAEVnL,KAAM,SACNG,OAAQ,CACNiL,MAAOzH,KAKTrK,EAAMiL,UAAU,aAClB4J,EAAWrM,KAAK,CACdjF,KAAM,4BACNqO,MAAS,yBACTtO,MAAO,OACPE,MAAO,CACLqO,OAAQ,OAEVnL,KAAM,SACN9E,SAAU,SAAkBoB,GAC1B,IAAI+R,EAAU/R,EAAM6C,OAAO,SAAUf,GACnC,OAAwB,GAAjBA,EAAKyI,WAGd,GAAsB,GAAlBwH,EAAQlQ,OACV,OAAO,EAEP,IAAK,IAAIpD,KAAKsT,EACZ,GAAyB,KAArBA,EAAQtT,GAAGiK,OACb,OAAO,GAKf7E,OAAQ,CACNiL,MAAOwC,KAKTtU,EAAMiL,UAAU,aAClB6J,EAAWtM,KAAK,CACdlF,MAAO,KACPoD,KAAM,SACNkL,MAAS,kBACThQ,SAAU,SAAkBL,GAC1B,OAAsC,GAAlCd,EAAmB2F,KAAKnC,QAGnBqP,EAAU/R,EAAImK,SAGzB7E,OAAQ,CACNiL,MAAOkC,KAKThU,EAAMiL,UAAU,aAClB6J,EAAWtM,KAAK,CACdlF,MAAO,KACPoD,KAAM,SACNkL,MAAS,kBACThQ,SAAU,SAAkBL,GAC1B,OAAsC,GAAlCd,EAAmB2F,KAAKnC,SAGR,KAAd1C,EAAImK,aAAR,IAQJ7E,OAAQ,CACNiL,MAAO1O,KAKTpD,EAAMiL,UAAU,aAClB6J,EAAWtM,KAAK,CACdlF,MAAO,OACPoD,KAAM,SACNkL,MAAS,kBACTG,QAAS,SAAiBxQ,GACxB,OAAsC,GAAlCd,EAAmB2F,KAAKnC,SAGjBqP,EAAU/R,EAAImK,SAI3B7E,OAAQ,CACNiL,MAAO0B,KAKTxT,EAAMiL,UAAU,aAClB6J,EAAWtM,KAAK,CACdlF,MAAO,OACPoD,KAAM,SACNkL,MAAS,kBACT/K,OAAQ,CACNiL,MAAOiC,KAKb/T,EAAM0B,SAAW,CACfF,OAAQsM,EACRkH,SAAU,SAAkBlQ,GAC1B,OAAO5E,EAAUuT,aAAe3O,EAAK4G,OAAS,UAAY,IAE5DgH,OAAQmC,EACRlC,WAAY,CAAC,CACXrP,MAAO,OACPoD,KAAM,OACNyL,YAAY,EACZjP,KAAM,WACNO,MAAO,MACP2O,MAAO,CACLC,QAAW,CACT3L,KAAM,QAER4L,KAAM,CACJ5L,KAAM,UAGV+B,OAAQ,SAAgBjC,EAAOjF,GAC7B,OAAsC,GAAlCd,EAAmB2F,KAAKnC,OACR,KAAd1C,EAAImK,QAA+B,KAAdnK,EAAImK,OACpBlF,EAAQ,IACQ,KAAdjF,EAAImK,QAA+B,KAAdnK,EAAImK,OAC3BlF,EAAQ,IAERA,EAGFA,IAGV,CACDlD,MAAO,OACPoD,KAAM,OACNyL,YAAY,EACZjP,KAAM,cACNkP,MAAO,CACLC,QAAW,CACT3L,KAAM,QAER4L,KAAM,CACJ5L,KAAM,WAGT,CACDpD,MAAO,KACPoD,KAAM,cACNyL,YAAY,EACZD,UAAU,EACVzO,MAAO,QACP2O,MAAO,CACLC,QAAW,CACTzL,QAASkO,GAEXxC,KAAM,CACJ1L,QAAS,CAAC,CACRtD,MAAO,KACPoD,KAAM,SACNkL,MAAS,kBACT/K,OAAQ,CACNiL,MAAOtP,IAER,CACDc,MAAO,KACPoD,KAAM,SACNkL,MAAS,kBACT/K,OAAQ,CACNiL,MAAOxQ,eAQnBV,EAAMmG,MAAM,uBAGdnG,EAAMmG,MAAM,oBAoClBpG,EAAcyS,qBAAqB,GA7BJ,SAAkCpQ,GAC7C,GAAdA,EAAMC,OACU,MAAdD,EAAME,MACgB,EAApBF,EAAME,KAAK2B,QACR7E,EAAMiL,UAAU,QAUDjI,EAAME,KARNF,EAAME,KAAK2C,OAAO,SAAUK,GAC5C,OAAkE,EAA9DA,EAAKoB,WAAWuG,OAAOpN,EAAmB2F,KAAKkB,cAUvD5G,EAAsBgN,oBAAoBgH,IAK5C9T,EAAMmG,MAAM,sBAUhBkO,EAAO,WACU,QAAfjV,EAAMoB,MACRU,IAEAuR,KAQC5S,EAAmB2F,KAAK8O,gBAO3BD,IANAjV,EAAMmV,IAAI,qBAAsB,SAAUC,EAAKC,GACzC5U,EAAmB2F,KAAK8O,iBAC1BD","file":"app-oc/js/controllers/user-list-ctrl.js","sourcesContent":["define(['controllers/controllers', 'Array'], function (controllers) {\n  'use strict';\n\n  controllers.initController('UserListCtrl', ['$scope', '$state', '$rootScope', '$routeParams', '$location', 'ngDialog', 'configUIService', 'resourceUIService', 'userInitService', 'userLoginUIService', 'userEnterpriseService', 'userUIService', 'growl', 'userRoleUIService', 'userFunctionService', 'userDomainService', 'commonMethodService', function (scope, $state, rootScope, routeParams, location, ngDialog, configUIService, resourceUIService, userInitService, userLoginUIService, userEnterpriseService, userUIService, growl, userRoleUIService, userFunctionService, userDomainService, cmd) {\n    var TEXT = {\n      \"SUBMIT\": \"确定\",\n      \"CANCEL\": \"取消\"\n    };\n    scope.cache = {};\n\n    scope.navigateTo = function (panel) {\n      location.path(\"usermanager/\" + panel);\n    };\n\n    scope.panel = routeParams.panel ? routeParams.panel : \"user\";\n\n    function extend() {\n      var args = [].slice.call(arguments),\n          item,\n          start = args.shift();\n\n      while (item = args.shift()) {\n        for (var i in item) {\n          start[i] = item[i];\n        }\n      }\n\n      return start;\n    }\n\n    var createlist = function createlist(tree) {\n      var rs = [];\n\n      var traverse = function traverse(data) {\n        rs.push(data);\n\n        if (data.hasOwnProperty(\"domainInfos\")) {\n          for (var i in data.domainInfos) {\n            traverse(data.domainInfos[i]);\n          }\n        }\n      };\n\n      traverse(tree);\n      return rs;\n    };\n\n    var cancelClick = function cancelClick(row, source) {\n      scope.userlist.setWholeDisabled(false);\n\n      for (var i in source) {\n        source[i].disabled = false;\n      }\n\n      row.isEdit = \"default\";\n    };\n\n    var renderUserList = function renderUserList() {\n      var domainlist,\n          domaintree,\n          enterpriseUsers,\n          ifShow,\n          userTypeList = [],\n          queryAllRoles = [],\n          allRolesData = [],\n          allRolesDataDic = {},\n          userList = []; //用于执行顺序;\n\n      var saveClick = function saveClick(row, source) {\n        var cached = row.cached;\n        var userName = cached.userName;\n        var officePhone = cached.officePhone;\n        var domainID = cached.domainID;\n        scope.userlist.setWholeDisabled(false);\n\n        for (var i in source) {\n          source[i].disabled = false;\n        }\n\n        row.isEdit = \"default\";\n        delete row.cached;\n        var oldUser = row.$clone();\n        oldUser.userName = userName;\n        oldUser.officePhone = officePhone;\n        oldUser.domainID = domainID;\n\n        var modifyUser_callback = function modifyUser_callback(event) {\n          if (event.code == 0) {\n            row.userName = event.data.userName;\n            row.officePhone = event.data.officePhone;\n            row.domainID = event.data.domainID;\n            growl.success(\"用户修改成功\", {});\n          }\n        };\n\n        userUIService.modifyUser(oldUser, modifyUser_callback);\n      };\n\n      var deleteClick = function deleteClick(row, source) {\n        var fnlist = [{\n          label: TEXT.SUBMIT,\n          icon: 'btn btn-success',\n          style: {\n            'width': '50%',\n            'border-radius': 0,\n            'font-size': '18px',\n            'font-weight': 'bold',\n            'padding': 10\n          },\n          fn: function fn() {\n            ngDialog.close();\n            userUIService.deleteUser(row.userID, function (event) {\n              if (event.code == 0) {\n                row.remove();\n                growl.success(\"删除用户成功!\", {});\n              }\n            });\n          }\n        }, {\n          label: TEXT.CANCEL,\n          icon: 'btn btn-default',\n          style: {\n            'width': '50%',\n            'border-radius': 0,\n            'font-size': '18px',\n            'font-weight': 'bold',\n            'padding': 10\n          },\n          fn: function fn() {\n            ngDialog.close();\n          }\n        }];\n        scope.dialog = {\n          title: {\n            label: '提示'\n          },\n          description: {\n            label: '确认要删除此用户吗？'\n          },\n          fnlist: fnlist\n        };\n        ngDialog.open({\n          template: '../partials/dialogue/common_dia_prompt.html',\n          className: 'ngdialog-theme-plain',\n          scope: scope\n        });\n      };\n\n      var userEditClick = function userEditClick(row, source) {\n        // 获取缓存的所有设备\n        var cmdins = new cmd();\n        var specialtyProps = cmdins.getRootScope(\"myDicts\")[\"specialtyProps\"];\n        var find = false;\n\n        if (userTypeList.length > 0) {\n          find = userTypeList.find(function (elem) {\n            return elem.typeCode == 10;\n          });\n        }\n\n        var arr = [];\n        $.extend(arr, userTypeList);\n\n        if (!find) {\n          arr = arr.concat([{\n            modelId: 300,\n            label: '企业管理员',\n            typeCode: 10,\n            name: '管理员'\n          }]);\n        }\n\n        if (row.closingDate) {\n          row.closingDate = new Date(row.closingDate).toISOString().replace(/T/g, ' ').replace(/\\.[\\d]{3}Z/, '');\n        }\n\n        var clone = row.$clone();\n        var namelist = enterpriseUsers.filter(function (elem) {\n          return elem.userName != row.userName;\n        }).map(function (elem) {\n          return elem.userName;\n        });\n        var loginlist = enterpriseUsers.filter(function (elem) {\n          return elem.loginName != row.loginName;\n        }).map(function (elem) {\n          return elem.loginName;\n        });\n        var modelId, userType;\n\n        if (ifShow) {\n          var fd = arr.find(function (item) {\n            return clone.userType == item.typeCode;\n          });\n\n          if (fd) {\n            modelId = fd.modelId;\n          }\n\n          userType = clone.userType = arr.find(function (item) {\n            return clone.userType == item.typeCode;\n          });\n        }\n\n        var userSelf = false;\n\n        if (clone.userID == userLoginUIService.user.userID) {\n          userSelf = true;\n        }\n\n        var userInfo = {\n          \"apply\": modelId == 300 || clone.userType == 10 || clone.userType == 0 || clone.userType == undefined || !ifShow ? false : true,\n          \"value\": \"\",\n          \"label\": \"\",\n          \"right\": true,\n          \"data\": \"subDomain\",\n          \"type\": \"select\",\n          \"composory\": true,\n          \"options\": [],\n          \"events\": {\n            \"change\": function change(data) {\n              if (data.value == undefined) {\n                data.error = userInfo.label + \"不可为空\";\n                data.right = false;\n              } else {\n                data.error = undefined;\n                data.right = true;\n              }\n            }\n          }\n        };\n\n        if (modelId != 300 && ifShow) {\n          var fdname = arr.find(function (item) {\n            if (userType) {\n              return item.typeCode == clone.userType.typeCode;\n            } else {\n              return false;\n            }\n\n            ;\n          });\n          userInfo.label = fdname ? fdname.name : \"\";\n          var param = {\n            \"modelId\": userType ? userType.modelId : undefined,\n            \"layer\": userType ? clone.userType.layer : \"\"\n          };\n          resourceUIService.getDomainsByFilter(param, function (returnObj) {\n            if (returnObj.code == 0) {\n              userInfo.options = returnObj.data;\n            }\n\n            var findval = userInfo.options.find(function (item) {\n              return item.domainPath == clone.subDomain;\n            });\n\n            if (findval) {\n              userInfo.value = findval.id;\n            }\n          });\n        }\n\n        scope.dialog = {\n          title: \"用户信息\",\n          input: [{\n            \"value\": clone.domainPath,\n            \"label\": \"管理域\",\n            \"data\": \"domainID\",\n            \"type\": \"tree\",\n            \"key\": \"domainPath\",\n            \"width\": 200,\n            \"composory\": true,\n            \"right\": true,\n            \"options\": domaintree,\n            \"mark\": \"nodes\",\n            \"apply\": true,\n            \"disabled\": userSelf,\n            \"events\": {\n              \"change\": function change(data) {\n                if (ifShow && clone.userType != undefined) {\n                  scope.dialog.input.find(function (item) {\n                    if (item.data == \"subDomain\") {\n                      item.value = \"\";\n                      item.right = false;\n                    }\n                  });\n                  var param = {\n                    \"domainPath\": data.value,\n                    \"modelId\": clone.userType.modelId,\n                    \"layer\": clone.userType.layer\n                  };\n                  resourceUIService.getDomainsByFilter(param, function (returnObj) {\n                    if (returnObj.code == 0) {\n                      userInfo.options = returnObj.data;\n                    }\n                  });\n                }\n\n                if (!data.value) {\n                  data.error = \"默认域不可为空\";\n                  data.right = false;\n                } else {\n                  data.error = undefined;\n                  data.right = true;\n                }\n              }\n            }\n          }, {\n            \"value\": clone.userType,\n            \"apply\": ifShow,\n            \"label\": \"用户类型\",\n            \"data\": \"userType\",\n            \"type\": \"userType\",\n            \"disabled\": true,\n            \"composory\": true,\n            \"right\": true,\n            \"options\": arr,\n            \"events\": {\n              \"change\": function change(data) {\n                if (data.value != 300) {\n                  var param = {};\n\n                  if (!scope.baseConfig || !scope.baseConfig.extendDomain) {\n                    scope.dialog.input.forEach(function (item) {\n                      if (item.data == \"domainID\") {\n                        param.domainPath = item.value;\n                      }\n                    });\n                  }\n\n                  param.modelId = data.value;\n                  userInfo.apply = true;\n                  userInfo.right = false;\n                  userInfo.value = \"\";\n                  userInfo.label = data.options.find(function (item) {\n                    return item.id == data.value;\n                  }).name;\n                  resourceUIService.getDomainsByFilter(param, function (returnObj) {\n                    if (returnObj.code == 0) {\n                      userInfo.options = returnObj.data;\n                    }\n                  });\n                } else {\n                  userInfo.apply = false;\n                  userInfo.right = true;\n                }\n\n                if (data.value == undefined) {\n                  data.error = \"用户类型不可为空\";\n                  data.right = false;\n                } else {\n                  data.error = undefined;\n                  data.right = true;\n                }\n              }\n            }\n          }, userInfo, {\n            \"apply\": true,\n            \"label\": \"用户名称\",\n            \"value\": clone.userName,\n            \"maxlength\": 32,\n            \"data\": \"userName\",\n            \"type\": \"input\",\n            \"composory\": true,\n            \"right\": true,\n            \"events\": {\n              \"change\": function change(data) {\n                if (data.value == \"\") {\n                  data.error = \"用户名称不可为空\";\n                  data.right = false;\n                } else {\n                  if (namelist.indexOf(data.value) != -1) {\n                    data.error = \"用户名已存在\";\n                    data.right = false;\n                  } else {\n                    data.error = undefined;\n                    data.right = true;\n                  }\n                }\n              }\n            }\n          }, {\n            \"label\": \"登录名\",\n            \"apply\": true,\n            \"value\": clone.loginName,\n            \"maxlength\": 32,\n            \"composory\": true,\n            \"right\": true,\n            \"events\": {\n              \"change\": function change(data) {\n                if (data.value == \"\") {\n                  data.error = \"登录名不可为空\";\n                  data.right = false;\n                } else {\n                  if (loginlist.indexOf(data.value) != -1) {\n                    data.error = \"登录名已存在\";\n                    data.right = false;\n                  } else {\n                    var regExpNum = /\\d+/;\n                    var regExpNoNum = /\\D+/;\n                    var regExp = /^[A-Za-z0-9][A-Za-z0-9_-]{5,32}$/; // if (regExpNum.test(data.value) && regExpNoNum.test(data.value) && data.value.length > 5) {\n\n                    if (regExp.test(data.value)) {\n                      data.error = undefined;\n                      data.right = true;\n                    } else {\n                      data.error = \"请输入不低于6位的字母、数字和下划线，首字符不能是下划线。\";\n                      data.right = false;\n                    }\n                  }\n                }\n              },\n              \"blur\": function blur(data) {\n                if (!data.value || data.error) {\n                  return;\n                }\n\n                if (data.value != row.loginName) {\n                  userUIService.checkLoginName(data.value, function (returnObj) {\n                    if (returnObj.code == 0) {\n                      if (!returnObj.data) {\n                        data.error = \"登录名已存在\";\n                        data.right = false;\n                      } else {\n                        data.error = \"\";\n                        data.right = true;\n                      }\n                    }\n                  });\n                }\n              }\n            },\n            \"data\": \"loginName\",\n            \"type\": \"input\"\n          }, {\n            \"value\": function (e) {\n              if (e) {\n                var arr = e.split(\",\");\n                var specialties = [];\n                arr.forEach(function (ele) {\n                  specialties.push(ele);\n                });\n                return specialties;\n              }\n            }(clone.specialties),\n            //只支持数组clone.specialties,\n            \"label\": \"专业\",\n            \"data\": \"specialties\",\n            \"type\": \"multiple\",\n            \"options\": specialtyProps,\n            \"format\": {\n              id: \"valueCode\",\n              label: \"label\"\n            }\n          }, {\n            \"label\": \"到期日期\",\n            \"value\": clone.closingDate ? new Date(clone.closingDate).Format(\"yyyy-MM-dd\") : \"\",\n            \"apply\": clone.userID == userLoginUIService.user.userID ? false : true,\n            \"maxlength\": 32,\n            \"data\": \"closingDate\",\n            \"type\": \"data\",\n            \"resetdis\": true,\n            \"events\": {\n              \"change\": function change(data) {\n                var newData = new Date(data.value).Format(\"yyyy-MM-dd\");\n                var ckTime = checkDate(newData);\n\n                if (ckTime == false) {\n                  data.error = \"您选择的到期日期小于当前时间！\";\n                  data.right = false;\n                } else {\n                  data.error = undefined;\n                  data.right = true;\n                }\n              },\n              \"reset\": function reset(data) {\n                data.value = \"\";\n              }\n            }\n          }, {\n            \"label\": \"办公电话\",\n            \"maxlength\": 12,\n            \"value\": clone.officePhone,\n            \"right\": true,\n            \"composory\": false,\n            \"data\": \"officePhone\",\n            \"placeholder\": \"7－11位, 例如：53463333\",\n            \"events\": {\n              \"change\": function change(data) {\n                if (data.value == \"\") {\n                  data.error = undefined;\n                  data.right = true;\n                } else {\n                  var valid = checkValidmobile(data.value);\n\n                  if (valid == false) {\n                    data.error = \"不是有效的电话号码\";\n                    data.right = false;\n                  } else {\n                    data.error = undefined;\n                    data.right = true;\n                  }\n                }\n              }\n            },\n            \"type\": \"input\"\n          }, {\n            \"label\": \"备注\",\n            \"value\": clone.description,\n            \"data\": \"description\",\n            \"maxlength\": 200,\n            \"type\": \"textarea\"\n          }],\n          button: [{\n            label: TEXT.SUBMIT,\n            icon: \"btn btn-primary\",\n            disabledFn: function disabledFn() {\n              var every = scope.dialog.input.every(function (elem) {\n                var rs = elem.right && elem.value || elem.right == undefined || elem.apply != true;\n\n                if (rs != true) {}\n\n                return rs;\n              });\n              return !every;\n            },\n            fn: function fn() {\n              var errorStatus = -1;\n              scope.dialog.input.forEach(function (elem) {\n                if (elem.error) {\n                  errorStatus = 1;\n                  return;\n                }\n              });\n\n              if (errorStatus == -1) {\n                var self = scope.dialog;\n\n                var enterpriseUserRegister_callback = function enterpriseUserRegister_callback(event) {\n                  if (event.code == 0) {\n                    var newUser = event.data;\n\n                    var loop = function loop(elem) {\n                      row[elem.data] = event.data[elem.data];\n\n                      if (elem.data == 'domainID') {\n                        row.domainPath = event.data.domainPath;\n                      }\n                    };\n\n                    for (var i in self.input) {\n                      loop(self.input[i]);\n                    }\n\n                    growl.success(\"编辑用户成功\", {});\n                  } else {}\n                };\n\n                var oldUser = {},\n                    obj = {};\n\n                var loop = function loop(elem) {\n                  oldUser[elem.data] = elem.value;\n\n                  if (elem.data == 'domainID') {\n                    oldUser[elem.data] = elem.value.substring(0, elem.value.length - 1).substring(elem.value.substring(0, elem.value.length - 1).lastIndexOf(\"/\") + 1);\n                  } else if (elem.data == 'subDomain') {\n                    if (oldUser.subDomain) {\n                      oldUser[elem.data] = userInfo.options.find(function (item) {\n                        return oldUser.subDomain == item.id;\n                      }).domainPath;\n                    }\n                  } else if (elem.data == 'userType' && elem.value) {\n                    oldUser[elem.data] = elem.value.typeCode;\n                  } else if (elem.data == 'specialties' && elem.value) {\n                    oldUser[elem.data] = \"\";\n                    elem.value.forEach(function (ele) {\n                      if (ele) {\n                        oldUser[elem.data] += ele + \",\";\n                      }\n                    });\n                  }\n                };\n\n                for (var i in self.input) {\n                  loop(self.input[i]);\n                }\n\n                obj = extend({}, row, oldUser);\n                obj.domainID = oldUser.domainID == getDomainId(row.domainPath) ? null : oldUser.domainID;\n                userUIService.modifyUser(obj, enterpriseUserRegister_callback);\n                ngDialog.close();\n              }\n            }\n          }, {\n            label: TEXT.CANCEL,\n            icon: \"btn btn-default\",\n            fn: function fn() {\n              ngDialog.close();\n            }\n          }]\n        };\n        ngDialog.open({\n          template: '../partials/dialogue/config_alert_dia.html',\n          className: 'ngdialog-theme-plain',\n          scope: scope\n        });\n      };\n\n      function getDomainId(path) {\n        var match = /\\/(\\d+)\\/$/.exec(path);\n        return match ? match[1] : 0;\n      }\n\n      var addNewClick = function addNewClick(event) {\n        var cmdins = new cmd();\n        var specialtyProps = cmdins.getRootScope(\"myDicts\")[\"specialtyProps\"];\n        var namelist = enterpriseUsers.map(function (elem) {\n          return elem.userName;\n        });\n        var loginlist = enterpriseUsers.map(function (elem) {\n          return elem.loginName;\n        });\n        var emaillist = enterpriseUsers.map(function (elem) {\n          return elem.emailAddress;\n        });\n        var mobilelist = enterpriseUsers.map(function (elem) {\n          return elem.mobilePhone;\n        });\n        var newUserName = $$.duplicateName(\"新建用户\", namelist);\n        var newloginName = $$.duplicateName(\"newuser1\", loginlist, false);\n\n        scope.checkDisabled = function (target) {\n          if (typeof target == \"function\") {\n            return target();\n          } else {\n            return target;\n          }\n        };\n\n        var currentType = scope.userInfo.userType ? scope.userInfo.userType.toString() : \"\",\n            userTypeFilter = []; //10(企业管理员)\n\n        if (currentType && !scope.menuitems['A99_S17']) {\n          //没有编码，则只显示下级用户,有权限编码，则显示下级及所有用户\n          for (var key in userTypeList) {\n            var val = userTypeList[key].typeCode.toString();\n\n            if (val.indexOf(currentType) == 0) {\n              if (val.substring(currentType.length).length == 1) {\n                userTypeFilter.push(userTypeList[key]);\n              }\n            }\n          }\n\n          userTypeList = userTypeFilter;\n        }\n\n        var userInfo = {\n          \"apply\": false,\n          \"value\": undefined,\n          \"label\": \"\",\n          \"right\": false,\n          \"data\": \"subDomain\",\n          \"type\": \"select\",\n          \"composory\": true,\n          \"options\": [],\n          \"events\": {\n            \"change\": function change(data) {\n              if (data.value == undefined) {\n                data.error = userInfo.label + \"不可为空\";\n                data.right = false;\n              } else {\n                data.error = undefined;\n                data.right = true;\n              }\n            }\n          }\n        };\n        scope.dialog = {\n          title: \"用户信息\",\n          note: {\n            \"message\": \"系统将自动发送密码到所填手机号或邮箱，手机号或邮箱必选其一填写。\"\n          },\n          input: [{\n            \"value\": undefined,\n            \"label\": \"管理域\",\n            \"data\": \"domainID\",\n            \"type\": \"tree\",\n            \"right\": false,\n            \"key\": \"domainPath\",\n            \"width\": 200,\n            \"composory\": true,\n            \"options\": domaintree,\n            \"mark\": \"nodes\",\n            \"events\": {\n              \"change\": function change(data) {\n                if (ifShow) {\n                  scope.dialog.input.find(function (item) {\n                    if (item.data == \"userType\" || item.data == \"subDomain\") {\n                      item.value = \"\";\n                      item.right = false;\n                    }\n                  });\n                } else {\n                  scope.dialog.input.find(function (item) {\n                    if (item.data == \"userType\" || item.data == \"subDomain\") {\n                      item.value = \"\";\n                      item.right = true;\n                    }\n                  });\n                }\n\n                if (data.value == undefined) {\n                  data.error = \"默认域不可为空\";\n                  data.right = false;\n                } else {\n                  data.error = undefined;\n                  data.right = true;\n                }\n              }\n            }\n          }, {\n            \"value\": \"\",\n            \"apply\": ifShow,\n            \"label\": \"用户类型\",\n            \"data\": \"userType\",\n            \"type\": \"userType\",\n            \"composory\": true,\n            \"right\": true,\n            \"options\": userTypeList,\n            \"events\": {\n              \"change\": function change(data) {\n                if (data.value && data.value.modelId != 300) {\n                  var param = {};\n\n                  if (!scope.baseConfig || !scope.baseConfig.extendDomain) {\n                    scope.dialog.input.find(function (item) {\n                      if (item.data == \"domainID\") {\n                        param.domainPath = item.value;\n                      }\n                    });\n                  }\n\n                  param.modelId = data.value.modelId;\n                  param.layer = data.value.layer;\n                  userInfo.apply = true;\n                  userInfo.right = false;\n                  userInfo.label = data.options.find(function (item) {\n                    return item == data.value;\n                  }).name;\n                  resourceUIService.getDomainsByFilter(param, function (returnObj) {\n                    if (returnObj.code == 0) {\n                      userInfo.options = returnObj.data;\n                    }\n                  });\n                } else {\n                  userInfo.apply = false;\n                  userInfo.right = true;\n                }\n\n                if (data.value == undefined || data.value == '') {\n                  data.error = \"用户类型不可为空\";\n                  data.right = false;\n                } else {\n                  data.error = undefined;\n                  data.right = true;\n                }\n              }\n            }\n          }, userInfo, {\n            \"value\": undefined,\n            \"label\": \"默认角色\",\n            \"right\": false,\n            \"data\": \"role\",\n            \"type\": \"multiple\",\n            \"composory\": true,\n            \"options\": queryAllRoles,\n            \"events\": {\n              \"change\": function change(data) {\n                if (data.value.length == 0) {\n                  data.error = \"默认角色不可为空\";\n                  data.right = false;\n                } else {\n                  data.error = undefined;\n                  data.right = true;\n                }\n              }\n            }\n          }, {\n            \"value\": undefined,\n            \"label\": \"专业\",\n            \"data\": \"specialties\",\n            \"type\": \"multiple\",\n            \"options\": specialtyProps,\n            \"format\": {\n              id: \"valueCode\",\n              label: \"label\"\n            }\n          }, {\n            \"label\": \"用户名称\",\n            \"value\": \"\",\n            \"right\": false,\n            \"maxlength\": 32,\n            \"composory\": true,\n            \"data\": \"userName\",\n            \"events\": {\n              \"change\": function change(data) {\n                if (data.value == \"\") {\n                  data.error = \"用户名称不可为空\";\n                  data.right = false;\n                } else {\n                  if (namelist.indexOf(data.value) != -1) {\n                    data.error = \"用户名已存在\";\n                    data.right = false;\n                  } else {\n                    data.error = undefined;\n                    data.right = true;\n                  }\n                }\n              }\n            },\n            \"type\": \"input\"\n          }, {\n            \"label\": \"登录名\",\n            \"value\": \"\",\n            \"maxlength\": 32,\n            \"right\": false,\n            \"composory\": true,\n            \"data\": \"loginName\",\n            \"type\": \"input\",\n            \"events\": {\n              \"change\": function change(data) {\n                if (data.value == \"\") {\n                  data.error = \"登录名不可为空\";\n                  data.right = false;\n                } else {\n                  if (loginlist.indexOf(data.value) != -1) {\n                    data.error = \"登录名已存在\";\n                    data.right = false;\n                  } else {\n                    var regExpNum = /\\d+/;\n                    var regExpNoNum = /\\D+/;\n                    var regExp = /^[A-Za-z0-9][A-Za-z0-9_-]{5,32}$/;\n\n                    if (regExp.test(data.value)) {\n                      data.error = undefined;\n                      data.right = true;\n                    } else {\n                      data.error = \"请输入不低于6位的字母、数字和下划线，首字符不能是下划线。\";\n                      data.right = false;\n                    }\n                  }\n                }\n              },\n              \"blur\": function blur(data) {\n                if (!data.value || data.error) {\n                  return;\n                }\n\n                userUIService.checkLoginName(data.value, function (returnObj) {\n                  if (returnObj.code == 0) {\n                    if (!returnObj.data) {\n                      data.error = \"登录名已存在\";\n                      data.right = false;\n                    } else {\n                      data.error = \"\";\n                      data.right = true;\n                    }\n                  }\n                });\n              }\n            }\n          }, {\n            \"label\": \"到期日期\",\n            \"value\": \"\",\n            \"maxlength\": 32,\n            \"right\": true,\n            \"composory\": false,\n            \"data\": \"closingDate\",\n            \"type\": \"data\",\n            \"resetdis\": true,\n            \"events\": {\n              \"change\": function change(data) {\n                var newData = new Date(data.value).Format(\"yyyy-MM-dd\");\n                var ckTime = checkDate(newData);\n\n                if (ckTime == false) {\n                  data.error = \"您选择的到期日期小于当前时间！\";\n                  data.right = false;\n                } else {\n                  data.error = undefined;\n                  data.right = true;\n                }\n              },\n              \"reset\": function reset(data) {\n                data.value = \"\";\n                data.error = undefined;\n                data.right = true;\n              }\n            }\n          }, {\n            \"label\": \"手机号\",\n            \"maxlength\": 12,\n            \"value\": \"\",\n            \"right\": true,\n            \"composory\": false,\n            \"data\": \"mobilePhone\",\n            \"placeholder\": \"手机号或邮箱必选其一填写\",\n            \"events\": {\n              \"change\": function change(data) {\n                if (data.value == \"\") {\n                  data.error = \"\";\n                  data.right = true;\n                  return;\n                }\n\n                var numReg = /^1\\d{10}$/;\n\n                if (numReg.test(data.value) == false) {\n                  data.error = \"手机号必须是以1开头的11位数字\";\n                  data.right = false;\n                } else {\n                  if (mobilelist.indexOf(data.value) != -1) {\n                    data.error = \"手机号码已存在\";\n                    data.right = false;\n                  } else {\n                    data.error = undefined;\n                    data.right = true;\n                    var emailReg = /^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((\\.[a-zA-Z0-9_-]{2,3}){1,2})$/;\n                    scope.dialog.input.find(function (item) {\n                      if (item.data == \"emailAddress\") {\n                        if (item.value == \"\" || item.value && emailReg.test(item.value)) {\n                          item.right = true;\n                        }\n                      }\n                    });\n                  }\n                }\n              }\n            },\n            \"type\": \"input\"\n          }, {\n            \"label\": \"邮箱\",\n            \"maxlength\": 32,\n            \"value\": \"\",\n            \"composory\": false,\n            \"right\": true,\n            \"placeholder\": \"手机号或邮箱必选其一填写\",\n            \"data\": \"emailAddress\",\n            \"events\": {\n              \"change\": function change(data) {\n                if (data.value == \"\") {\n                  data.error = \"\";\n                  data.right = true;\n                  return;\n                }\n\n                var emailReg = /^[a-zA-Z0-9_-].+@[a-zA-Z0-9_-]+(\\.[a-zA-Z0-9_-]+)+$/;\n                ;\n\n                if (emailReg.test(data.value) == false) {\n                  data.right = false;\n                  data.error = \"不是正确的邮箱格式\";\n                } else {\n                  if (emaillist.indexOf(data.value) != -1) {\n                    data.error = \"邮箱已存在\";\n                    data.right = false;\n                  } else {\n                    data.error = undefined;\n                    data.right = true;\n                    var numReg = /^1\\d{10}$/;\n                    scope.dialog.input.find(function (item) {\n                      if (item.data == \"mobilePhone\") {\n                        if (item.value == \"\" || item.value && numReg.test(item.value)) {\n                          item.right = true;\n                        }\n                      }\n                    });\n                  }\n                }\n              }\n            },\n            \"type\": \"input\"\n          }, {\n            \"label\": \"办公电话\",\n            \"maxlength\": 12,\n            \"value\": \"\",\n            \"right\": true,\n            \"composory\": false,\n            \"data\": \"officePhone\",\n            \"placeholder\": \"7－11位, 例如：53463333\",\n            \"events\": {\n              \"change\": function change(data) {\n                if (data.value == \"\") {\n                  data.error = undefined;\n                  data.right = true;\n                } else {\n                  var valid = checkValidmobile(data.value);\n\n                  if (valid == false) {\n                    data.error = \"不是有效的电话号码\";\n                    data.right = false;\n                  } else {\n                    data.error = undefined;\n                    data.right = true;\n                  }\n                }\n              }\n            },\n            \"type\": \"input\"\n          }, {\n            \"label\": \"备注\",\n            \"value\": \"\",\n            \"data\": \"description\",\n            \"maxlength\": 200,\n            \"type\": \"textarea\"\n          }, {\n            \"label\": \"启用\",\n            \"value\": true,\n            \"data\": \"status\",\n            \"type\": \"toggle\"\n          }],\n          button: [{\n            label: TEXT.SUBMIT,\n            icon: \"btn btn-primary\",\n            disabledFn: function disabledFn() {\n              var every = scope.dialog.input.every(function (elem) {\n                var rs = elem.right != false || elem.apply == false;\n\n                if (rs != true) {}\n\n                return rs;\n              });\n              return !every;\n            },\n            fn: function fn() {\n              var role = [];\n              var self = scope.dialog;\n\n              var enterpriseUserRegister_callback = function enterpriseUserRegister_callback(event) {\n                if (event.code == 0) {\n                  var newUser = event.data;\n                  userRoleUIService.queryRoleByUser(event.data.userID, function (returnObj) {\n                    newUser.roles = returnObj.data;\n                  });\n                  enterpriseUsers.pushbefore(newUser);\n                  growl.success(\"创建新用户成功\", {});\n                  ngDialog.close();\n                }\n\n                ;\n              };\n\n              var newUser = {};\n\n              var loop = function loop(elem) {\n                newUser[elem.data] = elem.value;\n\n                if (elem.data == 'domainID') {\n                  newUser[elem.data] = elem.value.substring(0, elem.value.length - 1).substring(elem.value.substring(0, elem.value.length - 1).lastIndexOf(\"/\") + 1);\n                } else if (elem.data == 'subDomain') {\n                  if (newUser.subDomain) {\n                    newUser[elem.data] = userInfo.options.find(function (elem) {\n                      return newUser.subDomain == elem.id;\n                    }).domainPath;\n                  }\n                } else if (elem.data == 'role') {\n                  elem.value.forEach(function (item) {\n                    role.push({\n                      roleID: item\n                    });\n                  });\n                } else if (elem.data == 'userType') {\n                  newUser[elem.data] = elem.value.typeCode;\n                } else if (elem.data == 'specialties' && elem.value) {\n                  newUser[elem.data] = \"\";\n                  elem.value.forEach(function (ele) {\n                    newUser[elem.data] += ele + \",\";\n                  });\n                }\n              };\n\n              for (var i in self.input) {\n                loop(self.input[i]);\n              }\n\n              var domain;\n\n              for (var key in domainlist) {\n                if (domainlist[key].id == newUser.domainID) {\n                  domain = domainlist[key];\n                }\n              }\n\n              if (domain) {\n                domain = {\n                  userID: \"\",\n                  domainID: domain.id,\n                  domainPath: domain.domainPath,\n                  name: domain.name\n                };\n              }\n\n              delete newUser.domainID;\n              delete newUser.role;\n              newUser.status = newUser.status ? 0 : -1;\n\n              if (scope.baseConfig && scope.baseConfig.extendDomain) {\n                newUser.domains = domain.domainPath;\n              }\n\n              if (!newUser.mobilePhone && !newUser.emailAddress) {\n                growl.warning(\"请手机号或邮箱选其一进行填写\", {});\n                return;\n              }\n\n              userUIService.enterpriseUserRegister(newUser, domain, role, enterpriseUserRegister_callback);\n            }\n          }, {\n            label: TEXT.CANCEL,\n            icon: \"btn btn-default\",\n            fn: function fn() {\n              ngDialog.close();\n            }\n          }]\n        };\n        ngDialog.open({\n          template: '../partials/dialogue/config_alert_dia.html',\n          className: 'ngdialog-theme-plain',\n          scope: scope\n        });\n      };\n\n      var assignCharacter = function assignCharacter(list) {\n        var inx = 0;\n        var rs = [];\n        var assignRole = list;\n\n        var allLoaded = function allLoaded() {\n          var finished = function finished() {\n            var roles = scope.cache.role.$clone();\n            var roleArr = [];\n            var hasUserType2 = list.some(function (elem) {\n              return elem.userType == 2;\n            });\n\n            if (list.length > 1) {\n              for (var i in roles) {\n                roles[i].applied = false;\n\n                if (roles[i].roleID != 101 || roles[i].roleID != 103) {\n                  //暂时没有企业B角色\n                  roleArr.push(roles[i]);\n                }\n              }\n            } else if (list.length == 1) {\n              for (var i in roles) {\n                if (rs.indexOf(roles[i].roleID) != -1) {\n                  roles[i].applied = true;\n                  roleArr.push(roles[i]);\n                } else {\n                  if (roles[i].roleID != 101 && roles[i].roleID != 103) {\n                    roleArr.push(roles[i]);\n                  }\n                }\n\n                ;\n              }\n            }\n\n            scope.dialog = {\n              title: \"角色分配\",\n              titles: ['未分配角色', '已分配角色'],\n              mark: \"roleName\",\n              characters: roleArr,\n              button: [{\n                label: TEXT.SUBMIT,\n                icon: \"btn btn-primary\",\n                fn: function fn() {\n                  var inx = 0;\n                  var rls = roles.filter(function (elem) {\n                    return elem.applied == true;\n                  }).map(function (elem) {\n                    return elem.roleID;\n                  });\n\n                  if (rls.length <= 0) {\n                    growl.warning(\"必须要有一个已分配角色\", {});\n                    return;\n                  }\n\n                  var removeRole = function removeRole(userID) {\n                    var rem = [];\n\n                    for (var i in roles) {\n                      var tmp = -1;\n\n                      for (var j in rls) {\n                        if (roles[i].roleID == rls[j]) {\n                          tmp = j;\n                          break;\n                        }\n                      }\n\n                      if (tmp == -1) {\n                        rem.push(roles[i].roleID);\n                      }\n                    }\n\n                    if (rem.length > 0) {\n                      userRoleUIService.removeRole(list[0].userID, rem, function (res) {\n                        if (res.code == 0) {\n                          for (var i in assignRole) {\n                            assignRole[i].roleID = rls.join(\",\");\n                          }\n\n                          $$.cacheAsyncData.call(userRoleUIService.queryRoleByUser, [list[0].userID], function (event) {\n                            if (event.code == 0) {\n                              list[0].roles = res.data;\n                            }\n                          });\n                          growl.success(\"角色分配成功\", {});\n                        } else {}\n                      });\n                    }\n                  };\n\n                  var completeMsg;\n\n                  var complete = function complete(list) {\n                    ngDialog.close();\n\n                    if (completeMsg) {\n                      growl.warning(completeMsg, {});\n                    } else {\n                      removeRole(list);\n                    }\n                  };\n\n                  var traverse = function traverse(list) {\n                    var item = list[inx];\n\n                    if (list[inx]) {\n                      list[inx].selected = false;\n\n                      var success = function success(event) {\n                        if (event.code == 0) {\n                          var findManager = event.data.find(function (elem) {\n                            return elem.roleID == 100 || elem.roleID == 101 || elem.roleID == 102 || elem.roleID == 103;\n                          });\n                          /* if (findManager) {\n                           if (rls.indexOf(findManager.roleID) == -1) {\n                           completeMsg = \"管理员角色不能被删除\";\n                           };\n                           };*/\n\n                          $$.cacheAsyncData.call(userRoleUIService.queryRoleByUser, [item.userID], function (event) {\n                            if (event.code == 0) {\n                              item.roles = event.data;\n                            }\n                          });\n                        } else {\n                          return;\n                        }\n\n                        ;\n                        inx++;\n                        traverse(list);\n                      };\n\n                      var error = function error(_error) {\n                        inx++;\n                        traverse(list);\n                      };\n\n                      userRoleUIService.appendRole(list[inx].userID, rls, success, error);\n                    } else {\n                      complete(list);\n                    }\n                  };\n\n                  traverse(list);\n                }\n              }, {\n                label: TEXT.CANCEL,\n                icon: \"btn btn-default\",\n                fn: function fn() {\n                  ngDialog.close();\n                }\n              }]\n            };\n            ngDialog.open({\n              template: '../partials/dialogue/character_assign_dia.html',\n              className: 'ngdialog-theme-plain',\n              scope: scope\n            });\n          };\n\n          var queryEnterpriseRole_back = function queryEnterpriseRole_back(event) {\n            if (event.code == 0) {\n              var eventAllRoles = [];\n              event.data.forEach(function (item) {\n                item.id = item.roleID;\n                item.label = item.roleName;\n\n                if (userLoginUIService.user.domainPath.split(\"/\").length <= 4 || item.domainPath.search(userLoginUIService.user.domainPath) > -1) {\n                  eventAllRoles.push(item);\n                }\n              });\n              scope.cache.role = eventAllRoles.map(function (elem) {\n                if (userLoginUIService.user.userID == 1 && elem.roleID != 101 && elem.roleID != 103) {\n                  if (elem.roleID == 100 || elem.roleID == 102) {\n                    elem.roleName += \"A\";\n                  }\n                }\n\n                return elem;\n              });\n              finished();\n            }\n          };\n\n          if (scope.cache.role == undefined) {\n            userEnterpriseService.queryEnterpriseRole(queryEnterpriseRole_back);\n          } else {\n            finished();\n          }\n\n          ;\n        };\n\n        var traverse = function traverse(list) {\n          var callback = function callback(event) {\n            if (event.code == \"0\") {\n              var loop = function loop(item) {\n                var map = rs.map(function (el) {\n                  return el.roleID;\n                });\n\n                if (item && map.indexOf(item.roleID) == -1) {\n                  rs.push(item.roleID);\n                }\n              };\n\n              var roleList = list[inx].roles;\n\n              for (var i in roleList) {\n                loop(roleList[i]);\n              }\n            }\n\n            ;\n            inx++;\n            traverse(list);\n          };\n\n          if (list[inx]) {\n            $$.cacheAsyncData.call(userRoleUIService.queryRoleByUser, [list[inx].userID], callback);\n          } else {\n            allLoaded();\n          }\n        };\n\n        traverse(list);\n      };\n\n      var setEnable = function setEnable(list, callback) {\n        var editableUser = list.filter(function (elem) {\n          return elem.status != 0 && elem.userID != userLoginUIService.user.userID;\n        });\n        var diseditableUser = list.filter(function (elem) {\n          return elem.status == 0 && elem.userID != userLoginUIService.user.userID;\n        });\n        var fnlist = [{\n          label: TEXT.SUBMIT,\n          icon: 'btn btn-success',\n          style: {\n            width: '50%',\n            'border-radius': 0,\n            'font-size': '18px',\n            'font-weight': 'bold',\n            'padding': 10\n          },\n          fn: function fn() {\n            var users = editableUser.map(function (elem) {\n              return elem.userID;\n            });\n            userUIService.enableUsers(users, function (event) {\n              if (event.code == 0) {\n                for (var i in editableUser) {\n                  editableUser[i].status = 0;\n                }\n\n                enterpriseUsers.removeAllChecked();\n\n                if (callback) {\n                  callback();\n                } else {\n                  var msg = \"启用用户，成功\" + event.data.successObj.length + \"个,失败\" + event.data.failObj.length + \"个\";\n                  growl.success(msg, {});\n                }\n\n                ngDialog.close();\n              }\n            });\n          }\n        }, {\n          label: TEXT.CANCEL,\n          icon: 'btn btn-default',\n          style: {\n            width: '50%',\n            'border-radius': 0,\n            'font-size': '18px',\n            'font-weight': 'bold',\n            'padding': 10\n          },\n          fn: function fn() {\n            ngDialog.close();\n          }\n        }];\n        scope.dialog = {\n          title: {\n            label: '提示'\n          },\n          description: {\n            label: editableUser.length > 1 ? '当前有' + editableUser.length + '个用户未启用状态，确认要启用吗？' : '确认要启用' + editableUser[0].userName + '用户吗？'\n          },\n          fnlist: fnlist\n        };\n        ngDialog.open({\n          template: '../partials/dialogue/common_dia_prompt.html',\n          className: 'ngdialog-theme-plain',\n          scope: scope\n        });\n      };\n\n      var setEnableGroupClick = function setEnableGroupClick(source) {\n        setEnable(source);\n      };\n\n      var setEnableClick = function setEnableClick(row) {\n        setEnable([row], function () {\n          var msg = \"已启用成功\";\n          growl.success(msg, {});\n        });\n      };\n\n      var setDisable = function setDisable(list, callback) {\n        var editableUser = list.filter(function (elem) {\n          return elem.status == 0 && elem.userID != userLoginUIService.user.userID;\n        });\n        var diseditableUser = list.filter(function (elem) {\n          return elem.status != 0 && elem.userID != userLoginUIService.user.userID;\n        });\n        var fnlist = [{\n          label: TEXT.SUBMIT,\n          icon: 'btn btn-success',\n          style: {\n            width: '50%',\n            'border-radius': 0,\n            'font-size': '18px',\n            'font-weight': 'bold',\n            'padding': 10\n          },\n          fn: function fn() {\n            var users = editableUser.map(function (elem) {\n              return elem.userID;\n            });\n\n            if (users.length > 0) {\n              userUIService.disableUsers(users, function (event) {\n                if (event.code == 0) {\n                  for (var i in editableUser) {\n                    editableUser[i].status = -1;\n                  }\n\n                  enterpriseUsers.removeAllChecked();\n\n                  if (callback) {\n                    callback();\n                  } else {\n                    var msg = \"停用用户，成功\" + event.data.successObj.length + \"个, 失败\" + event.data.failObj.length + \"个\";\n                    growl.success(msg, {});\n                  }\n\n                  ngDialog.close();\n                }\n              });\n            } else {\n              if (callback) {\n                callback();\n              } else {\n                var msg = \"停用用户，成功\" + editableUser.length + \"个, 失败\" + diseditableUser.length + \"个\";\n                growl.success(msg, {});\n              }\n\n              ngDialog.close();\n            }\n          }\n        }, {\n          label: TEXT.CANCEL,\n          icon: 'btn btn-default',\n          style: {\n            width: '50%',\n            'border-radius': 0,\n            'font-size': '18px',\n            'font-weight': 'bold',\n            'padding': 10\n          },\n          fn: function fn() {\n            ngDialog.close();\n          }\n        }];\n\n        if (editableUser.length <= 0) {\n          growl.info(\"不能停用自己的账号\", {});\n          return;\n        }\n\n        scope.dialog = {\n          title: {\n            label: '提示'\n          },\n          description: {\n            label: editableUser.length > 1 ? '当前有 ' + editableUser.length + ' 个用户启用状态，停用后将禁止登录系统，确认要停用吗' : '用户停用后将禁止登录系统，确认要停用 ' + editableUser[0].userName + ' 用户吗？'\n          },\n          fnlist: fnlist\n        };\n        ngDialog.open({\n          template: '../partials/dialogue/common_dia_prompt.html',\n          className: 'ngdialog-theme-plain',\n          scope: scope\n        });\n      };\n\n      var setDisableGroupClick = function setDisableGroupClick(source) {\n        setDisable(source);\n      };\n\n      var setDisableClick = function setDisableClick(row) {\n        setDisable([row], function () {\n          var msg = \"已停用成功\";\n          growl.success(msg, {});\n        });\n      };\n\n      var assignCharacterGroupClick = function assignCharacterGroupClick(event) {\n        assignCharacter(event);\n      };\n\n      var assignCharacterClick = function assignCharacterClick(row, source) {\n        assignCharacter([row]);\n      };\n\n      scope.allDomain = [];\n      scope.allDomainDic = {};\n      scope.defaultDeviceIds = [];\n      scope.allDomainTree = {};\n      scope.accredit = 'domain';\n      scope.all = {\n        \"check\": false\n      };\n      scope.allDevice = [];\n\n      var domainAllot = function domainAllot(row, source) {\n        window.location.href = \"/app-oc/index.html#/prod_authorize_domain/\" + row.userID;\n        return;\n        scope.allDomain = scope.allDomainInit.slice(0);\n\n        var dialogueHtml = function dialogueHtml(data) {\n          scope.domainList = [];\n          scope.all.check = false;\n          var ids = row.domainIds;\n\n          if (row.domainIds && scope.allDomainDic[row.domainPath] != undefined && row.domainIds.indexOf(\"\" + scope.allDomainDic[row.domainPath].id + \"\") == -1) {\n            ids = ids + \",\" + scope.allDomainDic[row.domainPath].id;\n          } else {\n            if (scope.allDomainDic[row.domainPath] != undefined && row.domainIds.indexOf(\"\" + scope.allDomainDic[row.domainPath].id + \"\") == -1) {\n              ids = scope.allDomainDic[row.domainPath].id + \"\";\n            }\n          }\n\n          var domainIdsArr = ids.split(\",\");\n\n          for (var j in domainIdsArr) {\n            for (var n in scope.allDomain) {\n              if (scope.allDomain[n].id == domainIdsArr[j]) {\n                scope.domainList.push(scope.allDomain[n]);\n                scope.allDomain.splice(n, 1);\n                break;\n              }\n            }\n          }\n\n          ngDialog.open({\n            template: '../partials/dialogue/default_domain.html',\n            scope: scope,\n            className: 'ngdialog-theme-plain'\n          });\n        };\n\n        scope.domainObj = row;\n        dialogueHtml();\n      };\n\n      scope.defaultDomainAction = function (select, type) {\n        if (type == \"add\" && scope.domainObj.domainIds) {\n          for (var j in scope.domainList) {\n            var selDomainPath = scope.allDomainDic[scope.domainObj.domainIds].domainPath;\n            var domainPath = scope.domainList[j].domainPath;\n            var domainPathStr = domainPath.split(\"/\");\n\n            if (scope.allDomainDic[scope.domainObj.domainIds].id == scope.domainList[j].id) {\n              growl.warning(\"您选择的域已存在\", {});\n              scope.domainObj.domainIds = \"\";\n              return;\n            }\n\n            for (var i in domainPathStr) {\n              if (domainPathStr[i] == \"\" + scope.allDomainDic[scope.domainObj.domainIds].id + \"\") {\n                growl.warning(\"不能选当前域的父域\", {});\n                scope.domainObj.domainIds = \"\";\n                return;\n              }\n            }\n\n            if (selDomainPath.indexOf(\"\" + scope.domainList[j].id + \"\") != -1) {\n              growl.warning(\"不能选当前域的低级别域，删除父域在添加\", {});\n              scope.domainObj.domainIds = \"\";\n              return;\n            }\n          }\n\n          scope.allDomain.splice(jQuery.inArray(scope.allDomainDic[scope.domainObj.domainIds], scope.allDomain), 1);\n          scope.domainList.push(scope.allDomainDic[scope.domainObj.domainIds]);\n          scope.domainObj.domainIds = \"\";\n        } else if (type == \"del\") {\n          scope.domainObj.domainIds = \"\";\n\n          for (var i in scope.domainList) {\n            if (scope.domainList[i].id == select.id) {\n              scope.allDomain.push(scope.domainList[i]);\n              scope.domainList.splice(i, 1);\n              break;\n            }\n          }\n        } else if (type == \"save\") {\n          var domainIds = \"\";\n\n          for (var i in scope.domainList) {\n            domainIds += scope.domainList[i].id + \",\";\n          } // 所选的设备\n\n\n          var domainIdsAllot = [];\n\n          for (var j in scope.devices) {\n            if (scope.devices[j].check) {\n              domainIdsAllot.push(scope.devices[j].id);\n            }\n          }\n\n          var modifyUser_callback = function modifyUser_callback(event) {\n            if (event.code == 0) {\n              growl.success(\"默认扩展域修改成功\", {});\n            }\n          };\n\n          scope.domainObj.domainIds = domainIds;\n          scope.domainObj.deviceIds = domainIdsAllot;\n          scope.domainObj.deviceDomainId = select.split(\"/\")[select.split(\"/\").length - 2]; //当前的域的Id\n\n          userUIService.modifyUser(scope.domainObj, modifyUser_callback);\n        }\n      };\n      /**\n       * 查询设备\n       * @param obj\n       */\n\n\n      var deviceQuery = function deviceQuery(obj, selecedDeviceStr) {\n        resourceUIService.getDevicesByCondition(obj, function (returnObj) {\n          if (returnObj.code == 0) {\n            returnObj.data.forEach(function (item) {\n              var cmdins = new cmd();\n              var customNameArr = cmdins.getdomainNameHandler(item.domains, []);\n              var customName = \"\";\n\n              for (var i = 1; i < customNameArr.length; i++) {\n                customName += customNameArr[i] + \"/\";\n              }\n\n              item[\"customName\"] = customName;\n              item[\"check\"] = false;\n\n              if (selecedDeviceStr.indexOf(item.id) > -1) {\n                item.check = true;\n              }\n            });\n            scope.devices = returnObj.data;\n          }\n        }, \"includeFields=label,domains,id\");\n      };\n      /**\n       * 完成了数据授权的功能\n       * 检查上次有没有选中设备\n       * 查询所选的域下有多少设备\n       *\n       * HANXING  2018.06.15\n       */\n\n\n      scope.queryDevice = function (domains, name) {\n        // 所选的设备\n        scope.department = domains;\n        var selecedDeviceStr = \"\";\n        userUIService.queryUserDeviceByDeviceDomains(scope.domainObj.userID, domains, function (resultObj) {\n          if (resultObj && resultObj.data.length > 0) {\n            resultObj.data.forEach(function (ele) {\n              selecedDeviceStr += ele.deviceId + \";\";\n            });\n          }\n\n          deviceQuery({\n            domains: domains,\n            label: name\n          }, selecedDeviceStr);\n        });\n      };\n\n      var resetPwd = function resetPwd(row, source) {\n        var fnlist = [{\n          label: TEXT.SUBMIT,\n          icon: 'btn btn-primary',\n          style: {\n            width: '50%',\n            'border-radius': 0,\n            'font-size': '18px',\n            'font-weight': 'bold',\n            'padding': 10\n          },\n          fn: function fn() {\n            ngDialog.close();\n\n            if (row.userID != userLoginUIService.user.userID) {\n              if (row.emailAddress == \"\" || row.emailAddress == null) {\n                userUIService.sendModifyPassword(row.mobilePhone, function (resultObj) {\n                  if (resultObj.code == 0) {\n                    growl.success(\"重置密码成功,请查收\", {});\n                  }\n                });\n              } else {\n                userUIService.sendModifyPassword(row.emailAddress, function (resultObj) {\n                  if (resultObj.code == 0) {\n                    growl.success(\"重置密码成功,请查收\", {});\n                  }\n                });\n              }\n\n              ;\n            } else {\n              growl.warning(\"不能重置自己密码!\", {});\n            }\n          }\n        }, {\n          label: TEXT.CANCEL,\n          icon: 'btn btn-default',\n          style: {\n            width: '50%',\n            'border-radius': 0,\n            'font-size': '18px',\n            'font-weight': 'bold',\n            'padding': 10\n          },\n          fn: function fn() {\n            ngDialog.close();\n          }\n        }];\n        scope.dialog = {\n          title: {\n            label: '提示'\n          },\n          description: {\n            label: '确认要重置该用户密码？'\n          },\n          fnlist: fnlist\n        };\n        ngDialog.open({\n          template: '../partials/dialogue/common_dia_prompt.html',\n          className: 'ngdialog-theme-plain',\n          scope: scope\n        });\n      };\n\n      var loadedCount = 0;\n\n      var queryEnterpriseUser_back = function queryEnterpriseUser_back(event) {\n        if (event.code == 0) {\n          if (!scope.menuitems['A99_S17']) {\n            //如果不存在跨域用户权限，不显示上一级别的用户\n            enterpriseUsers = event.data.filter(function (item) {\n              if (item.domainPath.search(userLoginUIService.user.domainPath) > -1) {\n                return true;\n              }\n\n              return false;\n            });\n          } else {\n            enterpriseUsers = event.data;\n          }\n\n          loadedCount++;\n\n          if (loadedCount == 4) {\n            userListHandler();\n          }\n        }\n      };\n      /*queryEnterpriseUser_back*/\n\n\n      var queryDomainTree_back = function queryDomainTree_back(event) {\n        domainlist = event.domainListDic;\n        domaintree = {\n          nodes: event.data,\n          domainInfos: event.data\n        }; // for (var item in event.domainListDic) {\n        //    \n        //   if(event.domainListDic[item].domains){\n        //     var cmdins = new cmd();\n        //     var customNameArr = cmdins.getdomainNameHandler(event.domainListDic[item].domains, []);\n        //     var customName = \"\";\n        //     for (var i = 1; i < customNameArr.length; i++) {\n        //       customName += customNameArr[i] + \"/\";\n        //     }\n        //     event.domainListDic[obj][\"customName\"] = customName;\n        //   }\n        // }\n\n        scope.allDomainTree = event.data;\n        scope.allDomainDic = event.domainListDic;\n        scope.allDomainInit = event.data[0].domainInfos;\n        loadedCount++;\n\n        if (loadedCount == 4) {\n          userListHandler();\n        }\n      };\n\n      var userListHandler = function userListHandler() {\n        enterpriseUsers.forEach(function (user) {\n          if (user.roleID) {\n            user.roles = [];\n            user.roleID.split(\",\").forEach(function (roleId) {\n              user.roles.push(allRolesDataDic[roleId]);\n            });\n          }\n        });\n        var headerArr = [];\n        var optList = [];\n\n        if (scope.menuitems['D02_A01_S17']) {\n          headerArr.push({\n            icon: \"fa fa-plus\",\n            'class': \"btn btn-primary btn-sm\",\n            label: \"添加用户\",\n            style: {\n              margin: \"2px\"\n            },\n            type: \"button\",\n            events: {\n              click: addNewClick\n            }\n          });\n        }\n\n        if (scope.menuitems['D05_A01_S17']) {\n          headerArr.push({\n            icon: \"fa fa-play\",\n            'class': \"btn btn-default btn-sm\",\n            label: \"启用\",\n            style: {\n              margin: \"2px\"\n            },\n            type: \"button\",\n            disabled: function disabled(event) {\n              var some = event.some(function (elem) {\n                return elem.selected == true && elem.status == -1;\n              });\n              return !some;\n            },\n            events: {\n              click: setEnableGroupClick\n            }\n          });\n        }\n\n        if (scope.menuitems['D06_A01_S17']) {\n          headerArr.push({\n            icon: \"fa fa-stop\",\n            'class': \"btn btn-default btn-sm\",\n            label: \"停用\",\n            style: {\n              margin: \"2px\"\n            },\n            type: \"button\",\n            disabled: function disabled(event) {\n              var some = event.some(function (elem) {\n                return elem.selected == true && elem.status == 0;\n              });\n              return !some;\n            },\n            events: {\n              click: setDisableGroupClick\n            }\n          });\n        }\n\n        if (scope.menuitems['D03_A01_S17']) {\n          optList.push({\n            label: \"编辑\",\n            type: \"button\",\n            'class': \"btn btn-primary\",\n            events: {\n              click: userEditClick\n            }\n          });\n        }\n\n        if (scope.menuitems['D04_A01_S17']) {\n          optList.push({\n            label: \"删除\",\n            type: \"button\",\n            'class': \"btn btn-default\",\n            disabled: function disabled(row, source) {\n              return row.userID == userLoginUIService.user.userID || row.status == 0;\n            },\n            events: {\n              click: deleteClick\n            }\n          });\n        }\n\n        if (scope.menuitems['D07_A01_S17']) {\n          optList.push({\n            label: \"角色分配\",\n            type: \"button\",\n            'class': \"btn btn-default\",\n            events: {\n              click: assignCharacterClick\n            }\n          });\n        }\n\n        if (scope.menuitems['D08_A01_S17']) {\n          optList.push({\n            label: \"重置密码\",\n            type: \"button\",\n            'class': \"btn btn-default\",\n            visible: function visible(row, source) {\n              return row.userID != userLoginUIService.user.userID;\n            },\n            events: {\n              click: resetPwd\n            }\n          });\n        }\n\n        if (scope.menuitems['D09_A01_S17']) {\n          optList.push({\n            label: \"数据授权 \",\n            type: \"button\",\n            'class': \"btn btn-default\",\n            visible: function visible(row, source) {\n              return row.userID != userLoginUIService.user.userID;\n            },\n            events: {\n              click: domainAllot\n            }\n          });\n        }\n\n        if (scope.menuitems['D05_A01_S17']) {\n          optList.push({\n            label: \"启用\",\n            type: \"button\",\n            'class': \"btn btn-default\",\n            visible: function visible(row) {\n              return row.status == -1;\n            },\n            events: {\n              click: setEnableClick\n            }\n          });\n        }\n\n        if (scope.menuitems['D06_A01_S17']) {\n          optList.push({\n            label: \"停用\",\n            type: \"button\",\n            'class': \"btn btn-default\",\n            visible: function visible(row) {\n              return row.status == 0 && row.userID != userLoginUIService.user.userID;\n            },\n            events: {\n              click: setDisableClick\n            }\n          });\n        }\n\n        var defs = [{\n          label: \"用户名称\",\n          width: \"10%\",\n          editable: true,\n          sortable: true,\n          filterable: true,\n          data: \"userName\",\n          type: \"text\",\n          modes: {\n            'default': {\n              type: \"text\"\n            },\n            edit: {\n              type: \"input\",\n              placeholder: \"例如：请填写用户名，用户名不可为空\"\n            }\n          }\n        }, {\n          label: \"登录名\",\n          width: \"10%\",\n          editable: true,\n          sortable: true,\n          filterable: true,\n          data: \"loginName\",\n          type: \"text\",\n          modes: {\n            'default': {\n              type: \"text\"\n            },\n            edit: {\n              type: \"input\",\n              placeholder: \"例如：请填写用户名，用户名不可为空\"\n            }\n          }\n        }, {\n          label: \"手机号\",\n          width: \"10%\",\n          editable: true,\n          sortable: true,\n          filterable: true,\n          data: \"mobilePhone\",\n          type: \"text\",\n          format: function format(value) {\n            return value ? value : \"-\";\n          },\n          modes: {\n            'default': {\n              type: \"text\"\n            },\n            edit: {\n              type: \"input\",\n              placeholder: \"例如：请填写用户名，用户名不可为空\"\n            }\n          }\n        }, {\n          label: \"邮箱\",\n          width: \"10%\",\n          type: \"text\",\n          sortable: true,\n          filterable: true,\n          data: \"emailAddress\",\n          format: function format(value) {\n            return value ? value : \"-\";\n          },\n          modes: {\n            'default': {\n              type: \"text\"\n            },\n            edit: {\n              type: \"text\"\n            }\n          }\n        }, {\n          label: \"已分配角色\",\n          type: \"selectObj\",\n          sortable: true,\n          filterable: true,\n          filterFormat: {\n            label: \"roleName\",\n            value: \"roleID\"\n          },\n          data: \"roles\",\n          options: allRolesData,\n          format: function format(value) {\n            if (!value) return \"\";\n            var value = value.map(function (elem) {\n              if (elem && elem.roleName != undefined) {\n                return elem.roleName;\n              }\n            });\n            return value.toString();\n          },\n          modes: {\n            'default': {\n              type: \"text\"\n            },\n            edit: {\n              type: \"input\",\n              placeholder: \"例如：010-66668888\"\n            }\n          }\n        }, {\n          label: \"管理域\",\n          type: \"tree\",\n          sortable: true,\n          filterable: true,\n          data: \"domainPath\",\n          key: \"domainPath\",\n          mark: \"nodes\",\n          options: domaintree,\n          format: function format(value) {\n            if (!value) return \"-\";\n            var find = domainlist[value];\n\n            if (find) {\n              return find.label;\n            } else {\n              return \"-\";\n            }\n          },\n          modes: {\n            'default': {\n              type: \"text\"\n            }\n          }\n        }, {\n          label: \"状态\",\n          width: \"30px\",\n          type: \"status\",\n          sortable: true,\n          filterable: true,\n          'class': function _class(row) {\n            if (row.status == 0) {\n              return \"label-success\";\n            } else {\n              return \"label-default\";\n            }\n          },\n          style: function style(col) {\n            return {\n              \"cursor\": \"default\"\n            };\n          },\n          format: function format(value) {\n            if (value == 0) {\n              return \"已启用\";\n            } else {\n              return \"未启用\";\n            }\n          },\n          data: \"status\"\n        }, {\n          label: \"操作\",\n          type: \"buttonGroup\",\n          filterable: false,\n          sortable: false,\n          width: \"141px\",\n          modes: {\n            'default': {\n              options: optList\n            },\n            edit: {\n              options: [{\n                label: \"保存\",\n                type: \"button\",\n                'class': \"btn btn-primary\",\n                events: {\n                  click: saveClick\n                }\n              }, {\n                label: \"取消\",\n                type: \"button\",\n                'class': \"btn btn-default\",\n                events: {\n                  click: cancelClick\n                }\n              }]\n            }\n          }\n        }]; //如果没有配置用户类型将不会显示\n\n        if (ifShow == true) {\n          defs[1] = {\n            label: \"用户类型\",\n            apply: true,\n            editable: true,\n            sortable: true,\n            data: \"userType\",\n            type: \"text\",\n            format: function format(value) {\n              var find = userList.find(function (elem) {\n                return elem.id == value;\n              });\n\n              if (find) {\n                return find.label;\n              } else if (value == 10) {\n                return \"企业管理员\";\n              } else {\n                return \"-\";\n              }\n            },\n            modes: {\n              'default': {\n                type: \"text\"\n              },\n              edit: {\n                type: \"input\"\n              }\n            }\n          };\n        }\n\n        scope.userlist = {\n          source: enterpriseUsers,\n          header: headerArr,\n          columnDefs: defs\n        };\n      };\n      /*queryDomainTree_back*/\n\n\n      userEnterpriseService.queryEnterpriseRole(function (returnObj) {\n        if (returnObj.code == 0) {\n          queryAllRoles = [];\n          var rs = [];\n\n          for (var i in returnObj.data) {\n            if (returnObj.data[i]) {\n              rs.push(returnObj.data[i]);\n            }\n          }\n\n          rs.forEach(function (item) {\n            item.id = item.roleID;\n            item.label = item.roleName;\n            allRolesData.push(item);\n            allRolesDataDic[item.id] = item;\n\n            if (userLoginUIService.user.domainPath.split(\"/\").length <= 4 || item.domainPath.search(userLoginUIService.user.domainPath) > -1) {\n              queryAllRoles.push(item);\n            }\n          });\n          scope.cache.role = queryAllRoles.map(function (elem) {\n            if (userLoginUIService.user.userID == 1 && elem.roleID != 101 && elem.roleID != 103) {\n              if (elem.roleID == 100 || elem.roleID == 102) {\n                elem.roleName += \"A\";\n              }\n            }\n\n            return elem;\n          });\n          loadedCount++;\n\n          if (loadedCount == 4) {\n            userListHandler();\n          }\n        }\n\n        ;\n      });\n      /**\n       * 这个bug是在用户管理页面\n       * 刚开始表格管理域显示正常，一刷新管理域有的不显示\n       * 问题是: scope.baseConfig.extendDomain 这个属性没有找到,是接口异步的问题\n       * hanxing 2018.07.06\n       */\n\n      resourceUIService.getExtendDomainsByFilter({}, queryDomainTree_back);\n      /*\n      if (scope.baseConfig && scope.baseConfig.extendDomain) {\n        resourceUIService.getExtendDomainsByFilter({}, queryDomainTree_back);\n      } else {\n        userDomainService.queryDomainTree(userLoginUIService.user.userID, queryDomainTree_back);\n      }\n      */\n\n      var getConfigsByGroupName_back = function getConfigsByGroupName_back(returnObj) {\n        if (returnObj.code == 0 && returnObj.data[0]) {\n          ifShow = true;\n          userList = JSON.parse(returnObj.data[0].value);\n          userTypeList = JSON.parse(returnObj.data[0].value);\n          userList.forEach(function (item) {\n            item.id = item.typeCode;\n          });\n        } else if (returnObj.code == 0 && returnObj.data.length == 0) {\n          userTypeList = [{\n            typeCode: 10,\n            modelId: 300,\n            name: '企业用户'\n          }];\n          userList = [{\n            id: 300,\n            typeCode: 10,\n            modelId: 300,\n            label: '企业用户'\n          }];\n          ifShow = false;\n        }\n\n        loadedCount++;\n\n        if (loadedCount == 4) {\n          userListHandler();\n        }\n      };\n      /*getConfigsByGroupName_back*/\n\n\n      configUIService.getConfigsByGroupName(\"UserType\", getConfigsByGroupName_back);\n      userUIService.queryUserByCondition({}, queryEnterpriseUser_back);\n    };\n\n    var renderRoleList = function renderRoleList() {\n      var roleList = [],\n          enterpriseUsers;\n\n      var checkRole = function checkRole(str) {\n        var role = str + \"\";\n        return role.length < 5;\n      };\n\n      var permissionAssignment = function permissionAssignment(row) {\n        rootScope.currentRole = row.roleID;\n        location.path(\"usermanager/permission/menus/\" + row.roleID);\n      };\n\n      var assignCharacter = function assignCharacter(list) {\n        var inx = 0;\n        var rs = [];\n\n        var allLoaded = function allLoaded() {\n          var finished = function finished() {\n            var roles = scope.cache.role.$clone(); // var hasUserType2 = list.some(function(elem) {\n            //   return elem.userType == 2;\n            // });\n\n            if (list.length > 1) {\n              for (var i in roles) {\n                roles[i].applied = false;\n              }\n            } else if (list.length == 1) {\n              for (var i in roles) {\n                if (rs.indexOf(roles[i].userID) != -1) {\n                  roles[i].applied = true;\n                }\n\n                ;\n              }\n            }\n\n            scope.dialog = {\n              title: \"用户分配\",\n              titles: ['未分配用户', '已分配用户'],\n              mark: \"userName\",\n              characters: roles,\n              button: [{\n                label: TEXT.SUBMIT,\n                icon: \"btn btn-primary\",\n                fn: function fn() {\n                  var inx = 0;\n                  var rls = roles.filter(function (elem) {\n                    return elem.applied == true;\n                  }).map(function (elem) {\n                    return elem.userID;\n                  });\n\n                  var removeRole = function removeRole(list) {\n                    for (var k in rls) {\n                      rs.splice($.inArray(rls[k], rs), 1);\n                    }\n\n                    userRoleUIService.removeUser(rs, list[0].roleID, function (res) {\n                      if (res.code == 0) {\n                        growl.success(\"用户分配成功\", {});\n                      } else {}\n                    });\n                  };\n\n                  var completeMsg;\n\n                  var complete = function complete(list) {\n                    ngDialog.close();\n\n                    if (completeMsg) {\n                      growl.warning(completeMsg, {});\n                    } else {\n                      removeRole(list);\n                    }\n                  };\n\n                  var traverse = function traverse(list) {\n                    if (list[inx]) {\n                      list[inx].selected = false;\n\n                      var success = function success(event) {\n                        if (event.code == 0) {// var findManager = event.data.find(function(elem) {\n                          //   return elem.roleID == 100 || elem.roleID == 101 || elem.roleID == 102 || elem.roleID == 103;\n                          // });\n                          // if (findManager) {\n                          //   if (rls.indexOf(findManager.roleID) == -1) {\n                          //     completeMsg = \"管理员用户不能被删除\";\n                          //   };\n                          // };\n                        }\n\n                        ;\n                        inx++;\n                        traverse(list);\n                      };\n\n                      var error = function error(_error2) {\n                        inx++;\n                        traverse(list);\n                      };\n\n                      userRoleUIService.appendUser(rls, list[inx].roleID, success, error);\n                    } else {\n                      complete(list);\n                    }\n                  };\n\n                  traverse(list);\n                }\n              }, {\n                label: TEXT.CANCEL,\n                icon: \"btn btn-default\",\n                fn: function fn() {\n                  ngDialog.close();\n                }\n              }]\n            };\n            ngDialog.open({\n              template: '../partials/dialogue/character_assign_dia.html',\n              className: 'ngdialog-theme-plain',\n              scope: scope\n            });\n          };\n\n          var queryEnterpriseUser_back = function queryEnterpriseUser_back(event) {\n            if (event.code == 0) {\n              scope.cache.role = event.data.map(function (elem) {\n                return elem;\n              });\n              finished();\n            }\n          };\n\n          if (scope.cache.role == undefined) {\n            userUIService.queryUserByCondition({}, queryEnterpriseUser_back);\n          } else {\n            finished();\n          }\n\n          ;\n        };\n\n        var traverse = function traverse(list) {\n          var callback = function callback(event) {\n            if (event.code == \"0\") {\n              var loop = function loop(item) {\n                var map = rs.map(function (el) {\n                  return el.userID;\n                });\n\n                if (map.indexOf(item.userID) == -1) {\n                  rs.push(item.userID);\n                }\n              };\n\n              for (var i in event.data) {\n                loop(event.data[i]);\n              }\n            }\n\n            ;\n            inx++;\n            traverse(list);\n          };\n\n          if (list[inx]) {\n            userRoleUIService.getAssociateRole2User({\n              roleID: list[inx].roleID\n            }, callback);\n          } else {\n            allLoaded();\n          }\n        };\n\n        traverse(list);\n      };\n\n      var associateRole2User = function associateRole2User(row, source) {\n        assignCharacter([row]);\n      };\n\n      var editClick = function editClick(row, source) {\n        var namelist = roleList.filter(function (elem) {\n          return elem.roleID != row.roleID;\n        }).map(function (elem) {\n          return elem.roleName;\n        });\n        /** var newRoleName = $$.duplicateName(\"新建角色\", namelist); */\n\n        scope.dialog = {\n          title: {\n            label: \"角色信息\"\n          },\n          input: [{\n            \"label\": \"角色名称\",\n            \"value\": row.roleName,\n            \"composory\": true,\n            \"data\": \"roleName\",\n            \"type\": \"input\",\n            \"maxlength\": 32,\n            \"onChange\": function onChange(item) {\n              //角色存在同一有后端提示 tyq\n              // if (item.value && namelist.indexOf(item.value) != -1) {\n              //   item.error = \"角色名称已存在，请更换角色名称\";\n              //   item.right = false;\n              // } else\n              if (item.value == \"\") {\n                item.error = \"角色名称不可为空\";\n                item.right = false;\n              } else {\n                item.error = undefined;\n                item.right = true;\n              }\n            }\n          }, {\n            \"label\": \"角色描述\",\n            \"value\": row.description,\n            \"composory\": false,\n            maxlength: 200,\n            \"data\": \"description\",\n            \"type\": \"textarea\"\n          }],\n          fnlist: [{\n            label: TEXT.SUBMIT,\n            icon: \"btn btn-primary\",\n            disabledFn: function disabledFn() {\n              var every = scope.dialog.input.every(function (elem) {\n                return elem.right != false;\n              });\n              return !every;\n            },\n            fn: function fn() {\n              var self = scope.dialog;\n              var oldRole = row.$clone();\n\n              var loop = function loop(elem) {\n                oldRole[elem.data] = elem.value;\n              };\n\n              oldRole.domainID = userLoginUIService.user.domainID;\n              oldRole.domainPath = userLoginUIService.user.domainPath;\n\n              for (var i in self.input) {\n                loop(self.input[i]);\n              }\n\n              var modifyRole_callback = function modifyRole_callback(event) {\n                if (event.code == 0) {\n                  var newUser = event.data;\n\n                  var loop = function loop(elem) {\n                    row[elem.data] = event.data[elem.data];\n                  };\n\n                  for (var i in self.input) {\n                    loop(self.input[i]);\n                  }\n\n                  growl.success(\"角色修改成功\", {});\n                } else {}\n              };\n\n              userRoleUIService.modifyRole(oldRole, modifyRole_callback);\n              ngDialog.close();\n            }\n          }, {\n            label: TEXT.CANCEL,\n            icon: \"btn btn-default\",\n            fn: function fn() {\n              ngDialog.close();\n            }\n          }]\n        };\n        ngDialog.open({\n          template: '../partials/dialogue/common_dia.html',\n          className: 'ngdialog-theme-plain',\n          scope: scope\n        });\n      };\n\n      var addNewClick = function addNewClick(event) {\n        var namelist = roleList.map(function (elem) {\n          return elem.roleName;\n        }); // var newRoleName = $$.duplicateName(\"新建角色\", namelist);\n\n        var newRoleName = \"新建角色\";\n        scope.dialog = {\n          title: {\n            label: \"角色信息\"\n          },\n          input: [{\n            \"label\": \"角色名称\",\n            \"value\": newRoleName,\n            \"composory\": true,\n            \"data\": \"roleName\",\n            \"type\": \"input\",\n            \"maxlength\": 32,\n            \"onChange\": function onChange(item) {\n              //角色已存在统一由后端提示 tyq\n\n              /*    if (item.value && namelist.indexOf(item.value) != -1) {\n               item.error = \"角色名称已存在，请更换角色名称\";\n               item.right = false;\n               } else */\n              if (item.value == \"\") {\n                item.error = \"角色名称不可为空\";\n                item.right = false;\n              } else {\n                item.error = undefined;\n                item.right = true;\n              }\n            }\n          }, {\n            \"label\": \"角色描述\",\n            \"value\": \"角色描述\",\n            \"composory\": false,\n            maxlength: 200,\n            \"data\": \"description\",\n            \"type\": \"textarea\"\n          }],\n          fnlist: [{\n            label: TEXT.SUBMIT,\n            icon: \"btn btn-primary\",\n            disabledFn: function disabledFn() {\n              var every = scope.dialog.input.every(function (elem) {\n                return elem.right != false;\n              });\n              return !every;\n            },\n            fn: function fn() {\n              var self = scope.dialog;\n              var newRole = {};\n\n              var loop = function loop(elem) {\n                newRole[elem.data] = elem.value;\n              };\n\n              newRole.domainID = userLoginUIService.user.domainID;\n              newRole.domainPath = userLoginUIService.user.domainPath;\n\n              for (var i in self.input) {\n                loop(self.input[i]);\n              }\n\n              var addRole_callback = function addRole_callback(event) {\n                if (event.code == 0) {\n                  var newUser = event.data;\n                  roleList.pushbefore(newUser);\n                  growl.success(\"创建新角色成功\", {});\n                } else {}\n              };\n\n              userRoleUIService.addRole(newRole, addRole_callback);\n              ngDialog.close();\n            }\n          }, {\n            label: TEXT.CANCEL,\n            icon: \"btn btn-default\",\n            fn: function fn() {\n              ngDialog.close();\n            }\n          }]\n        };\n        ngDialog.open({\n          template: '../partials/dialogue/common_dia.html',\n          className: 'ngdialog-theme-plain',\n          scope: scope\n        });\n      };\n\n      var deleteGroupClick = function deleteGroupClick(source) {\n        var fnlist = [{\n          label: TEXT.SUBMIT,\n          icon: 'btn btn-success',\n          style: {\n            width: '50%',\n            'border-radius': 0,\n            'font-size': '18px',\n            'font-weight': 'bold',\n            'padding': 10\n          },\n          fn: function fn() {\n            ngDialog.close();\n            var roleIChecked = source.filter(function (elem) {\n              return elem.selected == true;\n            });\n            var inx = 0,\n                msg = \"\";\n\n            var delectRole = function delectRole(role) {\n              if (role) {\n                inx++; // if (!checkRole(role.roleID)) { 所有的角色都可以删除\n\n                var param = {\n                  \"roleID\": role.roleID\n                };\n                userRoleUIService.deleteRole(param, function (data) {\n                  if (data.code == 0) {\n                    role.remove();\n                    msg = \"角色删除成功\";\n                  }\n\n                  ;\n                  delectRole(roleIChecked[inx]);\n                }); // } else {\n                //   delectRole(roleIChecked[inx])\n                // }\n              } else {\n                if (msg != \"\") {\n                  growl.success(\"角色删除成功\", {});\n                }\n              }\n            };\n\n            delectRole(roleIChecked[inx]);\n          }\n        }, {\n          label: TEXT.CANCEL,\n          icon: 'btn btn-default',\n          style: {\n            width: '50%',\n            'border-radius': 0,\n            'font-size': '18px',\n            'font-weight': 'bold',\n            'padding': 10\n          },\n          fn: function fn() {\n            ngDialog.close();\n          }\n        }];\n        scope.dialog = {\n          title: {\n            label: '提示'\n          },\n          description: {\n            label: '确认要删除所选角色吗？'\n          },\n          fnlist: fnlist\n        };\n        ngDialog.open({\n          template: '../partials/dialogue/common_dia_prompt.html',\n          className: 'ngdialog-theme-plain',\n          scope: scope\n        });\n      };\n\n      var saveClick = function saveClick(row, source) {\n        var namelist = roleList.filter(function (elem) {\n          return row.roleName != elem.roleName;\n        }).map(function (elem) {\n          return elem.roleName;\n        });\n        var roleName = row.cached.roleName;\n\n        if (roleName == \"\") {\n          growl.warning(\"角色名不可为空\", {});\n        } else if (namelist.indexOf(roleName) == -1) {\n          var description = row.cached.description;\n          var roleID = row.roleID;\n          scope.userlist.setWholeDisabled(false);\n\n          for (var i in source) {\n            source[i].disabled = false;\n          }\n\n          row.isEdit = \"default\";\n          delete row.cached;\n          var oldRole = {\n            roleName: roleName,\n            description: description,\n            roleID: roleID\n          };\n          userRoleUIService.modifyRole(oldRole, function (event) {\n            if (event.code == 0) {\n              row.roleName = event.data.roleName;\n              row.description = event.data.description;\n              growl.success(\"修改角色成功\", {});\n              callback(true);\n            } else {\n              growl.warning(\"修改角色失败!\", {});\n            }\n          });\n        } else {\n          growl.warning(\"角色名已存在，请跟换\", {});\n        }\n      };\n\n      var deleteClick = function deleteClick(row, source) {\n        var fnlist = [{\n          label: TEXT.SUBMIT,\n          icon: 'btn btn-success',\n          style: {\n            width: '50%',\n            'border-radius': 0,\n            'font-size': '18px',\n            'font-weight': 'bold',\n            'padding': 10\n          },\n          fn: function fn() {\n            ngDialog.close();\n            var delectRole = {\n              \"roleID\": row.roleID\n            };\n            userRoleUIService.deleteRole(delectRole, function (data) {\n              if (data.code == 0) {\n                row.remove();\n                growl.success(\"删除角色成功\", {});\n              } else {//growl.warning(\"删除角色失败\", {});\n              }\n            });\n          }\n        }, {\n          label: TEXT.CANCEL,\n          icon: 'btn btn-default',\n          style: {\n            width: '50%',\n            'border-radius': 0,\n            'font-size': '18px',\n            'font-weight': 'bold',\n            'padding': 10\n          },\n          fn: function fn() {\n            ngDialog.close();\n          }\n        }];\n        scope.dialog = {\n          title: {\n            label: '提示'\n          },\n          description: {\n            label: '确认要删除这个角色吗？'\n          },\n          fnlist: fnlist\n        };\n        ngDialog.open({\n          template: '../partials/dialogue/common_dia_prompt.html',\n          className: 'ngdialog-theme-plain',\n          scope: scope\n        });\n      };\n\n      var queryEnterpriseRole_back = function queryEnterpriseRole_back(event) {\n        if (event.code == 0) {\n          /* 用户只能看到属于自己域和子域的角色 */\n          var removeEmpty = function removeEmpty(data) {\n            var rs = [];\n\n            for (var i in data) {\n              // userLoginUIService.user.domainPath.split(\"/\").length <= 4表示企业管理员或者超级管理员\n              if (userLoginUIService.user.domainPath.split(\"/\").length <= 4 || data[i] != null && data[i].domainPath.search(userLoginUIService.user.domainPath) > -1) {\n                rs.push(data[i]);\n              }\n            }\n\n            return rs;\n          };\n\n          if (event.data != null) {\n            if (event.data.length > 0) {\n              var roleArr = [];\n\n              for (var n in event.data) {\n                if (event.data[n] && event.data[n].roleID != 101 && event.data[n].roleID != 103) {\n                  //暂时没有企业B角色\n                  roleArr.push(event.data[n]);\n                }\n              }\n\n              roleList = removeEmpty(roleArr);\n              var roleHeader = [];\n              var roleOption = [];\n\n              if (scope.menuitems['D02_A02_S17']) {\n                roleHeader.push({\n                  icon: \"fa fa-plus\",\n                  'class': \"btn btn-primary btn-sm\",\n                  label: \"添加角色\",\n                  style: {\n                    margin: \"2px\"\n                  },\n                  type: \"button\",\n                  events: {\n                    click: addNewClick\n                  }\n                });\n              }\n\n              if (scope.menuitems['D04_A02_S17']) {\n                roleHeader.push({\n                  icon: \"glyphicon glyphicon-minus\",\n                  'class': \"btn btn-default btn-sm\",\n                  label: \"删除角色\",\n                  style: {\n                    margin: \"2px\"\n                  },\n                  type: \"button\",\n                  disabled: function disabled(event) {\n                    var checked = event.filter(function (elem) {\n                      return elem.selected == true;\n                    });\n\n                    if (checked.length == 0) {\n                      return true;\n                    } else {\n                      for (var i in checked) {\n                        if (checked[i].roleID == 100) {\n                          return true;\n                        }\n                      }\n                    }\n                  },\n                  events: {\n                    click: deleteGroupClick\n                  }\n                });\n              }\n\n              if (scope.menuitems['D03_A02_S17']) {\n                roleOption.push({\n                  label: \"编辑\",\n                  type: \"button\",\n                  'class': \"btn btn-primary\",\n                  disabled: function disabled(row) {\n                    if (userLoginUIService.user.userID == 1) {\n                      return false;\n                    } else {\n                      return checkRole(row.roleID);\n                    }\n                  },\n                  events: {\n                    click: editClick\n                  }\n                });\n              }\n\n              if (scope.menuitems['D04_A02_S17']) {\n                roleOption.push({\n                  label: \"删除\",\n                  type: \"button\",\n                  'class': \"btn btn-default\",\n                  disabled: function disabled(row) {\n                    if (userLoginUIService.user.userID == 1) {\n                      return false;\n                    } else {\n                      if (row.roleID == 100) {\n                        return true;\n                      }\n                    } //else {\n                    // return checkRole(row.roleID);\n                    //}\n\n                  },\n                  events: {\n                    click: deleteClick\n                  }\n                });\n              }\n\n              if (scope.menuitems['D05_A02_S17']) {\n                roleOption.push({\n                  label: \"权限设置\",\n                  type: \"button\",\n                  'class': \"btn btn-default\",\n                  visible: function visible(row) {\n                    if (userLoginUIService.user.userID == 1) {\n                      return true;\n                    } else {\n                      var ck = checkRole(row.roleID);\n                      return !ck;\n                    }\n                  },\n                  events: {\n                    click: permissionAssignment\n                  }\n                });\n              }\n\n              if (scope.menuitems['D06_A02_S17']) {\n                roleOption.push({\n                  label: \"用户分配\",\n                  type: \"button\",\n                  'class': \"btn btn-default\",\n                  events: {\n                    click: associateRole2User\n                  }\n                });\n              }\n\n              scope.userlist = {\n                source: roleList,\n                rowclass: function rowclass(elem) {\n                  return rootScope.currentRole == elem.roleID ? \"current\" : \"\";\n                },\n                header: roleHeader,\n                columnDefs: [{\n                  label: \"角色名称\",\n                  type: \"text\",\n                  filterable: true,\n                  data: \"roleName\",\n                  width: \"30%\",\n                  modes: {\n                    'default': {\n                      type: \"text\"\n                    },\n                    edit: {\n                      type: \"input\"\n                    }\n                  },\n                  format: function format(value, row) {\n                    if (userLoginUIService.user.userID == 1) {\n                      if (row.roleID == 100 || row.roleID == 102) {\n                        return value + \"A\";\n                      } else if (row.roleID == 101 || row.roleID == 103) {\n                        return value + \"B\";\n                      } else {\n                        return value;\n                      }\n                    } else {\n                      return value;\n                    }\n                  }\n                }, {\n                  label: \"角色描述\",\n                  type: \"text\",\n                  filterable: true,\n                  data: \"description\",\n                  modes: {\n                    'default': {\n                      type: \"text\"\n                    },\n                    edit: {\n                      type: \"input\"\n                    }\n                  }\n                }, {\n                  label: \"操作\",\n                  type: \"buttonGroup\",\n                  filterable: false,\n                  sortable: false,\n                  width: \"161px\",\n                  modes: {\n                    'default': {\n                      options: roleOption\n                    },\n                    edit: {\n                      options: [{\n                        label: \"保存\",\n                        type: \"button\",\n                        'class': \"btn btn-primary\",\n                        events: {\n                          click: saveClick\n                        }\n                      }, {\n                        label: \"取消\",\n                        type: \"button\",\n                        'class': \"btn btn-default\",\n                        events: {\n                          click: cancelClick\n                        }\n                      }]\n                    }\n                  }\n                }]\n              };\n            } else {\n              growl.error(\"角色列表为空，请刷新页面重试\");\n            }\n          } else {\n            growl.error(\"角色列表为空，请刷新页面重试\");\n          }\n\n          ;\n        }\n      };\n\n      var queryEnterpriseUser_back = function queryEnterpriseUser_back(event) {\n        if (event.code == 0) {\n          if (event.data != null) {\n            if (event.data.length > 0) {\n              if (!scope.menuitems['A99_S17']) {\n                //如果不存在跨域用户权限，不显示上一级别的用户\n                enterpriseUsers = event.data.filter(function (item) {\n                  if (item.domainPath.search(userLoginUIService.user.domainPath) > -1) {\n                    return true;\n                  }\n\n                  return false;\n                });\n              } else {\n                enterpriseUsers = event.data;\n              }\n\n              userEnterpriseService.queryEnterpriseRole(queryEnterpriseRole_back);\n            } else {\n              growl.error(\"用户列表为空，请刷新页面重试\");\n            }\n          } else {\n            growl.error(\"用户列表为空，请刷新页面重试\");\n          }\n        }\n\n        ;\n      };\n\n      userUIService.queryUserByCondition({}, queryEnterpriseUser_back);\n    };\n\n    var init = function init() {\n      if (scope.panel == 'user') {\n        renderUserList();\n      } else {\n        renderRoleList();\n      }\n    };\n    /*\n     * 监听登录状态\n     */\n\n\n    if (!userLoginUIService.user.isAuthenticated) {\n      scope.$on('loginStatusChanged', function (evt, d) {\n        if (userLoginUIService.user.isAuthenticated) {\n          init();\n        }\n      });\n    } else {\n      init();\n    }\n  }]);\n});"],"sourceRoot":"/source/"}