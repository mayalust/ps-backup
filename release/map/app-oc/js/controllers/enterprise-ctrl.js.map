{"version":3,"sources":["app-oc/js/controllers/enterprise-ctrl.js"],"names":["define","controllers","BootstrapDialog","initController","$scope","$routeParams","$timeout","$q","$location","ngDialog","userLoginUIService","energyConsumeUIService","growl","userDomainService","selectedCount","deferList","$watch","n","o","industryList","myDicts","forEach","item","id","valueCode","text","param","dialog","title","input","name","statisticsType","industryType","province","city","county","address","createTime","Date","list","provincesList","provinces","periodList","label","cityList","districtList","event","provinceClick","provinceId","districtId","cityDics","cityClick","cityId","districtDics","button","disabled","fn","values","standardAddress","addEnterpriseInfo","returnObj","code","searchData","success","updateEnterpriseInfo","close","addNewClick","obj","open","template","className","scope","tableInit","header","time","select","queryState","state","clacTime","clacKqiByTime","warning","doAction","type","callback","show","closable","message","buttons","cssClass","action","dialogRef","deleteEnterpriseInfo","$apply","pipeline","opts","conf","$","extend","pages","url","data","method","cacheLower","cacheUpper","cacheLastRequest","cacheLastJson","request","drawCallback","settings","ajax","requestStart","start","drawStart","requestLength","length","requestEnd","sort","columns","order","column","sortType","dir","clearCache","JSON","stringify","search","isFunction","d","isPlainObject","pageRequest","statCount","draw","getEnterpriceByPage","queryList","total","json","recordsTotal","undefined","recordsFiltered","splice","queryItem","findEnterpriseInfosByCondition","$broadcast","Event","ENTERPRISEINIT","option","init","defer","queryDomainTree","user","userID","domainListTree","domainListDic","resolve","push","promise","all","then","isAuthenticated","$on","evt","unitService","userType","ifShowEnter","unitList","units","unitDics","enterpriseId","desc","unit","every","elem","right","addProduct","newproduct","queryAllList","broardFun","updateProduct","objList","delete","addClick","goClear","deleteProduct","sel","i","findProducts","enterpriseList","routeParamsId","productId","occupyPrcent","energyConsumeNodeId","verifyFun","value","r","test","mistakeMesg","parseInt","addProductStruct","updateProductStruct","deleteProductStruct","parseFloat","findProductStructs","queryEnergyTree","energyListTree","energyListDic","findProductById","domainPath","initData","ifView","statisticsPeriod","ary","Format","split","enterpriseOperateInfo","productionValue","additionalValue","ignoreList","year","month","quarter","hasOwnProperty","productYields","yield","yieldUnit","statisticsYear","yearList","statisticsMonth","monthList","statisticsQuarter","key","join","addEnterpriseOperateInfoDto","updateEnterpriseOperateInfoDto","add","concat","changeYear","deleteEnterpriseOperateInfoDto","updateEnterpriseOperateInfoCommitStatus","findProductYieldsByOperateId","String","findEnterpriseOperateInfos","deferred","domains","findEnterpriseInfoById","findEnterpriseInfoByDomainPath","productName","sortList","sortList2","setting","boxClass","ulClass","liClass","placeholder","cursor","delay","distance","clipboard","ifGovernment","granularityList","filter","location","hash","enterpriseSize","contactPhone","contactEmail","website","business","editClick","phone","email","currentInfo","userInfo","timeout","resourceUIService","tab","ifEnterprise","lastReducePeriodData","thisReduceIndicator","publishReduceEnergy","reduceEnergyList","dialog2","publishForecastResult","ForecastResult","reducePeriod","forecastClick","saveReduceEnergy","lastCompleteStatus","energyTypeForecastData","some","energyType","queryEnterpriseById","findLastEnergyByEnterpriseId","findForecastResult","searchDate","findReduceEnergyListByCondition","findForecastResultsByCondition","getDomainsByFilter","modelId","layer","EnterprisesDic","allEnterprises","queryEnterpriseList","on","e","target","closest","removeClass","children","addClass","aname","attr","$filter","dictionaryService","kpiDataService","require","document","getElementById","energyDic","initAllData","lastYear","getFullYear","lastMonth","getMonth","queryDitem","unshift","clear","industryDic","statisticsTypeDic","MONTH","QUARTER","YEAR","fomatData","energyByEnterpriseIdAry","energyByIndustryCodeAry","echartData","xAxis","map","enterpriseAry","industryCodeAry","result","legend","series","setOption","subtext","x","y","tooltip","trigger","axisPointer","crossStyle","color","toolbox","feature","dataView","readOnly","magicType","restore","saveAsImage","boundaryGap","axisLabel","interval","yAxis","formatter","industryCode","enterpriseInfo","isRealTimeData","nodeIds","domainID","kpiCodes","timeRange","statisticType","includeInstance","condList","timePeriod","dataType","getValueList","instanceAry","instance","instanceName","instanceCode","energyName","energyCode","startTime","endTime","aggregateType","granularityUnit","goSearch","info","findEnterpriseInfos","filterLastDic","filterBestDic","filterBestAry","filterLastAry","filterBestValue","industryLastValue","filterByIndustryType","datestr","bestIndustryCodeAry","lastIndustryCodeAry","lastTime","insertTime","goSubmit","industryName","instanceObj","paramAry","nodeId","kpiCode","saveMarkValue","insShortName","bestindustryCode","insShorteName","echart","target1","kpiCodeDic","3301","3304","3300","unitCodeDic","industryShortType","dicts","topN","enterpriseInfoAry","getOption","orient","left","radius","center","itemStyle","emphasis","shadowBlur","shadowOffsetX","shadowColor","margin","series1","queryEnterpriseByTopN","range","getTopN","defers","topNdata","subdefer","markValueDic","max","min","avg","showTable1","showTable2","filterEnterprises","formatDate","columnDefs","totalList","widgetMaxFun","jQuery","find","AdminLTE","boxWidget","collapse","enterpriseIds","markValue","queryDitem1","markValueList","tabOption","filterDataDic","xAisDic","nodeIdDic","enterprisesDic","nodeIdToEnfoDic","arisingTime","el","backgroundColor","grid","bottom","containLabel","kpiDataByEnterpriseId","category","enterpriseGDPList","nodeValue","enterpriseGDPValue","nodeName","diffValue","toFixed","diffToGDP","index","render","full","escape","fomatDataTable","startMonth","endMonth","nodeIdAry","enterToNodesDic","queryDomainsByEnterpriseId","modelDefinitionId","getIndustryMarkValue","filterModel","getModelDefinitionsByEnterpriseIds","flterDeviceList","getModelsByCondition","allModelsDic","allModels","getDeviceTypeNames","allDeviceList","target2","target31","target32","target33","target4","target5","area","$parent","showEnergyTitle","statisticsTypeList","kpiCodeList","industry","energy","enterpriseId2","enterpriseId5","statisticsType1","statisticsType2","statisticsType3","statisticsType4","statisticsType5","dataDic","selected","queryKpiCOdeByParam","formatDataFunc","trueData","yAxisMinAry","yAxisMaxAry","indexOf","a","b","legendAry","len","itemValue","xA","trueItemValue","yAxisIndex","trueObj","formatEnergyFunc","totalDic","trueTotalDic","totalAry","ele","itemObj","fotmat","xAixs","kpiAry","queryInstances","eventData","filterNodes","filterNodeId","model","filterStatistic","target3","nodeObj","areaStyle","normal","filterEnter","getEnterpriseInfosByModelDefinitionId","allModelAry","allModelDic","3305","3351","ssessmentAry","radarOption","randarSeries","indicator","radar","getEnergyEvaluations","Info","areaDic","合肥","get","features","temp","properties","cp","registerMap","区域综合能耗","区域GDP能耗","区域工业附加值能耗","optionMap","seriesMap","HFData","mapDic","yA","from","to","formName","toName","coords","zlevel","effect","period","trailLength","symbolSize","lineStyle","width","curveness","symbol","opacity","coordinateSystem","rippleEffect","brushType","position","val","axisTick","textStyle","visualMap","top","calculable","inRange","selectedMode","geo","roam","areaColor","borderColor","aggregate_instance","aggregate_rule"],"mappings":"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","file":"app-oc/js/controllers/enterprise-ctrl.js","sourcesContent":["define(['controllers/controllers', 'bootstrap-dialog', 'Array'], function (controllers, BootstrapDialog) {\n  'use strict'; //================================================     企业信息   ====================================================\n\n  controllers.initController('enterpriseCtrl', ['$scope', '$routeParams', '$timeout', '$q', '$location', 'ngDialog', 'userLoginUIService', 'energyConsumeUIService', 'growl', 'userDomainService', function ($scope, $routeParams, $timeout, $q, $location, ngDialog, userLoginUIService, energyConsumeUIService, growl, userDomainService) {\n    $scope.selectedCount = 0;\n    var deferList = [];\n    $scope.$watch(\"myDicts\", function (n, o) {\n      if (n) {\n        $scope.industryList = $scope.myDicts['industryShortType'];\n        $scope.industryList.forEach(function (item) {\n          item.id = item.valueCode;\n          item.text = item.param;\n        });\n      }\n    }); //企业dialog\n\n    $scope.dialog = {\n      title: \"企业信息\",\n      input: {\n        name: '',\n        statisticsType: '',\n        //周期\n        industryType: '',\n        province: '',\n        city: '',\n        county: '',\n        address: '',\n        id: -1,\n        createTime: new Date()\n      },\n      list: {\n        provincesList: $scope.provinces,\n        periodList: [{\n          id: 'MONTH',\n          label: '月'\n        }, {\n          id: 'QUARTER',\n          label: '季度'\n        }, {\n          id: 'YEAR',\n          label: '年'\n        }],\n        cityList: null,\n        districtList: null\n      },\n      event: {\n        provinceClick: function provinceClick(provinceId) {\n          $scope.dialog.input.districtId = \"\";\n\n          if ($scope.cityDics[provinceId]) {\n            $scope.dialog.list.cityList = $scope.cityDics[provinceId];\n          }\n        },\n        cityClick: function cityClick(cityId) {\n          if ($scope.districtDics[cityId]) {\n            $scope.dialog.list.districtList = $scope.districtDics[cityId];\n          }\n        }\n      },\n      button: [{\n        label: \"确定\",\n        disabled: function disabled() {// var every = scope.dialog.input.every(function(elem) {\n          //   return elem.right != false;\n          // });\n          // return !every;\n        },\n        fn: function fn() {\n          $scope.dialog.input.values = {};\n          $scope.dialog.input.values.standardAddress = $scope.dialog.input.county ? $scope.dialog.input.county : $scope.dialog.input.city ? $scope.dialog.input.city : $scope.dialog.input.province;\n\n          var addEnterprise_callback = function addEnterprise_callback(returnObj) {\n            if (returnObj.code == 0) {\n              $scope.searchData(); // var newEnterprise = returnObj.data;\n              // $scope.queryAllList.push(newEnterprise);\n              // broardFun($scope.queryAllList);\n\n              growl.success(\"添加企业信息成功\", {});\n            }\n          };\n\n          var updataEnterprise_callback = function updataEnterprise_callback(returnObj) {\n            if (returnObj.code == 0) {\n              $scope.searchData();\n              growl.success(\"修改企业信息成功\", {}); // $scope.queryAllList.forEach(function(item) {\n              //   if (item.id == $scope.dialog.input.id) {\n              //     $.extend(item, $scope.dialog.input);\n              //   }\n              //   return;\n              // })\n            }\n          };\n\n          if ($scope.dialog.input.id == -1) {\n            //新增\n            energyConsumeUIService.addEnterpriseInfo($scope.dialog.input, addEnterprise_callback);\n          } else if ($scope.dialog.input.id > 0) {\n            //编辑\n            energyConsumeUIService.updateEnterpriseInfo($scope.dialog.input, updataEnterprise_callback);\n          }\n\n          ngDialog.close();\n        }\n      }, {\n        label: \"取消\",\n        fn: function fn() {\n          ngDialog.close();\n        }\n      }]\n    }; //初始化数据\n\n    var initData = function initData(obj) {\n      $scope.dialog.input = {\n        name: obj.name ? obj.name : \"\",\n        statisticsType: obj.statisticsType ? obj.statisticsType : \"\",\n        //周期\n        industryType: obj.industryType ? obj.industryType : \"\",\n        province: obj.province ? obj.province : \"\",\n        city: obj.city ? obj.city : \"\",\n        county: obj.county ? obj.county : \"\",\n        address: obj.address ? obj.address : \"\",\n        id: obj.id ? obj.id : -1,\n        createTime: obj.createTime ? obj.createTime : new Date()\n      };\n    };\n\n    $scope.addNewClick = function () {\n      initData({});\n      ngDialog.open({\n        template: '../partials/dialogue/enterprise_dia.html',\n        className: 'ngdialog-theme-plain',\n        scope: $scope\n      });\n    }; //企业展示信息\n\n\n    $scope.tableInit = {\n      'header': {\n        'label': \"企业信息管理\",\n        'time': ''\n      },\n      'select': {\n        name: '',\n        industryType: '',\n        statisticsType: ''\n      },\n      event: function event() {\n        $scope.tableInit.select.name = $scope.queryState.state == 1 ? $scope.tableInit.select.name : null;\n        $scope.tableInit.select.industryType = $scope.queryState.state == 2 ? $scope.tableInit.select.industryType : null;\n        $scope.tableInit.select.province = $scope.queryState.state == 3 ? $scope.tableInit.select.province : null;\n        $scope.tableInit.select.city = $scope.queryState.state == 3 ? $scope.tableInit.select.city : null;\n        $scope.tableInit.select.county = $scope.queryState.state == 3 ? $scope.tableInit.select.county : null;\n        $scope.tableInit.select.statisticsType = $scope.queryState.state == 4 ? $scope.tableInit.select.statisticsType : null;\n      },\n      clacTime: function clacTime() {\n        if (!$scope.tableInit.header.time) {\n          growl.warning(\"请先选择时间\", {});\n          return;\n        }\n\n        energyConsumeUIService.clacKqiByTime($scope.tableInit.header.time, function (returnObj) {\n          if (returnObj.code == 0) {\n            growl.success(\"已开始计算数据\", {});\n          }\n        });\n      }\n    }; //table动作\n\n    $scope.doAction = function (type, select, callback) {\n      if (type == 'delete') {\n        BootstrapDialog.show({\n          title: '提示',\n          closable: false,\n          message: '确认删除该企业信息？',\n          buttons: [{\n            label: '确定',\n            cssClass: 'btn-success',\n            action: function action(dialogRef) {\n              energyConsumeUIService.deleteEnterpriseInfo([select], function (returnObj) {\n                callback(returnObj);\n\n                if (returnObj.code == 0) {\n                  $scope.searchData(); // $scope.queryAllList.forEach(function(item) {\n                  //   select.forEach(function(sel) {\n                  //     if (item.id == sel) {\n                  //       $scope.queryAllList.splice(item, 1);\n                  //     }\n                  //   })\n                  // })\n\n                  growl.success(\"企业信息已删除\", {});\n                  $scope.selectedCount = 0;\n                  $scope.$apply();\n                  return;\n                }\n              });\n              dialogRef.close();\n            }\n          }, {\n            label: '取消',\n            action: function action(dialogRef) {\n              dialogRef.close();\n            }\n          }]\n        });\n      }\n    };\n\n    $scope.pipeline = function (opts) {\n      // Configuration options\n      var conf = $.extend({\n        pages: 1,\n        // number of pages to cache\n        url: '',\n        // script url\n        data: null,\n        // function or object with parameters to send to the server\n        // matching how `ajax.data` works in DataTables\n        method: 'POST' // Ajax HTTP method\n\n      }, opts); // Private variables for storing the cache\n\n      var cacheLower = -1;\n      var cacheUpper = null;\n      var cacheLastRequest = null;\n      var cacheLastJson = null;\n      return function (request, drawCallback, settings) {\n        var ajax = false;\n        var requestStart = request.start;\n        var drawStart = request.start;\n        var requestLength = request.length;\n        var requestEnd = requestStart + requestLength;\n        var sort = request.columns[request.order[0].column].data; //排序字段\n\n        var sortType = request.order[0].dir; //排序方式\n\n        if (settings.clearCache) {\n          // API requested that the cache be cleared\n          ajax = true;\n          settings.clearCache = false;\n        } else if (cacheLower < 0 || requestStart < cacheLower || requestEnd > cacheUpper) {\n          // outside cached data - need to make a request\n          ajax = true;\n        } else if (JSON.stringify(request.order) !== JSON.stringify(cacheLastRequest.order) || JSON.stringify(request.columns) !== JSON.stringify(cacheLastRequest.columns) || JSON.stringify(request.search) !== JSON.stringify(cacheLastRequest.search)) {\n          // properties changed (ordering, columns, searching)\n          ajax = true;\n        } // Store the request for checking next time around\n\n\n        cacheLastRequest = $.extend(true, {}, request);\n\n        if (ajax) {\n          // Need data from the server\n          if (requestStart < cacheLower) {\n            requestStart = requestStart - requestLength * (conf.pages - 1);\n\n            if (requestStart < 0) {\n              requestStart = 0;\n            }\n          }\n\n          cacheLower = requestStart;\n          cacheUpper = requestStart + requestLength * conf.pages;\n          request.start = requestStart;\n          request.length = requestLength * conf.pages; // Provide the same `data` options as DataTables.\n\n          if ($.isFunction(conf.data)) {\n            // As a function it is executed with the data object as an arg\n            // for manipulation. If an object is returned, it is used as the\n            // data object to submit\n            var d = conf.data(request);\n\n            if (d) {\n              $.extend(request, d);\n            }\n          } else if ($.isPlainObject(conf.data)) {\n            // As an object, the data given extends the default\n            $.extend(request, conf.data);\n          }\n\n          var pageRequest = {\n            start: request.start,\n            length: request.length,\n            sort: sort,\n            sortType: sortType,\n            statCount: request.draw == 1\n          };\n          $scope.getEnterpriceByPage($scope.queryList, pageRequest, function (returnObj, total) {\n            var json = {};\n            json.data = returnObj;\n            json.draw = request.draw; // Update the echo for each response\n\n            json.recordsTotal = total != undefined ? total == -1 ? cacheLastJson.recordsTotal : total : returnObj.length;\n            json.recordsFiltered = json.recordsTotal;\n            cacheLastJson = $.extend(true, {}, json);\n\n            if (cacheLower != drawStart) {\n              json.data.splice(0, drawStart - cacheLower);\n            }\n\n            if (requestLength >= -1) {\n              json.data.splice(requestLength, json.data.length);\n            }\n\n            drawCallback(json);\n          });\n        } else {\n          var json = $.extend(true, {}, cacheLastJson);\n          json.draw = request.draw; // Update the echo for each response\n\n          json.data.splice(0, requestStart - cacheLower);\n          json.data.splice(requestLength, json.data.length);\n          drawCallback(json);\n        }\n      };\n    };\n\n    $scope.getEnterpriceByPage = function (queryItem, pageRequest, callback) {\n      energyConsumeUIService.findEnterpriseInfosByCondition([queryItem, pageRequest], function (returnObj) {\n        if (returnObj.code == 0) {\n          if (callback) {\n            callback(returnObj.data.data, returnObj.data.total);\n          } // var ids = [];\n          // for (var i in returnObj.data.data) {\n          //   ids.push(returnObj.data.data[i].id);\n          // }\n          // getSearchResourceState(ids, returnObj.data.data, function(data) {\n          //   if (callback) {\n          //     callback(data, returnObj.data.count);\n          //   }\n          // });\n\n        }\n      });\n    };\n\n    $scope.searchData = function () {\n      $scope.queryList = {\n        \"id\": $scope.tableInit.select.id ? $scope.tableInit.select.id : \"\",\n        \"industryType\": $scope.tableInit.select.industryType ? $scope.tableInit.select.industryType : \"\",\n        \"province\": $scope.tableInit.select.province ? $scope.tableInit.select.province : \"\",\n        \"city\": $scope.tableInit.select.city ? $scope.tableInit.select.city : \"\",\n        \"county\": $scope.tableInit.select.county ? $scope.tableInit.select.county : \"\",\n        \"statisticsType\": $scope.tableInit.select.statisticsType ? $scope.tableInit.select.statisticsType : \"\",\n        \"name\": $scope.tableInit.select.name ? $scope.tableInit.select.name : \"\"\n      };\n      $timeout(function () {\n        $scope.$broadcast(Event.ENTERPRISEINIT + \"_info\", {\n          \"option\": []\n        });\n      });\n    }; //根据用户Id查用户域\n\n\n    var domainTreeQuery = function domainTreeQuery() {\n      var defer = $q.defer();\n      userDomainService.queryDomainTree(userLoginUIService.user.userID, function (data) {\n        $scope.domainListTree = data.domainListTree;\n        $scope.domainListDic = data.domainListDic;\n        defer.resolve(\"success\");\n      });\n      deferList.push(defer.promise);\n    }; // var getIndustry = function() {\n    //   var industryDic = [];\n    //   $.extend(industryDic, $scope.myDicts['industryType']);\n    //   var defer = $q.defer();\n    //   industryDic.forEach(function(item) {\n    //     item.id = item.valueCode;\n    //     item.text = item.label;\n    //   });\n    //   $scope.industryList = industryDic;\n    //   defer.resolve(\"seccess\");\n    //   deferList.push(defer.promise);\n    // };\n\n\n    var init = function init() {\n      // getIndustry();\n      domainTreeQuery();\n      $q.all(deferList).then(function () {\n        $scope.searchData();\n      });\n    };\n    /**\n     * 监听登录状态\n     */\n\n\n    if (!userLoginUIService.user.isAuthenticated) {\n      $scope.$on('loginStatusChanged', function (evt, d) {\n        if (userLoginUIService.user.isAuthenticated) {\n          init();\n        }\n      });\n    } else {\n      init();\n    }\n  }]); //================================================   产品结构（产品信息）   ======================================================\n\n  controllers.initController('productCtrl', ['$scope', '$routeParams', '$timeout', '$q', '$location', 'ngDialog', 'unitService', 'userLoginUIService', 'energyConsumeUIService', 'growl', 'userDomainService', function ($scope, $routeParams, $timeout, $q, $location, ngDialog, unitService, userLoginUIService, energyConsumeUIService, growl, userDomainService) {\n    $scope.selectedCount = 0;\n\n    if (userLoginUIService.user.userType == 100) {\n      //政府操作菜单\n      $scope.ifShowEnter = true;\n    } else {\n      //企业操作\n      $scope.ifShowEnter = false;\n    }\n\n    var deferList = []; //获取全部单位\n\n    var getUnit = function () {\n      $scope.unitList = unitService.units;\n      $scope.unitDics = unitService.unitDics;\n    }(); //产品dialog\n\n\n    $scope.dialog = {\n      title: \"产品结构\",\n      input: {\n        enterpriseId: '',\n        name: '',\n        // 产品名称\n        desc: '',\n        unit: '',\n        id: -1,\n        createTime: new Date()\n      },\n      button: [{\n        label: \"确定\",\n        disabled: function disabled() {\n          var every = scope.dialog.input.every(function (elem) {\n            return elem.right != false;\n          });\n          return !every;\n        },\n        fn: function fn() {\n          var addproduct_callback = function addproduct_callback(returnObj) {\n            if (returnObj.code == 0) {\n              var newproduct = returnObj.data;\n              $scope.queryAllList.push(newproduct);\n              broardFun($scope.queryAllList);\n              growl.success(\"添加产品信息成功\", {});\n            }\n          };\n\n          var updataproduct_callback = function updataproduct_callback(returnObj) {\n            if (returnObj.code == 0) {\n              $scope.queryAllList.forEach(function (item) {\n                if (item.id == $scope.dialog.input.id) {\n                  $.extend(item, $scope.dialog.input);\n                }\n\n                broardFun($scope.queryAllList);\n                growl.success(\"产品信息修改完成\", {});\n                return;\n              });\n            }\n          };\n\n          if ($scope.dialog.input.id == -1) {\n            //新增\n            if (!$scope.ifShowEnter) {\n              delete $scope.dialog.input.enterpriseId;\n            }\n\n            energyConsumeUIService.addProduct($scope.dialog.input, addproduct_callback);\n          } else if ($scope.dialog.input.id > 0) {\n            //编辑\n            energyConsumeUIService.updateProduct($scope.dialog.input, updataproduct_callback);\n          }\n\n          ngDialog.close();\n        }\n      }, {\n        label: \"取消\",\n        fn: function fn() {\n          ngDialog.close();\n        }\n      }]\n    };\n\n    var broardFun = function broardFun(objList) {\n      $timeout(function () {\n        $scope.$broadcast(Event.ENTERPRISEINIT + \"_product\", {\n          \"option\": [objList]\n        });\n      });\n    }; //初始化数据\n\n\n    var initData = function initData(obj) {\n      $scope.dialog.input = {\n        name: obj.name ? obj.name : \"\",\n        // domainPath: obj.domainPath ? obj.domainPath : \"\", //企业域\n        desc: obj.desc ? obj.desc : \"\",\n        unit: obj.unit ? obj.unit : \"\",\n        id: obj.id ? obj.id : -1,\n        createTime: obj.createTime ? obj.createTime : new Date()\n      };\n    }; //产品展示信息\n\n\n    $scope.tableInit = {\n      'header': {\n        'label': \"产品结构管理\",\n        'delete': \"删除产品结构\"\n      },\n      'select': {\n        'name': '',\n        'desc': '',\n        'enterpriseId': ''\n      },\n      'event': {\n        'addClick': function addClick() {\n          initData({});\n          ngDialog.open({\n            template: '../partials/dialogue/product_info_dia.html',\n            className: 'ngdialog-theme-plain',\n            scope: $scope\n          });\n        },\n        'goClear': function goClear() {\n          $scope.tableInit.select.name = $scope.queryState.state == 1 ? $scope.tableInit.select.name : null;\n          $scope.tableInit.select.desc = $scope.queryState.state == 2 ? $scope.tableInit.select.desc : null;\n          $scope.tableInit.select.enterpriseId = $scope.queryState.state == 3 ? $scope.tableInit.select.enterpriseId : null;\n        }\n      }\n    }; //table动作\n\n    $scope.doAction = function (type, select, callback) {\n      if (type == 'delete') {\n        BootstrapDialog.show({\n          title: '提示',\n          closable: false,\n          message: '确认删除该产品结构？',\n          buttons: [{\n            label: '确定',\n            cssClass: 'btn-success',\n            action: function action(dialogRef) {\n              energyConsumeUIService.deleteProduct([select], function (returnObj) {\n                callback(returnObj);\n\n                if (returnObj.code == 0) {\n                  select.forEach(function (sel) {\n                    for (var i in $scope.queryAllList) {\n                      if (sel == $scope.queryAllList[i].id) {\n                        $scope.queryAllList.splice(i, 1);\n                      }\n                    }\n                  });\n                  growl.success(\"产品结构已删除\", {});\n                  $scope.selectedCount = 0;\n                  $scope.$apply();\n                }\n              });\n              dialogRef.close();\n            }\n          }, {\n            label: '取消',\n            action: function action(dialogRef) {\n              callback(false);\n              dialogRef.close();\n              $scope.selectedCount = 0;\n              $scope.$apply();\n            }\n          }]\n        });\n      }\n    };\n\n    $scope.searchData = function () {\n      var param = {\n        \"id\": $scope.tableInit.select.id ? $scope.tableInit.select.id : \"\",\n        \"enterpriseId\": $scope.tableInit.select.enterpriseId ? $scope.tableInit.select.enterpriseId : $routeParams.enterpriseId ? $routeParams.enterpriseId : \"\",\n        \"desc\": $scope.tableInit.select.desc ? $scope.tableInit.select.desc : \"\",\n        \"name\": $scope.tableInit.select.name ? $scope.tableInit.select.name : \"\"\n      };\n      energyConsumeUIService.findProducts(param, function (returnObj) {\n        if (returnObj.code == 0) {\n          $scope.queryAllList = returnObj.data;\n          broardFun(returnObj.data);\n        }\n      });\n    }; //获取所有企业\n\n\n    (function () {\n      var queryList = {\n        \"id\": \"\",\n        \"industryType\": \"\",\n        \"province\": \"\",\n        \"city\": \"\",\n        \"county\": \"\",\n        \"statisticsType\": \"\",\n        \"name\": \"\"\n      };\n      var pageRequest = {\n        start: 0,\n        length: 1000000000,\n        sort: \"createTime\",\n        sortType: \"desc\",\n        statCount: true\n      };\n      energyConsumeUIService.findEnterpriseInfosByCondition([queryList, pageRequest], function (returnObj) {\n        if (returnObj.code == 0) {\n          returnObj.data.data.forEach(function (item) {\n            item.text = item.name;\n          });\n          $scope.enterpriseList = returnObj.data.data;\n        }\n      });\n    })(); //根据用户Id查用户域\n\n\n    var domainTreeQuery = function domainTreeQuery() {\n      var defer = $q.defer();\n      userDomainService.queryDomainTree(userLoginUIService.user.userID, function (data) {\n        $scope.domainListTree = data.domainListTree;\n        $scope.domainListDic = data.domainListDic;\n        defer.resolve(\"success\");\n      });\n      deferList.push(defer.promise);\n    };\n\n    var findProductsByEnterId = function findProductsByEnterId(enterpriseId) {\n      energyConsumeUIService.findProductsByEnterpriseId([enterpriseId], function (returnObj) {\n        if (returnObj.code == 0) {\n          $scope.queryAllList = returnObj.data;\n          broardFun(returnObj.data);\n        }\n      });\n    };\n\n    var init = function init() {\n      domainTreeQuery();\n      $q.all(deferList).then(function () {\n        $scope.searchData(); // if ($routeParams.enterpriseId) {\n        //   findProductsByEnterId($routeParams.enterpriseId);\n        // } else {\n        //   $scope.searchData();\n        // }\n      });\n    };\n    /**\n     * 监听登录状态\n     */\n\n\n    if (!userLoginUIService.user.isAuthenticated) {\n      $scope.$on('loginStatusChanged', function (evt, d) {\n        if (userLoginUIService.user.isAuthenticated) {\n          init();\n        }\n      });\n    } else {\n      init();\n    }\n  }]); //================================================  工艺流程   ======================================================\n\n  controllers.initController('productStructureCtrl', ['$scope', '$routeParams', '$timeout', '$q', '$location', 'ngDialog', 'userLoginUIService', 'energyConsumeUIService', 'growl', 'userDomainService', function ($scope, $routeParams, $timeout, $q, $location, ngDialog, userLoginUIService, energyConsumeUIService, growl, userDomainService) {\n    $scope.selectedCount = 0;\n    var deferList = [];\n    var routeParamsId = $routeParams.productId; //产品dialog\n\n    $scope.dialog = {\n      title: \"工艺流程\",\n      input: {\n        occupyPrcent: '',\n        //所占比例\n        energyConsumeNodeId: '',\n        // 能耗节点Id\n        id: -1,\n        productId: routeParamsId,\n        createTime: new Date()\n      },\n      event: {\n        verifyFun: function verifyFun(type, value) {\n          var reg, r;\n\n          if (type == 'number') {\n            // var isNumber = /^(0|[0-9][0-9]?|100)$/; //只准输入1-100，保留两位小数的数字\n            // var isNumber = /^[0-9]\\d*(\\.\\d+)$/; //输入大于等于0的数字\n            var isNumber = /^\\d+(\\.{0,1}\\d+){0,1}$/; //输入非负数\n\n            r = isNumber.test(value);\n\n            if (value == 0) {\n              r = true;\n            }\n\n            if (!r) {\n              $scope.mistakeMesg = true;\n            } else {\n              $scope.mistakeMesg = false;\n            }\n          }\n        }\n      },\n      button: [{\n        label: \"确定\",\n        disabled: function disabled() {\n          var every = scope.dialog.input.every(function (elem) {\n            return elem.right != false;\n          });\n          return !every;\n        },\n        fn: function fn() {\n          if ($scope.mistakeMesg) {\n            growl.warning(\"请正确输入所用分钟数\", {});\n            return;\n          }\n\n          var addProductStruct_callback = function addProductStruct_callback(returnObj) {\n            if (returnObj.code == 0) {\n              var newproduct = returnObj.data;\n              $scope.queryAllList.push(newproduct);\n              broardFun($scope.queryAllList);\n              growl.success(\"添加工艺流程成功\", {});\n            }\n          };\n\n          var updataProductStruct_callback = function updataProductStruct_callback(returnObj) {\n            if (returnObj.code == 0) {\n              $scope.queryAllList.forEach(function (item) {\n                if (item.id == $scope.dialog.input.id) {\n                  $.extend(item, $scope.dialog.input);\n                }\n\n                broardFun($scope.queryAllList);\n                growl.success(\"工艺流程修改完成\", {});\n                return;\n              });\n            }\n          };\n\n          $scope.dialog.input.productId = parseInt(routeParamsId);\n\n          if ($scope.dialog.input.id == -1) {\n            //新增             \n            energyConsumeUIService.addProductStruct($scope.dialog.input, addProductStruct_callback);\n          } else if ($scope.dialog.input.id > 0) {\n            //编辑\n            energyConsumeUIService.updateProductStruct($scope.dialog.input, updataProductStruct_callback);\n          }\n\n          ngDialog.close();\n        }\n      }, {\n        label: \"取消\",\n        fn: function fn() {\n          ngDialog.close();\n        }\n      }]\n    };\n\n    var broardFun = function broardFun(objList) {\n      $timeout(function () {\n        $scope.$broadcast(Event.ENTERPRISEINIT + \"_structrue\", {\n          \"option\": [objList]\n        });\n      });\n    }; //初始化数据\n\n\n    var initData = function initData(obj) {\n      $scope.dialog.input = {\n        occupyPrcent: obj.occupyPrcent ? obj.occupyPrcent : \"\",\n        energyConsumeNodeId: obj.energyConsumeNodeId ? obj.energyConsumeNodeId : \"\",\n        id: obj.id ? obj.id : -1,\n        createTime: obj.createTime ? obj.createTime : new Date()\n      };\n    }; //企业展示信息\n\n\n    $scope.tableInit = {\n      'header': {\n        'label': \"工艺流程\",\n        'delete': \"删除工艺流程\"\n      },\n      'select': {\n        'occupyPrcent': '',\n        'energyConsumeNodeId': ''\n      },\n      'event': {\n        'addClick': function addClick() {\n          initData({});\n          ngDialog.open({\n            template: '../partials/dialogue/product_structrue_dia.html',\n            className: 'ngdialog-theme-plain',\n            scope: $scope\n          });\n        },\n        'goClear': function goClear() {\n          $scope.tableInit.select.occupyPrcent = $scope.queryState.state == 1 ? $scope.tableInit.select.occupyPrcent : null;\n          $scope.tableInit.select.energyConsumeNodeId = $scope.queryState.state == 1 ? $scope.tableInit.select.energyConsumeNodeId : null;\n        }\n      }\n    }; //table动作\n\n    $scope.doAction = function (type, select, callback) {\n      if (type == 'delete') {\n        BootstrapDialog.show({\n          title: '提示',\n          closable: false,\n          message: '确认删除该工艺流程？',\n          buttons: [{\n            label: '确定',\n            cssClass: 'btn-success',\n            action: function action(dialogRef) {\n              energyConsumeUIService.deleteProductStruct([select], function (returnObj) {\n                callback(returnObj);\n\n                if (returnObj.code == 0) {\n                  for (var i in $scope.queryAllList) {\n                    select.forEach(function (sel) {\n                      if ($scope.queryAllList[i].id == sel) {\n                        $scope.queryAllList.splice(i, 1);\n                      }\n                    });\n                  } // for (var i in $scope.queryAllList) {\n                  //   select.forEach(function(sel) {\n                  //     sel == $scope.queryAllList[i].id;\n                  //     $scope.queryAllList.splice(i, 1);\n                  //   })\n                  // }\n                  // $scope.queryAllList.forEach(function(item) {\n                  //   select.forEach(function(sel) {\n                  //     if (item.id == sel) {\n                  //       $scope.queryAllList.splice(item, 1);\n                  //     }\n                  //   })\n                  // })\n\n\n                  growl.success(\"工艺流程已删除\", {});\n                  $scope.selectedCount = 0;\n                  $scope.$apply();\n                }\n              });\n              dialogRef.close();\n            }\n          }, {\n            label: '取消',\n            action: function action(dialogRef) {\n              callback(false);\n              dialogRef.close();\n              $scope.selectedCount = 0;\n              $scope.$apply();\n            }\n          }]\n        });\n      }\n    };\n\n    $scope.searchData = function () {\n      var param = {\n        \"productId\": parseInt($scope.tableInit.select.productId) ? parseInt($scope.tableInit.select.productId) : parseInt(routeParamsId) ? parseInt(routeParamsId) : \"\",\n        \"energyConsumeNodeId\": $scope.tableInit.select.energyConsumeNodeId ? $scope.tableInit.select.energyConsumeNodeId : \"\",\n        \"occupyPrcent\": parseFloat($scope.tableInit.select.occupyPrcent) ? parseFloat($scope.tableInit.select.occupyPrcent) : \"\"\n      };\n      energyConsumeUIService.findProductStructs(param, function (returnObj) {\n        if (returnObj.code == 0) {\n          $scope.queryAllList = returnObj.data;\n          broardFun(returnObj.data);\n        }\n      });\n    }; //根据用户Id查用户域\n\n\n    var domainTreeQuery = function domainTreeQuery() {\n      var defer = $q.defer();\n      userDomainService.queryDomainTree(userLoginUIService.user.userID, function (data) {\n        $scope.domainListTree = data.domainListTree;\n        $scope.domainListDic = data.domainListDic;\n        defer.resolve(\"success\");\n      });\n      deferList.push(defer.promise);\n    }; //根据用户path查能耗结构\n\n\n    function queryEnergyTree(param) {\n      // var defer = $q.defer();\n      energyConsumeUIService.queryEnergyTree([param], function (data) {\n        $scope.energyListTree = data.energyListTree;\n        $scope.energyListDic = data.energyListDic; // defer.resolve(\"success\");\n      }); // deferList.push(defer.promise);\n    }\n\n    ;\n\n    var init = function init() {\n      domainTreeQuery();\n\n      if (userLoginUIService.user.userType == 100) {\n        energyConsumeUIService.findProductById([parseInt(routeParamsId)], function (returnObj) {\n          var path = returnObj.data.domainPath;\n          queryEnergyTree(path);\n        });\n      } else {\n        queryEnergyTree();\n      }\n\n      $q.all(deferList).then(function () {\n        $scope.searchData();\n      });\n    };\n    /**\n     * 监听登录状态\n     */\n\n\n    if (!userLoginUIService.user.isAuthenticated) {\n      $scope.$on('loginStatusChanged', function (evt, d) {\n        if (userLoginUIService.user.isAuthenticated) {\n          init();\n        }\n      });\n    } else {\n      init();\n    }\n  }]); //================================================   企业经营信息   ======================================================\n\n  controllers.initController('enterpriseOperateCtrl', ['$scope', '$routeParams', '$timeout', '$q', '$location', 'ngDialog', 'unitService', 'userLoginUIService', 'energyConsumeUIService', 'growl', 'userDomainService', function ($scope, $routeParams, $timeout, $q, $location, ngDialog, unitService, userLoginUIService, energyConsumeUIService, growl, userDomainService) {\n    var productYields = {};\n    $scope.selectedCount = 0;\n    var deferList = []; //获取全部单位\n\n    var getUnit = function () {\n      $scope.unitList = unitService.units;\n      $scope.unitDics = unitService.unitDics;\n    }(); //获取企业信息\n\n\n    var getEnterprise = function getEnterprise(domainPath) {\n      var deferred = $q.defer();\n\n      if (!$routeParams.enterpriseId) {\n        energyConsumeUIService.findEnterpriseInfoByDomainPath([domainPath], function (returnObj) {\n          if (returnObj.code == 0) {\n            $scope.dialog.statisticsType = returnObj.data.statisticsType;\n            deferred.resolve('success');\n          }\n        });\n      } else {\n        energyConsumeUIService.findEnterpriseInfoById([$routeParams.enterpriseId], function (returnObj) {\n          if (returnObj.code == 0) {\n            $scope.dialog.statisticsType = returnObj.data.statisticsType;\n            deferred.resolve('success');\n          }\n        });\n      }\n\n      return deferred.promise;\n    };\n\n    var broardFun = function broardFun(objList) {\n      $timeout(function () {\n        $scope.$broadcast(Event.ENTERPRISEINIT + \"_operate\", {\n          \"option\": [objList]\n        });\n      });\n    }; //初始化数据\n\n\n    var initData = function initData(obj) {\n      $scope.ifView = false;\n\n      if (obj.statisticsPeriod) {\n        var ary = new Date(obj.statisticsPeriod).Format(\"yyyy-M\").split('-');\n      }\n\n      $scope.dialog.input.enterpriseOperateInfo = {\n        productionValue: obj.productionValue || '',\n        //产值\n        additionalValue: obj.additionalValue || '',\n        //附加值\n        id: obj.id || 0,\n        statisticsPeriod: '',\n        //统计周期\n        createTime: obj.createTime || new Date()\n      };\n      $scope.ignoreList = {\n        year: obj.statisticsPeriod ? parseInt(ary[0]) : '',\n        month: obj.statisticsPeriod ? parseInt(ary[1]) : '',\n        quarter: obj.statisticsPeriod ? parseInt(ary[1]) : ''\n      };\n\n      if (!obj.hasOwnProperty('id')) {\n        $scope.productYields.forEach(function (item) {\n          item.yield = '';\n        });\n      }\n    };\n\n    $scope.ignoreList = {\n      year: '',\n      month: '',\n      quarter: ''\n    }; //产品dialog\n\n    $scope.dialog = {\n      title: \"企业经营信息\",\n      statisticsType: \"\",\n      input: {\n        enterpriseOperateInfo: {\n          productionValue: '',\n          //产值\n          additionalValue: '',\n          //附加值\n          yieldUnit: '',\n          //单位\n          statisticsPeriod: '',\n          //统计周期\n          createTime: new Date()\n        }\n      },\n      select: {\n        statisticsYear: function () {\n          //获取年份（2015 ~ 2025年）            \n          var yearList = [];\n\n          for (var i = 2015; i < 2026; i++) {\n            yearList.push({\n              id: i,\n              text: i + '年'\n            });\n          }\n\n          ;\n          return yearList; // return [{\n          //   id: 0,\n          //   text: \"请选择...\"\n          // }].concat(yearList);\n        }(),\n        statisticsMonth: function () {\n          //获取月份（2010 ~ 2020年）\n          var monthList = [];\n\n          for (var i = 1; i < 13; i++) {\n            monthList.push({\n              id: i,\n              text: i + '月'\n            });\n          }\n\n          ;\n          return monthList; // return [{\n          //   id: 0,\n          //   text: \"请选择...\"\n          // }].concat(monthList);\n        }(),\n        statisticsQuarter: [{\n          id: 1,\n          text: '第一季度'\n        }, {\n          id: 4,\n          text: '第二季度'\n        }, {\n          id: 8,\n          text: '第三季度'\n        }, {\n          id: 12,\n          text: '第四季度'\n        }]\n      },\n      button: [{\n        label: \"确定\",\n        disabled: function disabled() {\n          var every = scope.dialog.input.every(function (elem) {\n            return elem.right != false;\n          });\n          return !every;\n        },\n        fn: function fn() {\n          var verifyFun = function verifyFun(value) {\n            var isNumber = /^[1-9]\\d*(\\.\\d+)?$/;\n            var r = isNumber.test(value);\n\n            if (!r) {\n              //不是大于0的正数\n              growl.warning(\"请输入且为大于0的正数\", {});\n              return false;\n            } else {\n              return true; //是数字\n            }\n          };\n\n          var enterpriseOperateInfo = $scope.dialog.input.enterpriseOperateInfo;\n          $scope.dialog.input.productYields = $scope.productYields;\n\n          if ($scope.dialog.statisticsType == 'YEAR') {\n            enterpriseOperateInfo.statisticsPeriod = $scope.ignoreList.year ? new Date([$scope.ignoreList.year, 1, 1].join('-')) : \"\";\n          } else if ($scope.dialog.statisticsType == 'MONTH') {\n            enterpriseOperateInfo.statisticsPeriod = $scope.ignoreList.month ? new Date([$scope.ignoreList.year, $scope.ignoreList.month, 1].join('-')) : \"\";\n          } else if ($scope.dialog.statisticsType == 'QUARTER') {\n            enterpriseOperateInfo.statisticsPeriod = $scope.ignoreList.quarter ? new Date([$scope.ignoreList.year, $scope.ignoreList.quarter, 1].join('-')) : \"\";\n          }\n\n          for (var key in enterpriseOperateInfo) {\n            if (key == 'productionValue' || key == 'additionalValue') {\n              if (!verifyFun(enterpriseOperateInfo[key])) {\n                return;\n              }\n\n              ;\n            }\n          }\n\n          $scope.dialog.input.productYields.forEach(function (item) {\n            if (!verifyFun(item.yield)) {\n              return;\n            }\n\n            ;\n          });\n\n          var addproduct_callback = function addproduct_callback(returnObj) {\n            if (returnObj.code == 0) {\n              var newproduct = returnObj.data.enterpriseOperateInfo;\n              $scope.queryAllList.push(newproduct);\n              broardFun($scope.queryAllList);\n              growl.success(\"添加企业经营信息成功\", {});\n            }\n          };\n\n          var updataproduct_callback = function updataproduct_callback(returnObj) {\n            if (returnObj.code == 0) {\n              $scope.queryAllList.forEach(function (item) {\n                if (item.id == enterpriseOperateInfo.id) {\n                  $.extend(item, returnObj.data.enterpriseOperateInfo);\n                  broardFun($scope.queryAllList);\n                  growl.success(\"企业经营信息修改完成\", {});\n                  return;\n                }\n              });\n            }\n          };\n\n          if ($routeParams.enterpriseId) {\n            $scope.dialog.input.enterpriseOperateInfo.enterpriseId = $routeParams.enterpriseId;\n          }\n\n          if (enterpriseOperateInfo.id == 0) {\n            //新增\n            energyConsumeUIService.addEnterpriseOperateInfoDto($scope.dialog.input, addproduct_callback);\n          } else if (enterpriseOperateInfo.id > 0) {\n            //编辑\n            energyConsumeUIService.updateEnterpriseOperateInfoDto($scope.dialog.input, updataproduct_callback);\n          }\n\n          ngDialog.close();\n        }\n      }, {\n        label: \"取消\",\n        fn: function fn() {\n          ngDialog.close();\n        }\n      }]\n    }; //产品展示信息\n\n    $scope.tableInit = {\n      'header': {\n        'label': \"企业经营信息\",\n        'add': \"添加经营信息\",\n        'delete': \"删除经营信息\"\n      },\n      'select': {\n        'year': '',\n        'month': '',\n        'quarter': '',\n        'statisticsYear': [{\n          id: 0,\n          text: \"请选择...\"\n        }].concat($scope.dialog.select.statisticsYear),\n        'statisticsMonth': [{\n          id: 0,\n          text: \"请选择...\"\n        }].concat($scope.dialog.select.statisticsMonth),\n        'statisticsQuarter': [{\n          id: 0,\n          text: \"请选择...\"\n        }].concat($scope.dialog.select.statisticsQuarter),\n        'statisticsPeriod': '',\n        //统计周期\n        'productionValue': '' //产值\n\n      },\n      'event': {\n        'addClick': function addClick() {\n          initData({});\n          ngDialog.open({\n            template: '../partials/dialogue/enterprise_operate_info_dia.html',\n            className: 'ngdialog-theme-plain',\n            scope: $scope\n          });\n        },\n        'changeYear': function changeYear(year) {\n          if (!year) {\n            $scope.tableInit.select.month = \"\";\n            $scope.tableInit.select.quarter = \"\";\n          }\n        }\n      }\n    }; //table动作\n\n    $scope.doAction = function (type, select, callback) {\n      if (type == 'delete') {\n        BootstrapDialog.show({\n          title: '提示',\n          closable: false,\n          message: '确认删除该企业经营信息？',\n          buttons: [{\n            label: '确定',\n            cssClass: 'btn-success',\n            action: function action(dialogRef) {\n              energyConsumeUIService.deleteEnterpriseOperateInfoDto([select], function (returnObj) {\n                callback(returnObj);\n\n                if (returnObj.code == 0) {\n                  select.forEach(function (sel) {\n                    for (var i in $scope.queryAllList) {\n                      if (sel == $scope.queryAllList[i].id) {\n                        $scope.queryAllList.splice(i, 1);\n                      }\n                    }\n                  });\n                  $scope.selectedCount = 0;\n                  $scope.$apply();\n                }\n              });\n              dialogRef.close();\n            }\n          }, {\n            label: '取消',\n            action: function action(dialogRef) {\n              callback(false);\n              dialogRef.close();\n              $scope.selectedCount = 0;\n              $scope.$apply();\n            }\n          }]\n        });\n      } else if (type == 'commit') {\n        BootstrapDialog.show({\n          title: '提示',\n          closable: false,\n          message: '确认' + (userLoginUIService.user.userType == 100 ? '审核' : '提交') + ' 该企业经营信息？',\n          buttons: [{\n            label: '确定',\n            cssClass: 'btn-success',\n            action: function action(dialogRef) {\n              var state = userLoginUIService.user.userType == 100 ? 'pass' : 'yes';\n              energyConsumeUIService.updateEnterpriseOperateInfoCommitStatus([select, state], function (returnObj) {\n                callback(returnObj);\n\n                if (returnObj.code == 0) {\n                  if (userLoginUIService.user.userType == 100) {\n                    growl.success(\"企业经营信息已审核\", {});\n                  } else {\n                    growl.success(\"企业经营信息已提交\", {});\n                  }\n\n                  $scope.selectedCount = 0;\n                  $scope.$apply();\n                }\n              });\n              dialogRef.close();\n            }\n          }, {\n            label: '取消',\n            action: function action(dialogRef) {\n              callback(false);\n              dialogRef.close();\n              $scope.selectedCount = 0;\n              $scope.$apply();\n            }\n          }]\n        });\n      } else if (type == 'edit') {\n        energyConsumeUIService.findProductYieldsByOperateId([select.id], function (returnObj) {\n          if (returnObj.code == 0) {\n            initData(select);\n\n            if (!$routeParams.enterpriseId) {\n              $scope.dialog.input.enterpriseOperateInfo.enterpriseId = select.enterpriseId; // $.extend($scope.dialog.input, select);\n            }\n\n            $scope.productYields = returnObj.data;\n            ngDialog.open({\n              template: '../partials/dialogue/enterprise_operate_info_dia.html',\n              className: 'ngdialog-theme-plain',\n              scope: $scope\n            });\n          }\n        });\n      } else if (type == 'view') {\n        energyConsumeUIService.findProductYieldsByOperateId([select.id], function (returnObj) {\n          if (returnObj.code == 0) {\n            initData(select);\n            $scope.ifView = true; // $.extend($scope.dialog.input, select);\n\n            $scope.productYields = returnObj.data;\n            ngDialog.open({\n              template: '../partials/dialogue/enterprise_operate_info_dia.html',\n              className: 'ngdialog-theme-plain',\n              scope: $scope\n            });\n          }\n        });\n      }\n    };\n\n    $scope.searchData = function () {\n      var statisticsPeriod = \"\";\n\n      if ($scope.dialog.statisticsType == 'YEAR') {\n        statisticsPeriod = $scope.tableInit.select.year ? new Date(String($scope.tableInit.select.year)) : \"\";\n      } else if ($scope.dialog.statisticsType == 'MONTH') {\n        if ($scope.tableInit.select.year && !$scope.tableInit.select.month) {\n          statisticsPeriod = new Date(String($scope.tableInit.select.year));\n        } else {\n          statisticsPeriod = $scope.tableInit.select.month ? new Date([$scope.tableInit.select.year, $scope.tableInit.select.month].join('-')) : \"\";\n        }\n      } else if ($scope.dialog.statisticsType == 'QUARTER') {\n        if ($scope.tableInit.select.year && !$scope.tableInit.select.quarter) {\n          statisticsPeriod = new Date(String($scope.tableInit.select.year));\n        } else {\n          statisticsPeriod = $scope.tableInit.select.quarter ? new Date([$scope.tableInit.select.year, $scope.tableInit.select.quarter].join('-')) : \"\";\n        }\n      }\n\n      var param = {\n        \"productionValue\": $scope.tableInit.select.productionValue ? $scope.tableInit.select.productionValue : \"\",\n        \"statisticsPeriod\": statisticsPeriod ? statisticsPeriod : \"\",\n        \"enterpriseId\": $routeParams.enterpriseId ? $routeParams.enterpriseId : \"\"\n      };\n      energyConsumeUIService.findEnterpriseOperateInfos(param, function (returnObj) {\n        if (returnObj.code == 0) {\n          $scope.queryAllList = returnObj.data;\n          broardFun(returnObj.data);\n        }\n      });\n    }; //获取企业的产品信息\n\n\n    var getProducts = function getProducts() {\n      energyConsumeUIService.findProducts({\n        enterpriseId: $routeParams.enterpriseId\n      }, function (returnObj) {\n        if (returnObj.code == 0) {\n          returnObj.data.forEach(function (item) {\n            item.yield = '';\n            item.yieldUnit = item.unit;\n            item.productId = item.id;\n            item.productName = item.name;\n            delete item.id;\n          });\n          $scope.productYields = returnObj.data;\n        }\n      });\n    };\n\n    var init = function init() {\n      getEnterprise(userLoginUIService.user.domains);\n      getProducts();\n      $q.all(deferList).then(function () {\n        $scope.searchData();\n      });\n    };\n    /**\n     * 监听登录状态\n     */\n\n\n    if (!userLoginUIService.user.isAuthenticated) {\n      $scope.$on('loginStatusChanged', function (evt, d) {\n        if (userLoginUIService.user.isAuthenticated) {\n          init();\n        }\n      });\n    } else {\n      init();\n    }\n  }]); //================================================     企业基本信息   ====================================================\n\n  controllers.initController('basicEnterpriseCtrl', ['$scope', '$routeParams', '$timeout', '$q', '$location', 'ngDialog', 'userLoginUIService', 'energyConsumeUIService', 'growl', 'userDomainService', function ($scope, $routeParams, $timeout, $q, $location, ngDialog, userLoginUIService, energyConsumeUIService, growl, userDomainService) {\n    $scope.sortList = [{\n      id: \"id_1\",\n      label: \"我是哈哈1\"\n    }, {\n      id: \"id_2\",\n      label: \"我是哈哈2\"\n    }, {\n      id: \"id_3\",\n      label: \"我是哈哈3\"\n    }, {\n      id: \"id_4\",\n      label: \"我是哈哈4\"\n    }, {\n      id: \"id_5\",\n      label: \"我是哈哈5\"\n    }];\n    $scope.sortList2 = [{\n      id: \"id_11\",\n      label: \"我是try1\"\n    }, {\n      id: \"id_22\",\n      label: \"我是try2\"\n    }, {\n      id: \"id_33\",\n      label: \"我是try3\"\n    }];\n    $scope.setting = {\n      boxClass: \"boxClass\",\n      ulClass: \"ulhaha\",\n      liClass: \"lihaha\",\n      type: \"sort\",\n      placeholder: \"placeholder\",\n      cursor: \"move\",\n      delay: 50,\n      distance: 3\n    };\n    $scope.clipboard = \"hahaCopy\"; //demo end\n\n    $scope.ifGovernment = false;\n    $scope.mistakeMesg = {};\n    $scope.$watch(\"myDicts\", function (n, o) {\n      if (n) {\n        $scope.industryList = $scope.myDicts['industryShortType'];\n        $scope.granularityList = $scope.myDicts['KqiGranularityUnit'];\n        $scope.industryList.forEach(function (item) {\n          item.id = item.valueCode;\n          item.text = item.param;\n        });\n        $scope.granularityList = $scope.granularityList.filter(function (item) {\n          item.id = item.valueCode;\n          item.text = item.label;\n          return item.valueCode == 'MONTH' || item.valueCode == 'QUARTER' || item.valueCode == 'YEAR';\n        });\n      }\n    });\n\n    if (location.hash.search('#/businessManagement') > -1) {\n      //企业管理（政府操作员入口）\n      $scope.ifGovernment = true;\n    }\n\n    var basicInfo = null; //企业展示信息\n\n    $scope.tableInit = {\n      'header': {\n        'label': $scope.ifGovernment ? \"企业管理\" : \"企业基本信息\"\n      },\n      'input': {\n        province: \"\",\n        city: \"\",\n        county: \"\",\n        enterpriseSize: \"\",\n        //企业规模\n        address: \"\",\n        //街道地址\n        contactPhone: \"\",\n        //联系电话\n        contactEmail: \"\",\n        //联系邮箱\n        website: \"\",\n        //主页地址\n        business: \"\" //营业范围\n\n      },\n      'select': {\n        name: '',\n        cityList: [],\n        districtList: []\n      },\n      event: {\n        editClick: function editClick() {\n          if ($scope.mistakeMesg.phone) {\n            growl.warning(\"请正确输入手机号码\", {});\n            return;\n          }\n\n          if ($scope.mistakeMesg.email) {\n            growl.warning(\"请正确输入邮箱地址\", {});\n            return;\n          }\n\n          if ($scope.mistakeMesg.website) {\n            growl.warning(\"请正确输入主页地址\", {});\n            return;\n          }\n\n          $scope.tableInit.input.values = {};\n          $scope.tableInit.input.values.standardAddress = $scope.tableInit.input.county ? $scope.tableInit.input.county : $scope.tableInit.input.city ? $scope.tableInit.input.city : $scope.tableInit.input.province;\n          energyConsumeUIService.updateEnterpriseInfo($scope.tableInit.input, function (returnObj) {\n            if (returnObj.code == 0) {\n              growl.success(\"企业信息保存成功\", {});\n              return;\n            }\n          });\n        }\n      }\n    }; //验证信息\n\n    $scope.verifyFun = function (value, type) {\n      var reg, r;\n\n      if (type == \"phone\") {\n        var isMob = /^((1[34578]\\d{9})|(0\\d{2,4}\\-\\d{7,8})|\\d{8})$/;\n        r = isMob.test(value);\n\n        if (!r) {\n          if (!value) {\n            $scope.mistakeMesg.phone = false;\n          } else {\n            $scope.mistakeMesg.phone = true;\n          }\n        } else {\n          $scope.mistakeMesg.phone = false;\n        }\n      } else if (type == \"email\") {\n        reg = /^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((\\.[a-zA-Z0-9_-]{2,3}){1,2})$/;\n        r = reg.test(value);\n\n        if (!r) {\n          if (!value) {\n            $scope.mistakeMesg.email = false;\n          } else {\n            $scope.mistakeMesg.email = true;\n          }\n        } else {\n          $scope.mistakeMesg.email = false;\n        }\n      } else if (type == \"website\") {\n        reg = /(\\w+):\\/\\/([^/:]+)(:\\d+)?([^# :]{1,12}.?([^# :]*))/;\n        r = reg.test(value);\n\n        if (!r) {\n          if (!value) {\n            $scope.mistakeMesg.website = false;\n          } else {\n            $scope.mistakeMesg.website = true;\n          }\n        } else {\n          $scope.mistakeMesg.website = false;\n        }\n      }\n    };\n\n    var currentInfo = function currentInfo() {\n      if ($routeParams.enterpriseId) {\n        energyConsumeUIService.findEnterpriseInfoById([$routeParams.enterpriseId], function (returnObj) {\n          if (returnObj.code == 0) {\n            $scope.tableInit.input = returnObj.data;\n            $scope.tableInit.select.cityList = $scope.cityDics[returnObj.data.province];\n            $scope.tableInit.select.districtList = $scope.districtDics[returnObj.data.city];\n          }\n        });\n      } else {\n        energyConsumeUIService.findEnterpriseInfoByDomainPath([$scope.userInfo.domains], function (returnObj) {\n          if (returnObj.code == 0) {\n            $scope.tableInit.input = returnObj.data;\n            $scope.tableInit.select.cityList = $scope.cityDics[returnObj.data.province];\n            $scope.tableInit.select.districtList = $scope.districtDics[returnObj.data.city];\n          }\n        });\n      }\n    };\n    /**\n     * 监听登录状态\n     */\n\n\n    if (!userLoginUIService.user.isAuthenticated) {\n      $scope.$on('loginStatusChanged', function (evt, d) {\n        if (userLoginUIService.user.isAuthenticated) {\n          currentInfo();\n        }\n      });\n    } else {\n      currentInfo();\n    }\n  }]); //================================================  发布管理   ======================================================\n\n  controllers.initController('publishCtrl', ['$scope', '$routeParams', '$timeout', '$q', '$location', 'ngDialog', 'resourceUIService', 'userLoginUIService', 'energyConsumeUIService', 'growl', 'userDomainService', function ($scope, $routeParams, timeout, $q, $location, ngDialog, resourceUIService, userLoginUIService, energyConsumeUIService, growl, userDomainService) {\n    $scope.tab = \"tab1\";\n    $scope.ifView = false;\n    $scope.ifEnterprise = userLoginUIService.user.userType == 1000 ? true : false;\n    var deferList = []; //节能指标\n\n    $scope.dialog = {\n      title: \"节能指标\",\n      input: {\n        lastReducePeriodData: '',\n        thisReduceIndicator: '',\n        id: -1,\n        enterpriseId: '',\n        createTime: new Date()\n      },\n      event: {\n        verifyFun: function verifyFun(type, value) {\n          var reg, r;\n\n          if (type == 'number') {\n            // var isNumber = /^(0|[0-9][0-9]?|100)$/; //只准输入1-100，保留两位小数的数字\n            // var isNumber = /^[0-9]\\d*(\\.\\d+)$/; //输入大于等于0的数字\n            var isNumber = /^\\d+(\\.{0,1}\\d+){0,1}$/; //输入非负数\n\n            r = isNumber.test(value);\n\n            if (value == 0) {\n              r = true;\n            }\n\n            if (!r) {\n              $scope.mistakeMesg = true;\n            } else {\n              $scope.mistakeMesg = false;\n            }\n          }\n        }\n      },\n      button: [{\n        label: \"确定\",\n        disabled: function disabled() {\n          var every = scope.dialog.input.every(function (elem) {\n            return elem.right != false;\n          });\n          return !every;\n        },\n        fn: function fn() {\n          // if ($scope.dialog.input.thisReduceIndicator < 0) {\n          //   growl.warning(\"请正确输入能耗数据\", {});\n          //   return;\n          // }\n          var addReduceEnergy_callback = function addReduceEnergy_callback(returnObj) {\n            if (returnObj.code == 0) {\n              var newproduct = returnObj.data;\n              $scope.reduceEnergyList.push(newproduct);\n              broardFun($scope.reduceEnergyList, '_publish');\n              growl.success(\"发布节能指标成功\", {});\n            }\n          };\n\n          if ($scope.dialog.input.id == -1) {\n            //新增             \n            energyConsumeUIService.publishReduceEnergy($scope.dialog.input, addReduceEnergy_callback);\n          }\n\n          ngDialog.close();\n        }\n      }, {\n        label: \"取消\",\n        fn: function fn() {\n          ngDialog.close();\n        }\n      }]\n    }; //预测结果\n\n    $scope.dialog2 = {\n      title: \"预测结果\",\n      param: {\n        lastReducePeriodData: '',\n        thisReduceIndicator: '',\n        id: -1,\n        enterpriseId: '',\n        createTime: new Date()\n      },\n      button: [{\n        label: \"确定\",\n        disabled: function disabled() {\n          var every = scope.dialog.param.every(function (elem) {\n            return elem.right != false;\n          });\n          return !every;\n        },\n        fn: function fn() {\n          var ForecastResult_callback = function ForecastResult_callback(returnObj) {\n            if (returnObj.code == 0) {\n              var newproduct = returnObj.data;\n              $scope.ForecastResult.push(newproduct);\n              broardFun($scope.ForecastResult, '_forecast');\n              growl.success(\"发布预测结果成功\", {});\n              ngDialog.close();\n            }\n          };\n\n          if ($scope.dialog2.param.id == -1) {\n            //新增             \n            energyConsumeUIService.publishForecastResult($scope.dialog2.param.enterpriseId, ForecastResult_callback);\n          }\n        }\n      }, {\n        label: \"取消\",\n        fn: function fn() {\n          ngDialog.close();\n        }\n      }]\n    }; //展示信息\n\n    $scope.tableInit = {\n      'select': {\n        'enterpriseId': '',\n        'reducePeriod': ''\n      },\n      'event': {\n        'addClick': function addClick() {\n          $scope.statisticsType = \"\";\n          $scope.dialog.input = {\n            lastReducePeriodData: '',\n            thisReduceIndicator: '',\n            id: -1,\n            enterpriseId: '',\n            createTime: new Date()\n          };\n          ngDialog.open({\n            template: '../partials/dialogue/publish_dia.html',\n            className: 'ngdialog-theme-plain',\n            scope: $scope\n          });\n        },\n        'forecastClick': function forecastClick() {\n          $scope.ifView = false;\n          $scope.statisticsType = \"\";\n          $scope.dialog2.param = {\n            lastReducePeriodData: '',\n            thisReduceIndicator: '',\n            id: -1,\n            enterpriseId: '',\n            createTime: new Date()\n          };\n          ngDialog.open({\n            template: '../partials/dialogue/forecast_dia.html',\n            className: 'ngdialog-theme-plain',\n            scope: $scope\n          });\n        },\n        'goClear': function goClear() {\n          $scope.tableInit.select.occupyPrcent = $scope.queryState.state == 1 ? $scope.tableInit.select.occupyPrcent : null;\n          $scope.tableInit.select.energyConsumeNodeId = $scope.queryState.state == 1 ? $scope.tableInit.select.energyConsumeNodeId : null;\n        }\n      }\n    }; //验证阈值\n\n    $scope.mistakeMesg = {};\n\n    $scope.verifyFun = function (value, type) {\n      var reg, r;\n      reg = /^[+-]?([1-9][0-9]*|0)(\\.[0-9]+)?%?$/; //全体实数\n\n      r = reg.test(value);\n\n      if (!r) {\n        //不为数字\n        $scope.mistakeMesg[type] = true;\n      } else {\n        $scope.mistakeMesg[type] = false;\n      }\n    };\n\n    var broardFun = function broardFun(objList, type) {\n      timeout(function () {\n        $scope.$broadcast(Event.ENTERPRISEINIT + type, {\n          \"option\": [objList]\n        });\n      });\n    }; //table动作\n\n\n    $scope.doAction = function (type, select, callback) {\n      if (type == 'complete') {\n        BootstrapDialog.show({\n          title: '提示',\n          closable: false,\n          message: '确认该节能周期已完成？',\n          buttons: [{\n            label: '确定',\n            cssClass: 'btn-success',\n            action: function action(dialogRef) {\n              energyConsumeUIService.saveReduceEnergy({\n                id: select,\n                lastCompleteStatus: 'yes'\n              }, function (returnObj) {\n                if (returnObj.code == 0) {\n                  callback(returnObj);\n                }\n              });\n              dialogRef.close();\n            }\n          }, {\n            label: '取消',\n            action: function action(dialogRef) {\n              dialogRef.close();\n            }\n          }]\n        });\n      } else if (type == 'view') {\n        $scope.ifView = true;\n        var state = select.energyTypeForecastData.some(function (item) {\n          return item.hasOwnProperty('value');\n        });\n\n        if (!state) {\n          select.energyTypeForecastData.forEach(function (item) {\n            for (var key in item) {\n              item.energyType = key;\n              item.value = item[key];\n            }\n          });\n        }\n\n        $scope.dialog2.param.energyTypeForecastData = select.energyTypeForecastData;\n        ngDialog.open({\n          template: '../partials/dialogue/forecast_dia.html',\n          className: 'ngdialog-theme-plain',\n          scope: $scope\n        });\n      }\n    }; //根据企业查询企业信息\n\n\n    $scope.queryEnterpriseById = function (obj) {\n      var id = obj.id.split(':')[1];\n      energyConsumeUIService.findEnterpriseInfoById(id, function (returnObj) {\n        if (returnObj.code == 0) {\n          $scope.statisticsType = returnObj.data.statisticsType;\n        }\n      });\n      energyConsumeUIService.findLastEnergyByEnterpriseId(id, function (returnObj) {\n        if (returnObj.code == 0) {\n          $scope.dialog.input.lastReducePeriodData = returnObj.data.value;\n        }\n      });\n\n      if ($scope.tab == 'tab3') {\n        energyConsumeUIService.findForecastResult(id, function (returnObj) {\n          if (returnObj.code == 0) {\n            returnObj.data.energyTypeForecastData.forEach(function (item) {\n              for (var key in item) {\n                item.energyType = key;\n                item.value = item[key];\n              }\n            });\n            $scope.dialog2.param.energyTypeForecastData = returnObj.data.energyTypeForecastData;\n          }\n        });\n      }\n    }; //获取所有企业\n\n\n    function queryAllEnterprises() {\n      var defer = $q.defer();\n      resourceUIService.getDomainsByFilter({\n        modelId: 303,\n        layer: 2\n      }, function (returnObj) {\n        if (returnObj.code == 0) {\n          $scope.EnterprisesDic = {};\n          returnObj.data.forEach(function (item) {\n            item.text = item.label;\n            $scope.EnterprisesDic[item.id] = item;\n          });\n          $scope.allEnterprises = returnObj.data;\n          $scope.queryEnterpriseList = [{\n            id: '',\n            text: '请选择...'\n          }].concat(returnObj.data);\n          defer.resolve('success');\n        }\n      });\n      deferList.push(defer.promise);\n    }\n\n    ; //获取所有\n\n    $scope.searchDate = function () {\n      var param = {\n        \"enterpriseId\": parseInt($scope.tableInit.select.enterpriseId) ? parseInt($scope.tableInit.select.enterpriseId) : \"\"\n      };\n\n      if ($scope.tab == 'tab1') {\n        energyConsumeUIService.findReduceEnergyListByCondition(param, function (returnObj) {\n          if (returnObj.code == 0) {\n            $scope.reduceEnergyList = returnObj.data;\n            broardFun($scope.reduceEnergyList, '_publish');\n          }\n        });\n      } else if ($scope.tab == 'tab3') {\n        energyConsumeUIService.findForecastResultsByCondition(param, function (returnObj) {\n          if (returnObj.code == 0) {\n            // returnObj.data.forEach(function(item) {\n            //   item.energyTypeForecastData.forEach(function(obj) {\n            //     for (var key in obj) {\n            //       obj.energyType = key;\n            //       obj.value = obj[key];\n            //     }\n            //   })\n            // })\n            $scope.ForecastResult = returnObj.data;\n            broardFun($scope.ForecastResult, '_forecast');\n          }\n        });\n      }\n    };\n\n    var initEvent = function initEvent() {\n      $('#deploy a[data-toggle=\"tab\"]').on('shown.bs.tab', function (e) {\n        if ($(e.target).closest(\"li.disabled\").length > 0) {\n          $(e.target).closest(\"li.disabled\").removeClass(\"active\");\n          $(e.target).closest(\"ul\").children(\"[name=\" + $scope.tab + \"]\").addClass(\"active\");\n          return;\n        }\n\n        var aname = $(e.target).closest(\"li\").attr(\"name\");\n\n        if (aname) {\n          $scope.tab = aname;\n          $scope.$apply();\n        }\n\n        if (aname == 'tab3' || aname == 'tab1') {\n          $scope.searchDate();\n        }\n      });\n    };\n\n    var init = function init() {\n      queryAllEnterprises();\n      initEvent();\n      $q.all(deferList).then(function () {\n        $scope.searchDate();\n      });\n    };\n    /**\n     * 监听登录状态\n     */\n\n\n    if (!userLoginUIService.user.isAuthenticated) {\n      $scope.$on('loginStatusChanged', function (evt, d) {\n        if (userLoginUIService.user.isAuthenticated) {\n          init();\n        }\n      });\n    } else {\n      init();\n    }\n  }]); //================================================  能效对标  ======================================================\n\n  controllers.initController('benchMarkingCtrl', ['$scope', '$routeParams', '$filter', '$timeout', '$q', '$location', 'ngDialog', 'dictionaryService', 'kpiDataService', 'userLoginUIService', 'energyConsumeUIService', 'growl', 'resourceUIService', function ($scope, $routeParams, $filter, timeout, $q, $location, ngDialog, dictionaryService, kpiDataService, userLoginUIService, energyConsumeUIService, growl, resourceUIService) {\n    var echart = require('echarts');\n\n    var target = echart.init(document.getElementById('bardataview'));\n    var deferList = [];\n    var energyDic = {};\n    $scope.industryDic = {};\n    $scope.statisticsTypeDic = {\n      'MONTH': '月',\n      'QUARTER': '季度',\n      'YEAR': '年'\n    };\n    $scope.$watch(\"myDicts\", function (n, o) {\n      if (n) {\n        $scope.industryList = $scope.myDicts['industryShortType'];\n        $scope.energyType = $scope.myDicts['energyType'];\n        $scope.industryList.forEach(function (item) {\n          item.id = item.valueCode;\n          item.text = item.param;\n          $scope.industryDic[item.valueCode] = item;\n          $scope.industryDic[item.label] = item;\n        });\n        $scope.energyType.forEach(function (item) {\n          energyDic[item.label] = item;\n        });\n      }\n    }); //初始化所有的数据\n\n    function initAllData() {\n      var lastYear = new Date().getFullYear();\n      var lastMonth = new Date().getMonth();\n      $scope.queryDitem = {};\n      $scope.queryDitem.industryType = '';\n      $scope.queryDitem.enterpriseId = '';\n      $scope.queryDitem.year = lastYear;\n      $scope.queryDitem.month = lastMonth;\n      $scope.yearList = [];\n      $scope.monthList = [];\n\n      for (var i = 0; i < 8; i++) {\n        $scope.yearList.push({\n          id: lastYear - i,\n          text: lastYear - i + '年'\n        });\n      }\n\n      for (var i = 1; i < 13; i++) {\n        $scope.monthList.unshift({\n          id: i,\n          text: i + '月'\n        });\n      }\n\n      target.clear();\n    }\n\n    ;\n\n    $scope.goClear = function () {\n      initAllData();\n    }; //定义EChart option\n\n\n    var getOption = function getOption(echartData) {\n      target.setOption({\n        title: {\n          text: '',\n          subtext: '',\n          x: 'center',\n          y: 'top'\n        },\n        tooltip: {\n          trigger: 'axis',\n          axisPointer: {\n            type: 'cross',\n            crossStyle: {\n              color: '#999'\n            }\n          }\n        },\n        toolbox: {\n          feature: {\n            dataView: {\n              show: true,\n              readOnly: false\n            },\n            magicType: {\n              show: true,\n              type: ['line', 'bar']\n            },\n            restore: {\n              show: true\n            },\n            saveAsImage: {\n              show: true\n            }\n          }\n        },\n        legend: {\n          data: echartData.legend\n        },\n        xAxis: [{\n          type: 'category',\n          boundaryGap: true,\n          axisLabel: {\n            interval: 0\n          },\n          data: echartData.xAxis,\n          axisPointer: {\n            type: 'shadow'\n          }\n        }],\n        yAxis: [{\n          type: 'value',\n          name: '节点能耗（单位：吨标煤）',\n          boundaryGap: true,\n          axisLabel: {\n            formatter: '{value}'\n          }\n        }, {\n          type: 'value',\n          name: '标杆值（单位：吨标煤）',\n          boundaryGap: true,\n          axisLabel: {\n            formatter: '{value}'\n          }\n        }],\n        series: echartData.series //{name:'',type:'',data:[]}\n\n      });\n    }; //处理数据\n\n\n    function fomatData(energyByEnterpriseIdAry, energyByIndustryCodeAry) {\n      var xAxis = $scope.energyType.map(function (item) {\n        return item.label;\n      });\n      var enterpriseAry = energyByEnterpriseIdAry.map(function (item) {\n        return item.value;\n      });\n      var industryCodeAry = energyByIndustryCodeAry.map(function (item) {\n        return item.value;\n      }); //设置柱状图的各项参数\n\n      var echartData = {\n        result: [energyByEnterpriseIdAry, energyByIndustryCodeAry],\n        xAxis: xAxis,\n        legend: ['节点能耗', '标杆值'],\n        series: [{\n          name: '节点能耗',\n          type: 'bar',\n          data: enterpriseAry ? enterpriseAry : []\n        }, {\n          name: '标杆值',\n          type: 'bar',\n          data: industryCodeAry ? industryCodeAry : []\n        }]\n      };\n      getOption(echartData);\n    }\n\n    ; //获取企业对应的节点能耗\n\n    var kpiDataByEnterpriseId = function kpiDataByEnterpriseId(obj) {\n      var defer = $q.defer();\n      $scope.energyByEnterpriseIdAry = [];\n      var param = [\"kpi\", {\n        \"isRealTimeData\": false,\n        \"nodeIds\": [obj.enterpriseId],\n        \"kpiCodes\": [3331],\n        \"startTime\": new Date(obj.startTime),\n        \"endTime\": new Date(obj.endTime),\n        \"timeRange\": \"\",\n        \"aggregateType\": [\"VALENTWEIGHT\"],\n        \"granularityUnit\": \"MONTH\",\n        \"statisticType\": \"psiot\",\n        \"includeInstance\": true,\n        \"condList\": [],\n        \"timePeriod\": 0,\n        \"dataType\": 1\n      }];\n      kpiDataService.getValueList(param, function (returnObj) {\n        if (returnObj.code == 0) {\n          returnObj.data.forEach(function (item) {\n            item.energyName = item.instance;\n            item.energyCode = energyDic[item.instance].valueCode;\n            $scope.energyByEnterpriseIdAry.push(item);\n          });\n          defer.resolve(\"success\");\n        }\n      });\n      deferList.push(defer.promise);\n    }; //获取企业对应行业的标杆值\n\n\n    var industryDataByindustryCode = function industryDataByindustryCode(industryCode) {\n      var defer = $q.defer();\n      $scope.energyByIndustryCodeAry = [];\n      var param = [\"kpi\", {\n        \"isRealTimeData\": false,\n        \"nodeIds\": [userLoginUIService.user.domainID],\n        \"kpiCodes\": [3328],\n        \"timeRange\": \"\",\n        \"statisticType\": \"psiot\",\n        \"includeInstance\": true,\n        \"condList\": [],\n        \"timePeriod\": 0,\n        \"dataType\": 1\n      }];\n      kpiDataService.getValueList(param, function (returnObj) {\n        if (returnObj.code == 0) {\n          returnObj.data.forEach(function (item) {\n            var instanceAry = item.instance.split(',');\n            item.instanceName = $scope.industryDic[instanceAry[0]].param;\n            item.instanceCode = $scope.industryDic[instanceAry[0]].valueCode;\n            item.energyName = instanceAry[1];\n            item.energyCode = energyDic[instanceAry[1]].valueCode;\n\n            if (industryCode == item.instanceCode) {\n              $scope.energyByIndustryCodeAry.push(item);\n            }\n          });\n          defer.resolve(\"success\");\n        }\n      });\n      deferList.push(defer.promise);\n    }; //根据企业查询企业信息\n\n\n    var queryEnterpriseById = function queryEnterpriseById(obj) {\n      energyConsumeUIService.findEnterpriseInfoById(obj.enterpriseId, function (returnObj) {\n        if (returnObj.code == 0) {\n          $scope.enterpriseInfo = returnObj.data;\n          industryDataByindustryCode(returnObj.data.industryType);\n          kpiDataByEnterpriseId(obj);\n          $q.all(deferList).then(function () {\n            fomatData($scope.energyByEnterpriseIdAry, $scope.energyByIndustryCodeAry);\n          });\n        }\n      });\n    }; //获取所有企业\n\n\n    function queryAllEnterprises() {\n      energyConsumeUIService.findEnterpriseInfos(function (returnObj) {\n        if (returnObj.code == 0) {\n          $scope.EnterprisesDic = {};\n          returnObj.data.forEach(function (item) {\n            item.text = item.name;\n            $scope.EnterprisesDic[item.id] = item;\n          });\n          $scope.allEnterprises = returnObj.data;\n          $scope.queryEnterpriseList = returnObj.data;\n        }\n      });\n    }\n\n    $scope.goSearch = function (obj) {\n      obj.startTime = new Date(obj.year + '-' + obj.month);\n      obj.endTime = new Date(obj.year + '-' + obj.month + '-' + '02');\n\n      if (!$scope.queryDitem.enterpriseId) {\n        growl.info(\"请选择企业名称\", {});\n        return;\n      }\n\n      queryEnterpriseById(obj);\n    };\n\n    var init = function init() {\n      initAllData();\n      queryAllEnterprises();\n    };\n    /**\n     * 监听登录状态\n     */\n\n\n    if (!userLoginUIService.user.isAuthenticated) {\n      $scope.$on('loginStatusChanged', function (evt, d) {\n        if (userLoginUIService.user.isAuthenticated) {\n          init();\n        }\n      });\n    } else {\n      init();\n    }\n  }]); //================================================  标杆设置  ======================================================\n\n  controllers.initController('benchMarkSetCtrl', ['$scope', '$routeParams', '$filter', '$timeout', '$q', '$location', 'ngDialog', 'dictionaryService', 'kpiDataService', 'userLoginUIService', 'energyConsumeUIService', 'growl', 'resourceUIService', function ($scope, $routeParams, $filter, timeout, $q, $location, ngDialog, dictionaryService, kpiDataService, userLoginUIService, energyConsumeUIService, growl, resourceUIService) {\n    var echart = require('echarts');\n\n    var target = echart.init(document.getElementById('barsettingdataview'));\n    var deferList = [];\n    $scope.energyDic = {};\n    $scope.industryDic = {};\n    $scope.statisticsTypeDic = {\n      'MONTH': '月',\n      'QUARTER': '季度',\n      'YEAR': '年'\n    };\n    $scope.$watch(\"myDicts\", function (n, o) {\n      if (n) {\n        $scope.industryList = $scope.myDicts['industryShortType'];\n        $scope.energyType = $scope.myDicts['energyType'];\n        $scope.industryList.forEach(function (item) {\n          item.id = item.label;\n          item.text = item.param;\n          $scope.industryDic[item.valueCode] = item;\n          $scope.industryDic[item.label] = item;\n        });\n        $scope.energyType.forEach(function (item) {\n          $scope.energyDic[item.label] = item;\n        });\n      }\n    }); //初始化所有的数据\n\n    function initAllData() {\n      $scope.queryDitem.industryType = '';\n      $scope.filterLastDic = {};\n      $scope.filterBestDic = {};\n      target.clear();\n    }\n\n    ;\n\n    $scope.goClear = function () {\n      initAllData();\n    }; //定义EChart option\n\n\n    var getOption = function getOption(echartData) {\n      target.setOption({\n        title: {\n          text: '',\n          subtext: '',\n          x: 'center',\n          y: 'top'\n        },\n        tooltip: {\n          trigger: 'axis',\n          axisPointer: {\n            type: 'cross',\n            crossStyle: {\n              color: '#999'\n            }\n          }\n        },\n        toolbox: {\n          feature: {\n            dataView: {\n              show: true,\n              readOnly: false\n            },\n            magicType: {\n              show: true,\n              type: ['line', 'bar']\n            },\n            restore: {\n              show: true\n            },\n            saveAsImage: {\n              show: true\n            }\n          }\n        },\n        legend: {\n          data: echartData.legend\n        },\n        xAxis: [{\n          type: 'category',\n          boundaryGap: true,\n          axisLabel: {\n            interval: 0\n          },\n          data: echartData.xAxis,\n          axisPointer: {\n            type: 'shadow'\n          }\n        }],\n        yAxis: [{\n          type: 'value',\n          name: '上周期设置值（单位：吨标煤）',\n          boundaryGap: true,\n          axisLabel: {\n            formatter: '{value}'\n          }\n        }, {\n          type: 'value',\n          name: '标杆值（单位：吨标煤）',\n          boundaryGap: true,\n          axisLabel: {\n            formatter: '{value}'\n          }\n        }],\n        series: echartData.series //{name:'',type:'',data:[]}\n\n      });\n    };\n    /**\n     * 格式化时间格式(YYYY-MM-Day HH:MM:SS)\n     */\n\n\n    var formatDate = function formatDate(datestr) {\n      datestr = $filter('date')(datestr, 'yyyy-MM-dd');\n      return datestr;\n    }; //处理数据\n\n\n    function fomatData(filterBestAry, filterLastAry) {\n      var xAxis = $scope.energyType.map(function (item) {\n        return item.label;\n      });\n      var filterBestValue = [];\n      var industryLastValue = [];\n      xAxis = xAxis.sort();\n      xAxis.forEach(function (item) {\n        filterBestAry.forEach(function (obj) {\n          if (item == obj.energyName) {\n            filterBestValue.push(obj.value);\n          }\n        });\n      });\n      xAxis.forEach(function (item) {\n        filterLastAry.forEach(function (obj) {\n          if (item == obj.energyName) {\n            industryLastValue.push(obj.value);\n          }\n        });\n      }); // var filterBestValue = filterBestAry.map(function(item) {\n      //   return item.value;\n      // });\n      // var industryLastValue = filterLastAry.map(function(item) {\n      //   return item.value;\n      // });\n      //设置柱状图的各项参数\n\n      var echartData = {\n        result: [industryLastValue, filterBestValue],\n        xAxis: xAxis,\n        legend: ['上周期设置值', '标杆值'],\n        series: [{\n          name: '上周期设置值',\n          type: 'bar',\n          data: industryLastValue\n        }, {\n          name: '标杆值',\n          type: 'bar',\n          data: filterBestValue\n        }]\n      };\n      getOption(echartData);\n    }\n\n    ; //获取企业对应行业的标杆值(3327)\n\n    var bestindustryCode = function bestindustryCode() {\n      var defer = $q.defer();\n      $scope.bestIndustryCodeAry = [];\n      var param = [\"kpi\", {\n        \"isRealTimeData\": true,\n        \"nodeIds\": [userLoginUIService.user.domainID],\n        \"kpiCodes\": [3327],\n        \"granularityUnit\": \"MONTH\",\n        \"timeRange\": \"\",\n        \"statisticType\": \"psiot\",\n        \"includeInstance\": true,\n        \"condList\": [],\n        \"timePeriod\": 1,\n        \"dataType\": 1\n      }];\n      kpiDataService.getValueList(param, function (returnObj) {\n        if (returnObj.code == 0) {\n          returnObj.data.forEach(function (item) {\n            var instanceAry = item.instance.split(',');\n            item.instanceName = $scope.industryDic[instanceAry[0]].label;\n            item.insShortName = $scope.industryDic[instanceAry[0]].param;\n            item.instanceCode = $scope.industryDic[instanceAry[0]].valueCode;\n            item.energyName = instanceAry[1];\n            item.energyCode = $scope.energyDic[instanceAry[1]].valueCode;\n          });\n          $scope.bestIndustryCodeAry = returnObj.data;\n          defer.resolve('success');\n        }\n      });\n      deferList.push(defer.promise);\n    }; //获取上期设置标杆值数据(3328)\n\n\n    var lastindustryCode = function lastindustryCode() {\n      var defer = $q.defer();\n      $scope.lastIndustryCodeAry = [];\n      var param = [\"kpi\", {\n        \"isRealTimeData\": false,\n        \"nodeIds\": [userLoginUIService.user.domainID],\n        \"kpiCodes\": [3328],\n        \"timeRange\": \"\",\n        \"statisticType\": \"psiot\",\n        \"includeInstance\": true,\n        \"condList\": [],\n        \"timePeriod\": 0,\n        \"dataType\": 1\n      }];\n      kpiDataService.getValueList(param, function (returnObj) {\n        if (returnObj.code == 0) {\n          returnObj.data.forEach(function (item) {\n            var instanceAry = item.instance.split(',');\n            item.instanceName = $scope.industryDic[instanceAry[0]].label;\n            item.insShorteName = $scope.industryDic[instanceAry[0]].param;\n            item.instanceCode = $scope.industryDic[instanceAry[0]].valueCode;\n            item.energyName = instanceAry[1];\n            item.energyCode = $scope.energyDic[instanceAry[1]].valueCode;\n          });\n          $scope.lastIndustryCodeAry = returnObj.data;\n          defer.resolve(\"success\");\n        }\n      });\n      deferList.push(defer.promise);\n    }; //根据行业过滤  \n\n\n    var filterByIndustryType = function filterByIndustryType(obj) {\n      //系统标杆值 3327\n      $scope.filterBestAry = [];\n      $scope.filterLastAry = [];\n      $scope.filterBestDic = {};\n      $scope.filterLastDic = {};\n      $scope.bestIndustryCodeAry.forEach(function (item) {\n        if (obj.industryType == item.instanceName) {\n          $scope.filterBestAry.push(item);\n          $scope.filterBestDic[item.energyName] = item;\n        }\n      });\n      $scope.lastIndustryCodeAry.forEach(function (item) {\n        if (obj.industryType == item.instanceName) {\n          $scope.filterLastAry.push(item);\n          $scope.filterLastDic[item.energyName] = item;\n        }\n      });\n      $scope.energyType.forEach(function (item) {\n        if (!$scope.filterLastDic[item.label]) {\n          $scope.filterLastDic[item.label] = {\n            value: 0\n          };\n        }\n\n        if (!$scope.filterBestDic[item.label]) {\n          $scope.filterBestDic[item.label] = {\n            value: 0\n          };\n        }\n      });\n      $scope.lastTime = $scope.filterLastAry.length > 0 ? formatDate($scope.filterLastAry[0].insertTime) : '';\n      fomatData($scope.filterBestAry, $scope.filterLastAry);\n    };\n\n    $scope.goSearch = function (obj) {\n      filterByIndustryType(obj);\n    };\n\n    $scope.goSubmit = function () {\n      var industryName = $scope.industryDic[$scope.queryDitem.industryType].label;\n      var instanceObj = {};\n\n      for (var key in $scope.filterBestDic) {\n        instanceObj[industryName + ',' + key] = $scope.filterBestDic[key].value;\n      }\n\n      var paramAry = [];\n\n      for (var key in instanceObj) {\n        paramAry.push({\n          nodeId: userLoginUIService.user.domainID,\n          kpiCode: 3327,\n          value: instanceObj[key],\n          instance: key\n        });\n      }\n\n      ;\n      energyConsumeUIService.saveMarkValue(paramAry, function (returnObj) {\n        if (returnObj.code == 0) {\n          init(function () {\n            $scope.goSearch($scope.queryDitem);\n            growl.success(\"对标设置成功\");\n          });\n        }\n      });\n    };\n\n    var init = function init(callback) {\n      bestindustryCode();\n      lastindustryCode();\n      $q.all(deferList).then(function () {\n        if (callback) {\n          callback();\n        }\n      });\n    };\n    /**\n     * 监听登录状态\n     */\n\n\n    if (!userLoginUIService.user.isAuthenticated) {\n      $scope.$on('loginStatusChanged', function (evt, d) {\n        if (userLoginUIService.user.isAuthenticated) {\n          init();\n        }\n      });\n    } else {\n      init();\n    }\n  }]); //================================================  重点能耗单位  ======================================================\n\n  controllers.initController('keyEnterpriseCtrl', ['$scope', '$routeParams', '$timeout', '$q', '$location', 'ngDialog', 'dictionaryService', 'kpiDataService', 'userLoginUIService', 'energyConsumeUIService', 'growl', 'resourceUIService', function ($scope, $routeParams, timeout, $q, $location, ngDialog, dictionaryService, kpiDataService, userLoginUIService, energyConsumeUIService, growl, resourceUIService) {\n    $scope.ifView = false;\n\n    var echart = require('echarts');\n\n    var target = echart.init(document.getElementById('piedataview'));\n    var target1 = echart.init(document.getElementById('bardataview'));\n    var deferList = [];\n    $scope.kpiCodeDic = {\n      '3301': '综合能耗',\n      '3304': 'GDP能耗',\n      '3300': '单能源消耗'\n    };\n    $scope.unitCodeDic = {\n      '3301': '单位：吨标煤',\n      '3304': '单位：吨标煤/万元',\n      '3300': '单位：吨标煤'\n    };\n    $scope.industryDic = {};\n    $scope.statisticsTypeDic = {\n      'MONTH': '月',\n      'QUARTER': '季度',\n      'YEAR': '年'\n    };\n    $scope.energyDic = {};\n    var industryShortType = dictionaryService.dicts['industryShortType'];\n    $scope.energyType = dictionaryService.dicts['energyType'];\n    industryShortType.forEach(function (item) {\n      $scope.industryDic[item.valueCode] = item;\n      $scope.industryDic[item.label] = item;\n    });\n    $scope.energyType.forEach(function (item) {\n      $scope.energyDic[item.label] = item;\n    }); //初始化所有的数据\n\n    function initAllData() {\n      $scope.queryDitem = {\n        topN: '',\n        statisticsType: '',\n        kpiCode: '',\n        energyType: ''\n      };\n      $scope.enterpriseInfoAry = [];\n      target.clear();\n    }\n\n    ;\n\n    $scope.goClear = function () {\n      initAllData();\n    }; //定义EChart option\n\n\n    var getOption = function getOption(echartData) {\n      if (echartData.legend.length == 0) {\n        target.clear();\n        target1.clear();\n        return;\n      }\n\n      target.setOption({\n        title: {\n          text: '',\n          subtext: '',\n          x: 'center',\n          y: 'top'\n        },\n        toolbox: {\n          feature: {\n            dataView: {\n              show: true,\n              readOnly: false\n            },\n            restore: {\n              show: true\n            },\n            saveAsImage: {\n              show: true\n            }\n          }\n        },\n        tooltip: {\n          trigger: 'item',\n          formatter: \"{a} <br/>{b} : {c} (占比：{d}%)\"\n        },\n        legend: {\n          orient: 'vertical',\n          left: 'left',\n          data: echartData.legend\n        },\n        series: [{\n          name: '',\n          type: 'pie',\n          radius: '55%',\n          center: ['50%', '40%'],\n          data: echartData.series.data,\n          itemStyle: {\n            emphasis: {\n              shadowBlur: 10,\n              shadowOffsetX: 0,\n              shadowColor: 'rgba(0, 0, 0, 0.5)'\n            }\n          }\n        }]\n      });\n      target1.setOption({\n        tooltip: {\n          trigger: 'axis',\n          axisPointer: {\n            type: 'cross',\n            crossStyle: {\n              color: '#999'\n            }\n          }\n        },\n        toolbox: {\n          feature: {\n            dataView: {\n              show: true,\n              readOnly: false\n            },\n            magicType: {\n              show: true,\n              type: ['line', 'bar']\n            },\n            restore: {\n              show: true\n            },\n            saveAsImage: {\n              show: true\n            }\n          }\n        },\n        legend: {\n          data: echartData.legend\n        },\n        xAxis: [{\n          type: 'category',\n          data: [$scope.kpiCodeDic[echartData.param.kpiCode]],\n          axisPointer: {\n            type: 'shadow'\n          }\n        }],\n        yAxis: [{\n          type: 'value',\n          axisLabel: {\n            margin: 30,\n            formatter: '{value}'\n          },\n          name: $scope.unitCodeDic[echartData.param.kpiCode]\n        }],\n        series: echartData.series1\n      });\n    }; //处理数据\n\n\n    function fomatData(enterpriseInfoAry, topNdata, param) {\n      enterpriseInfoAry.forEach(function (item) {\n        topNdata.forEach(function (topN) {\n          if (topN.nodeId == item.id) {\n            topN.name = item.name;\n          }\n        });\n      });\n      var legend = enterpriseInfoAry.map(function (item) {\n        return item.name;\n      });\n      var series = {};\n      series.name = topNdata.map(function (item) {\n        return item.instance;\n      });\n      series.data = topNdata.map(function (item) {\n        return {\n          value: item.value,\n          name: item.name\n        };\n      });\n      var series1 = [];\n      series.data.forEach(function (item) {\n        series1.push({\n          data: [item.value],\n          name: item.name,\n          type: 'bar'\n        });\n      }); //设置柱状图的各项参数\n\n      var echartData = {\n        param: param,\n        result: [enterpriseInfoAry, topNdata],\n        legend: legend,\n        series: series,\n        series1: series1\n      };\n      getOption(echartData);\n    }\n\n    ; //获取topN企业\n\n    function queryEnterpriseByTopN(param) {\n      $scope.enterpriseInfoAry = []; //根据企业查询企业信息\n\n      var queryEnterpriseById = function queryEnterpriseById(enterpriseId) {\n        var subdefer = $q.defer();\n        energyConsumeUIService.findEnterpriseInfoById(enterpriseId, function (returnObj) {\n          if (returnObj.code == 0) {\n            $scope.enterpriseInfoAry.push(returnObj.data);\n            subdefer.resolve('success');\n          }\n        });\n        return subdefer.promise;\n      };\n\n      if (param.kpiCode != '3300') {\n        param.energyType = '';\n      }\n\n      var paramAry = [param.topN, param.statisticsType, param.kpiCode, param.energyType, param.range];\n      energyConsumeUIService.getTopN(paramAry, function (returnObj) {\n        var defers = [];\n        var topNdata = [];\n\n        if (returnObj.code == 0) {\n          topNdata = returnObj.data;\n          returnObj.data.forEach(function (item) {\n            defers.push(queryEnterpriseById(item.nodeId));\n          });\n        }\n\n        $q.all(defers).then(function () {\n          fomatData($scope.enterpriseInfoAry, topNdata, param);\n        });\n      });\n    }\n\n    $scope.goSearch = function (obj) {\n      if (!obj) {\n        return;\n      }\n\n      if (!obj.topN) {\n        growl.info(\"请选择topN\", {});\n        return;\n      }\n\n      if (!obj.statisticsType) {\n        growl.info(\"请选择统计周期\", {});\n        return;\n      }\n\n      if (!obj.kpiCode) {\n        growl.info(\"请选择指标\", {});\n        return;\n      }\n\n      if (!obj.range) {\n        growl.info(\"请选择时间段\", {});\n        return;\n      }\n\n      if (obj.kpiCode == '3300' && !obj.energyType) {\n        growl.info(\"请选择能源类型\", {});\n        return;\n      }\n\n      queryEnterpriseByTopN(obj);\n    };\n\n    var init = function init() {};\n    /**\n     * 监听登录状态\n     */\n\n\n    if (!userLoginUIService.user.isAuthenticated) {\n      $scope.$on('loginStatusChanged', function (evt, d) {\n        if (userLoginUIService.user.isAuthenticated) {\n          init();\n        }\n      });\n    } else {\n      init();\n    }\n  }]); //================================================  节能潜力点分析 ======================================================\n\n  controllers.initController('potentialCtrl', ['$scope', '$filter', '$routeParams', '$timeout', '$q', '$location', 'ngDialog', 'dictionaryService', 'kpiDataService', 'userLoginUIService', 'energyConsumeUIService', 'growl', 'resourceUIService', function ($scope, $filter, $routeParams, timeout, $q, $location, ngDialog, dictionaryService, kpiDataService, userLoginUIService, energyConsumeUIService, growl, resourceUIService) {\n    var echart = require('echarts');\n\n    var target = echart.init(document.getElementById('potentialdataview'));\n    var target1 = echart.init(document.getElementById('potentialDeviceview'));\n    var deferList = [];\n    var energyDic = {};\n    var markValueDic = {\n      'max': '最大值',\n      'min': '最小值',\n      'avg': '平均值'\n    };\n    $scope.tab = \"tab1\";\n    $scope.showTable1 = false;\n    $scope.showTable2 = false;\n    $scope.industryDic = {};\n    $scope.filterEnterprises = [];\n    $scope.queryDitem = {};\n    $scope.statisticsTypeDic = {\n      'MONTH': '月',\n      'QUARTER': '季度',\n      'YEAR': '年'\n    };\n\n    var initEvent = function initEvent() {\n      $('#deploy a[data-toggle=\"tab\"]').on('shown.bs.tab', function (e) {\n        if ($(e.target).closest(\"li.disabled\").length > 0) {\n          $(e.target).closest(\"li.disabled\").removeClass(\"active\");\n          $(e.target).closest(\"ul\").children(\"[name=\" + $scope.tab + \"]\").addClass(\"active\");\n          return;\n        }\n\n        var aname = $(e.target).closest(\"li\").attr(\"name\");\n\n        if (aname) {\n          $scope.tab = aname;\n          $scope.$apply();\n        }\n      });\n    };\n\n    $scope.$watch(\"myDicts\", function (n, o) {\n      if (n) {\n        $scope.industryList = $scope.myDicts['industryShortType'];\n        $scope.energyType = $scope.myDicts['energyType'];\n        $scope.industryList.forEach(function (item) {\n          item.id = item.valueCode;\n          item.text = item.param;\n          $scope.industryDic[item.valueCode] = item;\n          $scope.industryDic[item.label] = item;\n        });\n        $scope.energyType.forEach(function (item) {\n          item.text = item.label;\n          energyDic[item.label] = item;\n        });\n      }\n    });\n    /**\n     * 格式化时间格式(YYYY-MM-Day HH:MM:SS)\n     */\n\n    var formatDate = function formatDate(datestr) {\n      datestr = $filter('date')(datestr, 'yyyy-MM');\n      return datestr;\n    };\n\n    var broardFun = function broardFun(columns, columnDefs, totalList, type) {\n      timeout(function () {\n        $scope.$broadcast(Event.ENTERPRISEINIT + type, {\n          \"option\": [columns, columnDefs, totalList]\n        });\n      });\n    };\n\n    var widgetMaxFun = function widgetMaxFun(id) {\n      if (jQuery(id).find(\".fa.fa-plus\").length > 0) {\n        jQuery.AdminLTE.boxWidget.collapse(jQuery(id));\n      }\n    };\n\n    var widgetMinFun = function widgetMinFun(id) {\n      if (jQuery(id).find(\".fa.fa-plus\").length == 0) {\n        jQuery.AdminLTE.boxWidget.collapse(jQuery(id));\n      }\n    }; //初始化所有的数据\n\n\n    function initAllData() {\n      if ($scope.tab == 'tab1') {\n        $scope.queryDitem.enterpriseIds = [];\n        $scope.queryDitem.industryType = '';\n        $scope.queryDitem.markValue = '';\n        $scope.queryDitem.modelId = '';\n        $scope.queryDitem.startTime = '';\n        $scope.queryDitem.endTime = '';\n        target.clear();\n        $scope.showTable1 = false;\n      } else if ($scope.tab == 'tab3') {\n        $scope.queryDitem1.industryType = '';\n        $scope.queryDitem1.markValue = '';\n        $scope.queryDitem1.enterpriseId = '';\n        $scope.queryDitem1.modelId = '';\n        $scope.queryDitem1.startTime = '';\n        $scope.queryDitem1.endTime = '';\n        target1.clear();\n        $scope.showTable2 = false;\n      }\n    }\n\n    ;\n\n    $scope.goClear = function () {\n      initAllData();\n    }; //定义EChart option\n\n\n    var getOption = function getOption(echartData) {\n      var tabOption = {\n        title: {\n          text: ''\n        },\n        tooltip: {\n          trigger: 'axis',\n          axisPointer: {\n            type: 'cross',\n            label: {\n              backgroundColor: '#6a7985'\n            }\n          }\n        },\n        legend: {\n          data: echartData.legend\n        },\n        toolbox: {\n          feature: {\n            dataView: {\n              show: true,\n              readOnly: false\n            },\n            magicType: {\n              show: true,\n              type: ['line', 'bar']\n            },\n            restore: {\n              show: true\n            },\n            saveAsImage: {\n              show: true\n            }\n          }\n        },\n        grid: {\n          left: '3%',\n          right: '4%',\n          bottom: '3%',\n          containLabel: true\n        },\n        xAxis: [{\n          type: 'category',\n          boundaryGap: true,\n          data: echartData.xAxis\n        }],\n        yAxis: [{\n          type: 'value'\n        }],\n        series: echartData.series\n      };\n\n      if ($scope.tab == 'tab1') {\n        target.setOption(tabOption);\n      } else if ($scope.tab == 'tab3') {\n        target1.setOption(tabOption);\n      }\n    }; //处理数据\n\n\n    function fomatData(energyByEnterpriseIdAry, markValueList, obj) {\n      //返回数据，节点与相应企业信息\n      var legend = [];\n      var dataDic = {};\n      var filterDataDic = {};\n      var xAisDic = {};\n      var xAxis = [];\n      var series = [];\n      energyByEnterpriseIdAry.forEach(function (item) {\n        for (var key in obj.nodeIdDic) {\n          if (!filterDataDic[obj.nodeIdDic[key].name]) {\n            filterDataDic[obj.nodeIdDic[key].name] = [];\n          }\n\n          if (item.nodeId == key) {\n            filterDataDic[obj.nodeIdDic[key].name].push(item.value); //key是企业名字\n          }\n        }\n      });\n      obj.enterpriseIds.forEach(function (item) {\n        legend.push($scope.enterprisesDic[item].name);\n      });\n      legend = obj.nodeIds.map(function (item) {\n        return obj.nodeIdToEnfoDic[item].name + '-' + obj.nodeIdDic[item].label;\n      });\n      legend.push(markValueDic[obj.markValue]);\n      energyByEnterpriseIdAry.forEach(function (item) {\n        if (!xAisDic[item.arisingTime]) {\n          xAisDic[item.arisingTime] = item.arisingTime;\n          xAxis.push(formatDate(item.arisingTime));\n        }\n      });\n      obj.nodeIds.forEach(function (nodeId) {\n        series.push({\n          name: obj.nodeIdToEnfoDic[nodeId].name + '-' + obj.nodeIdDic[nodeId].label,\n          type: 'bar',\n          data: xAxis.map(function (elem) {\n            var find = energyByEnterpriseIdAry.find(function (el) {\n              var time = formatDate(el.arisingTime);\n              return time == elem && el.nodeId == nodeId;\n            });\n\n            if (find) {\n              return find;\n            } else {\n              return {};\n            }\n          })\n        });\n      });\n      series.push({\n        name: markValueDic[obj.markValue],\n        type: 'line',\n        data: xAxis.map(function (elem) {\n          var find = markValueList.find(function (el) {\n            var time = formatDate(el.arisingTime);\n            return time == elem;\n          });\n\n          if (find) {\n            return find;\n          } else {\n            return {};\n          }\n        })\n      }); //设置折线图的各项参数\n\n      var echartData = {\n        xAxis: xAxis,\n        legend: legend,\n        series: series\n      };\n      getOption(echartData);\n    }\n\n    ; //获取表格信息\n\n    function fomatDataTable(enterpriseGDPList, energyByEnterpriseIdAry, markValueList, obj) {\n      var xAisDic = {};\n      var xAxis = [];\n      var totalList = [];\n      energyByEnterpriseIdAry.forEach(function (item) {\n        if (!xAisDic[item.arisingTime]) {\n          xAisDic[item.arisingTime] = item.arisingTime;\n          xAxis.push(item.arisingTime);\n        }\n      });\n      xAxis.forEach(function (x) {\n        obj.nodeIds.forEach(function (nodeId) {\n          totalList.push({\n            arisingTime: formatDate(x),\n            nodeName: obj.nodeIdToEnfoDic[nodeId].name + '-' + obj.nodeIdDic[nodeId].label,\n            nodeValue: function () {\n              var find = energyByEnterpriseIdAry.find(function (el) {\n                return x == el.arisingTime && el.nodeId == nodeId;\n              });\n\n              if (find) {\n                return find.value;\n              } else {\n                return '-';\n              }\n            }(),\n            markValue: function () {\n              var find = markValueList.find(function (el) {\n                return x == el.arisingTime;\n              });\n\n              if (find) {\n                return find.value;\n              } else {\n                return '-';\n              }\n            }(),\n            diffValue: function () {\n              var nodeValue = energyByEnterpriseIdAry.find(function (el) {\n                return x == el.arisingTime && el.nodeId == nodeId;\n              });\n              var markValue = markValueList.find(function (el) {\n                return x == el.arisingTime;\n              });\n\n              if (nodeValue && markValue) {\n                return (nodeValue.value - markValue.value).toFixed(2);\n              } else {\n                return '-';\n              }\n            }(),\n            diffToGDP: function () {\n              var nodeValue = energyByEnterpriseIdAry.find(function (el) {\n                return x == el.arisingTime && el.nodeId == nodeId;\n              });\n              var markValue = markValueList.find(function (el) {\n                return x == el.arisingTime;\n              });\n              var enterpriseGDPValue = enterpriseGDPList.find(function (el) {\n                return x == el.arisingTime && el.nodeId == obj.nodeIdToEnfoDic[nodeId].id;\n              });\n\n              if (nodeValue && markValue && enterpriseGDPValue) {\n                var diff = (nodeValue.value - markValue.value).toFixed(2);\n                return (diff * enterpriseGDPValue.value).toFixed(2);\n              } else {\n                return '-';\n              }\n            }()\n          });\n        });\n      });\n      var columns = [{\n        data: \"arisingTime\",\n        title: \"时间\"\n      }, {\n        data: \"nodeName\",\n        title: \"节点名称\"\n      }, {\n        data: \"nodeValue\",\n        title: \"节点GDP能耗\"\n      }, {\n        data: \"markValue\",\n        title: markValueDic[obj.markValue]\n      }, {\n        data: \"diffValue\",\n        title: \"差值\"\n      }, {\n        data: \"diffToGDP\",\n        title: \"差值能耗值\"\n      }];\n      var columnDefs = [];\n      columns.forEach(function (item, index) {\n        columnDefs.push({\n          target: index,\n          data: item.data,\n          render: function render(data, type, full) {\n            return escape(data);\n          }\n        });\n      });\n\n      if ($scope.tab == \"tab1\") {\n        broardFun(columns, columnDefs, totalList, '_potential_data');\n      } else if ($scope.tab == \"tab3\") {\n        broardFun(columns, columnDefs, totalList, '_potential_device');\n      }\n    }\n\n    ; //获取节点对应的GDP能耗\n\n    var kpiDataByEnterpriseId = function kpiDataByEnterpriseId(obj, type, callback) {\n      var filterENterpriseAry = []; // var kpiCode = $scope.tab == 'tab3' ? [3325] : [3301];\n\n      var kpiCode = [];\n\n      if (type == 'enterpriseGDP') {\n        kpiCode = [3302];\n      } else {\n        kpiCode = [3304];\n      }\n\n      var param = [\"kpi\", {\n        \"category\": \"time\",\n        \"isRealTimeData\": false,\n        // \"nodeIds\": obj.nodeIds,\n        \"kpiCodes\": kpiCode,\n        \"startTime\": new Date(obj.startTime),\n        \"endTime\": new Date(obj.endTime),\n        \"timeRange\": \"\",\n        \"statisticType\": \"psiot\",\n        \"includeInstance\": true,\n        \"condList\": [],\n        \"timePeriod\": 0,\n        \"dataType\": 1\n      }];\n\n      if (type == 'enterpriseGDP') {\n        param[1].nodeIds = obj.enterpriseIds;\n      } else {\n        param[1].nodeIds = obj.nodeIds;\n      }\n\n      kpiDataService.getValueList(param, function (returnObj) {\n        if (returnObj.code == 0) {\n          if (type == 'enterpriseGDP') {\n            $scope.enterpriseGDPList = returnObj.data;\n            fomatDataTable($scope.enterpriseGDPList, $scope.energyByEnterpriseIdAry, $scope.markValueList, obj);\n          } else {\n            $scope.energyByEnterpriseIdAry = [];\n            returnObj.data.forEach(function (item) {\n              $scope.energyByEnterpriseIdAry.push(item);\n            });\n            fomatData($scope.energyByEnterpriseIdAry, $scope.markValueList, obj);\n          }\n\n          if (callback) {\n            callback();\n          }\n        }\n      });\n    }; //获取企业对应的GDP能耗\n\n\n    var queryDataByEnterpriseId = function queryDataByEnterpriseId(obj) {\n      var param = {};\n      $.extend(param, obj);\n\n      if ($scope.tab == 'tab1') {\n        param.enterpriseIds = obj.enterpriseIds;\n      } else if ($scope.tab == 'tab3') {\n        param.enterpriseIds = [obj.enterpriseId];\n      }\n\n      kpiDataByEnterpriseId(param, 'enterpriseGDP');\n    }; //获取所有企业\n\n\n    function queryAllEnterprises() {\n      energyConsumeUIService.findEnterpriseInfos(function (returnObj) {\n        if (returnObj.code == 0) {\n          $scope.enterprisesDic = {};\n          returnObj.data.forEach(function (item) {\n            item.text = item.name;\n            $scope.enterprisesDic[item.id] = item;\n          });\n          $scope.allEnterprises = returnObj.data;\n        }\n      });\n    }\n\n    ; //获取所有设备模板\n\n    function queryAllModels() {\n      resourceUIService.getModelsByCondition({}, function (returnObj) {\n        if (returnObj.code == 0) {\n          $scope.allModelsDic = {};\n          returnObj.data.forEach(function (item) {\n            $scope.allModelsDic[item.id] = item;\n          });\n          $scope.allModels = returnObj.data;\n        }\n      });\n    }\n\n    ; //获取节点上的设备类型\n\n    function queryAllDevices() {\n      energyConsumeUIService.getDeviceTypeNames('devicetype', function (returnObj) {\n        if (returnObj.code == 0) {\n          returnObj.data.forEach(function (item) {\n            item.text = item.label;\n          });\n          $scope.allDeviceList = returnObj.data;\n        }\n      });\n    }\n\n    ; //获取取值类型及行业对应值\n\n    function queryMarkValue(obj, callback) {\n      var param = [\"MONTH\", obj.industryType, obj.modelId, obj.markValue, [3304], obj.startTime, obj.endTime];\n      energyConsumeUIService.getIndustryMarkValue(param, function (returnObj) {\n        if (returnObj.code == 0) {\n          if (callback) {\n            callback();\n          }\n\n          $scope.markValueList = returnObj.data;\n        }\n      });\n    }\n\n    ;\n\n    $scope.goSearch = function (obj) {\n      if (!obj || !obj.industryType) {\n        growl.info(\"请选择行业\", {});\n        return;\n      }\n\n      if (!obj || $scope.tab == 'tab3' && !obj.enterpriseId || $scope.tab == 'tab1' && obj.enterpriseIds.length == 0) {\n        growl.info(\"请选择企业\", {});\n        return;\n      }\n\n      if (!obj || !obj.modelId) {\n        growl.info(\"请选择设备\", {});\n        return;\n      }\n\n      if (!obj || !obj.modelId) {\n        growl.info(\"请选择设备\", {});\n        return;\n      }\n\n      if (!obj || !obj.startTime) {\n        var year = new Date().getFullYear();\n        var startMonth = new Date().getMonth();\n        var endMonth = new Date().getMonth() + 1;\n        obj.startTime = new Date(year + '-' + startMonth);\n        obj.endTime = new Date(year + '-' + endMonth);\n      }\n\n      if (!obj || !obj.markValue) {\n        growl.info(\"请选择取值类型\", {});\n        return;\n      } //通过企业查设备模型\n\n\n      var nodeIdAry = [];\n      var nodeIdDic = {};\n      var modelNodeDic = {};\n      var nodeIdToEnfoDic = {};\n      var index = 0;\n      var ary = [];\n      var defers = [];\n      obj.enterToNodesDic = {};\n\n      var queryDomainsByEnterpriseId = function queryDomainsByEnterpriseId(enterpriseId) {\n        var subdefer = $q.defer();\n        energyConsumeUIService.queryDomainsByEnterpriseId(enterpriseId, function (returnObj) {\n          if (returnObj.code == 0) {\n            if ($scope.tab == 'tab1') {\n              index++;\n              ary = returnObj.data.filter(function (item) {\n                return item.modelDefinitionId == obj.modelId;\n              });\n              ary.forEach(function (item) {\n                nodeIdAry.push(item.id);\n                nodeIdDic[item.id] = item; ///节点存放节点信息 \n\n                nodeIdToEnfoDic[item.id] = $scope.enterprisesDic[enterpriseId]; //节点id对应企业信息\n              });\n\n              if (!obj.enterToNodesDic[enterpriseId]) {\n                obj.enterToNodesDic[enterpriseId] = ary;\n              }\n\n              if (index == obj.enterpriseIds.length) {\n                obj.nodeIds = nodeIdAry;\n                obj.nodeIdDic = nodeIdDic;\n                obj.nodeIdToEnfoDic = nodeIdToEnfoDic;\n              }\n            } else if ($scope.tab == 'tab3') {\n              // if (!obj.modelIds) {\n              //   ary = returnObj.data.filter(function(item) {\n              //     return item.modelDefinitionId != undefined;\n              //   });\n              // }\n              // else {\n              //   obj.modelIds.forEach(function(model) {\n              //     returnObj.data.forEach(function(item) {\n              //       if (item.modelDefinitionId == model) {\n              //         ary.push(item);\n              //       }\n              //     })\n              //   })\n              // }\n              returnObj.data.forEach(function (item) {\n                if (item.modelDefinitionId == obj.modelId) {\n                  ary.push(item);\n                }\n              });\n              ary.forEach(function (item) {\n                nodeIdAry.push(item.id);\n                nodeIdDic[item.id] = item; ///节点存放企业信息\n\n                nodeIdToEnfoDic[item.id] = $scope.enterprisesDic[enterpriseId]; //节点id对应企业信息\n              });\n              obj.nodeIds = nodeIdAry;\n              obj.nodeIdDic = nodeIdDic; //节点id对应节点信息\n\n              obj.nodeIdToEnfoDic = nodeIdToEnfoDic;\n            }\n\n            subdefer.resolve(\"success\");\n          }\n        });\n        return subdefer.promise;\n      };\n\n      if ($scope.tab == 'tab1') {\n        target.clear();\n        $scope.showTable1 = true;\n        widgetMaxFun('#viewcollapse1');\n        widgetMaxFun('#viewcollapse2');\n        obj.enterpriseIds.forEach(function (item) {\n          defers.push(queryDomainsByEnterpriseId(item));\n        });\n      } else if ($scope.tab == 'tab3') {\n        target1.clear();\n        $scope.showTable2 = true;\n        widgetMaxFun('#devicecollapse1');\n        widgetMaxFun('#devicecollapse2');\n        obj.enterpriseIds = [obj.enterpriseId];\n        defers.push(queryDomainsByEnterpriseId(obj.enterpriseId));\n      }\n\n      $q.all(defers).then(function () {\n        queryMarkValue(obj, function () {\n          kpiDataByEnterpriseId(obj, '', function () {\n            queryDataByEnterpriseId(obj);\n          }); //两个函数的执行顺序不能反\n        });\n      });\n    };\n\n    $scope.filterModel = function (obj) {\n      var param = obj;\n\n      if ($scope.tab == 'tab3') {\n        param = [obj];\n      }\n\n      if (obj.length == 0) {\n        return;\n      }\n\n      energyConsumeUIService.getModelDefinitionsByEnterpriseIds(param, function (returnObj) {\n        if (returnObj.code == 0) {\n          returnObj.data.forEach(function (item) {\n            item.text = item.label;\n          });\n          $scope.flterDeviceList = returnObj.data;\n        }\n      });\n    };\n\n    var init = function init() {\n      queryAllEnterprises();\n      queryAllModels();\n      queryAllDevices();\n      initEvent();\n      jQuery.AdminLTE.boxWidget.collapse(jQuery(\"#viewcollapse1\"));\n      jQuery.AdminLTE.boxWidget.collapse(jQuery(\"#viewcollapse2\"));\n      jQuery.AdminLTE.boxWidget.collapse(jQuery(\"#devicecollapse1\"));\n      jQuery.AdminLTE.boxWidget.collapse(jQuery(\"#devicecollapse2\")); // widgetMinFun('#viewcollapse1');\n      // widgetMinFun('#viewcollapse2');\n      // widgetMinFun('#devicecollapse1');\n      // widgetMinFun('#devicecollapse2');\n    };\n    /**\n     * 监听登录状态\n     */\n\n\n    if (!userLoginUIService.user.isAuthenticated) {\n      $scope.$on('loginStatusChanged', function (evt, d) {\n        if (userLoginUIService.user.isAuthenticated) {\n          init();\n        }\n      });\n    } else {\n      init();\n    }\n  }]); //================================================  能耗预测  ======================================================\n\n  controllers.initController('forecastCtrl', ['$scope', '$filter', '$routeParams', '$timeout', '$q', '$location', 'ngDialog', 'dictionaryService', 'kpiDataService', 'userLoginUIService', 'energyConsumeUIService', 'growl', 'resourceUIService', function ($scope, $filter, $routeParams, timeout, $q, $location, ngDialog, dictionaryService, kpiDataService, userLoginUIService, energyConsumeUIService, growl, resourceUIService) {\n    var echart = require('echarts');\n\n    var target1 = echart.init(document.getElementById('areaview'));\n    var target2 = echart.init(document.getElementById('industryview'));\n    var target31 = echart.init(document.getElementById('energyview1'));\n    var target32 = echart.init(document.getElementById('energyview2'));\n    var target33 = echart.init(document.getElementById('energyview3'));\n    var target4 = echart.init(document.getElementById('deviceView'));\n    var target5 = echart.init(document.getElementById('enterpriseView'));\n    $scope.area = $scope.$parent.districtDics['安徽省,合肥市'];\n    $scope.tab = 'tab1';\n    $scope.energyDic = {};\n    $scope.showEnergyTitle = false;\n    $scope.industryShortType = dictionaryService.dicts['industryShortType'];\n    $scope.energyType = dictionaryService.dicts['energyType'];\n    $scope.industryShortType.forEach(function (item) {\n      item.id = item.param;\n      item.text = item.param;\n    });\n    $scope.energyType.forEach(function (item) {\n      item.text = item.label;\n      item.id = item.label;\n      $scope.energyDic[item.label] = item;\n    });\n    $scope.statisticsTypeList = [{\n      id: \"MONTH\",\n      text: '月'\n    }, {\n      id: \"QUARTER\",\n      text: '季度'\n    }, {\n      id: \"YEAR\",\n      text: '年'\n    }];\n    var kpiCodeList = [{\n      id: 3319,\n      type: 'area',\n      label: \"区域工业附加值能耗\"\n    }, {\n      id: 3318,\n      type: 'area',\n      label: \"区域GDP能耗\"\n    }, {\n      id: 3315,\n      type: 'area',\n      label: \"区域综合能耗\"\n    }, {\n      id: 3330,\n      type: 'industry',\n      label: \"行业工业附加值能耗\"\n    }, {\n      id: 3329,\n      type: 'industry',\n      label: \"行业GDP能耗\"\n    }, {\n      id: 3312,\n      type: 'industry',\n      label: \"行业综合能耗\"\n    }, {\n      id: 3332,\n      type: 'energy',\n      label: \"能源类型的工业附加值能耗\"\n    }, {\n      id: 3331,\n      type: 'energy',\n      label: \"能源类型的GDP能耗\"\n    }, {\n      id: 3300,\n      type: 'energy',\n      label: \"能源类型的综合能耗\"\n    }, {\n      id: 3305,\n      type: 'device',\n      label: \"工业附加值能耗\"\n    }, {\n      id: 3304,\n      type: 'device',\n      label: \"GDP能耗\"\n    }, {\n      id: 3301,\n      type: 'device',\n      label: \"综合能耗\"\n    }]; //初始化所有的数据\n\n    function initAllData() {\n      $scope.queryDitem.area = '';\n      $scope.queryDitem.industry = '';\n      $scope.queryDitem.energy = '';\n      $scope.queryDitem.enterpriseId = '';\n      $scope.queryDitem.enterpriseId2 = '';\n      $scope.queryDitem.enterpriseId5 = '';\n      $scope.queryDitem.statisticsType1 = '';\n      $scope.queryDitem.statisticsType2 = '';\n      $scope.queryDitem.statisticsType3 = '';\n      $scope.queryDitem.statisticsType4 = '';\n      $scope.queryDitem.statisticsType5 = '';\n      $scope.queryDitem.modelId = '';\n      $scope.queryDitem.nodeId = '';\n      $scope.showEnergyTitle = false;\n      target1.clear();\n      target2.clear();\n      target31.clear();\n      target32.clear();\n      target33.clear();\n      target4.clear();\n      target5.clear();\n    }\n\n    ;\n\n    $scope.goClear = function () {\n      initAllData();\n    };\n\n    var initEvent = function initEvent() {\n      $('#deploy a[data-toggle=\"tab\"]').on('shown.bs.tab', function (e) {\n        if ($(e.target).closest(\"li.disabled\").length > 0) {\n          $(e.target).closest(\"li.disabled\").removeClass(\"active\");\n          $(e.target).closest(\"ul\").children(\"[name=\" + $scope.tab + \"]\").addClass(\"active\");\n          return;\n        }\n\n        var aname = $(e.target).closest(\"li\").attr(\"name\");\n\n        if (aname) {\n          $scope.tab = aname;\n          $scope.$apply();\n        }\n      });\n    }; //定义EChart option\n\n\n    var getOption = function getOption(echartData) {\n      var yAxis = [];\n\n      if ($scope.tab == \"tab3\") {\n        yAxis = [{\n          name: '单位（吨标煤/万元）',\n          boundaryGap: true,\n          type: 'value'\n        }, {\n          name: '单位（吨标煤）',\n          boundaryGap: true,\n          type: 'value'\n        }];\n      } else {\n        yAxis = [{\n          name: '单位（吨标煤/万元）',\n          boundaryGap: true,\n          type: 'value',\n          max: echartData.yAxis[0]\n        }, {\n          name: '单位（吨标煤）',\n          boundaryGap: true,\n          type: 'value',\n          max: echartData.yAxis[1]\n        }];\n      }\n\n      var option = {\n        title: {\n          text: ''\n        },\n        tooltip: {\n          trigger: 'axis',\n          axisPointer: {\n            type: 'cross',\n            label: {\n              backgroundColor: '#6a7985'\n            }\n          }\n        },\n        legend: {\n          data: echartData.legend,\n          selected: function () {\n            var dataDic = {};\n            echartData.legend.forEach(function (item) {\n              dataDic[item] = $scope.tab == \"tab3\" ? false : true;\n            });\n            dataDic['电力'] = true;\n            dataDic['电力（真实值）'] = true;\n            dataDic['水'] = true;\n            dataDic['水（真实值）'] = true;\n            return dataDic;\n          }()\n        },\n        toolbox: {\n          feature: {\n            dataView: {\n              readOnly: false\n            },\n            magicType: {\n              type: ['line', 'bar']\n            },\n            restore: {},\n            saveAsImage: {}\n          }\n        },\n        grid: {\n          left: '3%',\n          right: '4%',\n          bottom: '3%',\n          containLabel: true\n        },\n        xAxis: [{\n          type: 'category',\n          boundaryGap: true,\n          data: echartData.xAxis\n        }],\n        yAxis: yAxis,\n        series: echartData.series\n      };\n\n      if ($scope.tab == \"tab1\") {\n        target1.setOption(option);\n      } else if ($scope.tab == \"tab2\") {\n        target2.setOption(option);\n      } else if ($scope.tab == \"tab3\") {\n        if (echartData.kpiCode == 3332) {\n          target31.setOption(option);\n        } else if (echartData.kpiCode == 3331) {\n          target32.setOption(option);\n        } else if (echartData.kpiCode == 3300) {\n          target33.setOption(option);\n        }\n      } else if ($scope.tab == \"tab4\") {\n        target4.setOption(option);\n      } else if ($scope.tab == \"tab5\") {\n        target5.setOption(option);\n      }\n    };\n    /**\n     * 格式化时间格式(YYYY-MM-Day HH:MM:SS)\n     */\n\n\n    var formatDate = function formatDate(datestr) {\n      datestr = $filter('date')(datestr, 'yyyy-MM');\n      return datestr;\n    }; //根据参数查kpi数据\n\n\n    var queryKpiCOdeByParam = function queryKpiCOdeByParam(param, callback) {\n      kpiDataService.getValueList(param, function (returnObj) {\n        if (returnObj.code == 0) {\n          callback(returnObj.data);\n        }\n      });\n    }; //处理数据\n\n\n    var formatDataFunc = function formatDataFunc(data, trueData) {\n      var xAxis = [];\n      var yAxisMinAry = [];\n      var yAxisMaxAry = [];\n      var yAxis = [];\n      data.forEach(function (item) {\n        if (item.kpiCode == 3315 || item.kpiCode == 3312 || item.kpiCode == 3300 || item.kpiCode == 3301) {\n          yAxisMaxAry.push(item.value);\n        } else {\n          yAxisMinAry.push(item.value);\n        }\n\n        if (xAxis.indexOf(formatDate(item.arisingTime)) == -1) {\n          xAxis.push(formatDate(item.arisingTime));\n        }\n      });\n\n      if (trueData) {\n        trueData.forEach(function (item) {\n          if (item.kpiCode == 3315 || item.kpiCode == 3312 || item.kpiCode == 3300 || item.kpiCode == 3301) {\n            yAxisMaxAry.push(item.value);\n          } else {\n            yAxisMinAry.push(item.value);\n          }\n        });\n      }\n\n      yAxisMinAry = yAxisMinAry.sort(function (a, b) {\n        return a - b;\n      });\n      yAxisMaxAry = yAxisMaxAry.sort(function (a, b) {\n        return a - b;\n      });\n      yAxis = [yAxisMinAry[yAxisMinAry.length - 1], yAxisMaxAry[yAxisMaxAry.length - 1]];\n      var legendAry = [];\n\n      if ($scope.tab == 'tab1') {\n        legendAry = kpiCodeList.filter(function (item) {\n          return item.type == 'area';\n        });\n      } else if ($scope.tab == 'tab2') {\n        legendAry = kpiCodeList.filter(function (item) {\n          return item.type == 'industry';\n        });\n      } else if ($scope.tab == 'tab3') {\n        legendAry = kpiCodeList.filter(function (item) {\n          return item.type == 'energy';\n        });\n      } else if ($scope.tab == 'tab4' || $scope.tab == 'tab5') {\n        legendAry = kpiCodeList.filter(function (item) {\n          return item.type == 'device';\n        });\n      }\n\n      var legend = [];\n      legendAry.forEach(function (item) {\n        legend.push(item.label, item.label + '（真实值）');\n      });\n      var series = [];\n      legendAry.map(function (len) {\n        var itemValue = xAxis.map(function (xA) {\n          var find = data.find(function (el) {\n            var time = formatDate(el.arisingTime);\n            return xA == time && el.kpiCode == len.id;\n          });\n\n          if (find) {\n            return find;\n          } else {\n            return [];\n          }\n\n          ;\n        });\n        var trueItemValue = xAxis.map(function (xA) {\n          if (trueData) {\n            var find = trueData.find(function (el) {\n              var time = formatDate(el.arisingTime);\n              return xA == time && el.kpiCode == len.id;\n            });\n          }\n\n          if (find) {\n            return find;\n          } else {\n            return [];\n          }\n\n          ;\n        });\n        var obj = {\n          name: len.label,\n          type: 'bar',\n          // stack: '总量',\n          // areaStyle: {\n          //   normal: {}\n          // },\n          yAxisIndex: len.id == 3315 || len.id == 3312 || len.id == 3300 || len.id == 3301 ? 1 : 0,\n          data: itemValue.map(function (item) {\n            return item.value;\n          })\n        };\n        var trueObj = {\n          name: len.label + '（真实值）',\n          type: 'line',\n          // xAxisIndex: (len.id == 3315 || len.id == 3312 || len.id == 3300 || len.id == 3301) ? 1 : 0,\n          yAxisIndex: len.id == 3315 || len.id == 3312 || len.id == 3300 || len.id == 3301 ? 1 : 0,\n          data: trueItemValue.map(function (item) {\n            return item && item.value ? item.value : '-';\n          })\n        };\n        series.push(obj, trueObj);\n      }); //设置折线图的各项参数\n\n      var echartData = {\n        xAxis: xAxis,\n        yAxis: yAxis,\n        legend: legend,\n        series: series\n      };\n      getOption(echartData);\n    }; //特殊处理能源数据\n\n\n    var formatEnergyFunc = function formatEnergyFunc(data, trueData) {\n      var legend = [];\n      $scope.energyType.forEach(function (item) {\n        legend.push(item.text, item.text + '（真实值）');\n      });\n      var totalDic = {};\n      var trueTotalDic = {};\n      var totalAry = [];\n      var picAry = kpiCodeList.filter(function (item) {\n        return item.type == 'energy';\n      });\n      picAry.forEach(function (item) {\n        totalDic[item.id] = [];\n        trueTotalDic[item.id] = [];\n        data.forEach(function (ele) {\n          if (item.id == ele.kpiCode) {\n            totalDic[item.id].push(ele);\n          }\n        });\n        trueData.forEach(function (ele) {\n          if (item.id == ele.kpiCode) {\n            trueTotalDic[item.id].push(ele);\n          }\n        });\n      });\n\n      var loop = function loop(itemObj) {\n        itemObj.data.forEach(function (item) {\n          if (itemObj.xAxis.indexOf(formatDate(item.arisingTime)) == -1) {\n            itemObj.xAxis.push(formatDate(item.arisingTime));\n          }\n        });\n        $scope.energyType.map(function (len) {\n          function fotmat(xAixs, data) {\n            var itemValue = xAixs.map(function (xA) {\n              var find = data.find(function (el) {\n                var time = formatDate(el.arisingTime);\n                return xA == time && el.instance == len.text;\n              });\n\n              if (find) {\n                return find;\n              } else {\n                return [];\n              }\n\n              ;\n            });\n            return itemValue;\n          }\n\n          ;\n          var itemValue = fotmat(itemObj.xAxis, itemObj.data);\n          var trueItemValue = fotmat(itemObj.xAxis, itemObj.trueData);\n          var obj = {\n            name: len.label,\n            type: 'bar',\n            // stack: '总量',\n            // areaStyle: {\n            //   normal: {}\n            // },\n            data: itemValue.map(function (item) {\n              return item.value;\n            })\n          };\n          var trueObj = {\n            name: len.label + '（真实值）',\n            type: 'line',\n            yAxisIndex: 1,\n            // stack: '总量',\n            // areaStyle: {\n            //   normal: {}\n            // },\n            data: trueItemValue.map(function (item) {\n              return item.value;\n            })\n          };\n          itemObj.series.push(obj, trueObj);\n        });\n      };\n\n      for (var key in totalDic) {\n        totalAry.push({\n          kpiCode: key,\n          data: totalDic[key],\n          trueData: trueTotalDic[key],\n          xAxis: [],\n          legend: legend,\n          series: []\n        });\n      }\n\n      ;\n      totalAry.forEach(function (item) {\n        loop(item);\n        getOption(item);\n      }); //设置折线图的各项参数\n      // getOption(totalAry);\n    };\n\n    $scope.goSearch = function (obj) {\n      var param = [\"kpi\", {\n        \"category\": \"time\",\n        \"isRealTimeData\": true,\n        // \"nodeIds\": obj.nodeIds,\n        // \"kpiCodes\": [3300],\n        // \"startTime\": new Date(obj.startTime),\n        // \"endTime\": new Date(obj.endTime),\n        \"timeRange\": \"\",\n        // \"granularityUnit\": \"MONTH\",\n        \"aggregateType\": [],\n        \"statisticType\": \"psiot\",\n        \"includeInstance\": true,\n        \"condList\": [],\n        \"timePeriod\": 15552000000,\n        \"dataType\": 2\n      }];\n\n      if ($scope.tab == 'tab1') {\n        param[1].granularityUnit = obj.statisticsType1;\n        param[1].nodeIds = [userLoginUIService.user.domainID];\n        var kpiAry = kpiCodeList.filter(function (item) {\n          return item.type == \"area\";\n        });\n        param[1].kpiCodes = kpiAry.map(function (item) {\n          return item.id;\n        });\n        param[1].queryInstances = obj.area;\n        queryKpiCOdeByParam(param, function (eventData) {\n          param[1].dataType = 1;\n          queryKpiCOdeByParam(param, function (trueData) {\n            formatDataFunc(eventData, trueData);\n          });\n        });\n      } else if ($scope.tab == 'tab2') {\n        param[1].granularityUnit = obj.statisticsType2;\n        param[1].nodeIds = [userLoginUIService.user.domainID];\n        var kpiAry = kpiCodeList.filter(function (item) {\n          return item.type == \"industry\";\n        });\n        param[1].kpiCodes = kpiAry.map(function (item) {\n          return item.id;\n        });\n        param[1].queryInstances = obj.industry;\n        queryKpiCOdeByParam(param, function (eventData) {\n          param[1].dataType = 1;\n          queryKpiCOdeByParam(param, function (trueData) {\n            formatDataFunc(eventData, trueData);\n          });\n        });\n      } else if ($scope.tab == 'tab5') {\n        param[1].nodeIds = [obj.enterpriseId5];\n        var kpiAry = kpiCodeList.filter(function (item) {\n          return item.type == \"device\";\n        });\n        param[1].kpiCodes = kpiAry.map(function (item) {\n          return item.id;\n        });\n        queryKpiCOdeByParam(param, function (eventData) {\n          param[1].dataType = 1;\n          queryKpiCOdeByParam(param, function (trueData) {\n            formatDataFunc(eventData, trueData);\n          });\n        });\n      } else if ($scope.tab == 'tab3') {\n        $scope.showEnergyTitle = true;\n        param[1].granularityUnit = obj.statisticsType3;\n        param[1].nodeIds = $scope.queryDitem.enterpriseId2 ? [$scope.queryDitem.enterpriseId2] : [userLoginUIService.user.domainID];\n        var kpiAry = kpiCodeList.filter(function (item) {\n          return item.type == \"energy\";\n        });\n        param[1].kpiCodes = kpiAry.map(function (item) {\n          return item.id;\n        });\n        param[1].queryInstances = obj.energy;\n        queryKpiCOdeByParam(param, function (eventData) {\n          param[1].dataType = 1;\n          queryKpiCOdeByParam(param, function (trueData) {\n            formatEnergyFunc(eventData, trueData);\n          });\n        });\n      } else if ($scope.tab == 'tab4') {\n        if (!obj.enterpriseId) {\n          growl.info(\"请选择企业\", {});\n          return;\n        }\n\n        if (!obj.modelId) {\n          growl.info(\"请选择设备\", {});\n          return;\n        } // queryNodeIdByEnterprise(obj, function(returnNodeId) {\n        // param[1].nodeIds = [returnNodeId];\n\n\n        param[1].nodeIds = [obj.nodeId];\n        param[1].granularityUnit = obj.statisticsType4;\n        var kpiAry = kpiCodeList.filter(function (item) {\n          return item.type == \"device\";\n        });\n        param[1].kpiCodes = kpiAry.map(function (item) {\n          return item.id;\n        });\n        queryKpiCOdeByParam(param, function (eventData) {\n          param[1].dataType = 1;\n          queryKpiCOdeByParam(param, function (trueData) {\n            formatDataFunc(eventData, trueData);\n          });\n        });\n      }\n    }; //获取节点上的设备类型\n\n\n    function queryAllDevices() {\n      energyConsumeUIService.getDeviceTypeNames('devicetype', function (returnObj) {\n        if (returnObj.code == 0) {\n          returnObj.data.forEach(function (item) {\n            item.text = item.label;\n          });\n          $scope.allDeviceList = returnObj.data;\n        }\n      });\n    }\n\n    ;\n\n    $scope.filterModel = function (obj) {\n      $scope.filterNodes = [];\n      $scope.queryDitem.modelId = \"\";\n      $scope.queryDitem.nodeId = \"\";\n      var id = obj.id.split(\":\")[1];\n      $scope.queryDitem.statisticsType4 = $scope.enterprisesDic[id].statisticsType;\n      $scope.$apply();\n      energyConsumeUIService.getModelDefinitionsByEnterpriseIds([id], function (returnObj) {\n        if (returnObj.code == 0) {\n          returnObj.data.forEach(function (item) {\n            item.text = item.label;\n          });\n          $scope.flterDeviceList = returnObj.data;\n        }\n      });\n    };\n\n    $scope.filterNodeId = function (model) {\n      var obj = {\n        enterpriseId: $scope.queryDitem.enterpriseId,\n        modelId: model.id.split(\":\")[1]\n      };\n      queryNodeIdByEnterprise(obj);\n    };\n\n    $scope.filterStatistic = function (obj) {\n      var id = obj.id.split(':')[1];\n\n      if ($scope.tab == \"tab3\") {\n        $scope.queryDitem.statisticsType3 = $scope.enterprisesDic[id].statisticsType;\n        $scope.$apply();\n      } else if ($scope.tab == \"tab5\") {\n        $scope.queryDitem.statisticsType5 = $scope.enterprisesDic[id].statisticsType;\n        $scope.$apply();\n      }\n    }; //获取所有企业\n\n\n    function queryAllEnterprises() {\n      energyConsumeUIService.findEnterpriseInfos(function (returnObj) {\n        if (returnObj.code == 0) {\n          $scope.enterprisesDic = {};\n          returnObj.data.forEach(function (item) {\n            item.text = item.name;\n            $scope.enterprisesDic[item.id] = item;\n          });\n          $scope.allEnterprises = returnObj.data;\n        }\n      });\n    }\n\n    ; //根据企业和所选设备过滤出节点信息\n\n    function queryNodeIdByEnterprise(obj, callback) {\n      energyConsumeUIService.queryDomainsByEnterpriseId(obj.enterpriseId, function (returnObj) {\n        if (returnObj.code == 0) {\n          var data = returnObj.data.filter(function (item) {\n            item.text = item.name;\n            return item.modelDefinitionId && item.modelDefinitionId == obj.modelId;\n          });\n          $scope.filterNodes = data; //var data = returnObj.data;\n          // var ids = [];\n          // for (var i = 0; i < data.length; i++) {\n          //   if (data[i].modelDefinitionId && data[i].modelDefinitionId == obj.modelId) {\n          //     ids.push(data[i].id);\n          //   }\n          // }\n          // callback(ids);\n        }\n      });\n    }\n\n    ;\n\n    var init = function init() {\n      queryAllEnterprises();\n      queryAllDevices();\n      initEvent();\n    };\n    /**\n     * 监听登录状态\n     */\n\n\n    if (!userLoginUIService.user.isAuthenticated) {\n      $scope.$on('loginStatusChanged', function (evt, d) {\n        if (userLoginUIService.user.isAuthenticated) {\n          init();\n        }\n      });\n    } else {\n      init();\n    }\n  }]); //================================================  企业间设备对比（新）  ======================================================\n\n  controllers.initController('deviceComparisonCtrl', ['$scope', '$filter', '$routeParams', '$timeout', '$q', '$location', 'ngDialog', 'dictionaryService', 'kpiDataService', 'userLoginUIService', 'energyConsumeUIService', 'growl', 'resourceUIService', function ($scope, $filter, $routeParams, timeout, $q, $location, ngDialog, dictionaryService, kpiDataService, userLoginUIService, energyConsumeUIService, growl, resourceUIService) {\n    var echart = require('echarts');\n\n    var target = echart.init(document.getElementById('deviceview'));\n    var target3 = echart.init(document.getElementById('device3view'));\n    var deferList = [];\n    $scope.industryDic = {};\n    $scope.tab = 'tab1';\n    $scope.statisticsTypeDic = {\n      'MONTH': '月',\n      'QUARTER': '季度',\n      'YEAR': '年'\n    };\n    $scope.energyDic = {};\n    var industryShortType = dictionaryService.dicts['industryShortType'];\n    $scope.energyType = dictionaryService.dicts['energyType'];\n    industryShortType.forEach(function (item) {\n      $scope.industryDic[item.valueCode] = item;\n      $scope.industryDic[item.label] = item;\n    });\n    $scope.energyType.forEach(function (item) {\n      item.id = item.label;\n      item.text = item.label;\n      $scope.energyDic[item.label] = item;\n    }); //初始化所有的数据\n\n    function initAllData() {\n      $scope.queryDitem.enterpriseIds = [];\n      $scope.queryDitem.modelId = '';\n      $scope.queryDitem.energyType = '';\n      target.clear();\n    }\n\n    ;\n\n    $scope.goClear = function () {\n      initAllData();\n    };\n\n    var initEvent = function initEvent() {\n      $('#deploy a[data-toggle=\"tab\"]').on('shown.bs.tab', function (e) {\n        if ($(e.target).closest(\"li.disabled\").length > 0) {\n          $(e.target).closest(\"li.disabled\").removeClass(\"active\");\n          $(e.target).closest(\"ul\").children(\"[name=\" + $scope.tab + \"]\").addClass(\"active\");\n          return;\n        }\n\n        var aname = $(e.target).closest(\"li\").attr(\"name\");\n\n        if (aname) {\n          $scope.tab = aname;\n          $scope.$apply();\n        }\n\n        if (aname == 'tab3' || aname == 'tab1') {//$scope.searchDate();\n        }\n      });\n    }; //定义EChart option\n\n\n    var getOption = function getOption(echartData) {\n      var option = {\n        title: {\n          text: ''\n        },\n        tooltip: {\n          trigger: 'axis',\n          axisPointer: {\n            type: 'cross',\n            label: {\n              backgroundColor: '#6a7985'\n            }\n          }\n        },\n        legend: {\n          data: echartData.legend\n        },\n        toolbox: {\n          feature: {\n            dataView: {\n              show: true,\n              readOnly: false\n            },\n            magicType: {\n              show: true,\n              type: ['line', 'bar']\n            },\n            restore: {\n              show: true\n            },\n            saveAsImage: {\n              show: true\n            }\n          }\n        },\n        grid: {\n          left: '3%',\n          right: '4%',\n          bottom: '3%',\n          containLabel: true\n        },\n        xAxis: [{\n          type: 'category',\n          boundaryGap: false,\n          data: echartData.xAxis\n        }],\n        yAxis: [{\n          name: '单能源消耗（单位：吨标煤）',\n          axisLabel: {\n            margin: 30\n          },\n          type: 'value'\n        }],\n        series: echartData.series\n      };\n\n      if ($scope.tab == 'tab1') {\n        target.setOption(option);\n      } else if ($scope.tab == 'tab3') {\n        target3.setOption(option);\n      }\n    };\n    /**\n     * 格式化时间格式(YYYY-MM-Day HH:MM:SS)\n     */\n\n\n    var formatDate = function formatDate(datestr) {\n      datestr = $filter('date')(datestr, 'yyyy-MM');\n      return datestr;\n    }; //处理数据\n\n\n    function fomatData(data, obj) {\n      //返回数据，节点与相应企业信息\n      var xAxis = [];\n      data.forEach(function (item) {\n        if (xAxis.indexOf(formatDate(item.arisingTime)) == -1) {\n          xAxis.push(formatDate(item.arisingTime));\n        }\n      });\n      var series = [];\n      var legend = [];\n      var result = [];\n      obj.enterpriseIds.forEach(function (item) {\n        legend.push($scope.enterprisesDic[item].name);\n      });\n      legend = obj.nodeIds.map(function (item) {\n        return obj.nodeIdToEnfoDic[item].name + '-' + obj.nodeIdDic[item].label;\n      });\n      obj.nodeIds.forEach(function (nodeId) {\n        var nodeObj = {\n          name: obj.nodeIdToEnfoDic[nodeId].name + '-' + obj.nodeIdDic[nodeId].label,\n          value: xAxis.map(function (elem) {\n            var find = data.find(function (el) {\n              var time = formatDate(el.arisingTime);\n              return time == elem && el.nodeId == nodeId;\n            });\n\n            if (find) {\n              return find;\n            } else {\n              return {};\n            }\n          })\n        };\n        result.push(nodeObj);\n      });\n      result.forEach(function (item) {\n        series.push({\n          name: item.name,\n          type: 'line',\n          areaStyle: {\n            normal: {}\n          },\n          data: item.value.map(function (el) {\n            return el.value;\n          })\n        });\n      }); //设置折线图的各项参数\n\n      var echartData = {\n        xAxis: xAxis,\n        legend: legend,\n        series: series\n      };\n      getOption(echartData);\n    }\n\n    ; //获取企业对应的综合能耗\n\n    var kpiDataByEnterpriseId = function kpiDataByEnterpriseId(obj) {\n      var filterENterpriseAry = [];\n      var param = [\"kpi\", {\n        \"category\": \"time\",\n        \"isRealTimeData\": false,\n        \"nodeIds\": obj.nodeIds,\n        \"kpiCodes\": [3300],\n        \"startTime\": obj.startTime,\n        \"endTime\": obj.endTime,\n        \"timeRange\": \"\",\n        \"statisticType\": \"psiot\",\n        \"queryInstances\": obj.energyType,\n        \"aggregateType\": [\"VALENTWEIGHT\"],\n        \"granularityUnit\": \"MONTH\",\n        \"includeInstance\": true,\n        \"condList\": [],\n        \"timePeriod\": 15552000000,\n        \"dataType\": 1\n      }];\n      kpiDataService.getValueList(param, function (returnObj) {\n        if (returnObj.code == 0) {\n          fomatData(returnObj.data, obj);\n        }\n      });\n    }; //获取所有企业及企业对应的节点信息\n\n\n    function queryAllEnterprises() {\n      var index = 0;\n      var ary = [];\n      var allEnterprisesLength = 0;\n      var allModelAry = [];\n      var allModelDic = {};\n      $scope.allModelAry = [];\n      $scope.allModelDic = {};\n\n      var queryDomainsByEnterpriseId = function queryDomainsByEnterpriseId(enterpriseId) {\n        energyConsumeUIService.queryDomainsByEnterpriseId(enterpriseId, function (returnObj) {\n          if (returnObj.code == 0) {\n            index++;\n            returnObj.data.forEach(function (item) {\n              //筛选出企业的设备模板\n              if (item.modelDefinitionId) {\n                ary.push(item);\n              }\n            });\n\n            if (ary) {\n              ary.forEach(function (item) {\n                allModelAry.push();\n                allModelDic[item.modelDefinitionId] = $scope.enterprisesDic[enterpriseId]; ///设备模型上存放企业信息\n              });\n            }\n\n            if (index == allEnterprisesLength) {\n              //查询了所有的企业节点\n              $scope.allModelAry = allModelAry;\n              $scope.allModelDic = allModelDic; //节点id对应企业信息\n            }\n          }\n        });\n      };\n\n      energyConsumeUIService.findEnterpriseInfos(function (returnObj) {\n        if (returnObj.code == 0) {\n          $scope.enterprisesDic = {};\n          returnObj.data.forEach(function (item) {\n            item.text = item.name;\n            $scope.enterprisesDic[item.id] = item; // queryDomainsByEnterpriseId(item.id);\n          });\n          $scope.allEnterprises = returnObj.data;\n          allEnterprisesLength = returnObj.data.length;\n        }\n      });\n    }\n\n    ; //获取节点上的设备类型\n\n    function queryAllDevices() {\n      energyConsumeUIService.getDeviceTypeNames('devicetype', function (returnObj) {\n        if (returnObj.code == 0) {\n          returnObj.data.forEach(function (item) {\n            item.text = item.label;\n          });\n          $scope.allDeviceList = returnObj.data;\n        }\n      });\n    }\n\n    ;\n\n    $scope.goSearch = function (obj) {\n      //通过企业查设备模型\n      var nodeIdAry = [];\n      var nodeIdDic = {};\n      var nodeIdToEnfoDic = {};\n      var index = 0;\n      var defers = [];\n      obj.enterToNodesDic = {};\n\n      var queryDomainsByEnterpriseId = function queryDomainsByEnterpriseId(enterpriseId) {\n        var subdefer = $q.defer();\n        energyConsumeUIService.queryDomainsByEnterpriseId(enterpriseId, function (returnObj) {\n          if (returnObj.code == 0) {\n            index++;\n            var ary = returnObj.data.filter(function (item) {\n              return item.modelDefinitionId == obj.modelId;\n            });\n            ary.forEach(function (item) {\n              nodeIdAry.push(item.id);\n              nodeIdDic[item.id] = item; //节点ID对应节点信息\n\n              nodeIdToEnfoDic[item.id] = $scope.enterprisesDic[enterpriseId]; //节点id对应企业信息\n            });\n\n            if (!obj.enterToNodesDic[enterpriseId]) {\n              obj.enterToNodesDic[enterpriseId] = ary;\n            }\n\n            if (index == obj.enterpriseIds.length) {\n              obj.nodeIds = nodeIdAry;\n              obj.nodeIdDic = nodeIdDic;\n              obj.nodeIdToEnfoDic = nodeIdToEnfoDic;\n            }\n\n            subdefer.resolve(\"success\");\n          }\n        });\n        return subdefer.promise;\n      };\n\n      obj.enterpriseIds.forEach(function (item) {\n        defers.push(queryDomainsByEnterpriseId(item));\n      });\n      $q.all(defers).then(function () {\n        kpiDataByEnterpriseId(obj);\n      });\n    };\n\n    $scope.filterEnter = function (obj) {\n      var modelId = obj.id.split(':')[1];\n      energyConsumeUIService.getEnterpriseInfosByModelDefinitionId([modelId], function (returnObj) {\n        if (returnObj.code == 0) {\n          returnObj.data.forEach(function (item) {\n            item.text = item.name;\n          });\n          $scope.filterEnterprises = returnObj.data;\n        }\n      });\n    };\n\n    $scope.filterModel = function (obj) {\n      if (obj.length == 0) {\n        return;\n      }\n\n      energyConsumeUIService.getModelDefinitionsByEnterpriseIds(obj, function (returnObj) {\n        if (returnObj.code == 0) {\n          returnObj.data.forEach(function (item) {\n            item.text = item.label;\n          });\n          $scope.flterDeviceList = returnObj.data;\n        }\n      });\n    };\n\n    var init = function init() {\n      queryAllEnterprises();\n      queryAllDevices();\n      initEvent();\n    };\n    /**\n     * 监听登录状态\n     */\n\n\n    if (!userLoginUIService.user.isAuthenticated) {\n      $scope.$on('loginStatusChanged', function (evt, d) {\n        if (userLoginUIService.user.isAuthenticated) {\n          init();\n        }\n      });\n    } else {\n      init();\n    }\n  }]); //================================================  能效评估 ======================================================\n\n  controllers.initController('assessmentCtrl', ['$scope', '$filter', '$routeParams', '$timeout', '$q', '$location', 'ngDialog', 'dictionaryService', 'kpiDataService', 'userLoginUIService', 'energyConsumeUIService', 'growl', 'resourceUIService', function ($scope, $filter, $routeParams, timeout, $q, $location, ngDialog, dictionaryService, kpiDataService, userLoginUIService, energyConsumeUIService, growl, resourceUIService) {\n    var echart = require('echarts');\n\n    var target = echart.init(document.getElementById('radarView'));\n    var target1 = echart.init(document.getElementById('tendencyView'));\n    var statisticsTypeDic = {\n      'MONTH': '月',\n      'QUARTER': '季度',\n      'YEAR': '年'\n    };\n    var kpiCodeDic = {\n      3304: 'GDP能耗得分',\n      3305: '工业附加值能耗得分',\n      3301: '节能率指标得分',\n      3351: '节能潜力指标得分'\n    };\n    $scope.industryDic = {};\n    $scope.queryDitem = {};\n    $scope.$watch(\"myDicts\", function (n, o) {\n      if (n) {\n        $scope.industryList = $scope.myDicts['industryShortType'];\n        $scope.industryList.forEach(function (item) {\n          item.id = item.valueCode;\n          item.text = item.param;\n          $scope.industryDic[item.valueCode] = item;\n          $scope.industryDic[item.label] = item;\n        });\n      }\n    });\n    /**\n     * 格式化时间格式(YYYY-MM-Day HH:MM:SS)\n     */\n\n    var formatDate = function formatDate(datestr) {\n      datestr = $filter('date')(datestr, 'yyyy-MM');\n      return datestr;\n    };\n\n    var widgetMaxFun = function widgetMaxFun(id) {\n      if (jQuery(id).find(\".fa.fa-plus\").length > 0) {\n        jQuery.AdminLTE.boxWidget.collapse(jQuery(id));\n      }\n    };\n\n    var widgetMinFun = function widgetMinFun(id) {\n      if (jQuery(id).find(\".fa.fa-plus\").length == 0) {\n        jQuery.AdminLTE.boxWidget.collapse(jQuery(id));\n      }\n    }; //初始化所有的数据\n\n\n    function initAllData() {\n      $scope.queryDitem.enterpriseId = '';\n      $scope.queryDitem.industryType = '';\n      $scope.queryDitem.statisticsType = '';\n      $scope.queryDitem.startTime = '';\n      $scope.queryDitem.endTime = '';\n      target.clear();\n      target1.clear();\n    }\n\n    ;\n\n    $scope.goClear = function () {\n      initAllData();\n    }; //定义EChart option\n\n\n    var getOption = function getOption(echartData) {\n      var tabOption = {\n        title: {\n          text: ''\n        },\n        tooltip: {\n          trigger: 'axis',\n          axisPointer: {\n            type: 'cross',\n            label: {\n              backgroundColor: '#6a7985'\n            }\n          }\n        },\n        legend: {\n          data: echartData.legend\n        },\n        toolbox: {\n          feature: {\n            dataView: {\n              show: true,\n              readOnly: false\n            },\n            magicType: {\n              show: true,\n              type: ['line', 'bar']\n            },\n            restore: {\n              show: true\n            },\n            saveAsImage: {\n              show: true\n            }\n          }\n        },\n        grid: {\n          left: '3%',\n          right: '4%',\n          bottom: '3%',\n          containLabel: true\n        },\n        xAxis: [{\n          type: 'category',\n          boundaryGap: false,\n          data: echartData.xAxis\n        }],\n        yAxis: [{\n          type: 'value'\n        }],\n        series: echartData.series\n      };\n      var radarOption = {\n        title: {\n          text: ''\n        },\n        tooltip: {},\n        toolbox: {\n          feature: {\n            dataView: {\n              show: true,\n              readOnly: false\n            },\n            restore: {\n              show: true\n            },\n            saveAsImage: {\n              show: true\n            }\n          }\n        },\n        legend: {\n          data: echartData.xAxis\n        },\n        radar: {\n          // shape: 'circle',\n          indicator: echartData.indicator\n        },\n        series: [{\n          name: '',\n          type: 'radar',\n          // areaStyle: {normal: {}},\n          data: echartData.randarSeries\n        }]\n      };\n      target.setOption(radarOption);\n      target1.setOption(tabOption);\n    }; //处理数据\n\n\n    function fomatData(ssessmentAry, obj) {\n      //返回数据\n      var legend = [];\n      var legendAry = [];\n      var xAisDic = {};\n      var xAxis = [];\n      var series = [];\n      var randarSeries = [];\n\n      for (var key in kpiCodeDic) {\n        legend.push(kpiCodeDic[key]);\n        legendAry.push({\n          id: key,\n          name: kpiCodeDic[key],\n          max: 100\n        });\n      }\n\n      ssessmentAry.forEach(function (item) {\n        if (!xAisDic[item.arisingTime]) {\n          xAisDic[item.arisingTime] = item.arisingTime;\n          xAxis.push(formatDate(item.arisingTime));\n        }\n      });\n      legendAry.forEach(function (legend) {\n        series.push({\n          name: legend.name,\n          type: 'line',\n          data: xAxis.map(function (elem) {\n            var find = ssessmentAry.find(function (el) {\n              var time = formatDate(el.arisingTime);\n              return time == elem && el.kpiCode == legend.id;\n            });\n\n            if (find) {\n              return find.value;\n            } else {\n              return '-';\n            }\n          })\n        });\n      }); //雷达图：xAxis时间为图例，legendAry为5个指标\n\n      xAxis.forEach(function (x) {\n        randarSeries.push({\n          name: x,\n          value: legendAry.map(function (legend) {\n            var find = ssessmentAry.find(function (el) {\n              var time = formatDate(el.arisingTime);\n              return time == x && el.kpiCode == legend.id;\n            });\n\n            if (find) {\n              return find.value;\n            } else {\n              return '-';\n            }\n          })\n        });\n      }); //设置折线图的各项参数\n\n      var echartData = {\n        xAxis: xAxis,\n        legend: legend,\n        series: series,\n        indicator: legendAry,\n        randarSeries: randarSeries\n      };\n      getOption(echartData);\n    }\n\n    ; //获取能效评估的5个指标\n\n    var kpiDataByEnterpriseId = function kpiDataByEnterpriseId(obj) {\n      var param = [obj.statisticsType, obj.industryType, obj.enterpriseId, obj.startTime, obj.endTime];\n      energyConsumeUIService.getEnergyEvaluations(param, function (returnObj) {\n        if (returnObj.code == 0) {\n          var ssessmentAry = [];\n          returnObj.data.forEach(function (item) {\n            ssessmentAry.push(item);\n          });\n          fomatData(ssessmentAry, obj);\n        }\n      });\n    };\n\n    $scope.goSearch = function (obj) {\n      if (!obj || !obj.industryType) {\n        growl.info(\"请选择行业\", {});\n        return;\n      }\n\n      if (!obj || !obj.enterpriseId) {\n        growl.info(\"请选择企业\", {});\n        return;\n      }\n\n      if (!obj || !obj.statisticsType) {\n        growl.info(\"请选择周期类型\", {});\n        return;\n      }\n\n      if (!obj || !obj.startTime) {\n        var year = new Date().getFullYear();\n        var startMonth = new Date().getMonth();\n        var endMonth = new Date().getMonth() + 1;\n        obj.startTime = new Date(year + '-' + startMonth);\n        obj.endTime = new Date(year + '-' + endMonth);\n      }\n\n      target.clear();\n      kpiDataByEnterpriseId(obj);\n      widgetMaxFun(\"#viewrandar1\");\n      widgetMaxFun(\"#viewrandar2\");\n    }; //获取所有企业\n\n\n    function queryAllEnterprises() {\n      energyConsumeUIService.findEnterpriseInfos(function (returnObj) {\n        if (returnObj.code == 0) {\n          $scope.enterprisesDic = {};\n          returnObj.data.forEach(function (item) {\n            item.text = item.name;\n            $scope.enterprisesDic[item.id] = item;\n          });\n          $scope.allEnterprises = returnObj.data;\n        }\n      });\n    }\n\n    ;\n\n    var init = function init() {\n      queryAllEnterprises();\n      jQuery.AdminLTE.boxWidget.collapse(jQuery(\"#viewrandar1\"));\n      jQuery.AdminLTE.boxWidget.collapse(jQuery(\"#viewrandar2\")); // widgetMinFun(\"#viewrandar1\");\n      // widgetMinFun(\"#viewrandar2\");\n    };\n    /**\n     * 监听登录状态\n     */\n\n\n    if (!userLoginUIService.user.isAuthenticated) {\n      $scope.$on('loginStatusChanged', function (evt, d) {\n        if (userLoginUIService.user.isAuthenticated) {\n          init();\n        }\n      });\n    } else {\n      init();\n    }\n  }]); //================================================  能耗区域态势  ======================================================\n\n  controllers.initController('areaEnergyCtrl', ['$scope', '$filter', '$routeParams', '$timeout', 'Info', '$q', '$location', 'ngDialog', 'dictionaryService', 'kpiDataService', 'userLoginUIService', 'energyConsumeUIService', 'growl', 'resourceUIService', function ($scope, $filter, $routeParams, timeout, Info, $q, $location, ngDialog, dictionaryService, kpiDataService, userLoginUIService, energyConsumeUIService, growl, resourceUIService) {\n    var echart = require('echarts');\n\n    var target1 = echart.init(document.getElementById('areaEnergyview'));\n    var target2 = echart.init(document.getElementById('areamap'));\n    var areaDic = {\n      '合肥': [117.29, 32.0581]\n    };\n    Info.get('../localdb/hefei2.json', function (data) {\n      data.features.forEach(function (item) {\n        var temp = item.properties.cp;\n        areaDic[item.properties.name] = [temp[0], temp[1]];\n      });\n      echart.registerMap('hefei', data);\n    });\n    $scope.tab = 'tab1';\n    var kpiCodeList = [{\n      id: 3320,\n      type: 'area',\n      label: \"区域综合能耗增幅\"\n    }, {\n      id: 3321,\n      type: 'area',\n      label: \"区域GDP增幅\"\n    }, {\n      id: 3322,\n      type: 'area',\n      label: \"区域工业附加值增幅\"\n    }, {\n      id: 3323,\n      type: 'area',\n      label: \"区域GDP能耗增幅\"\n    }, {\n      id: 3324,\n      type: 'area',\n      label: \"区域工业附加值能耗增幅\"\n    }, {\n      id: 3315,\n      type: 'map',\n      label: \"区域综合能耗\"\n    }, {\n      id: 3318,\n      type: 'map',\n      label: \"区域GDP能耗\"\n    }, {\n      id: 3319,\n      type: 'map',\n      label: \"区域工业附加值能耗\"\n    }]; //初始化所有的数据\n\n    function initAllData() {\n      var lastYear = new Date().getFullYear();\n      var lastMonth = new Date().getMonth();\n      $scope.queryDitem = {};\n      $scope.queryDitem1 = {};\n      $scope.queryDitem.year = lastYear;\n      $scope.queryDitem.month = lastMonth;\n      $scope.queryDitem1.year = lastYear;\n      $scope.queryDitem1.month = lastMonth;\n      $scope.yearList = [];\n      $scope.monthList = [];\n\n      for (var i = 0; i < 8; i++) {\n        $scope.yearList.push({\n          id: lastYear - i,\n          text: lastYear - i + '年'\n        });\n      }\n\n      for (var i = 1; i < 13; i++) {\n        $scope.monthList.unshift({\n          id: i,\n          text: i + '月'\n        });\n      }\n\n      target1.clear();\n      target2.clear();\n    }\n\n    ;\n\n    $scope.goClear = function () {\n      initAllData();\n    };\n\n    var initEvent = function initEvent() {\n      $('#deploy a[data-toggle=\"tab\"]').on('shown.bs.tab', function (e) {\n        if ($(e.target).closest(\"li.disabled\").length > 0) {\n          $(e.target).closest(\"li.disabled\").removeClass(\"active\");\n          $(e.target).closest(\"ul\").children(\"[name=\" + $scope.tab + \"]\").addClass(\"active\");\n          return;\n        }\n\n        var aname = $(e.target).closest(\"li\").attr(\"name\");\n\n        if (aname) {\n          $scope.tab = aname;\n          $scope.$apply();\n        }\n      });\n    }; //定义EChart option\n\n\n    var getOption = function getOption(echartData) {\n      var option = {\n        // tooltip: {\n        //   trigger: 'axis',\n        //   axisPointer: { // 坐标轴指示器，坐标轴触发有效\n        //     type: 'shadow' // 默认为直线，可选为：'line' | 'shadow'\n        //   }\n        // },\n        tooltip: {\n          trigger: 'axis',\n          axisPointer: {\n            type: 'cross',\n            label: {\n              backgroundColor: '#6a7985'\n            }\n          }\n        },\n        toolbox: {\n          feature: {\n            dataView: {\n              show: true,\n              readOnly: false\n            },\n            magicType: {\n              show: true,\n              type: ['stack', 'tiled']\n            },\n            restore: {\n              show: true\n            },\n            saveAsImage: {\n              show: true\n            }\n          }\n        },\n        legend: echartData.legend,\n        grid: {\n          left: '3%',\n          right: '4%',\n          bottom: '3%',\n          containLabel: true\n        },\n        xAxis: echartData.xAxis,\n        yAxis: echartData.yAxis,\n        series: echartData.series\n      };\n      var optionMap = {\n        backgroundColor: 'rgb(208, 224, 227)',\n        title: {\n          text: '',\n          subtext: '',\n          left: 'center',\n          textStyle: {\n            color: '#000'\n          }\n        },\n        tooltip: {\n          trigger: 'item'\n        },\n        toolbox: {\n          feature: {\n            dataView: {\n              show: true,\n              readOnly: false\n            },\n            restore: {\n              show: true\n            },\n            saveAsImage: {\n              show: true\n            }\n          }\n        },\n        visualMap: {\n          min: 0,\n          max: 2500,\n          left: 'left',\n          top: 'bottom',\n          text: ['高', '低'],\n          // 文本，默认为数值文本\n          calculable: true,\n          inRange: {\n            color: ['lightskyblue', 'yellow', 'orangered']\n          }\n        },\n        legend: {\n          orient: 'vertical',\n          top: 'top',\n          left: 'left',\n          data: echartData.legend,\n          textStyle: {\n            color: '#333'\n          },\n          selectedMode: 'single'\n        },\n        geo: {\n          map: 'hefei',\n          label: {\n            emphasis: {\n              show: false\n            }\n          },\n          roam: true,\n          itemStyle: {\n            normal: {\n              areaColor: 'rgb(111, 168, 220)',\n              borderColor: '#404a59'\n            },\n            emphasis: {\n              areaColor: 'rgb(7, 55, 99)'\n            }\n          }\n        },\n        series: echartData.series\n      };\n\n      if ($scope.tab == \"tab1\") {\n        //  \n        target1.setOption(option);\n      } else if ($scope.tab == \"tab2\") {\n        target2.setOption(optionMap);\n      }\n    };\n    /**\n     * 格式化时间格式(YYYY-MM-Day HH:MM:SS)\n     */\n\n\n    var formatDate = function formatDate(datestr) {\n      datestr = $filter('date')(datestr, 'yyyy-MM');\n      return datestr;\n    }; //根据参数查kpi数据\n\n\n    var queryKpiCOdeByParam = function queryKpiCOdeByParam(param, callback) {\n      kpiDataService.getValueList(param, function (returnObj) {\n        if (returnObj.code == 0) {\n          callback(returnObj.data);\n        }\n      });\n    }; //处理数据\n\n\n    var formatDataFunc = function formatDataFunc(data, type) {\n      var planePath = 'path://M1705.06,1318.313v-89.254l-319.9-221.799l0.073-208.063c0.521-84.662-26.629-121.796-63.961-121.491c-37.332-0.305-64.482,36.829-63.961,121.491l0.073,208.063l-319.9,221.799v89.254l330.343-157.288l12.238,241.308l-134.449,92.931l0.531,42.034l175.125-42.917l175.125,42.917l0.531-42.034l-134.449-92.931l12.238-241.308L1705.06,1318.313z';\n      var color = {\n        '区域综合能耗': '#a6c84c',\n        '区域GDP能耗': '#ffa022',\n        '区域工业附加值能耗': '#46bee9'\n      };\n      var xAxis = [];\n      var yAxis = [];\n      data.forEach(function (item) {\n        if (yAxis.indexOf(item.instance) == -1) {\n          yAxis.push(item.instance);\n        }\n      });\n      var legend = kpiCodeList.filter(function (item) {\n        return item.type == type;\n      });\n      var series = [];\n      var seriesMap = [];\n      var HFData = [];\n      var echartData = {};\n      var mapDic = {};\n      legend.map(function (len) {\n        mapDic[len.label] = [];\n        var itemValue = yAxis.map(function (yA) {\n          var find = data.find(function (el) {\n            return yA == el.instance && el.kpiCode == len.id;\n          });\n\n          if (find) {\n            HFData.push({\n              name: len.label,\n              from: '合肥',\n              to: find.instance,\n              value: find.value\n            });\n            return find;\n          } else {\n            return [];\n          }\n\n          ;\n        });\n        var obj = {\n          name: len.label,\n          type: 'bar',\n          areaStyle: {\n            normal: {\n              show: true\n            }\n          },\n          data: itemValue.map(function (item) {\n            return item.value;\n          })\n        };\n        series.push(obj);\n      });\n\n      for (var key in mapDic) {\n        HFData.forEach(function (item) {\n          if (key == item.name) {\n            mapDic[key].push({\n              formName: '合肥',\n              toName: item.to,\n              name: item.to,\n              coords: [areaDic['合肥'], areaDic[item.to]],\n              value: areaDic[item.to].concat(item.value)\n            });\n          }\n        });\n      }\n\n      ;\n\n      for (var key in mapDic) {\n        seriesMap.push({\n          name: key,\n          type: 'lines',\n          zlevel: 1,\n          effect: {\n            show: true,\n            period: 6,\n            trailLength: 0.7,\n            color: '#fff',\n            symbolSize: 3\n          },\n          lineStyle: {\n            normal: {\n              color: color[key],\n              width: 0,\n              curveness: 0.2\n            }\n          },\n          data: mapDic[key]\n        }, {\n          name: key,\n          type: 'lines',\n          zlevel: 2,\n          symbol: ['none', 'arrow'],\n          symbolSize: 10,\n          effect: {\n            show: true,\n            period: 6,\n            trailLength: 0,\n            symbol: planePath,\n            symbolSize: 15\n          },\n          lineStyle: {\n            normal: {\n              color: color[key],\n              width: 1,\n              opacity: 0.6,\n              curveness: 0.2\n            }\n          },\n          data: mapDic[key]\n        }, {\n          name: key,\n          type: 'effectScatter',\n          coordinateSystem: 'geo',\n          zlevel: 2,\n          rippleEffect: {\n            brushType: 'stroke'\n          },\n          label: {\n            normal: {\n              show: true,\n              position: 'right',\n              formatter: '{b}'\n            }\n          },\n          symbolSize: function symbolSize(val) {\n            return 10;\n          },\n          itemStyle: {\n            normal: {\n              label: {\n                show: true\n              }\n            },\n            emphasis: {\n              label: {\n                show: true\n              }\n            } // normal: {\n            //   color: color[key]\n            // }\n\n          },\n          data: mapDic[key]\n        });\n      } //设置折线图的各项参数\n\n\n      if (type == 'area') {\n        echartData = {\n          xAxis: [{\n            type: 'value'\n          }],\n          yAxis: [{\n            type: 'category',\n            axisTick: {\n              show: false\n            },\n            data: yAxis\n          }],\n          legend: {\n            data: function () {\n              return legend.map(function (item) {\n                return item.label;\n              });\n            }()\n          },\n          series: series\n        };\n      } else {\n        echartData = {\n          legend: legend.map(function (item) {\n            return item.label;\n          }),\n          series: seriesMap\n        };\n      }\n\n      getOption(echartData);\n    };\n\n    $scope.goSearch = function (obj) {\n      obj.startTime = new Date(obj.year + '-' + obj.month);\n      obj.endTime = new Date(obj.year + '-' + obj.month + '-' + '02');\n      var param = [\"kpi\", {\n        // \"category\": \"ci\",\n        \"aggregate_instance\": 2,\n        \"aggregate_rule\": 0,\n        \"isRealTimeData\": false,\n        \"nodeIds\": [userLoginUIService.user.domainID],\n        // \"kpiCodes\": [3300],\n        \"startTime\": obj.startTime,\n        \"endTime\": obj.endTime,\n        \"timeRange\": \"\",\n        \"granularityUnit\": \"MONTH\",\n        \"aggregateType\": ['VALENTWEIGHT'],\n        \"statisticType\": \"psiot\",\n        \"includeInstance\": true,\n        \"condList\": [],\n        \"timePeriod\": 15552000000,\n        \"dataType\": 1\n      }];\n\n      if ($scope.tab == 'tab1') {\n        param[1].category = \"time\";\n        var kpiAry = kpiCodeList.filter(function (item) {\n          return item.type == \"area\";\n        });\n        param[1].kpiCodes = kpiAry.map(function (item) {\n          return item.id;\n        });\n        queryKpiCOdeByParam(param, function (eventData) {\n          formatDataFunc(eventData, 'area');\n        });\n      } else if ($scope.tab == 'tab2') {\n        param[1].category = \"ci\";\n        var kpiAry = kpiCodeList.filter(function (item) {\n          return item.type == \"map\";\n        });\n        param[1].kpiCodes = kpiAry.map(function (item) {\n          return item.id;\n        });\n        queryKpiCOdeByParam(param, function (eventData) {\n          formatDataFunc(eventData, 'map');\n        });\n      }\n    };\n\n    var init = function init() {\n      initAllData();\n      initEvent();\n    };\n    /**\n     * 监听登录状态\n     */\n\n\n    if (!userLoginUIService.user.isAuthenticated) {\n      $scope.$on('loginStatusChanged', function (evt, d) {\n        if (userLoginUIService.user.isAuthenticated) {\n          init();\n        }\n      });\n    } else {\n      init();\n    }\n  }]);\n});"],"sourceRoot":"/source/"}