define(["controllers/controllers"],function(e){"use strict";e.initController("viewDirectiveCtrl",["$scope","$routeParams","$timeout","resourceUIService","kpiDataService","SwSocket","growl",function(c,e,i,t,r,m,o){var u;console.info("viewDirectiveCtrl被触发");var s=[],a={},d=e.modelId,n=e.nodeId;c.selectedDiritem={},c.itemKpiValues={},c.itemDirValues={},c.itemlabel="",c.dirItemClick=function(e){c.selectedDiritem=e},c.sendItemDir=function(){for(var e in c.selectedDiritem.params){var i=c.selectedDiritem.params[e];if(!c.itemDirValues[i.name])return void o.warning("请输入:"+c.selectedDiritem.params[e].label,{})}t.sendDeviceDirective(Number(n),c.selectedDiritem.id,c.itemDirValues,function(e){0==e.code&&o.success("指令发送成功",{})})};var p=function(e){var i=a[e.data.kpiCode];i&&(c.itemKpiValues[i]=e.data.value)},l=function(d,n){var l,e=["kpi",{category:"time",isRealTimeData:!0,timePeriod:0,nodeIds:n,kpiCodes:d}];r.getKpiHierarchyValueList(e,function(e){!function(e){if(0==e.code){for(var i in(l=e.data).recordList){var t=l.recordList[i];for(var r in t){var o=r.split("-");1<o.length&&(c.itemKpiValues[o[1]]=t[r])}}var s={ciid:n.toString(),kpi:d.toString()},a="register";m.register(u,a,p),m.send(u,a,"kpi",s)}}(e)})};d&&n&&(u=Math.uuid(),t.getDirectivesByModelId(d,function(e){0==e.code&&(c.modelsDirs=e.data,c.selectedDiritem=c.modelsDirs[0])}),t.getKpisByModelId(d,function(e){if(0==e.code){for(var i in c.modelsKpis=e.data,c.modelsKpis)s.push(c.modelsKpis[i].id),a[c.modelsKpis[i].id]=c.modelsKpis[i].name,c.itemKpiValues[c.modelsKpis[i].name]="";l(s,[n])}}),t.getResourceById(n,function(e){0==e.code&&(c.itemlabel=e.data.label)})),c.$on("$destroy",function(){m.unregister(u)})}])});
//# sourceMappingURL=../../../map/app-oc/js/controllers/view-directive-ctrl.js.map
