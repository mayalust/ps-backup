define(["controllers/controllers","bootstrap-dialog"],function(e,g){"use strict";e.initController("sendMailCtrl",["$scope","$routeParams","$sce","FileUploader","userLoginUIService","userEnterpriseService","psMessageService","growl","userRoleUIService","userFunctionService","userDomainService","marketplaceUIService",function(s,e,t,n,a,r,o,i,l,c,u,d){s.msgModel={messageId:"",title:"",content:"",insertTime:"",status:"",msgType:"",objectId:""};var g=e.msgId;g&&o.queryMessageInfo(g,function(e){0==e.code&&(s.msgModel=e.data,s.msgModel.content=e.data.content)}),s.TrustAsHtml=function(e){return t.trustAsHtml(e)},s.msgSave=function(){var e=CKEDITOR.instances.editor1.getData(),t=s.msgModel.title;""!=t&&""!=$.trim(t)&&""!=e&&""!=$.trim(e)?e.length<1e4?(s.msgModel.content=e,""==s.msgModel.messageId?o.addMessage(s.msgModel,function(e){0==e.code&&(i.success("站内信保存成功",{}),location.href="#/system")}):o.modifyMessage(s.msgModel,function(e){0==e.code&&(i.success("修改站内信保存成功",{}),location.href="#/system")})):i.warning("联系管理员，输入内容过长",{}):i.warning("标题或者内容不能为空",{})}}]),e.initController("systemCtrl",["$scope","$sce","FileUploader","userLoginUIService","userEnterpriseService","psMessageService","growl","userRoleUIService","userFunctionService","userDomainService","marketplaceUIService",function(t,s,e,n,a,r,o,i,l,c,u){t.systemGridData={columns:[{title:"标题",data:"title"},{title:"创建时间",data:"createTime"},{title:"状态",data:"status"},{title:"发布时间",data:"insertTime"},{title:"操作",orderable:!1,data:"option"}],columnDefs:[{targets:1,data:"createTime",render:function(e,t,s){return newDateJson(e).Format(GetDateCategoryStrByLabel())}},{targets:2,data:"status",render:function(e,t,s){var n="";return 0==e?n="草稿":5==e&&(n="已发布"),n}},{targets:3,data:"insertTime",render:function(e,t,s){var n="";return 0==s.status?n="":5==s.status&&""!=e&&null!=e&&(n=newDateJson(e).Format(GetDateCategoryStrByLabel())),n}},{targets:4,data:"option",render:function(e,t,s){var n="";return 0==s.status?n+="<div class='btn-group table-option-group' ><button type='button' class='btn btn-default btn-sm'>操作</button><button type='button' class='btn btn-default btn-sm dropdown-toggle' data-toggle='dropdown'><span class='caret'></span><span class='sr-only'>Toggle Dropdown</span></button><ul class='dropdown-menu' role='menu'><li><a style='cursor: pointer;' id='update-btn'>修改</a></li><li><a style='cursor: pointer;' id='delete-btn'>删除</a></li><li><a style='cursor: pointer;' id='publish-btn'>发布</a></li><li><a style='cursor: pointer;' id='preview-btn'>预览</a></li></ul></div>":5==s.status&&(n="已发布"),n}}]},t.deleteMessage=function(t){g.show({title:"提示",closable:!1,message:"确认要删除该公告",buttons:[{label:"确定",cssClass:"btn-success",action:function(e){r.deleteMessage(t.messageId,function(e){0==e.code&&(d(),o.success("公告删除成功",{}))}),e.close()}},{label:"取消",action:function(e){e.close()}}]})},t.notice="tab",t.previewData="",t.TrustAsHtml=function(e){return s.trustAsHtml(e)},t.preview=function(e){t.previewData=e,t.notice="preview",t.$apply()},t.addMail=function(){window.location.href="#/mailedit"},t.publishMessage=function(e){r.sendMessageToAll(e.messageId,function(e){0==e.code&&(d(),o.success("公告发布成功",{}))})};var d=function(){r.queryAllMessage(function(e){0==e.code&&(t.systemGridData.data=e.data,t.$broadcast(Event.USERINFOSINIT+"_system",t.systemGridData))})};d()}])});
//# sourceMappingURL=../../../map/app-oc/js/controllers/mail-ctrl.js.map
