define(["controllers/controllers","bootstrap-dialog","Array"],function(e,r){"use strict";e.initController("FacilityPanelCtrl",["$scope","$q","$timeout","$routeParams","growl","userUIService","userEnterpriseService","kpiDataService","resourceUIService","Info","viewFlexService","userDomainService","userLoginUIService","customerUIService","projectUIService","ngDialog","deviceAccessUIService","freeboardservice","roleViewService",function(c,e,d,r,t,o,a,n,s,i,u,l,f,v,p,m,I,g,y){decodeURIComponent(r.parameter);var S=JSON.parse(decodeURIComponent(r.parameter)),w=S[0].modelId,U=S[0].resourceId;if(w){c.instance={};u.getManagedViewsByTypeAndRole("dashboard",function(e){var n,i;0==e.code&&(n=e.data,u.getDefaultView(w,function(e){if(0==e.code)if(i=e.data,e.data instanceof Array){var r,t=i.find(function(e){return!!e.template&&e.template.resourceId==w}),o=n.find(function(e){var r=e.viewId;return!!e.template&&e.template.resourceId==w&&f.user.roleResList.some(function(e){return e.resId==r&&21==e.resType})});if(o?r=o:t&&(r=t),r)u.getViewById(r.viewId,function(e){var a,n;if("0"==e.code){var i=e.data.content;s.getModelByIds([w],function(e){"0"==e.code&&(a=e.data[0]);var o=function(e){if("0"==e.code&&(n=e.data,null!=i)){var r=JSON.parse(i);if(r.hasOwnProperty("groups"));else var t={layout:r.data?r.data:r.layout,setting:r.setting};delete r.data;var o=new g.replaceCiKpi(t,function(){d(function(){c.instance.setMode(!0),c.instance.renderLayout(o,null,c)})},{model:a,resource:n})}};U?s.getResourceById(U,o):s.getResources(function(e){0==e.code&&(c.resources=e.data,c.resource=c.resources[0],c.itemchange=function(e){var r=e.id.split("number:")[1],t=c.resources.find(function(e){return e.id==r});t&&o({code:0,data:t})},o({code:0,data:c.resources[0]}))})})}});else{var a=JSON.stringify({modelId:w});c.error="没有找到相应的设备仪表板视图，点击<a href='../app-freeboard/index.html#/template/model/dashboard/"+encodeURIComponent(a)+"' style='cursor:pointer; text-decoration: underline;'>创建设备仪表板</a>"}}else c.error="视图列表为空，请联系系统管理员";else c.error="获取视图列表发生错误，请联系系统管理员"}))})}else c.error="传入的设备模型，或者设备参数错误。请退出重新选择。"}])});
//# sourceMappingURL=../../../map/app-oc/js/controllers/facility-panel-ctrl.js.map
