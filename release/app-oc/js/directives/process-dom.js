define(["directives/directives","bootstrap-dialog","datatables.net","datatables.net-bs","datatables.net-select"],function(d,t,e){"use strict";d.initDirective("processDesignDom",["$timeout","$compile","$filter","growl",function(t,n,i,o){return{restrict:"A",controller:["$scope","$element","$attrs",function(d,t,e){var r,a=t;d.$on("PROCESS",function(t,e){r&&(r.destroy(),a.empty()),!1,r=a.DataTable({dom:e.data&&0<e.data.length?$.ProudSmart.datatable.footerdom:"",language:$.ProudSmart.datatable.language,data:e.data,order:[[2,"desc"]],columns:[{data:"name",title:"流程名称"},{data:"desc",title:"描述"},{data:"createTime",title:"创建时间"},{data:"updateTime",title:"更新时间"},{data:"pulishTime",title:"最新发布时间"},{data:"version",title:"最新版本号"},{data:"versionCount",title:"历史版本数量"},$.ProudSmart.datatable.optionCol3],columnDefs:[{targets:0,data:"name",render:function(t,e,a){return 2!=a.isEdit&&3!=a.isEdit||"display"!=e?escape(t):"<input style='width:100%' class='form-control input-sm' type='text' value='"+escape(t)+"'>"}},{targets:2,data:"createTime",render:function(t,e,a){return i("date")(t,"yyyy-MM-dd HH:mm:ss")}},{targets:3,data:"updateTime",render:function(t,e,a){return i("date")(t,"yyyy-MM-dd HH:mm:ss")}},{targets:4,data:"pulishTime",render:function(t,e,a){return i("date")(t,"yyyy-MM-dd HH:mm:ss")}},{targets:5,data:"version",render:function(t,e,a){return t}},{targets:1,data:"desc",render:function(t,e,a){return 2!=a.isEdit&&3!=a.isEdit||"display"!=e?escape(t):"<input maxlength='20' style='width:100%' class='form-control input-sm' type='text' value='"+escape(t)+"'>"}},{targets:6,data:"versionCount",render:function(t,e,a){return escape(t)}},{targets:7,data:"option",render:function(t,e,a){var n="<div class='btn-group btn-group-sm'>";return 2==a.isEdit||3==a.isEdit?(n+="<button id='save-btn'  class='btn btn-primary' ><i class='fa fa-check hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 保存</span></button>",n+="<button id='cancel-btn'   class='btn btn-default' ><i class='fa fa-trash hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 取消</span></button>"):(d.menuitems.A01_S19&&(n+="<button id='design-btn'  class='btn btn-primary' ><i class='fa fa-edit hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 设计</span></button>"),d.menuitems.A06_S19&&(n+="<button id='edit-btn'   class='btn btn-default' ><i class='fa fa-trash hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 编辑</span></button>"),(d.menuitems.A01_S19||d.menuitems.A08_S19||d.menuitems.A03_S19)&&(n+="<button type='button' class='btn btn-default dropdown-toggle' data-toggle='dropdown'> 更多<span class='caret'></span></button>"),n+="<ul class='dropdown-menu' role='menu'>",d.menuitems.A07_S19&&(n+="<li><a role='button'  id='del-btn'>删除</a></li>"),d.menuitems.A08_S19&&(n+="<li><a role='button'  id='release-btn'>发布</a></li>"),d.menuitems.A03_S19&&(n+="<li><a role='button'  id='history-btn'>历史版本</a></li>"),n+="</ul>"),n+="</div>"}}]})}),a.on("init.dt",function(){var t=$(".special-btn").parent();t.html('<a ng-click="addViews()" class="btn btn-default btn-sm"><i class="fa fa-plus"></i><span class="hidden-xs"> 新建流程</span></a>'),n(t)(d)}),a.on("click","#view-btn",function(t){t.preventDefault();var e=$(this).closest("tr"),a=r.row(e).data();location.href="../app-flowsheet/index.html#/displayView/"+a.id}),a.on("click","#design-btn",function(t){t.preventDefault();var e=$(this).closest("tr"),a=r.row(e).data();location.href="../app-flowsheet/index.html#/flow/"+a.id}),a.on("click","#copy-btn",function(t){t.preventDefault();var e=$(this).closest("tr"),a=r.row(e).data();d.doAction("view-copy",a)}),a.on("click","#edit-btn",function(t){t.preventDefault();var e=$(this).closest("tr"),a=r.row(e);d.addViews(a.data())}),a.on("click","#save-btn",function(t){t.preventDefault();var e=$(this).closest("tr"),a=r.row(e),n=a.data();if(2==n.isEdit||3==n.isEdit){var i=$(this).parents("tr").children(),s=!0;$.each(i,function(t,e){var a=$(e);if(0==t&&(0<a.children("input").length&&!(n=a.children("input").val())))return o.warning("视图名称不能空"),s=!1;if(0==t||1==t){var n=a.children("input").val();a.html(n),r.cell(a).data(n)}})}s&&d.doAction("view-save",n,function(t){t&&(!1,a.data().isEdit=0,a.cells().invalidate())})}),a.on("click","#cancel-btn",function(t){t.preventDefault();var e=$(this).closest("tr"),a=r.row(e);a.data();!1,a.data().isEdit=0,a.cells().invalidate()}),a.on("click","#del-btn",function(t){t.preventDefault();var e=$(this).closest("tr"),a=r.row(e);a.data().isDel=!0;var n=a.data();d.doAction("attr-delete",n,function(t){t&&a.remove().draw(!1)})}),a.on("click","#release-btn",function(t){t.preventDefault();var e=$(this).closest("tr"),a=r.row(e);a.data().isDel=!0;var n=a.data();d.doAction("release",n)}),a.on("click","#history-btn",function(t){t.preventDefault();var e=$(this).closest("tr"),a=r.row(e);a.data().isDel=!0;var n=a.data();d.doAction("history",n)})}]}}]),d.initDirective("processHistory",["$timeout","$compile","$filter","growl",function(t,e,n,a){return{restrict:"A",controller:["$scope","$element","$attrs",function(i,t,e){var s,a=t;i.$on("PROCESShistory",function(t,e){s&&(s.destroy(),a.empty()),!1,s=a.DataTable({dom:e.data&&0<e.data.length?$.ProudSmart.datatable.footerdom:"",language:$.ProudSmart.datatable.language,data:e.data,order:[[2,"desc"]],columns:[{data:"name",title:"视图名称"},{data:"desc",title:"描述"},{data:"createTime",title:"发布时间"},{data:"version",title:"版本号"},{data:"option",orderable:!1,title:"操作",width:"120px",visible:i.selectedDitem&&i.selectedDitem.canEdit}],columnDefs:[{targets:0,data:"name",render:function(t,e,a){return 2!=a.isEdit&&3!=a.isEdit||"display"!=e?escape(t):"<input style='width:100%' class='form-control input-sm' type='text' value='"+escape(t)+"'>"}},{targets:2,data:"createTime",render:function(t,e,a){return n("date")(t,"yyyy-MM-dd HH:mm:ss")}},{targets:3,data:"version",render:function(t,e,a){return t}},{targets:1,data:"desc",render:function(t,e,a){return 2!=a.isEdit&&3!=a.isEdit||"display"!=e?escape(t):"<input maxlength='20' style='width:100%' class='form-control input-sm' type='text' value='"+escape(t)+"'>"}},{targets:4,data:"option",render:function(t,e,a){var n="<div class='btn-group btn-group-sm'>";return i.menuitems.A09_S19&&(n+="<button id='look-btn'  class='btn btn-primary' ><i class='fa fa-edit hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 查看</span></button>"),i.menuitems.A10_S19&&(n+="<button id='del-btn'   class='btn btn-default' ><i class='fa fa-trash hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 删除</span></button>"),n+="</div>"}}]})}),a.on("click","#del-btn",function(t){t.preventDefault();var e=$(this).closest("tr"),a=s.row(e);a.data().isDel=!0;var n=a.data();i.doAction("history-delete",n)}),a.on("click","#look-btn",function(t){t.preventDefault();var e=$(this).closest("tr"),a=s.row(e);a.data().isDel=!0;var n=a.data();location.href="../app-flowsheet/index.html#/historyView/"+n.id})}]}}]),d.initDirective("processReleaseDom",["$timeout","$compile","$filter","growl",function(t,e,n,a){return{restrict:"A",controller:["$scope","$element","$attrs",function(i,t,e){var s,a=t;i.$on("PROCESS-RELEASE",function(t,e){s&&s.destroy(),!1,s=a.DataTable({dom:'<"row"<"col-sm-6"<"special-btn">><"col-sm-6"f>><"row"<"clo-sm-12">>t<"row"<"col-sm-2"i><"col-sm-2"l><"col-sm-8"p>>',language:d.datatable.language,data:e.data,columns:[{data:"name",title:"流程名称"},{data:"desc",title:"描述"},{data:"createTime",title:"创建时间"},{data:"version",title:"版本号"},{data:"option",orderable:!1,title:"操作",width:"120px",visible:i.selectedDitem&&i.selectedDitem.canEdit}],columnDefs:[{targets:0,data:"name",render:function(t,e,a){return escape(t)}},{targets:2,data:"createTime",render:function(t,e,a){return n("date")(t,"yyyy-MM-dd HH:mm:ss")}},{targets:1,data:"desc",render:function(t,e,a){return escape(t)}},{targets:4,data:"option",render:function(t,e,a){return'<div class="btn-group  btn-group-sm"><a id="del-btn" class="btn btn-default" ><i class="fa fa-close hidden-lg hidden-md hidden-sm"></i><span class="hidden-xs ng-binding">删除</span></a></div>'}}]})}),a.on("click","#del-btn",function(t){t.preventDefault();var e=$(this).closest("tr"),a=s.row(e);a.data().isDel=!0;var n=a.data();i.doAction("attr-delete",n,function(t){t&&a.remove().draw(!1)})})}]}}])});
//# sourceMappingURL=../../../map/app-oc/js/directives/process-dom.js.map
