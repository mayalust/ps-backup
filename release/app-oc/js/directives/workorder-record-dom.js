define(["directives/directives","bootstrap-dialog","datatables.net","datatables.net-bs","datatables.net-select"],function(t,a,e){t.initDirective("workOrderRecord",["$timeout","$compile",function(t,a){return{restrict:"A",controller:["$scope","$element","$attrs",function(n,t,a){var r,e=t,i="";n.$on(Event.WORKORDERRECORDINIT,function(t,a){r&&(r.destroy(),e.empty()),i=a.state,r=e.DataTable({dom:a.data&&0<a.data.length?$.ProudSmart.datatable.footerdom:"",language:$.ProudSmart.datatable.language,data:a.data,columns:a.columns,order:[6,"desc"],columnDefs:a.columnDefs})}),e.on("click","#process",function(t){var a=$(this).closest("tr"),e=r.row(a).data();location.href="../app-flowsheet/index.html#/processView/"+e.id}),e.on("click","#history",function(t){var a=$(this).closest("tr");r.row(a).data()}),e.on("click","td",function(t){t.preventDefault();var a=$(this).text(),e=$(this).closest("tr"),o=r.row(e).data();(n.menuitems.A03_S08||n.menuitems.A02_S09)&&-1==a.indexOf("执行历史")&&n.herfList(a,o,i)})}]}}]),t.initDirective("historyTable",["$timeout","$compile",function(t,a){return{restrict:"A",controller:["$scope","$element","$attrs",function(t,a,e){var o,n=a;t.$on(Event.WORKORDERRECORDINIT+"_history",function(t,a){o&&o.destroy(),!1,o=n.DataTable({dom:a.data&&0<a.data.length?$.ProudSmart.datatable.footerdom:"",language:$.ProudSmart.datatable.language,data:a.data,columns:a.columns,columnDefs:a.columnDefs})})}]}}]),t.initDirective("majorDeviceTable",["$timeout","$compile",function(t,o){return{restrict:"A",controller:["$scope","$element","$attrs",function(r,t,a){var i,e=t;r.$on(Event.WORKORDERRECORDINIT+"_deviceTask",function(t,a){i&&i.destroy(),!1,i=e.DataTable({dom:a.data&&0<a.data.length?$.ProudSmart.datatable.footerdom:"",language:$.ProudSmart.datatable.language,data:a.data,rowCallback:function(t,a,e){o(t)(r)},columns:[{title:"备件编号",data:"name",orderable:!1},{title:"备件名称",data:"label",orderable:!1},{title:"数量",data:"stockNumber",orderable:!1},{title:"操作",visible:200!=r.detail.taskStatus,data:"option",orderable:!1}],columnDefs:[{targets:0,data:"name",render:function(t,a,e){var o="";return 3==e.isEdit&&"display"==a?(o+='<select id="allSpare" name="allSpare" class="combobox form-control input-sm" ng-model="definitions.selectList" ng-change="saveAttachment(definitions.selectList);" ng-options="pro as pro.name for  pro in selectList.allSpareParts">',o+='<option value="">请选择...</option>',o+="</select>"):o="<a href='#sparepartInfo/"+e.id+"'>"+t+"</a>",o}},{targets:1,data:"label",render:function(t,a,e){return t}},{targets:2,data:"stockNumber",render:function(t,a,e){return 0<e.isEdit&&"display"==a?t:200!=r.detail.taskStatus?null!=r.sparePartsArray[e.id]?"<input class='form-control col-xs-6'  name='"+e.id+"' id='stockName' ng-model='sparePartsArray["+e.id+"].editNumber'  type='text'  maxlength='20'  value='"+t+"'  style='border: 1px solid #F18282;width: 100%;' placeholder='当前库存数量："+r.sparePartsArray[e.id].stockNumber+"'>":"<input class='form-control col-xs-6'  name='"+e.id+"' id='stockName' type='text'  maxlength='20'  style='border: 1px solid #F18282;width: 100%;' placeholder='当前库存数量："+t+"'>":t}},{targets:3,data:"option",render:function(t,a,e){var o="<div class='btn-group ' >";return 200!=r.detail.taskStatus&&3!=e.isEdit&&(o+="<a id='del-btn' ng-show='detail.taskStatus != 200' class='btn btn-default btn-sm' ><i class='fa fa-times hidden-lg hidden-md hidden-sm '></i><span class='hidden-xs'> 删除</span></a>"),o+="</div>"}}]})}),e.on("init.dt",function(){}),e.on("click","#save-btn",function(t){t.stopPropagation();var a=$(this).closest("tr"),e=(i.row(a).data(),r.selectList.allSpareParts),o=$("#allSpare option:selected").val();if(""!=o||null!=o)for(var n in e)if(e[n].id==o){r.saveAttachment(e[n]);break}}),e.on("click","#cancel-btn",function(t){t.stopPropagation(),!1;var a=$(this).closest("tr"),e=i.row(a);r.cancelAttach(e.data())}),e.on("click","#del-btn",function(t){t.stopPropagation(),!1;var a=$(this).closest("tr"),e=i.row(a);r.cancelAttach(e.data())})}]}}])});
//# sourceMappingURL=../../../map/app-oc/js/directives/workorder-record-dom.js.map
