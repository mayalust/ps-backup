{"version":3,"sources":["app-oc/js/controllers/dashboard-management-ctrl.js"],"names":["define","controllers","initController","scope","q","rootScope","$location","$routeParams","timeout","userRoleUIService","resourceUIService","userLoginUIService","Info","growl","userEnterpriseService","viewFlexService","userDomainService","window","freeboardservice","dialogue","ngDialog","charRoot","views","domainlist","domaintree","widget","config","allRoles","treeData","TEXT","viewType","viewId","createTree","data","hierarchy","self","this","all","viewTitle","children","root","loop","elem","viewHierarchy","addTo","target","parent","Object","defineProperty","enumerable","_children","push","find","el","i","editAlertView","view","namelist","filter","map","newTitle","$$","duplicateName","run","rootModel","stateToArr","arr","split","value","indexOf","replacer","alertOption","label","severities","getViewById_back","event","code","dt","domainPath","content","JSON","parse","console","log","dialog","title","input","type","maxlength","composory","events","change","item","error","right","undefined","key","mark","options","disabled","fontsize","width","modelIds","pageSize","minlength","test","toString","length","messageFilter","states","description","button","icon","disabledFn","some","fn","close","param","index","$attr","stringify","getData","updateView","addView","newView","createTime","updateTime","creatorName","success","domainID","deferred","defer","hasOwnProperty","then","domainObj","pushbefore","promise","queryDomainInfo","getViewById","open","template","className","checkAllLoaded","queryDomainTree","user","userID","getRootModel","getModels","Array","prototype","apply","duplicateClick","duplicateNameBase","fnlist","style","border-radius","font-size","font-weight","padding","getDomainId","finished","resourceType","projectId","templateStr","insertAfter","message","err","placeholder","onChange","element","releaseView","viewTitles","viewIds","releasedIds","callback","releaseViews","successObj","failObj","releaseGroup","releaseStatus","removeAllChecked","releaseClick","setComponentClick","values","component","params","sethomeClick","source","maindashboard","viewName","saveManageDashboard","homeview","deleteClickCommon","deleteView","remove","editViewInfo","$clone","addNewClick","location","href","deleteClick","designClick","modelId","gotoDashboard","keyValue","resourceId","editClick","available","call","lb","viewClick","encodeURIComponent","domain","format","name","id","str","deleteGroup","deleteViews","fail","itm","creator","_CONFIG_","dashboard","header","columnDefs","buttons","active","configure","designView","configAlert","nav","navClick","path","complete","getManagedViewsByTypeAndRole","defers","dataTable","projectIds","allviews","findRoleRes","resId","roleRes","roleId","bindRoles","roleID","roleName","resolve","projects","loopView","getModelByIds","rowclass","row","attr","at","OPTIONS","modes","default","init","attributesLoadDefer","modelObj","cacheAsyncData","loadResource","getAllDomainName","getResourceByIds","checkPowerCss","flg","css","menuitems","checkPowerVisible","bol","queryDomainTree_back","tree","rs","traverse","domainInfos","CREAT","class","margin","click","DESIGNVIEW","RELEASE","selected","DELETE","COMPONENT","filterable","sortable","TEMPLATE","SETHOME","VIEWTITLE","HIERARCHY","RESTYPE","DESCRIPTION","OWNER","filterFormat","RELEASESTATUS","CREATETIME","UPDATETIME","DOMAIN","BTN_DESIGN","BTN_EDIT","BTN_DELETE","visible","BTN_VIEW","BTN_DUPLICATE","BTN_RELEASE","BTN_HOME","queryEnterpriseUser","queryEnterpriseRole","bgColorFn","bgColor","background-color"],"mappings":"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","file":"app-oc/js/controllers/dashboard-management-ctrl.js","sourcesContent":["define(['controllers/controllers', 'Array'], function (controllers) {\n  'use strict';\n\n  controllers.initController('dashboardmanageCtrl', ['$scope', '$q', '$rootScope', '$location', '$routeParams', '$timeout', 'userRoleUIService', 'resourceUIService', 'userLoginUIService', 'Info', 'growl', 'userEnterpriseService', 'viewFlexService', 'userDomainService', \"$window\", \"freeboardservice\", 'dialogue', \"ngDialog\", function (scope, q, rootScope, $location, $routeParams, timeout, userRoleUIService, resourceUIService, userLoginUIService, Info, growl, userEnterpriseService, viewFlexService, userDomainService, window, freeboardservice, dialogue, ngDialog) {\n    var type, serviceView, charRoot, views, domainlist, domaintree, enterpriseUsers, widget, config, allRoles;\n    var treeData;\n    var TEXT = {\n      \"SUBMIT\": \"确定\",\n      \"CANCEL\": \"取消\"\n    };\n    var viewType = $routeParams.viewType;\n    scope.viewId = $routeParams.viewId;\n\n    var createTree = function createTree(data, hierarchy) {\n      var self = this;\n      var all = {\n        viewId: 0,\n        viewTitle: \"根层级\",\n        children: []\n      };\n      var root = {\n        children: [all]\n      };\n\n      var loop = function loop(elem) {\n        elem.viewHierarchy = elem.viewHierarchy ? elem.viewHierarchy : 0;\n\n        var addTo = function addTo() {};\n\n        var checkSelfViewId = function checkSelfViewId() {\n          if (self) {\n            return elem.viewId != self.viewId;\n          } else {\n            return true;\n          }\n        };\n\n        if (checkSelfViewId()) {\n          addTo = function addTo(target) {\n            elem.parent = target;\n            Object.defineProperty(elem, \"parent\", {\n              enumerable: false\n            });\n\n            if (!target.children) {\n              target.children = [];\n            }\n\n            target.children.push(elem);\n          };\n        } else {\n          addTo = function addTo(target) {\n            elem.parent = target;\n            Object.defineProperty(elem, \"parent\", {\n              enumerable: false\n            });\n\n            if (!target._children) {\n              target._children = [];\n            }\n\n            target._children.push(elem);\n          };\n        }\n\n        var find = data.find(function (el) {\n          return el.viewId == elem.viewHierarchy;\n        });\n\n        if (find) {\n          elem.parent = find;\n          addTo(find);\n        } else {\n          addTo(all);\n        }\n      };\n\n      for (var i in data) {\n        delete data[i].children;\n        delete data[i]._children;\n      }\n\n      for (var i in data) {\n        loop(data[i]);\n      }\n\n      return root;\n    };\n\n    var createlist = function createlist(tree) {\n      var rs = [];\n\n      var traverse = function traverse(data) {\n        rs.push(data);\n\n        if (data.hasOwnProperty(\"domainInfos\")) {\n          for (var i in data.domainInfos) {\n            traverse(data.domainInfos[i]);\n          }\n        }\n      };\n\n      traverse(tree);\n      return rs;\n    };\n\n    var editAlertView = function editAlertView(view) {\n      var namelist = views.filter(function (elem) {\n        if (view) {\n          return elem.viewTitle != view.viewTitle;\n        } else {\n          return true;\n        }\n      }).map(function (elem) {\n        return elem.viewTitle;\n      });\n      var newTitle = $$.duplicateName(\"创建告警组\", namelist);\n\n      var run = function run(domainlist, rootModel) {\n        var stateToArr = function stateToArr(target, data) {\n          if (data) {\n            var arr = data.split(\",\");\n\n            var loop = function loop(elem) {\n              elem.value = arr.indexOf(elem.replacer + \"\") > -1;\n            };\n\n            for (var i in target) {\n              loop(target[i]);\n            }\n          }\n\n          return target;\n        };\n\n        var getData = function getData(data) {\n          var param = {};\n\n          var loop = function loop(index, elem) {\n            var type = elem.type;\n            var value;\n\n            if (type == \"checkbox\") {\n              value = [];\n\n              for (var i in elem.options) {\n                if (elem.options[i].value) {\n                  value.push(elem.options[i].replacer);\n                }\n              }\n\n              value = value.toString();\n            } else {\n              value = elem.value;\n            }\n\n            param.$attr(elem.data, value);\n          };\n\n          for (var i in data) {\n            loop(i, data[i]);\n          }\n\n          param.content = JSON.stringify(param.content);\n          return param;\n        };\n\n        var alertOption = [{\n          label: \"新产生\",\n          replacer: 0\n        }, {\n          label: \"已确认\",\n          replacer: 5\n        }, {\n          label: \"处理中\",\n          replacer: 10\n        }, {\n          label: \"已解决\",\n          replacer: 20\n        }];\n        var severities = [{\n          label: \"警告\",\n          replacer: 1,\n          value: false\n        }, {\n          label: \"次要\",\n          replacer: 2,\n          value: false\n        }, {\n          label: \"重要\",\n          replacer: 3,\n          value: false\n        }, {\n          label: \"严重\",\n          replacer: 4,\n          value: false\n        }];\n\n        var getViewById_back = function getViewById_back(event) {\n          if (event.code == \"0\") {\n            var dt,\n                domainPath = null;\n\n            if (event.data) {\n              if (event.data.content != null) {\n                dt = JSON.parse(event.data.content);\n              } else {\n                dt = {};\n              }\n\n              domainPath = event.data.domainPath;\n            }\n\n            console.log(view);\n            scope.dialog = {\n              title: charRoot + \"信息\",\n              input: [{\n                \"label\": \"告警视图名称\",\n                \"value\": view ? view.viewTitle : newTitle,\n                \"data\": \"viewTitle\",\n                \"type\": \"input\",\n                \"maxlength\": 32,\n                \"composory\": true,\n                \"events\": {\n                  \"change\": function change(item) {\n                    if (namelist.indexOf(item.value) != -1) {\n                      item.error = \"告警视图以存在，请更换视图名称\";\n                      scope.dialog.input[0].right = false;\n                    } else if (item.value == \"\") {\n                      item.error = \"视图名称不可为空\";\n                      scope.dialog.input[0].right = false;\n                    } else {\n                      item.error = undefined;\n                      scope.dialog.input[0].right = true;\n                    }\n                  }\n                }\n              }, {\n                \"label\": \"管理域\",\n                \"value\": domainPath,\n                \"data\": \"domainPath\",\n                \"type\": \"tree\",\n                \"key\": \"domainPath\",\n                \"mark\": \"domainInfos\",\n                \"options\": domaintree,\n                \"composory\": true,\n                \"disabled\": view != undefined,\n                \"right\": domainPath ? true : false,\n                \"fontsize\": \"12px\",\n                \"width\": \"200px\",\n                \"events\": {\n                  \"change\": function change(item) {\n                    if (item) {\n                      scope.dialog.input[1].right = true;\n                    }\n\n                    ;\n                  }\n                }\n              }, {\n                \"label\": \"设备模板\",\n                \"value\": view ? dt.modelIds : null,\n                \"data\": \"content/modelIds\",\n                \"type\": \"multiple\",\n                \"options\": rootModel,\n                \"fontsize\": \"12px\",\n                \"width\": \"200px\"\n              }, {\n                \"value\": view ? dt.pageSize : 1000,\n                \"label\": \"取得告警数量\",\n                \"data\": \"content/pageSize\",\n                \"type\": \"number\",\n                \"maxlength\": 99999999,\n                \"minlength\": 0,\n                \"events\": {\n                  \"change\": function change(item) {\n                    var regExp = /^[0-9]*$/;\n\n                    if (item.value) {\n                      var test = regExp.test(item.value);\n\n                      if (item.value.toString().length > 8) {\n                        item.error = \"长度不能大于8位数\";\n                        scope.dialog.input[3].right = false;\n                      } else {\n                        if (test) {\n                          item.error = undefined;\n                          scope.dialog.input[3].right = true;\n                        } else {\n                          item.error = \"请输入整数\";\n                          scope.dialog.input[3].right = false;\n                        }\n                      }\n                    }\n                  }\n                }\n              }, {\n                \"label\": \"内容关键词\",\n                \"value\": view ? dt.messageFilter : \"\",\n                \"data\": \"content/messageFilter\",\n                \"maxlength\": 32,\n                \"type\": \"input\"\n              }, {\n                \"label\": \"告警状态\",\n                \"data\": \"content/states\",\n                \"type\": \"checkbox\",\n                \"options\": stateToArr(alertOption, view ? dt.states : \"\")\n              }, {\n                \"label\": \"告警级别\",\n                \"data\": \"content/severities\",\n                \"type\": \"checkbox\",\n                \"options\": stateToArr(severities, view ? dt.severities : \"\")\n              }, {\n                \"label\": \"视图描述\",\n                \"value\": view ? view.description : null,\n                \"data\": \"description\",\n                \"type\": \"textarea\",\n                \"maxlength\": 200,\n                \"composory\": false,\n                \"width\": \"200px\"\n              }],\n              button: [{\n                label: TEXT.SUBMIT,\n                icon: \"btn btn-primary\",\n                disabledFn: function disabledFn() {\n                  return scope.dialog.input.some(function (elem) {\n                    return elem.right == false;\n                  });\n                },\n                fn: function fn() {\n                  ngDialog.close();\n                  var param = getData(scope.dialog.input);\n                  var fn;\n                  param.viewType = viewType;\n\n                  if (view) {\n                    param.viewId = view.viewId;\n                    fn = viewFlexService.updateView;\n                  } else {\n                    fn = viewFlexService.addView;\n                  }\n\n                  fn(param, function (event) {\n                    if (event.code == \"0\") {\n                      var newView = event.data;\n\n                      if (view) {\n                        view.viewTitle = event.data.viewTitle;\n                        view.content = event.data.content;\n                        view.createTime = event.data.createTime;\n                        view.updateTime = event.data.updateTime;\n                        view.description = event.data.description;\n                        view.creatorName = event.data.creatorName;\n                        growl.success(\"告警视图修改成功\", {});\n                      } else {\n                        //views[views.length - 1].insertAfter(event.data);\n                        var arr = event.data.domainPath.split(\"/\");\n                        var domainID,\n                            deferred = q.defer();\n\n                        if (arr.length > 2) {\n                          domainID = arr[arr.length - 2];\n                        }\n\n                        ;\n\n                        if (!scope[domainID]) {\n                          scope[domainID] = deferred.promise;\n                          userDomainService.queryDomainInfo(domainID, function (event) {\n                            if (event.code == \"0\") {\n                              scope[domainID] = event.data;\n                              newView.domainObj = scope[domainID];\n                              views.pushbefore(newView);\n                              growl.success(\"创建告警视图成功\", {});\n                            }\n                          });\n                        } else {\n                          if (scope[domainID].hasOwnProperty(\"$$state\")) {\n                            scope[domainID].then(function () {\n                              newView.domainObj = scope[domainID];\n                              views.pushbefore(newView);\n                              growl.success(\"创建告警视图成功\", {});\n                            });\n                          } else {\n                            newView.domainObj = scope[domainID];\n                            views.pushbefore(newView);\n                            growl.success(\"创建告警视图成功\", {});\n                          }\n                        }\n\n                        ;\n                      }\n\n                      ;\n                    }\n                  });\n                }\n              }, {\n                label: TEXT.CANCEL,\n                icon: \"btn btn-default\",\n                fn: function fn() {\n                  ngDialog.close();\n                }\n              }]\n            };\n          }\n        };\n\n        if (view) {\n          viewFlexService.getViewById(view.viewId, getViewById_back);\n        } else {\n          getViewById_back({\n            code: 0,\n            data: null\n          });\n        }\n\n        ;\n        ngDialog.open({\n          template: '../partials/dialogue/config_alert_dia.html',\n          className: 'ngdialog-theme-plain',\n          scope: scope\n        });\n      };\n\n      var checkAllLoaded = function checkAllLoaded() {\n        if (window['domainlist'] == undefined) {\n          userDomainService.queryDomainTree(userLoginUIService.user.userID, function (event) {\n            if (event.code == 0) {\n              window['domainlist'] = event.data;\n              checkAllLoaded();\n            }\n          });\n        } else if (window['rootModel'] == undefined) {\n          var getRootModel_back = function getRootModel_back(event) {\n            if (event.code == 0) {\n              /** window['rootModel'] = [event.data] */\n              ;\n              window['rootModel'] = [];\n\n              var getModels_back = function getModels_back(event) {\n                Array.prototype.push.apply(window['rootModel'], event.data);\n                checkAllLoaded();\n              };\n\n              resourceUIService.getModels(getModels_back);\n            }\n          };\n\n          resourceUIService.getRootModel(getRootModel_back);\n        } else {\n          run(window['domainlist'], window['rootModel']);\n        }\n      };\n\n      checkAllLoaded();\n      ngDialog.close();\n    };\n\n    var dashboard_run = function dashboard_run(callback) {\n      /**\n      var path = \"../localdb/freeboard.json\";\n      var standardDashboard, machineDashboard;\n      var Info_back = function(info){\n        standardDashboard = info.standardDashboard;\n        machineDashboard = info.machineDashboard;\n        var getManageDashboard_back = function(event){\n          if(event.code == 0) {\n            if(event.data != null) {\n              if(typeof event.data.content) {\n                var dat = JSON.parse(event.data.content);\n                var dashboardView = event.data;\n                dashboardView.JSON = dat;\n                if(event.data.viewType == \"dashboard\") {\n                  if(checkVersion(dat) == \"version1_machine\") {\n                    scope.maindashboard = machineDashboard;\n                  } else if(checkVersion(dat) == \"version1_standard\") {\n                    scope.maindashboard = standardDashboard;\n                  } else {\n                    scope.maindashboard = dashboardView.JSON;\n                  }\n                } else {\n                  scope.maindashboard = standardDashboard;\n                }\n              }\n            } else {\n              scope.maindashboard = standardDashboard;\n            }\n            callback();\n          }\n        };\n        viewFlexService.getManageDashboard(getManageDashboard_back)\n      };\n      Info.get(path, Info_back);\n       */\n      callback();\n    };\n\n    var configure_run = function configure_run(callback) {\n      callback();\n    };\n\n    var configAlert_run = function configAlert_run(callback) {\n      callback();\n    };\n\n    var designView_run = function designView_run(callback) {\n      callback();\n    };\n\n    var deleteGroup_common = function deleteGroup_common(event) {\n      var self = event;\n      var filter = event.filter(function (elem) {\n        return elem.creator == userLoginUIService.user.userID;\n      });\n      var viewIds = filter.map(function (elem) {\n        return elem.viewId;\n      });\n      var viewTitles = filter.map(function (elem) {\n        return elem.viewTitle;\n      });\n      var fnlist = [{\n        label: TEXT.SUBMIT,\n        icon: 'btn btn-success',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        fn: function fn() {\n          ngDialog.close();\n          viewFlexService.deleteViews(viewIds, function (event) {\n            if (event.code == 0) {\n              var success = event.$attr(\"data/successObj\");\n              var fail = event.$attr(\"data/failObj\");\n              growl.success(charRoot + \"删除成功\" + success.length + \"个,失败\" + (self.length - success.length) + \"个\", {});\n\n              var loop = function loop(itm) {\n                if (success.indexOf(itm.viewId) != -1) {\n                  itm.remove();\n                }\n              };\n\n              for (var i in self) {\n                loop(self[i]);\n              }\n\n              ;\n            }\n          });\n        }\n      }, {\n        label: TEXT.CANCEL,\n        icon: 'btn btn-default',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        fn: function fn() {\n          ngDialog.close();\n        }\n      }];\n      scope.dialog = {\n        title: {\n          label: '提示'\n        },\n        description: {\n          label: '确认要删除此' + charRoot + '吗？'\n        },\n        fnlist: fnlist\n      };\n      ngDialog.open({\n        template: '../partials/dialogue/common_dia_prompt.html',\n        className: 'ngdialog-theme-plain',\n        scope: scope\n      });\n    };\n\n    var deleteGroup_configure = function deleteGroup_configure(event) {\n      var self = event;\n      var viewIds = event.map(function (elem) {\n        return elem.viewId;\n      });\n      var viewTitles = event.map(function (elem) {\n        return elem.viewTitle;\n      });\n      var fnlist = [{\n        label: TEXT.SUBMIT,\n        icon: 'btn btn-success',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        fn: function fn() {\n          ngDialog.close();\n          viewFlexService.deleteViews(viewIds, function (event) {\n            if (event.code == 0) {\n              var success = event.$attr(\"data/successObj\");\n              var fail = event.$attr(\"data/failObj\");\n              growl.success(charRoot + \"删除成功\" + success.length + \"个,失败\" + fail.length + \"个\", {});\n\n              var loop = function loop(view) {\n                var lp = function lp(viewId) {\n                  if (view.viewHierarchy == viewId) {\n                    view.viewHierarchy = 0;\n                    viewFlexService.updateView(view, function (event) {\n                      growl.success(charRoot + \" [ \" + event.data.viewTitle + \" ] 的父节点被放回根节点。\", {});\n                    });\n                  }\n                };\n\n                for (var i in success) {\n                  lp(success[i]);\n                }\n              };\n\n              for (var i in views) {\n                loop(views[i]);\n              }\n\n              createTree(views); // growl.success(charRoot + \"删除成功\", {});\n\n              var loopCur = function loopCur(itm) {\n                if (success.indexOf(itm.viewId) != -1) {\n                  itm.remove();\n                }\n              };\n\n              for (var i in self) {\n                loopCur(self[i]);\n              }\n\n              ;\n            }\n          });\n        }\n      }, {\n        label: TEXT.CANCEL,\n        icon: 'btn btn-default',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        fn: function fn() {\n          ngDialog.close();\n        }\n      }];\n      scope.dialog = {\n        title: {\n          label: '提示'\n        },\n        description: {\n          label: '该视图下的子节点将会被移动到根节点下，确认删除？'\n        },\n        fnlist: fnlist\n      };\n      ngDialog.open({\n        template: '../partials/dialogue/common_dia_prompt.html',\n        className: 'ngdialog-theme-plain',\n        scope: scope\n      });\n    };\n\n    var duplicateClick = function duplicateClick(event) {\n      var self = event;\n      var duplicateNameBase = event.viewTitle;\n      var content = event.content;\n      var namelist = views.map(function (elem) {\n        return elem.viewTitle;\n      });\n      var duplicateName = $$.duplicateName(duplicateNameBase, namelist);\n      var fnlist = [{\n        label: '创建',\n        icon: 'btn btn-primary',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        fn: function fn(event) {\n          var viewTitle = event.input[0].value;\n          var viewId = self.viewId;\n\n          var getViewById_back = function getViewById_back(event) {\n            if (event.code == 0) {\n              var param = event.data;\n              param.viewTitle = viewTitle;\n              delete param.viewId;\n              delete param.updateTime;\n              viewFlexService.addView(param, function (event) {\n                if (event.code == 0) {\n                  growl.success(\"复制视图成功\", {});\n                  var item = event.data;\n\n                  var getDomainId = function getDomainId(domainPath) {\n                    var arr = domainPath.split(\"/\");\n\n                    if (arr.length > 2) {\n                      return arr[arr.length - 2];\n                    }\n                  };\n\n                  var domainID = getDomainId(item.domainPath);\n\n                  var finished = function finished() {\n                    if (item.template) {\n                      if (item.template.resourceType == \"project\") {\n                        if (item.template.projectId) {\n                          if (scope[\"allprojects\"]) {\n                            item.templateStr = scope[\"allprojects\"][item.template.projectId].label;\n                          }\n                        }\n                      }\n                    } else {\n                      item.templateStr = \"普通\";\n                    }\n\n                    item.domainObj = scope[domainID];\n                    self.insertAfter(item);\n                    createTree(views);\n                    ngDialog.close();\n                  };\n\n                  if (scope[domainID]) {\n                    finished();\n                  } else {\n                    userDomainService.queryDomainInfo(domainID, function (event) {\n                      if (event.code == \"0\") {\n                        finished();\n                      }\n                    });\n                  }\n\n                  ;\n                }\n              });\n            } else {\n              growl.error(event.message);\n            }\n          };\n\n          var error = function error(err) {\n            growl.error(err);\n          };\n\n          viewFlexService.getViewById(viewId, getViewById_back, error);\n        }\n      }, {\n        label: '取消',\n        icon: 'btn btn-default',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        fn: function fn() {\n          ngDialog.close();\n        }\n      }];\n      scope.dialog = {\n        title: {\n          label: '复制视图'\n        },\n        input: [{\n          value: duplicateName,\n          label: '新视图名称',\n          placeholder: '新视图名称',\n          maxlength: 32,\n          onChange: function onChange(event) {\n            var value = this.value;\n            var find = views.find(function (element) {\n              return element.viewTitle == value;\n            });\n\n            if (find) {\n              event.error = \"此视图名已被占用，请更换.\";\n              fnlist[0].disabled = true;\n            } else {\n              if (value == \"\") {\n                event.error = \"视图名称不可为空.\";\n                fnlist[0].disabled = true;\n              } else {\n                event.error = null;\n                fnlist[0].disabled = false;\n              }\n            }\n          }\n        }],\n        fnlist: fnlist\n      };\n      ngDialog.open({\n        template: '../partials/dialogue/common_dia.html',\n        className: 'ngdialog-theme-plain',\n        scope: scope\n      });\n    };\n\n    var releaseView = function releaseView(viewTitles, viewIds, releasedIds, callback) {\n      var fnlist = [{\n        label: TEXT.SUBMIT,\n        icon: 'btn btn-success',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        fn: function fn() {\n          dialogue.close();\n          viewFlexService.releaseViews(viewIds, function (event) {\n            if (event.code == 0) {\n              if (viewIds.length == 1) {\n                growl.success(\"发布\" + charRoot + \"成功\", {});\n              } else {\n                growl.success(\"发布\" + charRoot + \",成功\" + event.data.successObj.length + \"个,失败\" + event.data.failObj.length + \"个\", {});\n              }\n\n              callback(event.data.successObj);\n            }\n          });\n        }\n      }, {\n        label: TEXT.CANCEL,\n        icon: 'btn btn-default',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        fn: function fn() {\n          dialogue.close();\n        }\n      }];\n      dialogue.open({\n        title: {\n          label: '提示'\n        },\n        description: {\n          label: '确认要发布' + charRoot + '吗？'\n        },\n        fnlist: fnlist\n      });\n    };\n\n    var releaseGroup = function releaseGroup(event) {\n      var self = event;\n      var viewIds = event.filter(function (elem) {\n        return elem.releaseStatus == 0;\n      }).map(function (elem) {\n        return elem.viewId;\n      });\n      var releasedIds = event.filter(function (elem) {\n        return elem.releaseStatus == 1;\n      }).map(function (elem) {\n        return elem.viewId;\n      });\n      var viewTitles = event.map(function (elem) {\n        return elem.viewTitle;\n      });\n      releaseView(viewTitles, viewIds, releasedIds, function (data) {\n        for (var i in self) {\n          self[i].releaseStatus = 1;\n        }\n\n        views.removeAllChecked(); //console.log(\"viewTitle\", data);\n      });\n    };\n\n    var releaseClick = function releaseClick(event) {\n      var self = event;\n      var viewId = event.viewId;\n      var viewTitle = event.viewTitle;\n      releaseView([viewTitle], [viewId], event.viewType, function (data) {\n        //console.log(\"viewTitle\", data);\n        self.releaseStatus = 1;\n      });\n    };\n\n    var addNew_config = function addNew_config(event) {\n      location.href = \"../app-configure/index.html#/configure/\" + 0;\n    };\n\n    var configure_edit = function configure_edit(event) {\n      var self = event;\n      var fnlist = [{\n        label: TEXT.SUBMIT,\n        icon: 'btn btn-primary',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        fn: function fn(event) {\n          var viewHierarchy = event.input[1].value;\n          var description = event.input[2].value;\n          description = description ? description : \"\";\n          var param = {\n            viewType: \"configure\",\n            viewId: self.viewId,\n            viewTitle: event.input[0].value,\n            viewHierarchy: viewHierarchy,\n            description: description\n          };\n          viewFlexService.updateView(param, function (event) {\n            if (event.code == 0) {\n              growl.success(\"组态视图修改成功\", {});\n              ngDialog.close();\n              self.viewTitle = event.data.viewTitle;\n              self.description = event.data.description;\n              self.viewHierarchy = viewHierarchy;\n              self.createTime = event.data.createTime;\n              self.updateTime = event.data.updateTime;\n              createTree(views);\n            }\n          });\n        }\n      }, {\n        label: TEXT.CANCEL,\n        icon: 'btn btn-default',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        fn: function fn() {\n          ngDialog.close();\n        }\n      }];\n      var viewHierarchy = event.viewHierarchy ? event.viewHierarchy : 0;\n      var available = createTree.call(self, views, self.viewHierarchy);\n      scope.dialog = {\n        title: {\n          label: charRoot + '信息'\n        },\n        input: [{\n          value: event.viewTitle,\n          composory: true,\n          type: \"input\",\n          label: '组态视图名称',\n          placeholder: '组态视图名称',\n          maxlength: 32,\n          onChange: function onChange(event) {\n            var value = this.value;\n            var find = views.find(function (element) {\n              return element.viewTitle == value && element.viewTitle != event.viewTitle;\n            });\n\n            if (find) {\n              event.error = \"此视图名已被占用，请更换.\";\n              fnlist[0].disabled = true;\n            } else {\n              if (value == \"\") {\n                event.error = \"视图名称不可为空.\";\n                fnlist[0].disabled = true;\n              } else {\n                event.error = null;\n                fnlist[0].disabled = false;\n              }\n            }\n          }\n        }, {\n          value: viewHierarchy,\n          type: \"tree\",\n          lb: \"viewTitle\",\n          fontsize: \"12px\",\n          width: \"200px\",\n          key: \"viewId\",\n          mark: \"children\",\n          composory: false,\n          label: '选择父级视图',\n          placeholder: '层级结构，例如 0/1',\n          options: available\n        }, {\n          value: event.description,\n          type: \"textarea\",\n          maxlength: 200,\n          composory: false,\n          label: '描述信息',\n          placeholder: '描述信息'\n        }],\n        fnlist: fnlist\n      };\n      ngDialog.open({\n        template: '../partials/dialogue/common_dia.html',\n        className: 'ngdialog-theme-plain',\n        scope: scope\n      });\n    };\n\n    var setComponentClick = function setComponentClick(event, value) {\n      var values = value ? {\n        component: true\n      } : {\n        component: false\n      };\n      var params = {\n        viewId: event.viewId,\n        values: values\n      };\n      viewFlexService.updateView(params, function (event) {\n        if (event.code == \"0\") {\n          growl.success(\"修改成功\");\n        }\n      });\n    };\n\n    var sethomeClick = function sethomeClick(event, source) {\n      var self = event;\n      scope.maindashboard = event;\n      var content = JSON.parse(event.content);\n      var viewTitle = event.viewTitle;\n      content.viewId = event.viewId;\n      var param = {\n        viewTitle: 'dashboard',\n        viewName: 'dashboard',\n        viewType: \"dashboard\",\n        content: JSON.stringify(content)\n      };\n      viewFlexService.saveManageDashboard(param, function (event) {\n        if (event.code == 0) {\n          if (event.data != null) {\n            growl.success(\"设定[\" + viewTitle + \"]为运营首页\", {});\n            scope.maindashboard = JSON.parse(event.data.content);\n\n            for (var i in source) {\n              source[i].homeview = false;\n            }\n\n            self.homeview = true;\n          } else {\n            growl.error(\"错误:运营首页保存失败\", {});\n          }\n        } else {\n          growl.error(\"错误:\" + event.message, {});\n        }\n      });\n    };\n\n    var deleteClickCommon = function deleteClickCommon(event) {\n      var self = event;\n      var viewId = event.viewId;\n      var viewTitle = event.viewTitle;\n      var fnlist = [{\n        label: TEXT.SUBMIT,\n        icon: 'btn btn-success',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        fn: function fn() {\n          ngDialog.close();\n          viewFlexService.deleteView(viewId, function (event) {\n            if (event.code == 0) {\n              growl.success(charRoot + \"删除成功\", {});\n              self.remove();\n            }\n          });\n        }\n      }, {\n        label: TEXT.CANCEL,\n        icon: 'btn btn-default',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        fn: function fn() {\n          ngDialog.close();\n        }\n      }];\n      scope.dialog = {\n        title: {\n          label: '提示'\n        },\n        description: {\n          label: '确认要删除' + charRoot + '吗？'\n        },\n        fnlist: fnlist\n      };\n      ngDialog.open({\n        template: '../partials/dialogue/common_dia_prompt.html',\n        className: 'ngdialog-theme-plain',\n        scope: scope\n      });\n    };\n\n    var deleteClickConfigure = function deleteClickConfigure(event) {\n      var self = event;\n      var viewId = event.viewId;\n      var viewTitle = event.viewTitle;\n      var fnlist = [{\n        label: TEXT.SUBMIT,\n        icon: 'btn btn-primary',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        fn: function fn() {\n          dialogue.close();\n          viewFlexService.deleteView([viewId], function (event) {\n            if (event.code == 0) {\n              var loop = function loop(view) {\n                if (view.viewHierarchy == viewId) {\n                  view.viewHierarchy = 0;\n                  viewFlexService.updateView(view, function (event) {\n                    growl.success(charRoot + \" [ \" + event.data.viewTitle + \" ] 的父节点被放回根节点。\", {});\n                  });\n                }\n              };\n\n              for (var i in views) {\n                loop(views[i]);\n              }\n\n              createTree(views);\n              growl.success(charRoot + \"删除成功\", {});\n              self.remove();\n            }\n          });\n        }\n      }, {\n        label: TEXT.CANCEL,\n        icon: 'btn btn-default',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        fn: function fn() {\n          dialogue.close();\n        }\n      }];\n      dialogue.open({\n        title: {\n          label: '提示'\n        },\n        description: {\n          label: '该视图下的子节点将会被移动到根节点下，确认删除？'\n        },\n        fnlist: fnlist\n      });\n    };\n\n    var editViewInfo = function editViewInfo(event) {\n      var self = event;\n      var fnlist = [{\n        label: TEXT.SUBMIT,\n        icon: 'btn btn-primary',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        disabledFn: function disabledFn() {\n          return this.disabled;\n        },\n        fn: function fn(event) {\n          ngDialog.close();\n          var view = self.$clone();\n          view.viewTitle = scope.dialog.input[0].value;\n          view.description = scope.dialog.input[1].value;\n          viewFlexService.updateView(view, function (event) {\n            if (event.code == \"0\") {\n              self.viewTitle = event.data.viewTitle;\n              self.description = event.data.description;\n              self.updateTime = event.data.updateTime;\n              growl.success(charRoot + \"修改成功\");\n            }\n          });\n        }\n      }, {\n        label: TEXT.CANCEL,\n        icon: 'btn btn-default',\n        style: {\n          width: '50%',\n          'border-radius': 0,\n          'font-size': '18px',\n          'font-weight': 'bold',\n          'padding': 10\n        },\n        fn: function fn() {\n          ngDialog.close();\n        }\n      }];\n      scope.dialog = {\n        title: {\n          label: charRoot + '信息'\n        },\n        input: [{\n          value: event.viewTitle,\n          composory: true,\n          type: \"input\",\n          label: charRoot + '名称',\n          placeholder: charRoot + '名称',\n          maxlength: 32,\n          onChange: function onChange(event) {\n            var value = this.value;\n            var namelist = views.filter(function (elem) {\n              return elem.viewId != self.viewId;\n            }).map(function (elem) {\n              return elem.viewTitle;\n            });\n\n            if (namelist.indexOf(value) != -1) {\n              event.error = \"此视图名已被占用，请更换.\";\n              fnlist[0].disabled = true;\n            } else {\n              if (value == \"\") {\n                event.error = \"视图名称不可为空.\";\n                fnlist[0].disabled = true;\n              } else {\n                event.error = null;\n                fnlist[0].disabled = false;\n              }\n            }\n          }\n        }, {\n          value: event.description,\n          type: \"textarea\",\n          maxlength: 200,\n          composory: false,\n          label: '描述信息',\n          placeholder: '新视图名称'\n        }],\n        fnlist: fnlist\n      };\n      ngDialog.open({\n        template: '../partials/dialogue/common_dia.html',\n        className: 'ngdialog-theme-plain',\n        scope: scope\n      });\n    };\n\n    var viewConfigAlert = function viewConfigAlert(view) {\n      var run = function run() {\n        if (view) {\n          var stateToArr = function stateToArr(target, data) {\n            var arr = data.split(\",\");\n\n            var loop = function loop(elem) {\n              elem.value = arr.indexOf(elem.replacer + \"\") > -1;\n            };\n\n            for (var i in target) {\n              loop(target[i]);\n            }\n\n            return target;\n          };\n\n          var getData = function getData(data) {\n            var param = {};\n\n            var loop = function loop(index, elem) {\n              var type = elem.type;\n              var value;\n\n              if (type == \"checkbox\") {\n                value = [];\n\n                for (var i in elem.options) {\n                  if (elem.options[i].value) {\n                    value.push(elem.options[i].replacer);\n                  }\n                }\n\n                value = value.toString();\n              } else {\n                value = elem.value;\n              }\n\n              param.$attr(elem.data, value);\n            };\n\n            for (var i in data) {\n              loop(i, data[i]);\n            }\n\n            param.content = JSON.stringify(param.content);\n            return param;\n          };\n\n          var alertOption = [{\n            label: \"新产生\",\n            replacer: 0\n          }, {\n            label: \"已确认\",\n            replacer: 5\n          }, {\n            label: \"处理中\",\n            replacer: 10\n          }, {\n            label: \"已解决\",\n            replacer: 20\n          }];\n          var severities = [{\n            label: \"警告\",\n            replacer: 1,\n            value: false\n          }, {\n            label: \"次要\",\n            replacer: 2,\n            value: false\n          }, {\n            label: \"重要\",\n            replacer: 3,\n            value: false\n          }, {\n            label: \"严重\",\n            replacer: 4,\n            value: false\n          }];\n\n          var getViewById_back = function getViewById_back(event) {\n            if (event.code == \"0\") {\n              var dt = JSON.parse(event.data.content);\n              scope.dialog = {\n                title: charRoot + \"信息\",\n                input: [{\n                  \"label\": \"告警组名称\",\n                  \"value\": view ? view.viewTitle : newTitle,\n                  \"data\": \"viewTitle\",\n                  \"type\": \"text\"\n                }, {\n                  \"label\": \"视图描述\",\n                  \"value\": view ? view.description : \"\",\n                  \"data\": \"viewTitle\",\n                  \"type\": \"text\"\n                }, {\n                  \"label\": \"管理域\",\n                  \"value\": view ? dt.domain : null,\n                  \"data\": \"content/domain\",\n                  \"type\": \"text\",\n                  \"format\": function format(value) {\n                    var find = domainlist.find(function (elem) {\n                      return elem.domainPath == view.domainPath;\n                    });\n                    return find ? find.name : \"-\";\n                  }\n                }, {\n                  \"label\": \"设备模板\",\n                  \"value\": view ? dt.modelIds : null,\n                  \"data\": \"content/modelIds\",\n                  \"type\": \"text\",\n                  \"format\": function format(value) {\n                    var filter = rootModel.filter(function (elem) {\n                      return dt.modelIds.indexOf(elem.id) != -1;\n                    }).map(function (elem) {\n                      return elem.label;\n                    });\n                    return filter.toString();\n                  }\n                }, {\n                  \"value\": view ? dt.pageSize : 1000,\n                  \"label\": \"取得告警数量\",\n                  \"data\": \"content/pageSize\",\n                  \"type\": \"number\"\n                }, {\n                  \"label\": \"内容关键词\",\n                  \"value\": view ? dt.messageFilter : \"\",\n                  \"data\": \"content/messageFilter\",\n                  \"type\": \"text\",\n                  \"format\": function format(value) {\n                    return value ? value : \"-\";\n                  }\n                }, {\n                  \"label\": \"告警状态\",\n                  \"value\": stateToArr(alertOption, view ? dt.states : \"\"),\n                  \"data\": \"content/states\",\n                  \"type\": \"text\",\n                  \"format\": function format() {\n                    var str = this.value.filter(function (elem) {\n                      return elem.value == true;\n                    }).map(function (elem) {\n                      return elem.label;\n                    });\n                    return str.length > 0 ? str.toString() : \"-\";\n                  }\n                }, {\n                  \"label\": \"告警级别\",\n                  \"value\": stateToArr(severities, view ? dt.severities : \"\"),\n                  \"data\": \"content/severities\",\n                  \"type\": \"text\",\n                  \"format\": function format() {\n                    var str = this.value.filter(function (elem) {\n                      return elem.value == true;\n                    }).map(function (elem) {\n                      return elem.label;\n                    });\n                    return str.length > 0 ? str.toString() : \"-\";\n                  }\n                }],\n                button: [{\n                  label: \"返回\",\n                  icon: \"btn btn-primary\",\n                  fn: function fn() {\n                    ngDialog.close();\n                  }\n                }]\n              };\n            }\n          };\n\n          viewFlexService.getViewById(view.viewId, getViewById_back);\n        }\n      };\n\n      var checkAllLoaded = function checkAllLoaded() {\n        if (window['domainlist'] == undefined) {\n          userDomainService.queryDomainTree(userLoginUIService.user.userID, function (event) {\n            if (event.code == 0) {\n              window['domainlist'] = event.data;\n              checkAllLoaded();\n            }\n          });\n        } else if (window['rootModel'] == undefined) {\n          var getRootModel_back = function getRootModel_back(event) {\n            if (event.code == 0) {\n              /** window['rootModel'] = [event.data]*/\n              ;\n              window['rootModel'] = [];\n\n              var getModels_back = function getModels_back(event) {\n                Array.prototype.push.apply(window['rootModel'], event.data);\n                checkAllLoaded();\n              };\n\n              resourceUIService.getModels(getModels_back);\n            }\n          };\n\n          resourceUIService.getRootModel(getRootModel_back);\n        } else {\n          run(window['domainlist'], window['rootModel']);\n        }\n      };\n\n      checkAllLoaded();\n      ngDialog.open({\n        template: '../partials/dialogue/config_alert_dia.html',\n        className: 'ngdialog-theme-plain',\n        scope: scope\n      });\n    };\n\n    var addNewClick = function (viewType) {\n      if (viewType == 'dashboard') {\n        return function () {\n          window.open(\"../app-freeboard/index.html#/freeboard/view/dashboard\", \"_blank\");\n        };\n      } else if (viewType == 'configAlert') {\n        return function () {\n          editAlertView();\n        };\n      } else if (viewType == 'configure') {\n        return addNew_config;\n      } else if (viewType == 'designView') {\n        return function () {\n          window.open(\"../app-freeboard/index.html#/editor/view/editor\", \"_blank\");\n        };\n      }\n    }(viewType);\n\n    var deleteClick = function (viewType) {\n      if (viewType == 'dashboard') {\n        return deleteClickCommon;\n      } else if (viewType == 'configAlert') {\n        return deleteClickCommon;\n      } else if (viewType == 'configure') {\n        return deleteClickConfigure;\n      } else if (viewType == 'designView') {\n        return deleteClickCommon;\n      }\n    }(viewType);\n\n    var designClick = function (viewType) {\n      if (viewType == 'dashboard') {\n        return function (event) {\n          var template = event.template;\n\n          var gotoDashboard = function gotoDashboard() {\n            window.open(\"../app-freeboard/index.html#/freeboard/view/dashboard/\" + event.viewId + \"/0\", \"_blank\");\n            /**\n            if(event.viewId == scope.maindashboard.viewId) {\n              window.location.href = \"../app-freeboard/index.html#/freeboard/view/dashboard/\" + event.viewId + \"/1\";\n            } else {\n             }\n             */\n          };\n\n          var gotoTemplate = function gotoTemplate(modelId) {\n            var params = {\n              modelId: modelId\n            };\n            window.open(\"../app-freeboard/index.html#/template/model/dashboard/\" + JSON.stringify(params), \"_blank\");\n          };\n\n          if (template) {\n            if (template.keyValue == \"default\") {\n              gotoTemplate(template.resourceId);\n            } else {\n              gotoDashboard();\n            }\n          } else {\n            gotoDashboard();\n          } //window.location.href = \"../app-freeboard/index.html#/freeboard/view/dashboard/\" + event.viewId + \"/0\";\n\n          /**\n          if(event.viewId == scope.maindashboard.viewId) {\n            window.location.href = \"../app-freeboard/index.html#/freeboard/view/dashboard/\" + event.viewId + \"/1\";\n          } else {\n            window.location.href = \"../app-freeboard/index.html#/freeboard/view/dashboard/\" + event.viewId + \"/0\";\n          }\n           */\n\n        };\n      } else if (viewType == 'configAlert') {\n        return editAlertView;\n      } else if (viewType == 'configure') {\n        return function (event) {\n          window.open(\"../app-configure/index.html#/configure/\" + event.viewId, \"_blank\");\n        };\n      } else if (viewType == 'designView') {\n        return function (event) {\n          window.open(\"../app-freeboard/index.html#/editor/view/editor/\" + event.viewId, \"_blank\");\n        };\n      }\n    }(viewType);\n\n    var editClick = function (viewType) {\n      if (viewType == 'dashboard') {\n        return editViewInfo;\n      } else if (viewType == 'configAlert') {\n        return editAlertView;\n      } else if (viewType == 'configure') {\n        return configure_edit;\n      } else if (viewType == 'designView') {\n        return editViewInfo;\n      }\n    }(viewType);\n\n    var viewClick = function (viewType) {\n      if (viewType == 'dashboard') {\n        return function (event) {\n          window.open(\"../app-free-style/index.html#/\" + event.viewId);\n        };\n      } else if (viewType == 'configure') {\n        return function (event) {\n          var param = [{\n            viewId: event.viewId\n          }];\n          window.open('../app-free-style/index.html#/topoview/index/' + encodeURIComponent(JSON.stringify(param)), '_blank');\n        };\n      } else if (viewType == 'designView') {\n        return function (event) {\n          window.open(\"../app-free-style/index.html#/\" + event.viewId);\n        };\n      } else if (viewType == 'configAlert') {\n        return viewConfigAlert;\n      }\n    }(viewType);\n\n    var deleteGroup = function (viewType) {\n      if (viewType == 'configure') {\n        return deleteGroup_configure;\n      } else {\n        return deleteGroup_common;\n      }\n    }(viewType);\n\n    var _CONFIG_ = {\n      dashboard: {\n        label: \"仪表板视图\",\n        viewType: \"dashboard\",\n        charRoot: \"仪表板视图\",\n        header: ['CREAT', 'RELEASE', 'DELETE'],\n        columnDefs: ['VIEWTITLE', 'OWNER', 'RESTYPE', 'RELEASESTATUS', 'COMPONENT', 'CREATETIME', 'UPDATETIME', 'DOMAIN', 'OPTIONS'],\n        buttons: ['BTN_DESIGN', 'BTN_EDIT', 'BTN_DELETE', 'BTN_DUPLICATE', 'BTN_RELEASE', 'BTN_VIEW'],\n        active: viewType == 'dashboard',\n        run: dashboard_run\n      },\n      configure: {\n        label: \"组态视图\",\n        charRoot: \"组态视图\",\n        viewType: \"configure\",\n        header: ['CREAT', 'RELEASE', 'DELETE'],\n        columnDefs: ['VIEWTITLE', 'DESCRIPTION', 'OWNER', 'RESTYPE', 'RELEASESTATUS', 'HIERARCHY', 'CREATETIME', 'UPDATETIME', 'DOMAIN', 'OPTIONS'],\n        buttons: ['BTN_DESIGN', 'BTN_EDIT', 'BTN_DELETE', 'BTN_DUPLICATE', 'BTN_RELEASE', 'BTN_VIEW'],\n        active: viewType == 'configure',\n        run: configure_run\n      },\n      designView: {\n        label: \"分析视图\",\n        charRoot: \"分析视图\",\n        viewType: \"designView\",\n        active: viewType == 'designView',\n        header: ['CREAT', 'RELEASE', 'DELETE'],\n        columnDefs: ['VIEWTITLE', 'DESCRIPTION', 'OWNER', 'RELEASESTATUS', 'CREATETIME', 'UPDATETIME', 'DOMAIN', 'OPTIONS'],\n        buttons: ['BTN_DESIGN', 'BTN_EDIT', 'BTN_DELETE', 'BTN_DUPLICATE', 'BTN_RELEASE', 'BTN_VIEW'],\n        run: designView_run\n      },\n      configAlert: {\n        label: \"告警视图\",\n        charRoot: \"告警视图\",\n        viewType: \"configAlert\",\n        header: ['CREAT', 'RELEASE', 'DELETE'],\n        columnDefs: ['VIEWTITLE', 'DESCRIPTION', 'OWNER', 'RELEASESTATUS', 'CREATETIME', 'UPDATETIME', 'DOMAIN', 'OPTIONS'],\n        buttons: ['BTN_DESIGN', 'BTN_DELETE', 'BTN_DUPLICATE', 'BTN_RELEASE'],\n        active: viewType == 'configAlert',\n        run: configAlert_run\n      }\n    };\n\n    var previewGraph = function previewGraph(viewId) {//window.open(\"../app-free-style/index.html#/\" + viewId);\n\n      /**\n      scope.instance = {};\n      viewFlexService.getViewById(viewId, function(event){\n        if(event.code == \"0\"){\n          var content = event.data.content, dt;\n          if(content != null){\n            var clone = JSON.parse(content);\n            scope.bgColor = clone.$attr(\"setting/color\");\n            var input = {\n              layout : clone.data ? clone.data : clone.layout,\n              setting : clone.setting\n            };\n            delete clone.data;\n            if(input.layout){\n              var editData = new freeboardservice.replaceCiKpi(input, function(){\n                timeout(function(){\n                  scope.instance.setMode(true);\n                  scope.instance.renderLayout(editData);\n                });\n              });\n            } else {\n              scope.error = \"此视图为多页面视图，不支持预览模式\"\n            };\n          }\n        }\n      })\n       */\n    };\n\n    scope.nav = _CONFIG_;\n\n    if (scope.viewId) {\n      previewGraph(scope.viewId);\n    } else {\n      charRoot = _CONFIG_[viewType].charRoot;\n\n      scope.navClick = function (key) {\n        $location.path(\"views/\" + key);\n      };\n\n      var complete = function complete() {\n        var getManagedViewsByType_back = function getManagedViewsByType_back(event) {\n          var viewType = config.viewType;\n          var defers = [];\n          var dataTable = {};\n          var projectIds = [];\n          var allviews = event.data;\n\n          if (event.code == 0) {\n            var loop = function loop(elem) {\n              var defer = q.defer();\n\n              if (viewType == \"configure\") {\n                if (elem.template) {\n                  if (elem.template.resourceType == \"project\") {\n                    projectIds.push(elem.template.resourceId);\n                  }\n                }\n              }\n\n              ;\n              var viewId = elem.viewId;\n\n              if (elem.value) {\n                elem.component = elem.value.component;\n              }\n\n              if (elem.template) {\n                elem.keyValue = elem.template.keyValue;\n              }\n\n              userRoleUIService.findRoleRes({\n                resId: viewId\n              }, function (event) {\n                if (event.code == 0) {\n                  var roleRes = event.data.map(function (el) {\n                    return el.roleId;\n                  });\n\n                  if (roleRes.length > 0) {\n                    elem.bindRoles = allRoles.filter(function (elem) {\n                      return roleRes.indexOf(elem.roleID) != -1;\n                    }).map(function (elem) {\n                      return elem.roleName;\n                    }).toString();\n                  }\n\n                  defer.resolve(\"success\");\n                }\n              });\n              return defer.promise;\n            };\n\n            for (var i in allviews) {\n              defers.push(loop(allviews[i]));\n            }\n\n            q.all(defers).then(function (event) {\n              var run = function run(projects) {\n                scope[\"allprojects\"] = projects;\n\n                var loopView = function loopView(view) {\n                  if (view.template) {\n                    if (view.template.resourceType == \"device\") {\n                      resourceUIService.getModelByIds([view.template.resourceId], function (data) {\n                        view.templateStr = \"模版 : 已删除\";\n\n                        if (data.data) {\n                          if (data.data[0]) {\n                            view.templateStr = \"模版 : \" + (data.data ? data.data[0].label : \"-\");\n                          }\n                        }\n                      });\n                    } else if (view.template.resourceType == \"project\") {\n                      if (projects) {\n                        var find = projects[view.template.resourceId];\n\n                        if (find) {\n                          view.templateStr = \"项目 : \" + find.label;\n                        }\n                      }\n                    } else {\n                      view.templateStr = \"普通\";\n                    }\n\n                    ;\n                  } else {\n                    view.templateStr = \"普通\";\n                  }\n\n                  ;\n                };\n\n                for (var i in allviews) {\n                  loopView(allviews[i]);\n                }\n\n                views = allviews;\n                dataTable.source = allviews;\n\n                dataTable.rowclass = function (row) {\n                  if (row.creator != userLoginUIService.user.userID) {\n                    return \"self\";\n                  }\n                };\n\n                window.header = [], window.columnDefs = [], window.buttons = [];\n\n                var loop = function loop(attr) {\n                  var arr = config[attr];\n\n                  var loop = function loop(at) {\n                    window[attr].push(widget[at]);\n                  };\n\n                  for (var i in arr) {\n                    loop(arr[i]);\n                  }\n                };\n\n                var arr = ['header', 'columnDefs', 'buttons'];\n\n                for (var i in arr) {\n                  loop(arr[i]);\n                }\n\n                ;\n                widget.OPTIONS.modes.default.options = window['buttons'];\n                dataTable.header = window['header'];\n                dataTable.columnDefs = window['columnDefs'];\n\n                for (var i in widget.columnDefs) {\n                  init(widget.columnDefs[i]);\n                }\n\n                ;\n                scope.dataTable = dataTable;\n\n                var getAllDomainName = function getAllDomainName(views) {\n                  var defers = [];\n\n                  var loop = function loop(item) {\n                    var deferred = q.defer(),\n                        attributesLoadDefer = [];\n                    var arr = item.domainPath.split(\"/\");\n                    var domainID;\n\n                    if (arr.length > 2) {\n                      domainID = arr[arr.length - 2];\n                    }\n\n                    ;\n\n                    var loadResource = function loadResource() {\n                      var deferred = q.defer();\n\n                      if (item.values) {\n                        item.component = item.values.component;\n                      }\n\n                      if (item.template) {\n                        var modelId = item.template.resourceId;\n\n                        if (!scope['model_' + modelId]) {\n                          $$.cacheAsyncData.call(resourceUIService.getModelByIds, [[modelId]], function (event) {\n                            if (event && event.code == 0) {\n                              scope['model_' + modelId] = event.data[0];\n                              item.modelObj = scope['model_' + modelId];\n                            }\n\n                            deferred.resolve(\"success\");\n                          });\n                        } else {\n                          if (scope['model_' + modelId].hasOwnProperty(\"$$state\")) {\n                            scope['model_' + modelId].then(function () {\n                              item.modelObj = scope['model_' + modelId];\n                              deferred.resolve(\"success\");\n                            });\n                          } else {\n                            item.modelObj = scope['model_' + modelId];\n                            deferred.resolve(\"success\");\n                          }\n                        }\n                      } else {\n                        deferred.resolve(\"success\");\n                      }\n\n                      return deferred.promise;\n                    };\n\n                    var loadDomain = function loadDomain() {\n                      var deferred = q.defer();\n\n                      if (!scope[domainID]) {\n                        scope[domainID] = deferred.promise;\n                        userDomainService.queryDomainInfo(domainID, function (event) {\n                          if (event.code == \"0\") {\n                            scope[domainID] = event.data;\n                            item.domainObj = scope[domainID];\n                          }\n\n                          deferred.resolve(\"success\");\n                        });\n                      } else {\n                        if (scope[domainID].hasOwnProperty(\"$$state\")) {\n                          scope[domainID].then(function () {\n                            item.domainObj = scope[domainID];\n                            deferred.resolve(\"success\");\n                          });\n                        } else {\n                          item.domainObj = scope[domainID];\n                          deferred.resolve(\"success\");\n                        }\n                      }\n\n                      ;\n                      return deferred.promise;\n                    };\n\n                    attributesLoadDefer.push(loadResource(), loadDomain());\n                    q.all(attributesLoadDefer).then(function (event) {\n                      deferred.resolve(\"success\");\n                    });\n                    return deferred.promise;\n                  };\n\n                  for (var i in views) {\n                    defers.push(loop(views[i]));\n                  }\n\n                  return defers;\n                };\n\n                q.all(getAllDomainName(views)).then(function () {});\n              };\n\n              if (projectIds.length > 0) {\n                resourceUIService.getResourceByIds(projectIds, function (event) {\n                  if (event) {\n                    run(event);\n                  }\n                });\n              } else {\n                run();\n              }\n\n              ;\n            });\n          } else {\n            growl.error(event.message);\n            views = [];\n          }\n        }; //viewFlexService.getManagedViewsByType(viewType, userLoginUIService.user.domainPath, getManagedViewsByType_back);\n\n\n        viewFlexService.getManagedViewsByTypeAndRole(viewType, getManagedViewsByType_back);\n        /** viewFlexService.getAllMyViews(getAllMyViews_back) */\n      };\n\n      var checkPowerCss = function checkPowerCss(flg) {\n        var css = \"\";\n\n        if (flg == \"CREAT\") {\n          if (charRoot == \"告警视图\" && !scope.menuitems[\"A1_S77\"]) {\n            css = \"ng-hide\";\n          }\n\n          if (charRoot == \"组态视图\" && !scope.menuitems[\"A03_S22\"]) {\n            css = \"ng-hide\";\n          }\n\n          if (charRoot == \"分析视图\" && !scope.menuitems[\"A02_S78\"]) {\n            css = \"ng-hide\";\n          }\n\n          if (charRoot == \"仪表板视图\" && !scope.menuitems[\"A04_S21\"]) {\n            css = \"ng-hide\";\n          }\n        } else if (flg == \"RELEASE\") {\n          if (charRoot == \"告警视图\" && !scope.menuitems[\"A2_S77\"]) {\n            css = \"ng-hide\";\n          }\n\n          if (charRoot == \"组态视图\" && !scope.menuitems[\"A04_S22\"]) {\n            css = \"ng-hide\";\n          }\n\n          if (charRoot == \"分析视图\" && !scope.menuitems[\"A03_S78\"]) {\n            css = \"ng-hide\";\n          }\n\n          if (charRoot == \"仪表板视图\" && !scope.menuitems[\"A04_S21\"]) {\n            css = \"ng-hide\";\n          }\n        } else if (flg == \"DELETE\") {\n          if (charRoot == \"告警视图\" && !scope.menuitems[\"A3_S77\"]) {\n            css = \"ng-hide\";\n          }\n\n          if (charRoot == \"组态视图\" && !scope.menuitems[\"A05_S22\"]) {\n            css = \"ng-hide\";\n          }\n\n          if (charRoot == \"分析视图\" && !scope.menuitems[\"A04_S78\"]) {\n            css = \"ng-hide\";\n          }\n\n          if (charRoot == \"仪表板视图\" && !scope.menuitems[\"A05_S21\"]) {\n            css = \"ng-hide\";\n          }\n        }\n\n        return css;\n      };\n\n      var checkPowerVisible = function checkPowerVisible(flg) {\n        var bol = true;\n\n        if (flg == \"BTN_DESIGN\") {\n          if (charRoot == \"分析视图\" && !scope.menuitems[\"A05_S78\"]) {\n            bol = false;\n          }\n\n          if (charRoot == \"组态视图\" && !scope.menuitems[\"A01_S22\"]) {\n            bol = false;\n          }\n\n          if (charRoot == \"仪表板视图\" && !scope.menuitems[\"A01_S21\"]) {\n            bol = false;\n          }\n\n          if (charRoot == \"告警视图\" && !scope.menuitems[\"A4_S77\"]) {\n            bol = false;\n          }\n        } else if (flg == \"BTN_DELETE\") {\n          if (charRoot == \"告警视图\" && !scope.menuitems[\"A3_S77\"]) {\n            bol = false;\n          }\n\n          if (charRoot == \"组态视图\" && !scope.menuitems[\"A05_S22\"]) {\n            bol = false;\n          }\n\n          if (charRoot == \"分析视图\" && !scope.menuitems[\"A04_S78\"]) {\n            bol = false;\n          }\n\n          if (charRoot == \"仪表板视图\" && !scope.menuitems[\"A05_S21\"]) {\n            bol = false;\n          }\n        } else if (flg == \"BTN_EDIT\") {\n          if (charRoot == \"告警视图\" && !scope.menuitems[\"A4_S77\"]) {\n            bol = false;\n          }\n\n          if (charRoot == \"分析视图\" && !scope.menuitems[\"A01_S78\"]) {\n            bol = false;\n          }\n\n          if (charRoot == \"组态视图\" && !scope.menuitems[\"A06_S22\"]) {\n            bol = false;\n          }\n\n          if (charRoot == \"仪表板视图\" && !scope.menuitems[\"A06_S21\"]) {\n            bol = false;\n          }\n        } else if (flg == \"BTN_DUPLICATE\") {\n          if (charRoot == \"告警视图\" && !scope.menuitems[\"A5_S77\"]) {\n            bol = false;\n          }\n\n          if (charRoot == \"组态视图\" && !scope.menuitems[\"A07_S22\"]) {\n            bol = false;\n          }\n\n          if (charRoot == \"分析视图\" && !scope.menuitems[\"A06_S78\"]) {\n            bol = false;\n          }\n\n          if (charRoot == \"仪表板视图\" && !scope.menuitems[\"A07_S21\"]) {\n            bol = false;\n          }\n        } else if (flg == \"BTN_RELEASE\") {\n          if (charRoot == \"告警视图\" && !scope.menuitems[\"A2_S77\"]) {\n            bol = false;\n          }\n\n          if (charRoot == \"组态视图\" && !scope.menuitems[\"A04_S22\"]) {\n            bol = false;\n          }\n\n          if (charRoot == \"分析视图\" && !scope.menuitems[\"A03_S78\"]) {\n            bol = false;\n          }\n\n          if (charRoot == \"仪表板视图\" && !scope.menuitems[\"A04_S21\"]) {\n            bol = false;\n          }\n        } else if (flg == \"BTN_VIEW\") {\n          if (charRoot == \"告警视图\") {\n            bol = false;\n          }\n\n          if (charRoot == \"组态视图\" && !scope.menuitems[\"A08_S22\"]) {\n            bol = false;\n          }\n\n          if (charRoot == \"分析视图\" && !scope.menuitems[\"A07_S78\"]) {\n            bol = false;\n          }\n\n          if (charRoot == \"仪表板视图\" && !scope.menuitems[\"A08_S21\"]) {\n            bol = false;\n          }\n        }\n\n        return bol; //return false;\n      };\n\n      var queryDomainTree_back = function queryDomainTree_back(event) {\n        if (event.code == \"0\") {\n          domainlist = createlist(event.data[0]);\n          domaintree = {\n            domainInfos: event.data\n          };\n          widget = {\n            CREAT: {\n              label: \"创建\" + charRoot,\n              icon: \"fa fa-plus\",\n              type: \"button\",\n              class: \"btn btn-primary btn-sm \" + checkPowerCss(\"CREAT\"),\n              style: {\n                margin: \"2px\"\n              },\n              events: {\n                click: addNewClick\n              }\n            },\n            DESIGNVIEW: {\n              label: \"管理性能视图\",\n              icon: \"glyphicon glyphicon-new-window\",\n              type: \"button\",\n              class: \"btn btn-default btn-sm\",\n              style: {\n                margin: \"2px\"\n              },\n              events: {\n                click: function click() {\n                  location.href = \"#/designView2\";\n                }\n              }\n            },\n            RELEASE: {\n              label: \"发布\",\n              icon: \"glyphicon glyphicon-new-window\",\n              type: \"button\",\n              class: \"btn btn-default btn-sm \" + checkPowerCss(\"RELEASE\"),\n              disabled: function disabled(event) {\n                if (event) {\n                  var some = event.some(function (elem) {\n                    return elem.selected == true && elem.releaseStatus != true;\n                  });\n                  return !some;\n                } else {\n                  return true;\n                }\n              },\n              style: {\n                margin: \"2px\"\n              },\n              events: {\n                click: releaseGroup\n              }\n            },\n            DELETE: {\n              label: \"删除\",\n              icon: \"fa fa-minus\",\n              type: \"button\",\n              disabled: function disabled(event) {\n                if (event) {\n                  var some = event.some(function (elem) {\n                    return elem.selected == true;\n                  });\n                  return !some;\n                } else {\n                  return true;\n                }\n              },\n              class: \"btn btn-default btn-sm \" + checkPowerCss(\"DELETE\"),\n              style: {\n                margin: \"2px\"\n              },\n              events: {\n                click: deleteGroup\n              }\n            },\n            COMPONENT: {\n              label: \"组件\",\n              data: \"component\",\n              type: \"toggle\",\n              filterable: false,\n              sortable: false,\n              format: function format(value, row) {\n                if (value == \"default\") {\n                  return \"是\";\n                } else {\n                  return \"否\";\n                }\n              },\n              events: {\n                click: setComponentClick\n              }\n            },\n            TEMPLATE: {\n              label: \"默认仪表板\",\n              data: \"keyValue\",\n              type: \"text\",\n              filterable: false,\n              sortable: true,\n              format: function format(value, row) {\n                if (value == \"default\") {\n                  return \"是\";\n                } else {\n                  return \"否\";\n                }\n              },\n              modes: {\n                default: {\n                  type: \"text\"\n                }\n              }\n            },\n            SETHOME: {\n              label: \"首页设置\",\n              data: \"homeview\",\n              type: \"sethome\",\n              filterable: false,\n              sortable: false,\n              width: 30,\n              events: {\n                click: sethomeClick\n              }\n            },\n            VIEWTITLE: {\n              label: \"视图名称\",\n              data: \"viewTitle\",\n              type: \"text\",\n              filterable: true,\n              sortable: true,\n              modes: {\n                default: {\n                  type: \"text\"\n                }\n              }\n            },\n            HIERARCHY: {\n              label: \"视图层级\",\n              data: \"viewHierarchy\",\n              type: \"text\",\n              filterable: false,\n              sortable: true,\n              modes: {\n                default: {\n                  type: \"text\"\n                }\n              },\n              format: function format(value, row) {\n                if (treeData == undefined) {\n                  treeData = createTree(views);\n                }\n\n                var rs = '';\n                var parent = row.parent;\n\n                while (parent) {\n                  if (parent.viewId != 0) {\n                    rs = parent.viewTitle + \"/\" + rs;\n                  }\n\n                  parent = parent.parent;\n                }\n\n                rs = \"/\" + rs;\n                return rs;\n              }\n            },\n            RESTYPE: {\n              label: \"视图类型\",\n              data: \"templateStr\",\n              type: \"text\",\n              modes: {\n                default: {\n                  type: \"text\"\n                }\n              },\n              filterable: false,\n              sortable: true\n            },\n            DESCRIPTION: {\n              label: \"视图描述\",\n              data: \"description\",\n              type: \"text\",\n              modes: {\n                default: {\n                  type: \"text\"\n                }\n              },\n              format: function format(str) {\n                if (str == null) {\n                  return '-';\n                } else {\n                  return str;\n                }\n              },\n              filterable: false,\n              sortable: true\n            },\n            OWNER: {\n              label: \"绑定角色\",\n              data: \"bindRoles\",\n              type: \"select\",\n              options: allRoles,\n              filterFormat: {\n                label: \"roleName\",\n                value: \"roleName\"\n              },\n              modes: {\n                default: {\n                  type: \"text\"\n                }\n              },\n              filterable: true,\n              sortable: false\n            },\n            RELEASESTATUS: {\n              label: \"发布状态\",\n              data: \"releaseStatus\",\n              type: \"text\",\n              modes: {\n                default: {\n                  type: \"text\"\n                }\n              },\n              format: function format(str) {\n                if (str == null) {\n                  return '未发布';\n                } else if (str == 0) {\n                  return '未发布';\n                } else if (str == 1) {\n                  return '已发布';\n                } else {\n                  return '-';\n                }\n              },\n              filterable: false,\n              sortable: true\n            },\n            CREATETIME: {\n              label: \"创建时间\",\n              data: \"createTime\",\n              type: \"date\",\n              format: \"yy-mm-dd hh:nn:ss\",\n              filterable: false,\n              sortable: true,\n              modes: {\n                default: {\n                  type: \"date\"\n                }\n              }\n            },\n            UPDATETIME: {\n              label: \"更新时间\",\n              data: \"updateTime\",\n              type: \"date\",\n              format: \"yy-mm-dd hh:nn:ss\",\n              filterable: false,\n              sortable: true,\n              modes: {\n                default: {\n                  type: \"date\"\n                }\n              }\n            },\n            DOMAIN: {\n              label: \"管理域\",\n              type: \"tree\",\n              sortable: true,\n              filterable: true,\n              data: \"domainPath\",\n              key: \"id\",\n              mark: \"domainInfos\",\n              options: domaintree,\n              format: function format(value, row) {\n                if (row.domainObj) {\n                  return row.domainObj.label;\n                } else {\n                  return \"-\";\n                }\n\n                ;\n              },\n              modes: {\n                default: {\n                  type: \"text\"\n                }\n              }\n            },\n            OPTIONS: {\n              label: \"操作\",\n              width: 141,\n              type: \"buttonGroup\",\n              filterable: false,\n              sortable: false,\n              modes: {\n                default: {\n                  options: []\n                }\n              }\n            },\n            BTN_DESIGN: {\n              label: viewType == 'configAlert' ? \"编辑\" : \"设计\",\n              disabled: function disabled(event) {\n                return !checkPowerVisible(\"BTN_DESIGN\");\n              },\n              type: \"button\",\n              class: \"btn btn-primary\",\n              events: {\n                click: designClick\n              }\n            },\n            BTN_EDIT: {\n              label: \"编辑\",\n              type: \"button\",\n              class: \"btn btn-default\",\n              disabled: function disabled(event) {\n                return !checkPowerVisible(\"BTN_EDIT\");\n              },\n              events: {\n                click: editClick\n              }\n            },\n            BTN_DELETE: {\n              label: \"删除\",\n              type: \"button\",\n              visible: function visible(event) {\n                return checkPowerVisible(\"BTN_DELETE\");\n              },\n              events: {\n                click: deleteClick\n              }\n            },\n            BTN_VIEW: {\n              label: \"预览\",\n              type: \"button\",\n              visible: function visible(event) {\n                return checkPowerVisible(\"BTN_VIEW\");\n              },\n              events: {\n                click: viewClick\n              }\n            },\n            BTN_DUPLICATE: {\n              label: \"复制\",\n              type: \"button\",\n              visible: function visible(event) {\n                return checkPowerVisible(\"BTN_DUPLICATE\");\n              },\n              events: {\n                click: duplicateClick\n              }\n            },\n            BTN_RELEASE: {\n              label: \"发布\",\n              type: \"button\",\n              visible: function visible(event) {\n                return checkPowerVisible(\"BTN_RELEASE\") && event.releaseStatus != true;\n              },\n              events: {\n                click: releaseClick\n              }\n            },\n            BTN_HOME: {\n              label: \"设为首页\",\n              type: \"button\",\n              visible: function visible(event) {\n                return !event.homeview;\n              },\n              events: {\n                click: sethomeClick\n              }\n            }\n          };\n          config = _CONFIG_[viewType];\n\n          var queryEnterpriseUser_back = function queryEnterpriseUser_back(event) {\n            if (event.code == 0) {\n              enterpriseUsers = event.data;\n              config.run(complete);\n            }\n          };\n\n          userEnterpriseService.queryEnterpriseUser(queryEnterpriseUser_back);\n        }\n      };\n\n      timeout(function () {\n        var queryEnterpriseRole_back = function queryEnterpriseRole_back(event) {\n          if (event.code == 0) {\n            allRoles = event.data;\n            userDomainService.queryDomainTree(userLoginUIService.user.userID, queryDomainTree_back);\n          }\n        };\n\n        userEnterpriseService.queryEnterpriseRole(queryEnterpriseRole_back);\n      }, 1000);\n    }\n\n    scope.bgColorFn = function (bgColor) {\n      return {\n        \"background-color\": bgColor ? bgColor : \"#eee\"\n      };\n    };\n\n    function checkVersion(data) {\n      var version = \"version2\";\n      var mode = \"standard\";\n      data.traverse(function (attr, element) {\n        for (var i in element) {\n          if (i == \"rows\") {\n            version = \"version1\";\n          }\n\n          if (element.kpi == 3236) {\n            mode = \"machine\";\n          }\n        }\n      });\n      return version + \"_\" + mode;\n    }\n  }]);\n});"],"sourceRoot":"/source/"}