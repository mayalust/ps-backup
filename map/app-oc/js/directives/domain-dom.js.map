{"version":3,"sources":["app-oc/js/directives/domain-dom.js"],"names":["define","directives","datatables","initDirective","timeout","ngDialog","userDomainService","growl","restrict","scope","ngModel","add","delete","edit","user","link","element","attr","TEXT","description","$","css","des_text","text","des_close","append","$watch","n","o","s","getAllName","data","rs","traverse","elem","push","label","hasOwnProperty","i","children","render","type","searchlist","tree","searchFound","remove","target","depth","parentIcon","parentRmvBtn","parentDom","parentUser","parentData","dom","btn","icon","addClass","userIcon","rubish","name","modelId","infoBtn","infoBtnClick","event","stopPropagation","offset","opacity","top","left","prepend","animate","on","infoBtnLeave","off","removeBtn","addBtn","clone","editBtn","cover","inner","find","prop","$broadcast","layer","foldClick","removeClass","max-height","intro","domainID","id","domainPath","domain","queryDeleteDomain","resultObj","warning","fnlist","style","width","border-radius","font-size","font-weight","padding","fn","deleteDomain","code","success","$remove","index","length","removeAttr","close","size","dialog","title","open","template","className","provinces","$parent","cityDics","districtDics","namelist","undefined","inx","indexOf","disabled","input","every","right","errorStatus","forEach","error","value","des","number","externalDevId","standardAddress","areaList","returnObj","newAdd","after","getAddressPointFromTools","split","join","address","addDomain","values","longitude","location","lng","latitude","lat","confirm","composory","placeholder","format","abled","options","maxlength","onChange","arr","provinceId","province","item","cityId","city","county","modifyDomain","isFlag","$apply","show","Array","$on","$timeout","$compile","dialogue","userEnterpriseService","controller","$scope","$element","$attrs","enterpriseUser","table","checkbox","domMain","Event","DOMAININFOSINIT","args","destroy","hasClass","select","DataTable","language","ProudSmart","datatable","autoWidth","order","columns","optionCol1","initComplete","setting","eq","columnDefs","targets","orderable","full","str","parent","createBtn","cls","subcls","button","span","deleteBtn","queryPart","queryFormat","queryDom","btnGroup","drop","ul","inputWrap","searchIcon","searchText","searchBtn","dt","createInput","createLi","li","a","createQuary","run","console","log","queryEnterpriseUser","e","preventDefault","tr","this","closest","rowData","row","context","cellIndex","isEdit","toggleClass","rows","selectRow","doAction","$filter","isEditing","DOMAINDEVICESINIT","visible","escape","Math","random","selectDomain1","enterpriseDomain","selectPath","deviceIdTree","domainsAry","rowCallback","nRow","aData","iDataIndex","domainSelect","domainSelectName","val","flg","draw","cells","invalidate"],"mappings":"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","file":"app-oc/js/directives/domain-dom.js","sourcesContent":["define(['directives/directives', 'datatables.net', 'datatables.net-bs'], function (directives, datatables) {\n  'use strict';\n\n  directives.initDirective('treeData', ['$timeout', 'ngDialog', 'userDomainService', 'growl', function (timeout, ngDialog, userDomainService, growl) {\n    return {\n      restrict: 'A',\n      scope: {\n        ngModel: \"=\",\n        add: \"&\",\n        delete: \"&\",\n        edit: \"&\",\n        user: \"&\"\n      },\n      link: function link(scope, element, attr) {\n        var TEXT = {\n          \"SUBMIT\": \"确定\",\n          \"CANCEL\": \"取消\"\n        };\n        var description = $(\"<div></div>\").css(\"z-index\", 1999).css(\"background-color\", \"#fff\").css(\"box-shadow\", \"1px 1px 10px rgba(0,0,0,.3)\").css(\"padding\", \"15px 20px\").css(\"margin\", \"-5px 0 0 25px\").css(\"display\", \"block\").css(\"width\", \"300px\").css(\"position\", \"fixed\");\n        var des_text = $(\"<p></p>\").text('').css(\"color\", \"#666\").css(\"margin\", 0).css(\"line-height\", \"16px\").css(\"font-size\", \"12px\").css(\"font-weight\", \"normal\");\n        var des_close = $(\"<div></div>\").append($(\"<span class='close'>x</span>\"));\n        var des_title = $(\"<p></p>\").text(\"描述 :\").css(\"font-weight\", \"bold\").css(\"color\", \"#333\").css(\"margin\", \"10px auto\").css(\"line-height\", \"16px\").css(\"font-size\", \"12px\");\n        description.append(des_close).append(des_text);\n\n        var ready = function ready() {\n          $(element).css(\"position\", \"relative\");\n\n          var ngModelWatcher = function ngModelWatcher(n, o, s) {\n            var getAllName = function getAllName(data) {\n              var rs = [];\n\n              var traverse = function traverse(data) {\n                rs.push(data.label);\n\n                var loop = function loop(elem) {\n                  traverse(elem);\n                };\n\n                if (data.hasOwnProperty(\"children\")) {\n                  for (var i in data.children) {\n                    loop(data.children[i]);\n                  }\n                }\n              };\n\n              traverse(data);\n              return rs;\n            };\n\n            var render = function render(data, type, searchlist) {\n              var tree = data,\n                  searchFound = type == \"search\" ? false : true;\n              $(element).children().remove();\n\n              var traverse = function traverse(target, data, depth, parentIcon, parentRmvBtn, parentDom, parentUser, parentData) {\n                depth++;\n                var children;\n                var dom = $(\"<div></div>\").css(\"border-bottom\", \"1px solid #ddd\").css(\"position\", \"relative\").css(\"overflow\", \"hidden\").css(\"opacity\", 0).css(\"max-height\", 0).css(\"line-height\", \"32px\");\n                var btn = $(\"<button></button>\").css(\"line-height\", \"20px\").css(\"color\", \"#fff\").css(\"border\", \"0\").css(\"background-color\", \"#009dea\").css(\"float\", \"left\").css(\"padding\", \"2px 5px 2px 6px\").css(\"margin\", \"4px 0px 0px 3px\");\n                var icon = $(\"<span></span>\").addClass(\"glyphicon glyphicon-minus\").css(\"font-size\", \"10px\");\n                var userIcon = $(\"<span></span>\").addClass(\"glyphicon glyphicon-user\").css(\"opacity\", 0).css(\"margin\", \"0 5px 0 8px\").css(\"color\", \"#ccc\");\n                var rubish = $(\"<div></div>\").addClass(\"glyphicon glyphicon-trash\");\n                var add = $(\"<div></div>\").addClass(\"glyphicon glyphicon-plus\");\n                var person = $(\"<span></span>\").addClass(\"glyphicon glyphicon-user\");\n                var text = $(\"<span></span>\").css(\"margin-left\", 10).text(data.name + (data.modelId == 301 ? \"[客户域]\" : data.modelId == 302 ? \"[项目域]\" : \"\"));\n                var infoBtn = $(\"<span></span>\").addClass(\"glyphicon glyphicon-question-sign\").css(\"font-size\", \"16px\").css(\"color\", \"#eee\").css(\"margin-left\", \"20px\");\n\n                var infoBtnClick = function infoBtnClick(event) {\n                  event.stopPropagation();\n                  description.remove();\n                  var offset = $(event.target).offset();\n                  description.css({\n                    opacity: 0,\n                    top: offset.top - 20,\n                    left: offset.left + 5\n                  });\n                  des_text.text(data.description);\n                  $(\"body\").prepend(description);\n                  description.animate({\n                    opacity: 1\n                  }, 300);\n                  $(\"body\").on(\"click.infoleave\", infoBtnLeave);\n                };\n\n                var infoBtnLeave = function infoBtnLeave(event) {\n                  event.stopPropagation();\n                  $(\"body\").off();\n                  description.remove();\n                };\n\n                var edit = $(\"<span></span>\").addClass(\"proudsmart ps-edit\");\n                var removeBtn = $(\"<button></button>\").css(\"color\", \"#dd695c\").css(\"border\", \"1px solid #ddd\").css(\"margin\", 0).css(\"background-color\", \"#fff\").css(\"line-height\", \"14px\").css(\"position\", \"relative\").css(\"overflow\", \"visible\").css(\"float\", \"right\").css(\"z-index\", 3).css(\"margin\", \"4px 3px 0px 2px\");\n                var addBtn = removeBtn.clone();\n                var editBtn = removeBtn.clone(); //var userBtn = removeBtn.clone();\n\n                var cover = $(\"<div></div>\").css(\"background-color\", \"#0f58a9\").css(\"opacity\", .2).css(\"position\", \"absolute\").css(\"height\", \"40px\").css(\"top\", 0).css(\"width\", \"100%\");\n                var inner = $(\"<div></div>\").css(\"margin-left\", (type != \"search\" ? depth * 20 : 0) + \"px\");\n                addBtn.append(add);\n                addBtn.css(\"z-index\", 1).css(\"color\", \"#1eb8b8\");\n                editBtn.append(edit);\n                editBtn.css(\"z-index\", 2).css(\"color\", \"#009fea\");\n                removeBtn.append(rubish); //userBtn.append(person);\n\n                if (type == \"search\") {\n                  var find = searchlist.find(function (elem) {\n                    return elem.name == data.name;\n                  });\n\n                  if (!find) {\n                    dom.css(\"display\", \"none\");\n                  } else {\n                    searchFound = true;\n                    btn.prop(\"disabled\", true);\n                    dom.on(\"click\", function (event) {\n                      scope.$broadcast(\"HIGHLIGHTDATA\", data);\n                    });\n                  }\n\n                  btn.css(\"display\", \"none\");\n                } else if (type == \"highlight\") {\n                  if (searchlist) {// if(data.id == searchlist.id){\n                    //   dom.css(\"background-color\", \"#d1edaa\");\n                    // }\n                  }\n                }\n\n                btn.append(icon);\n\n                if (data.description) {\n                  infoBtn.css(\"cursor\", \"pointer\").css(\"color\", \"#ccc\").on(\"click\", infoBtnClick);\n                }\n\n                if (!parentData || data.modelId == 301 && data.layer == 1 || data.modelId == 302 && data.layer == 1) {\n                  // dom.css(\"background-color\", \"#eee\");\n                  editBtn.css(\"display\", \"block\"); // removeBtn.css(\"display\", \"none\");\n                }\n\n                var foldClick = function foldClick(event) {\n                  if (children.css(\"max-height\") == \"0px\") {\n                    timeout(function () {\n                      icon.removeClass().addClass(\"glyphicon glyphicon-minus\");\n                      children.animate({\n                        \"max-height\": 800,\n                        \"opacity\": 1\n                      }, 300);\n                    });\n                  } else {\n                    timeout(function () {\n                      icon.removeClass().addClass(\"glyphicon glyphicon-plus\");\n                      children.animate({\n                        \"max-height\": 0,\n                        \"opacity\": 0\n                      }, 300);\n                    });\n                  }\n\n                  ;\n                };\n\n                var addClick = function addClick(event) {\n                  var provinces = scope.$parent.provinces;\n                  var cityDics = scope.$parent.cityDics;\n                  var districtDics = scope.$parent.districtDics;\n                  event.stopPropagation();\n                  description.remove();\n\n                  var cancel = function cancel(event) {\n                    ngDialog.close();\n                  };\n\n                  var namelist = [];\n\n                  if (data.children == undefined) {\n                    data.children = [];\n                  }\n\n                  namelist = getAllName(tree);\n                  var inx = 0;\n                  var name = \"新建域\";\n\n                  while (namelist.indexOf(name) != -1) {\n                    inx++;\n                    name = \"新建域_\" + inx;\n                  }\n\n                  var confirm = function confirm(event) {\n                    if (event.input[0].value == '' || event.input[0].value == null) {\n                      growl.warning(\"域名称不能为空\", {});\n                      return;\n                    }\n\n                    if (event.input[2].value == '' || event.input[2].value == null) {\n                      growl.warning(\"编码不能为空\", {});\n                      return;\n                    }\n\n                    if (event.input[3].value == '' || event.input[3].value == null) {\n                      growl.warning(\"所在省不能为空\", {});\n                      return;\n                    }\n\n                    ngDialog.close();\n                    var domainID = data.id;\n                    var name = event.input[0].value;\n                    var des = event.input[event.input.length - 1].value; // 新增加的序号\n\n                    var number = event.input[1].value - 0; // 新增加的编码\n\n                    var externalDevId = event.input[2].value;\n                    var standardAddress = areaList[2].value.id ? areaList[2].value.id : areaList[1].value.id ? areaList[1].value.id : areaList[0].value.id;\n\n                    var success = function success(returnObj) {\n                      if (returnObj.code == 0) {\n                        var newAdd = returnObj.data;\n                        data.children.push(newAdd);\n                        userIcon.css(\"display\", \"none\");\n                        btn.css(\"display\", \"inline\");\n                        icon.removeClass().addClass(\"glyphicon glyphicon-minus\");\n\n                        if (children == undefined) {\n                          children = $(\"<div></div>\").css(\"overflow\", \"hidden\").css(\"position\", \"relative\");\n                        }\n\n                        dom.after(children);\n                        btn.off(\"click\");\n                        btn.on(\"click\", foldClick);\n                        removeBtn.prop(\"disabled\", true);\n                        removeBtn.css(\"color\", \"#aaa\");\n                        dom.css(\"font-weight\", \"bold\");\n                        traverse(children, newAdd, depth, btn, removeBtn, dom, userIcon, data.children);\n                        scope.add({\n                          event: data\n                        });\n\n                        if (children.css(\"max-height\") == \"0px\") {\n                          timeout(function () {\n                            icon.removeClass().addClass(\"glyphicon glyphicon-minus\");\n                            children.animate({\n                              \"max-height\": 400,\n                              \"opacity\": 1\n                            }, 300, function () {});\n                          });\n                        }\n\n                        ;\n                        growl.success(\"新增管理域成功\", {});\n                      } else {\n                        growl.warning(\"新增管理域失败\", {});\n                      }\n                    };\n\n                    var error = function error(returnObj) {\n                      growl.warning(\"新增管理域失败\", {});\n                    };\n\n                    getAddressPointFromTools(standardAddress.split(\",\").join(\"\"), function (address) {\n                      userDomainService.addDomain(domainID, {\n                        name: name,\n                        description: des,\n                        externalDevId: externalDevId,\n                        values: {\n                          number: number,\n                          standardAddress: standardAddress,\n                          longitude: address ? address.location.lng : \"\",\n                          latitude: address ? address.location.lat : \"\"\n                        }\n                      }, success);\n                    });\n                  };\n\n                  var fnlist = [{\n                    label: TEXT.SUBMIT,\n                    icon: 'btn btn-primary',\n                    style: {\n                      width: '50%',\n                      'border-radius': 0,\n                      'font-size': '18px',\n                      'font-weight': 'bold',\n                      'padding': 10\n                    },\n                    disabled: function disabled() {\n                      var every = scope.dialog.input.every(function (elem) {\n                        return elem.right == true;\n                      });\n                      return !every;\n                    },\n                    fn: function fn() {\n                      var errorStatus = -1;\n                      scope.dialog.input.forEach(function (elem) {\n                        if (elem.error) {\n                          errorStatus = 1;\n                          return;\n                        }\n                      });\n\n                      if (errorStatus == -1) {\n                        var self = scope.dialog;\n                        confirm(self);\n                      }\n                    }\n                  }, {\n                    label: TEXT.CANCEL,\n                    icon: 'btn btn-default',\n                    style: {\n                      width: '50%',\n                      'border-radius': 0,\n                      'font-size': '18px',\n                      'font-weight': 'bold',\n                      'padding': 10\n                    },\n                    fn: cancel\n                  }];\n                  var areaList = [{\n                    value: '',\n                    label: '所在省',\n                    type: 'select',\n                    composory: true,\n                    placeholder: '',\n                    format: {\n                      label: 'label'\n                    },\n                    abled: false,\n                    right: false,\n                    options: provinces,\n                    maxlength: 32,\n                    onChange: function onChange(event) {\n                      areaList[2].value = \"\"; // areaList[2].right = false;\n\n                      if (event.value == \"\") {\n                        areaList[1].abled = true;\n                        event.right = false;\n                      } else {\n                        if (cityDics[event.value.id]) {\n                          areaList[1].options = cityDics[event.value.id];\n                        }\n\n                        areaList[1].abled = false;\n                        event.right = true;\n                      }\n                    }\n                  }, {\n                    value: '',\n                    label: '所在市',\n                    type: 'select',\n                    composory: false,\n                    placeholder: '',\n                    format: {\n                      label: 'label'\n                    },\n                    abled: true,\n                    right: true,\n                    options: cityDics,\n                    maxlength: 32,\n                    onChange: function onChange(event) {\n                      areaList[2].value = \"\"; // areaList[2].right = false;\n\n                      if (event.value == \"\") {\n                        areaList[2].abled = true;\n                        event.right = false;\n                      } else {\n                        if (event.value && districtDics[event.value.id]) {\n                          areaList[2].options = districtDics[event.value.id];\n                        }\n\n                        areaList[2].abled = false;\n                        event.right = true;\n                      }\n                    }\n                  }, {\n                    value: '',\n                    label: '区/县',\n                    type: 'select',\n                    composory: false,\n                    placeholder: '',\n                    format: {\n                      label: 'label'\n                    },\n                    abled: true,\n                    right: true,\n                    options: districtDics,\n                    maxlength: 32,\n                    onChange: function onChange(event) {\n                      if (event.value == \"\") {\n                        event.right = false;\n                      } else {\n                        event.right = true;\n                      }\n                    }\n                  }];\n                  scope.dialog = {\n                    title: {\n                      label: '管理域信息'\n                    },\n                    input: [{\n                      value: name,\n                      label: '域名称 ',\n                      type: 'input',\n                      composory: true,\n                      placeholder: '填写域名称',\n                      maxlength: 32,\n                      right: true,\n                      onChange: function onChange(event) {\n                        if (event.value == \"\") {\n                          event.error = \"域名称不可为空\";\n                          event.right = false;\n                        }\n                        /**else if (namelist.indexOf(event.value) != -1) {\n                        event.error = \"此域已被占用\";\n                        event.right = false;\n                        } */\n                        else {\n                            event.error = null;\n                            event.right = true;\n                          }\n                      }\n                    }, {\n                      value: \"\",\n                      label: '序号 ',\n                      type: 'input',\n                      placeholder: '填填写序号',\n                      right: true\n                    }, {\n                      value: \"\",\n                      label: '编码 ',\n                      type: 'input',\n                      composory: true,\n                      placeholder: '填填写编码',\n                      right: true,\n                      onChange: function onChange(event) {\n                        if (event.value == \"\") {\n                          event.error = \"编码不可为空\";\n                          event.right = false;\n                        } else {\n                          event.error = null;\n                          event.right = true;\n                        }\n                      }\n                    }, areaList[0], areaList[1], areaList[2], {\n                      maxlength: 200,\n                      value: '',\n                      label: '域描述 ',\n                      type: 'textarea',\n                      right: true,\n                      placeholder: '填写域描述'\n                    }],\n                    fnlist: fnlist\n                  };\n                  ngDialog.open({\n                    template: '../partials/dialogue/common_dia.html',\n                    className: 'ngdialog-theme-plain',\n                    scope: scope\n                  });\n                };\n\n                var removeClick = function removeClick() {\n                  event.stopPropagation();\n                  description.remove();\n                  var domainID = data.id;\n                  var domainPath = data.domainPath;\n                  var domain = {\n                    \"id\": domainID,\n                    \"domainPath\": domainPath\n                  };\n                  userDomainService.queryDeleteDomain(domain, function (resultObj) {\n                    if (resultObj.data != \"true\") {\n                      growl.warning(resultObj.data, {});\n                    } else {\n                      var confirm = function confirm() {\n                        var success = function success(event) {\n                          if (event.code == 0) {\n                            growl.success(\"删除管理域成功\", {});\n                            parentData.$remove(function (index, elem) {\n                              return elem.id == data.id;\n                            });\n\n                            if (parentData.length == 0) {\n                              parentRmvBtn.removeAttr(\"disabled\");\n                              parentRmvBtn.css(\"color\", \"#dd695c\");\n                            } else {\n                              parentRmvBtn.prop(\"disabled\", true);\n                              parentRmvBtn.css(\"color\", \"#aaa\");\n                            }\n\n                            ngDialog.close();\n\n                            var animFinished = function animFinished() {\n                              dom.remove();\n\n                              if (target.children().size() == 0) {\n                                target.remove();\n                                parentDom.css(\"font-weight\", \"normal\");\n                                parentDom.css(\"background-color\", \"#fff\");\n                                parentRmvBtn.css(\"display\", \"block\");\n                                parentIcon.css(\"display\", \"none\");\n                                parentUser.css(\"display\", \"inline\");\n                              }\n                            };\n\n                            dom.animate({\n                              \"opacity\": 0,\n                              \"max-height\": 0\n                            }, 300, animFinished);\n                            scope.delete({\n                              event: data\n                            });\n                          }\n                        };\n\n                        userDomainService.deleteDomain(domainID, domainPath, success);\n                      };\n\n                      var cancel = function cancel() {\n                        ngDialog.close();\n                      };\n\n                      var fnlist = [{\n                        label: '确定',\n                        icon: 'btn btn-success',\n                        style: {\n                          width: '50%',\n                          'border-radius': 0,\n                          'font-size': '18px',\n                          'font-weight': 'bold',\n                          'padding': 10\n                        },\n                        fn: confirm\n                      }, {\n                        label: '取消',\n                        icon: 'btn btn-default',\n                        style: {\n                          width: '50%',\n                          'border-radius': 0,\n                          'font-size': '18px',\n                          'font-weight': 'bold',\n                          'padding': 10\n                        },\n                        fn: cancel\n                      }];\n                      scope.dialog = {\n                        title: {\n                          label: '提示'\n                        },\n                        description: {\n                          label: '确认删除域?'\n                        },\n                        fnlist: fnlist\n                      };\n                      ngDialog.open({\n                        template: '../partials/dialogue/common_dia_prompt.html',\n                        className: 'ngdialog-theme-plain',\n                        scope: scope\n                      });\n                    }\n                  });\n                };\n\n                var editClick = function editClick(event) {\n                  var provinces = scope.$parent.provinces;\n                  var cityDics = scope.$parent.cityDics;\n                  var districtDics = scope.$parent.districtDics;\n                  event.stopPropagation();\n                  description.remove();\n                  var domainID = data.id;\n\n                  if (data.values.standardAddress) {\n                    var arr = data.values.standardAddress.split(\",\");\n                    data.provinceId = arr[0];\n                    data.province = provinces.find(function (item) {\n                      return arr[0] == item.label;\n                    });\n\n                    if (arr[1]) {\n                      data.cityId = cityDics[arr[0]].find(function (item) {\n                        return arr[1] == item.label;\n                      }).id;\n                      data.city = cityDics[arr[0]].find(function (item) {\n                        return arr[1] == item.label;\n                      });\n\n                      if (!arr[2]) {\n                        data.county = \"\";\n                      }\n                    } else if (!arr[1]) {\n                      data.county = \"\";\n                      data.cityId = \"\";\n                    }\n\n                    if (arr[2]) {\n                      data.county = districtDics[data.cityId].find(function (item) {\n                        return arr[2] == item.label;\n                      });\n                    }\n                  } else {\n                    data.province = \"\";\n                    data.city = \"\";\n                    data.county = \"\";\n                  }\n                  /**\n                   var filter = parentData.filter(function(elem){\n                    return elem.domainID != data.domainID;\n                  });\n                   */\n\n\n                  var namelist = getAllName(tree);\n                  namelist.$remove(function (index, elem) {\n                    return elem == data.name;\n                  });\n\n                  var cancel = function cancel(event) {\n                    ngDialog.close();\n                  };\n\n                  var confirm = function confirm(event) {\n                    if (event.input[0].value == '' || event.input[0].value == null) {\n                      growl.warning(\"域名称不能为空\", {});\n                      return;\n                    }\n\n                    if (event.input[2].value == '' || event.input[2].value == null) {\n                      growl.warning(\"编码不能为空\", {});\n                      return;\n                    }\n\n                    if (event.input[3].value == '' || event.input[3].value == null) {\n                      growl.warning(\"所在省不能为空\", {});\n                      return;\n                    }\n\n                    var standardAddress;\n                    var name = event.input[0].value;\n                    var des = event.input[event.input.length - 1].value; // 新增加的序号\n\n                    var number = event.input[1].value - 0; // 新增加的编码\n\n                    var externalDevId = event.input[2].value;\n\n                    if (areaList[2].value) {\n                      standardAddress = areaList[2].value.id; // standardAddress = areaList[2].value.id ? areaList[2].value.id : (areaList[1].value.id ? areaList[1].value.id : (areaList[0].value.id));\n                    } else if (areaList[1].value) {\n                      standardAddress = areaList[1].value.id;\n                    } else {\n                      standardAddress = areaList[0].value.id;\n                    }\n\n                    getAddressPointFromTools(standardAddress.split(\",\").join(\"\"), function (address) {\n                      data.id = domainID;\n                      data.name = name;\n                      data.externalDevId = externalDevId;\n                      data.description = des;\n                      data.values = data.values || {};\n                      data.values.number = number;\n                      data.values.standardAddress = standardAddress;\n                      data.values.longitude = address ? address.location.lng : \"\";\n                      data.values.latitude = address ? address.location.lat : \"\";\n                      userDomainService.modifyDomain([data], function (returnObj) {\n                        if (returnObj.code == 0) {\n                          if (returnObj.data) {\n                            if (returnObj.data.description) {\n                              infoBtn.css(\"cursor\", \"pointer\").css(\"color\", \"#ccc\").on(\"click\", infoBtnClick);\n                            } else {\n                              infoBtn.css(\"cursor\", \"default\").css(\"color\", \"#eee\").off(\"click\");\n                            }\n\n                            text.text(returnObj.data.name + (returnObj.data.modelId == 301 ? \"[客户域]\" : returnObj.data.modelId == 302 ? \"[项目域]\" : \"\"));\n                            des_text.text(returnObj.data.description);\n                            data.name = returnObj.data.name;\n                            data.label = returnObj.data.label;\n                            data.externalDevId = returnObj.data.externalDevId;\n                            data.values.number = returnObj.data.values.number;\n                            data.values.standardAddress = returnObj.data.values.standardAddress;\n                            data.description = returnObj.data.description;\n                          }\n\n                          growl.success(\"修改管理域成功\", {});\n                        } else {\n                          growl.warning(\"修改管理域失败\", {});\n                          return;\n                        }\n                      });\n                    });\n                    ngDialog.close();\n                  };\n\n                  var fnlist = [{\n                    label: '确定',\n                    icon: 'btn btn-primary',\n                    style: {\n                      width: '50%',\n                      'border-radius': 0,\n                      'font-size': '18px',\n                      'font-weight': 'bold',\n                      'padding': 10\n                    },\n                    disabled: function disabled() {\n                      var every = scope.dialog.input.every(function (elem) {\n                        return elem.right == true;\n                      });\n                      return !every;\n                    },\n                    fn: function fn() {\n                      var errorStatus = -1;\n                      scope.dialog.input.forEach(function (elem) {\n                        if (elem.error) {\n                          errorStatus = 1;\n                          return;\n                        }\n                      });\n\n                      if (errorStatus == -1) {\n                        var self = scope.dialog;\n                        confirm(self);\n                      }\n                    }\n                  }, {\n                    label: '取消',\n                    icon: 'btn btn-default',\n                    style: {\n                      width: '50%',\n                      'border-radius': 0,\n                      'font-size': '18px',\n                      'font-weight': 'bold',\n                      'padding': 10\n                    },\n                    fn: cancel\n                  }];\n                  /**\n                   * 是客户域和项目域进行特殊处理不可以编辑\n                   * 韩星 2018-03-15\n                   * @type {boolean}\n                   */\n\n                  var isFlag = (data.modelId == \"301\" || data.modelId == \"302\") && data.layer == \"1\";\n                  var areaList = [{\n                    value: data.province,\n                    label: '所在省',\n                    type: 'select',\n                    composory: true,\n                    placeholder: '',\n                    format: {\n                      label: 'label'\n                    },\n                    abled: isFlag ? true : false,\n                    options: provinces,\n                    maxlength: 32,\n                    right: data.province ? true : false,\n                    onChange: function onChange(event) {\n                      areaList[2].value = \"\";\n                      areaList[2].options = []; // areaList[2].right = false;\n\n                      if (event.value == \"\") {\n                        areaList[1].abled = true;\n                        event.right = false;\n                      } else {\n                        if (cityDics[event.value.id]) {\n                          areaList[1].options = cityDics[event.value.id];\n                        }\n\n                        areaList[1].abled = false;\n                        event.right = true;\n                      }\n                    }\n                  }, {\n                    value: data.city,\n                    label: '所在市',\n                    type: 'select',\n                    composory: false,\n                    placeholder: '',\n                    format: {\n                      label: 'label'\n                    },\n                    abled: isFlag ? true : false,\n                    // abled: arr[0] ? false : true,\n                    right: true,\n                    // right: data.city ? true : false,\n                    options: cityDics[data.provinceId],\n                    maxlength: 32,\n                    onChange: function onChange(event) {\n                      areaList[2].value = \"\"; // areaList[2].right = false;\n\n                      if (event.value == \"\") {\n                        areaList[2].abled = true;\n                        areaList[2].options = [];\n                        event.right = false;\n                      } else {\n                        if (event.value && districtDics[event.value.id]) {\n                          areaList[2].options = districtDics[event.value.id];\n                        }\n\n                        areaList[2].abled = false;\n                        event.right = true;\n                      }\n                    }\n                  }, {\n                    value: data.county,\n                    label: '区/县',\n                    type: 'select',\n                    composory: false,\n                    placeholder: '',\n                    format: {\n                      label: 'label'\n                    },\n                    abled: isFlag ? true : false,\n                    right: true,\n                    // right: data.county ? true : false,\n                    options: districtDics[data.cityId],\n                    maxlength: 32,\n                    onChange: function onChange(event) {\n                      if (event.value == \"\") {\n                        event.right = false;\n                      } else {\n                        event.right = true;\n                      }\n                    }\n                  }];\n                  scope.dialog = {\n                    title: {\n                      label: '管理域信息'\n                    },\n                    input: [{\n                      value: data.name,\n                      type: 'input',\n                      label: '域名称',\n                      maxlength: 32,\n                      composory: true,\n                      disabled: isFlag ? true : false,\n                      right: true,\n                      placeholder: '填写域名称',\n                      onChange: function onChange(event) {\n                        if (event.value == \"\") {\n                          event.error = \"域名称不可为空\";\n                          event.right = false;\n                        }\n                        /** else if (namelist.indexOf(event.value) != -1) {\n                        event.error = \"此域已被占用\";\n                        event.right = false;\n                        } */\n                        else {\n                            event.error = null;\n                            event.right = true;\n                          }\n                      }\n                    }, {\n                      value: data.values.number,\n                      label: '序号 ',\n                      type: 'input',\n                      placeholder: '填填写序号',\n                      right: true,\n                      abled: true\n                    }, {\n                      value: data.externalDevId,\n                      label: '编码 ',\n                      type: 'input',\n                      composory: true,\n                      placeholder: '填填写编码',\n                      right: true,\n                      onChange: function onChange(event) {\n                        if (event.value == \"\") {\n                          event.error = \"编码不可为空\";\n                          event.right = false;\n                        } else {\n                          event.error = null;\n                          event.right = true;\n                        }\n                      }\n                    }, areaList[0], areaList[1], areaList[2], {\n                      value: data.description,\n                      label: '域描述',\n                      type: 'textarea',\n                      right: true,\n                      maxlength: 200,\n                      placeholder: '填写域描述'\n                    }],\n                    fnlist: fnlist\n                  };\n                  ngDialog.open({\n                    template: '../partials/dialogue/common_dia.html',\n                    className: 'ngdialog-theme-plain',\n                    scope: scope\n                  });\n\n                  var ready = function ready() {\n                    scope.edit({\n                      event: data\n                    });\n                  };\n\n                  scope.$apply(ready);\n                };\n\n                var userClick = function userClick() {\n                  var ready = function ready() {\n                    scope.user({\n                      event: data\n                    });\n                  };\n\n                  scope.$apply(ready);\n                };\n\n                var intro = $('<div></div>').css(\"padding\", \"2px 10px\").css(\"top\", \"0px\").css(\"right\", \"32px\").css(\"pointer-events\", \"none\").css(\"border-radius\", \"2px\").css(\"background-color\", \"#000\").css(\"position\", \"absolute\").css(\"font-weight\", \"bold\").css(\"width\", \"80px\").css(\"color\", \"#fff\");\n\n                var addenter = function addenter() {\n                  intro.text(\"创建子域\");\n                  addBtn.append(intro);\n                };\n\n                var addleave = function addleave() {\n                  intro.remove();\n                };\n\n                var removeenter = function removeenter() {\n                  intro.text(\"删除\");\n                  removeBtn.append(intro);\n                };\n\n                var removeleave = function removeleave() {\n                  intro.remove();\n                };\n\n                var editenter = function editenter() {\n                  intro.text(\"编辑\");\n                  editBtn.append(intro);\n                };\n\n                var editleave = function editleave() {\n                  intro.remove();\n                };\n\n                removeBtn.on(\"click\", removeClick);\n                addBtn.on(\"click\", addClick);\n                addBtn.on(\"mouseenter\", addenter);\n                addBtn.on(\"mouseleave\", addleave);\n                removeBtn.on(\"mouseenter\", removeenter);\n                removeBtn.on(\"mouseleave\", removeleave);\n                editBtn.on(\"click\", editClick);\n                editBtn.on(\"mouseenter\", editenter);\n                editBtn.on(\"mouseleave\", editleave); //userBtn.on(\"click\", userClick);\n\n                target.append(dom);\n\n                if (type != 'search') {\n                  inner.append(btn).append(userIcon);\n                }\n\n                ;\n                inner.append(text).append(infoBtn);\n                dom.animate({\n                  \"opacity\": 1,\n                  \"max-height\": \"50px\"\n                }, 300);\n                cover.animate({\n                  \"opacity\": \"0\"\n                }, 700, function () {\n                  cover.remove();\n                });\n\n                if (data.hasOwnProperty(\"children\")) {\n                  userIcon.css(\"display\", \"none\");\n                  btn.css(\"display\", \"block\");\n                  dom.css(\"font-weight\", \"bold\"); //dom.css(\"background-color\", \"#eee\");\n\n                  if (data.show = false) {\n                    dom.css(\"max-height\", 0);\n                  }\n\n                  ;\n                  children = $(\"<div></div>\").css(\"overflow\", \"hidden\");\n\n                  var hasChild = function hasChild(data, target) {\n                    var traverse = function traverse(data) {\n                      if (data == target) {\n                        return true;\n                      } else if (data.hasOwnProperty(\"children\")) {\n                        for (var i in data.children) {\n                          if (traverse(data.children[i])) {\n                            return true;\n                          }\n                        }\n\n                        return false;\n                      } else {\n                        return false;\n                      }\n                    };\n\n                    return traverse(data);\n                  };\n\n                  if (type == 'search') {\n                    icon.removeClass().addClass(\"glyphicon glyphicon-minus\");\n                  } else if (type == 'highlight') {\n                    if (hasChild(data, searchlist) && data != searchlist) {\n                      icon.removeClass().addClass(\"glyphicon glyphicon-minus\");\n                    } else {\n                      children.css(\"max-height\", 0);\n                      icon.removeClass().addClass(\"glyphicon glyphicon-plus\");\n                    }\n\n                    ;\n                  } else {\n                    if (depth > 1) {\n                      children.css(\"max-height\", 0);\n                      icon.removeClass().addClass(\"glyphicon glyphicon-plus\");\n                    }\n                  }\n\n                  target.append(children);\n\n                  for (var i in data.children) {\n                    traverse(children, data.children[i], depth, btn, removeBtn, dom, userIcon, data.children);\n                  }\n\n                  removeBtn.prop(\"disabled\", true);\n                  removeBtn.css(\"color\", \"#aaa\"); //removeBtn.css(\"display\", \"none\");\n\n                  btn.on(\"click\", foldClick);\n                } else {\n                  userIcon.css(\"display\", \"inline\");\n                  btn.css(\"display\", \"none\");\n                  removeBtn.removeAttr(\"disabled\");\n                  removeBtn.css(\"color\", \"#dd695c\"); //removeBtn.css(\"display\", \"inline\");\n                }\n\n                if (!parentData) {// dom.css(\"background-color\", \"#eee\");\n                } else {\n                  inner.append(removeBtn).append(editBtn);\n                }\n\n                inner.append(addBtn);\n                dom.append(inner);\n                dom.append(cover);\n              };\n\n              if (data instanceof Array) {\n                for (var i in data) {\n                  traverse($(element), data[i], -1);\n                }\n              } else {\n                traverse($(element), data, -1);\n              }\n\n              if (!searchFound) {\n                var error = $(\"<div></div>\").text(\"没有符合条件的记录。\").css(\"line-height\", \"50px\").css(\"text-align\", \"center\");\n                $(element).append(error);\n              }\n            };\n\n            if (n != undefined) {\n              scope.$on(\"SEARCHDATA\", function (event, data) {\n                render(n, \"search\", data);\n              });\n              scope.$on(\"HIGHLIGHTDATA\", function (event, data) {\n                render(n, 'highlight', data);\n              });\n              scope.$on(\"RENDERDATA\", function (event, data) {\n                render(n, 'normal', data);\n              });\n              render(n);\n            }\n          };\n\n          scope.$watch(\"ngModel\", ngModelWatcher);\n        };\n\n        timeout(ready);\n      }\n    };\n  }]);\n  directives.initDirective('domainUserTable', ['$timeout', '$compile', 'dialogue', 'userEnterpriseService', function ($timeout, $compile, dialogue, userEnterpriseService) {\n    return {\n      restrict: 'A',\n      controller: ['$scope', '$element', '$attrs', function ($scope, $element, $attrs) {\n        var enterpriseUser;\n        var domMain = $element;\n        var table;\n        var isEditing = false;\n        var checkbox;\n        $scope.$on(Event.DOMAININFOSINIT, function (event, args) {\n          if (table) {\n            table.destroy();\n          }\n\n          checkbox = $(\"<input type='checkbox'/>\");\n          checkbox.on(\"click\", function (event) {\n            event.stopPropagation();\n\n            if (checkbox.prop('checked')) {\n              if ($(domMain).find(\"tbody tr\").hasClass(\"select\") == false) {\n                $(domMain).find(\"tbody tr\").addClass(\"selected\");\n              }\n\n              $(domMain).find(\"tbody input[type*=checkbox]\").prop(\"checked\", true);\n            } else {\n              $(domMain).find(\"tbody tr\").removeClass(\"selected\");\n              $(domMain).find(\"tbody input[type*=checkbox]\").removeAttr(\"checked\");\n            }\n          });\n          isEditing = false;\n\n          for (var i in args.data) {\n            args.data[i].select = false;\n          }\n\n          table = domMain.DataTable({\n            dom: '<\"row\"<\"col-sm-12\"<\"special-btn\">>><\"row\"<\"clo-sm-12\">>t<\"row\"<\"col-sm-2\"i><\"col-sm-2\"l><\"col-sm-8\"p>>',\n            language: $.ProudSmart.datatable.language,\n            \"autoWidth\": false,\n            \"data\": args.data,\n            \"order\": [1, \"desc\"],\n            columns: [{\n              title: \"\",\n              data: \"select\",\n              type: \"\"\n            }, {\n              title: \"用户名称\",\n              data: \"userName\"\n            }, {\n              title: \"邮箱\",\n              data: \"emailAddress\"\n            }, {\n              title: \"手机\",\n              data: \"mobilePhone\"\n            }, $.ProudSmart.datatable.optionCol1],\n            \"initComplete\": function initComplete(setting) {\n              domMain.find('th').eq(0).children().remove();\n              domMain.find('th').eq(0).append(checkbox);\n            },\n            columnDefs: [{\n              \"targets\": 0,\n              \"width\": 14,\n              \"data\": \"userName\",\n              \"orderable\": false,\n              \"render\": function render(data, type, full) {\n                var str = '<input type=\"checkbox\" style=\"pointer-events: none;\"/>';\n                return str;\n              }\n            }, {\n              \"targets\": 1,\n              \"data\": \"userName\",\n              \"render\": function render(data, type, full) {\n                /**\n                 var str = '<select id=\"userDomainName\" name=\"userName\" class=\"combobox form-control input-sm\">' +\n                 '<option value=\"\">请选择用户</option>';\n                 var argData = args.data;\n                 var enterpriseData = $scope.enterpriseUser;\n                 for (var i = 0; i < enterpriseData.length; i++) {\n                    var index = -1;\n                    for (var j = 0; j < argData.length; ++j) {\n                      if (argData[j].userID == enterpriseData[i].userID) {\n                        index = j;\n                      }\n                    }\n                    if (index == -1) {\n                      str += '<option value=\"' + enterpriseData[i].userID + '\">' + escape(enterpriseData[i].userName) + '</option>';\n                    }\n                  }\n                 str += '</select>';\n                  if (full.isEdit == 2 && type == \"display\") {\n                  return str;\n                } else {\n                  return data;\n                }\n                 */\n                return data;\n              }\n            }, {\n              \"targets\": 3,\n              \"data\": 'mobilePhone',\n              \"render\": function render(data, type, full) {\n                if (data == null) {\n                  return \"\";\n                } else {\n                  return data;\n                }\n              }\n            }, {\n              \"targets\": 4,\n              \"data\": \"option\",\n              \"render\": function render(data, type, full) {\n                var str = \"<div class='btn-group btn-group-sm'>\";\n                str += \"<a id='del-btn' class='btn btn-default' ><i class='fa fa-minus hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'>移出</span></a>\";\n                /**\n                 if (full.isEdit == 2) {\n                  str += \"<a id='save-btn' class='btn btn-default' ><i class='fa fa-save hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 保存</span></a>\"\n                  str += \"<a id='cancel-btn' class='btn btn-default' ><i class='fa fa-times hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 取消</span></a>\"\n                } else {\n                  if($scope.selectedDomainitem.domainPath != full.domainPath){\n                    str += \"<a id='del-btn' class='btn btn-default' ><i class='fa fa-minus hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 删除</span></a>\"\n                  }\n                }\n                 */\n\n                str += \"</div>\";\n                return str;\n              }\n            }]\n          });\n        });\n        /**\n         * 监听表格初始化后，添加按钮\n         */\n\n        domMain.on('init.dt', function () {\n          var queryFormat = [{\n            title: \"用户名称\",\n            data: \"userName\",\n            type: \"input\"\n          }, {\n            title: \"邮箱\",\n            data: \"emailAddress\",\n            type: \"input\"\n          }, {\n            title: \"手机\",\n            data: \"mobilePhone\",\n            type: \"input\"\n          }];\n\n          var addClick = function addClick(event) {\n            var run = function run(enterpriseUser) {\n              var confirm = function confirm(event) {\n                ngDialog.close();\n                var username = event.input[0].value;\n                var email = event.input[1].value;\n                var cellphone = event.input[2].value;\n              };\n\n              var cancel = function cancel() {\n                ngDialog.close();\n              };\n\n              var fnlist = [{\n                label: '确定',\n                icon: 'btn btn-success',\n                style: {\n                  width: '50%',\n                  'border-radius': 0,\n                  'font-size': '18px',\n                  'font-weight': 'bold',\n                  'padding': 10\n                },\n                fn: confirm\n              }, {\n                label: '取消',\n                icon: 'btn btn-default',\n                style: {\n                  width: '50%',\n                  'border-radius': 0,\n                  'font-size': '18px',\n                  'font-weight': 'bold',\n                  'padding': 10\n                },\n                fn: cancel\n              }];\n              scope.dialog = {\n                type: \"list\",\n                title: {\n                  label: '添加域用户'\n                },\n                input: [{\n                  value: enterpriseUser[0],\n                  type: \"select\",\n                  options: enterpriseUser,\n                  composory: true,\n                  label: '选择用户',\n                  onChange: function onChange(event) {\n                    console.log(event);\n                  }\n                }, {\n                  value: 'example@example.com',\n                  type: \"input\",\n                  label: '邮箱',\n                  placeholder: '填写邮箱'\n                }, {\n                  value: '12345678',\n                  type: \"input\",\n                  label: '手机',\n                  placeholder: '填写手机'\n                }],\n                fnlist: fnlist\n              };\n            };\n\n            if (enterpriseUser) {\n              run(enterpriseUser);\n            } else {\n              userEnterpriseService.queryEnterpriseUser(function (event) {\n                if (event.code == 0) {\n                  enterpriseUser = event.data;\n                  run(enterpriseUser);\n                }\n              });\n            }\n          };\n\n          var parentDom = $(\".special-btn\").parent();\n\n          var createBtn = function createBtn(cls, subcls, text) {\n            var button = $(\"<button></button>\").addClass(cls);\n            var i = $(\"<i></i>\").addClass(subcls);\n            var span = $(\"<span></span>\").addClass(\"hidden-sm\").text(text);\n            i.append(span);\n            button.append(i);\n            return button;\n          };\n\n          var createQuary = function createQuary(queryFormat) {\n            var inx = 0;\n            var queryDom = $(\"<div></div>\").addClass(\"combined-query pull-right\");\n            var btnGroup = $(\"<div></div>\").addClass(\"btn-group\");\n            var button = $(\"<button></button>\").addClass(\"btn btn-default btn-sm dropdown-toggle\").css(\"margin\", \"2px\");\n            var text = $(\"<span></span>\").text(\"查询条件\");\n            var drop = $(\"<span></span>\").addClass(\"caret\");\n            var ul = $(\"<ul></ul>\").addClass(\"dropdown-menu\").css(\"cursor\", \"pointer\");\n            var inputWrap = $(\"<div></div>\").css(\"display\", \"inline-block\").css(\"margin\", \"2px\");\n            var searchIcon = $(\"<i></i>\").addClass(\"fa fa-search\");\n            var searchText = $(\"<span></span>\").text(\"查询\");\n            var searchBtn = $(\"<button></button>\").addClass(\"btn btn-primary btn-sm\").css(\"margin\", \"2px\");\n\n            var createInput = function createInput(dt) {\n              if (dt.type == \"input\") {\n                return $(\"<input />\").addClass(\"form-control\").css(\"height\", \"30px\").css(\"padding\", \"2px\");\n              }\n            };\n\n            searchBtn.append(searchIcon).append(searchText);\n            inputWrap.append(createInput(queryFormat[inx]));\n            button.append(text).append(drop);\n            button.on(\"click\", function (event) {\n              if (btnGroup.hasClass(\"open\")) {\n                btnGroup.removeClass(\"open\");\n              } else {\n                btnGroup.addClass(\"open\");\n              }\n            });\n            btnGroup.append(button).append(ul);\n            queryDom.append(btnGroup).append(inputWrap).append(searchBtn);\n\n            var createLi = function createLi(elem) {\n              var li = $(\"<li></li>\");\n              var a = $(\"<a></a>\").text(elem.title);\n              li.append(a);\n              li.on(\"click\", function (event) {\n                text.text(elem.title);\n                btnGroup.removeClass(\"open\");\n              });\n              return li;\n            };\n\n            for (var i in queryFormat) {\n              ul.append(createLi(queryFormat[i]));\n            }\n\n            ;\n            return queryDom;\n          };\n\n          var addBtn = createBtn(\"btn btn-primary btn-sm\", \"fa fa-plus\", \"添加域用户\").css(\"margin\", \"2px\");\n          var deleteBtn = createBtn(\"btn btn-default btn-sm\", \"fa fa-plus\", \"移除\").css(\"margin\", \"2px\");\n          var queryPart = createQuary(queryFormat);\n          parentDom.append(addBtn).append(deleteBtn).append(queryPart);\n          addBtn.on(\"click\", addClick);\n          $compile(parentDom)($scope);\n        });\n        domMain.on('click', 'td', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          var rowData = row.data();\n\n          if (rowData) {\n            if ($(this).context.cellIndex == 4 && rowData.isEdit == 0) {\n              return;\n            }\n\n            if (rowData.isEdit == 1) {}\n          }\n        });\n        domMain.on('click', 'tbody tr', function (e) {\n          e.preventDefault();\n          $(this).toggleClass('selected');\n\n          if ($(this).hasClass('selected')) {\n            $(this).find(\"input[type*=checkbox]\").prop(\"checked\", true);\n          } else {\n            $(this).find(\"input[type*=checkbox]\").removeAttr(\"checked\");\n          }\n\n          var selected = table.rows('.selected')[0].length;\n          var total = table.rows()[0].length;\n\n          if (selected == total) {\n            checkbox.prop(\"checked\", true);\n          } else {\n            checkbox.removeAttr(\"checked\");\n          }\n        });\n        domMain.on('click', '#save-btn', function (e) {\n          e.stopPropagation();\n          var tr = $(this).closest('tr');\n          var checkPass = true;\n          var selectRow = table.row('.shown');\n\n          if (checkPass) {\n            isEditing = false;\n            $scope.doAction('saveUserToDomain', selectRow.data());\n          }\n        });\n        domMain.on('click', '#cancel-btn', function (e) {\n          e.stopPropagation();\n          isEditing = false;\n          var selectRow = table.row('.shown');\n          $scope.doAction('cancel');\n        });\n        domMain.on('click', '#del-btn', function (e) {\n          console.log(e);\n          e.stopPropagation();\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          $scope.doAction('removeDomain', row.data());\n        });\n        domMain.on('click', '#changeDomain-btn', function (e) {\n          e.preventDefault();\n          isEditing = false;\n\n          if (!isEditing) {\n            isEditing = true;\n            var tr = $(this).closest('tr');\n            var row = table.row(tr);\n            row.data().isEdit = 1;\n          }\n        });\n        domMain.on('click', '#removeDomain-btn', function (e) {\n          //e.preventDefault();\n          isEditing = false;\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          var selectRow = table.row('.shown');\n          $scope.doAction('removeDomain', row.data());\n        });\n      }]\n    };\n  }]);\n  directives.initDirective('domainCmdbTable', ['$timeout', '$compile', '$filter', function ($timeout, $compile, $filter) {\n    return {\n      restrict: 'A',\n      controller: ['$scope', '$element', '$attrs', function ($scope, $element, $attrs) {\n        var domMain = $element;\n        var table;\n        var isEditing = false;\n        $scope.$on(Event.DOMAINDEVICESINIT, function (event, args) {\n          if (table) {\n            table.destroy();\n          }\n\n          isEditing = false;\n          table = domMain.DataTable({\n            dom: '<\"row\"<\"col-sm-6\"<\"special-btn\">><\"col-sm-6\"f>><\"row\"<\"clo-sm-12\">>t<\"row\"<\"col-sm-2\"i><\"col-sm-2\"l><\"col-sm-8\"p>>',\n            language: directives.datatable.language,\n            data: args.data,\n            columns: [{\n              data: \"id\",\n              title: \"编码\"\n            }, {\n              data: \"label\",\n              title: \"名称\"\n            }, {\n              data: \"createTime\",\n              title: \"上线时间\"\n            }, {\n              data: \"onlineStatus\",\n              title: \"在线状态\"\n            }, {\n              data: \"health\",\n              title: \"健康度\",\n              visible: false\n            }, {\n              data: \"domainPath\",\n              title: \"管理域\"\n            }, {\n              data: \"option\",\n              orderable: false,\n              title: \"操作\",\n              width: \"120px\"\n            }],\n            columnDefs: [{\n              targets: 2,\n              data: \"createTime\",\n              render: function render(data, type, full) {\n                // 返回自定义内容\n                var str = $filter('date')(data, 'yyyy-MM-dd HH:mm:ss'); //                var str = \"<date-label value=\" + data + \" format='yyyy-MM-dd HH:mm:ss'>\";\n\n                return str;\n              }\n            }, {\n              targets: 1,\n              data: \"label\",\n              render: function render(data, type, full) {\n                // 返回自定义内容    \n                return escape(data);\n              }\n            }, {\n              \"targets\": 3,\n              \"data\": \"onlineStatus\",\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                return \"<span class='label \" + (data == 'online' ? \"label-primary\" : \"label-warning\") + \"'>\" + (data == 'online' ? \"在线\" : \"离线\") + \"</span>\";\n              }\n            }, {\n              \"targets\": 4,\n              \"data\": \"health\",\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                //自定义随机的健康度---等待接口的实现连接\n                data = Math.random() * 100;\n                return \"<div class='progress progress-xs progress-striped active'><div class='progress-bar \" + (data > 90 ? \"progress-bar-success\" : data > 60 ? \"progress-bar-yellow\" : \"progress-bar-red\") + \"' style='width:\" + data + \"%'></div></div>\";\n              }\n            }, {\n              \"targets\": 5,\n              \"data\": \"domainPath\",\n              \"render\": function render(data, type, full) {\n                var str = \"\";\n                var test = $scope.enterpriseDomain;\n                var selectDomain1 = \"\";\n                var selectPath = \"\"; // var selectDomain = $scope.domainListDic[data].name;\n\n                for (var i in $scope.enterpriseDomain) {\n                  if ($scope.enterpriseDomain[i].domainPath == data) {\n                    selectDomain1 = $scope.enterpriseDomain[i].name;\n                    selectPath = $scope.enterpriseDomain[i].domainPath;\n                  }\n                }\n\n                if (full.isEdit == 2 && type == \"display\") {\n                  $scope.deviceIdTree(full.id);\n\n                  if (data != null && data != \"\") {\n                    for (var i in $scope.domainsAry) {\n                      if ($scope.domainsAry[i].domainPath == data) {\n                        str += \"<input name='domainPath' domain-Picker class='form-control input-sm' type='text' value='\" + selectDomain1 + \"' domainPath='\" + selectPath + \"'>\";\n                      }\n                    }\n                  }\n\n                  if (!str) {\n                    str += \"<input name='domainPath'  domain-Picker class='form-control input-sm' type='text' domainPath='' value='请选择...'>\";\n                  }\n                } else {\n                  str += selectDomain1;\n                }\n\n                return str;\n              }\n            }, {\n              \"targets\": 6,\n              \"data\": \"option\",\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                var str = \"<div class='btn-group btn-group-sm'>\";\n\n                if (full.isEdit == 2) {\n                  str += \"<a id='save-btn' class='btn btn-default' ><i class='fa fa-save hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 保存</span></a>\";\n                  str += \"<a id='cancel-btn' class='btn btn-default' ><i class='fa fa-times hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 取消</span></a>\";\n                } else {\n                  str += \"<a id='edit-btn' class='btn btn-default' ><i class='fa fa-refresh hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 切换域</span></a>\";\n                }\n\n                str += \"</div>\";\n                return str;\n              }\n            }],\n            rowCallback: function rowCallback(nRow, aData, iDataIndex) {\n              $compile(nRow)($scope);\n            }\n          });\n        });\n        domMain.on('click', '#save-btn', function (e) {\n          e.stopPropagation();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          var rowData = row.data();\n          var domainSelect = $(tr).find('input[name=\"domainPath\"]').attr(\"domainPath\");\n          var domainSelectName = $(tr).find('input[name=\"domainPath\"]').val();\n          rowData['domainPath'] = domainSelect;\n          rowData['domainName'] = domainSelectName;\n          var checkPass = true;\n\n          if (checkPass) {\n            $scope.doAction('saveChangedDomain', rowData, function (flg) {\n              if (flg) {\n                isEditing = false;\n                rowData.isEdit = 0;\n                row.remove().draw();\n              }\n            });\n          }\n        });\n        domMain.on('click', '#edit-btn', function (e) {\n          e.preventDefault();\n\n          if (!isEditing) {\n            isEditing = true;\n            var tr = $(this).closest('tr');\n            var row = table.row(tr);\n            row.data().isEdit = 2;\n            row.cells().invalidate();\n            $compile(tr)($scope);\n          } else {\n            $scope.doAction(\"thresholdMessage\", \"当前有修改中的属性，请先完成该操作\");\n          }\n        });\n        domMain.on('click', '#cancel-btn', function (e) {\n          e.stopPropagation();\n\n          if (isEditing) {\n            isEditing = false;\n            var tr = $(this).closest('tr');\n            var row = table.row(tr);\n            row.data().isEdit = 0;\n            row.cells().invalidate();\n          }\n        });\n      }]\n    };\n  }]);\n});"],"sourceRoot":"/source/"}