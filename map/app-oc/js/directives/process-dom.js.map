{"version":3,"sources":["app-oc/js/directives/process-dom.js"],"names":["define","directives","BootstrapDialog","datatables","initDirective","$timeout","$compile","$filter","growl","restrict","controller","$scope","$element","$attrs","table","domMain","$on","event","args","destroy","empty","DataTable","dom","data","length","$","ProudSmart","datatable","footerdom","language","order","columns","title","optionCol3","columnDefs","targets","render","type","full","isEdit","escape","str","menuitems","on","parentDom","parent","html","e","preventDefault","tr","this","closest","viewInfo","row","location","href","id","rowData","doAction","addViews","tds","parents","children","checkPass","each","i","val","jqob","txt","warning","cell","flg","cells","invalidate","isDel","remove","draw","orderable","width","visible","selectedDitem","canEdit"],"mappings":"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","file":"app-oc/js/directives/process-dom.js","sourcesContent":["define(['directives/directives', 'bootstrap-dialog', 'datatables.net', 'datatables.net-bs', 'datatables.net-select'], function (directives, BootstrapDialog, datatables) {\n  'use strict';\n\n  directives.initDirective('processDesignDom', ['$timeout', '$compile', '$filter', 'growl', function ($timeout, $compile, $filter, growl) {\n    return {\n      restrict: 'A',\n      controller: ['$scope', '$element', '$attrs', function ($scope, $element, $attrs) {\n        var domMain = $element;\n        var table;\n        var isEditing = false;\n        var itemAttrs;\n        $scope.$on(\"PROCESS\", function (event, args) {\n          if (table) {\n            table.destroy();\n            domMain.empty();\n          }\n\n          isEditing = false;\n          table = domMain.DataTable({\n            dom: args.data && args.data.length > 0 ? $.ProudSmart.datatable.footerdom : '',\n            language: $.ProudSmart.datatable.language,\n            data: args.data,\n            order: [[2, \"desc\"]],\n            columns: [{\n              data: \"name\",\n              title: \"流程名称\"\n            }, {\n              data: \"desc\",\n              title: \"描述\"\n            }, {\n              data: \"createTime\",\n              title: \"创建时间\"\n            }, {\n              data: \"updateTime\",\n              title: \"更新时间\"\n            }, {\n              data: \"pulishTime\",\n              title: \"最新发布时间\"\n            }, {\n              data: \"version\",\n              title: \"最新版本号\"\n            }, {\n              data: \"versionCount\",\n              title: \"历史版本数量\"\n            }, $.ProudSmart.datatable.optionCol3],\n            columnDefs: [{\n              targets: 0,\n              data: \"name\",\n              render: function render(data, type, full) {\n                // 返回自定义内容\n                if ((full.isEdit == 2 || full.isEdit == 3) && type == \"display\") return \"<input style='width:100%' class='form-control input-sm' type='text' value='\" + escape(data) + \"'>\";else return escape(data);\n              }\n            }, {\n              targets: 2,\n              data: \"createTime\",\n              render: function render(data, type, full) {\n                // 返回自定义内容\n                var str = $filter('date')(data, 'yyyy-MM-dd HH:mm:ss');\n                return str;\n              }\n            }, {\n              targets: 3,\n              data: \"updateTime\",\n              render: function render(data, type, full) {\n                // 返回自定义内容\n                var str = $filter('date')(data, 'yyyy-MM-dd HH:mm:ss');\n                return str;\n              }\n            }, {\n              targets: 4,\n              data: \"pulishTime\",\n              render: function render(data, type, full) {\n                // 返回自定义内容\n                var str = $filter('date')(data, 'yyyy-MM-dd HH:mm:ss');\n                return str;\n              }\n            }, {\n              targets: 5,\n              data: \"version\",\n              render: function render(data, type, full) {\n                return data;\n              }\n            }, {\n              targets: 1,\n              data: \"desc\",\n              render: function render(data, type, full) {\n                // 返回自定义内容\n                if ((full.isEdit == 2 || full.isEdit == 3) && type == \"display\") return \"<input maxlength='20' style='width:100%' class='form-control input-sm' type='text' value='\" + escape(data) + \"'>\";else return escape(data);\n              }\n            }, {\n              targets: 6,\n              data: \"versionCount\",\n              render: function render(data, type, full) {\n                return escape(data);\n              }\n            }, {\n              targets: 7,\n              data: \"option\",\n              render: function render(data, type, full) {\n                // 返回自定义内容\n                var str = \"<div class='btn-group btn-group-sm'>\";\n\n                if (full.isEdit == 2 || full.isEdit == 3) {\n                  str += \"<button id='save-btn'  class='btn btn-primary' ><i class='fa fa-check hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 保存</span></button>\";\n                  str += \"<button id='cancel-btn'   class='btn btn-default' ><i class='fa fa-trash hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 取消</span></button>\";\n                } else {\n                  if ($scope.menuitems['A01_S19']) {\n                    str += \"<button id='design-btn'  class='btn btn-primary' ><i class='fa fa-edit hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 设计</span></button>\";\n                  }\n\n                  if ($scope.menuitems['A06_S19']) {\n                    str += \"<button id='edit-btn'   class='btn btn-default' ><i class='fa fa-trash hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 编辑</span></button>\";\n                  }\n\n                  if ($scope.menuitems['A01_S19'] || $scope.menuitems['A08_S19'] || $scope.menuitems['A03_S19']) {\n                    str += \"<button type='button' class='btn btn-default dropdown-toggle' data-toggle='dropdown'> 更多<span class='caret'></span></button>\";\n                  }\n\n                  str += \"<ul class='dropdown-menu' role='menu'>\";\n\n                  if ($scope.menuitems['A07_S19']) {\n                    str += \"<li><a role='button'  id='del-btn'>删除</a></li>\";\n                  }\n\n                  if ($scope.menuitems['A08_S19']) {\n                    str += \"<li><a role='button'  id='release-btn'>发布</a></li>\";\n                  }\n\n                  if ($scope.menuitems['A03_S19']) {\n                    str += \"<li><a role='button'  id='history-btn'>历史版本</a></li>\";\n                  }\n\n                  str += \"</ul>\";\n                }\n\n                str += \"</div>\";\n                return str;\n              }\n            }]\n          });\n        });\n        /**\n         * 监听表格初始化后，添加按钮\n         */\n\n        domMain.on('init.dt', function () {\n          var parentDom = $(\".special-btn\").parent();\n          parentDom.html('<a ng-click=\"addViews()\" class=\"btn btn-default btn-sm\"><i class=\"fa fa-plus\"></i><span class=\"hidden-xs\"> 新建流程</span></a>');\n          $compile(parentDom)($scope);\n        });\n        domMain.on('click', '#view-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          var viewInfo = row.data();\n          location.href = \"../app-flowsheet/index.html#/displayView/\" + viewInfo.id;\n        });\n        domMain.on('click', '#design-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          var viewInfo = row.data();\n          location.href = \"../app-flowsheet/index.html#/flow/\" + viewInfo.id;\n        });\n        domMain.on('click', '#copy-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          var rowData = row.data();\n          $scope.doAction(\"view-copy\", rowData);\n        });\n        domMain.on('click', '#edit-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          $scope.addViews(row.data());\n          /*if(!isEditing) {\n            isEditing = true;\n            row.data().isEdit = 2;\n            row.cells().invalidate();\n          }*/\n        });\n        domMain.on('click', '#save-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          var rowData = row.data();\n\n          if (rowData.isEdit == 2 || rowData.isEdit == 3) {\n            var tds = $(this).parents(\"tr\").children();\n            var checkPass = true;\n            $.each(tds, function (i, val) {\n              var jqob = $(val);\n\n              if (i == 0) {\n                if (jqob.children(\"input\").length > 0) {\n                  var txt = jqob.children(\"input\").val();\n\n                  if (!txt) {\n                    growl.warning(\"视图名称不能空\");\n                    checkPass = false;\n                    return false;\n                  }\n                }\n              }\n\n              if (i == 0 || i == 1) {\n                var txt = jqob.children(\"input\").val();\n                jqob.html(txt);\n                table.cell(jqob).data(txt); //修改DataTables对象的数据\n              }\n            });\n          }\n\n          if (checkPass) {\n            $scope.doAction(\"view-save\", rowData, function (flg) {\n              if (flg) {\n                isEditing = false;\n                row.data().isEdit = 0;\n                row.cells().invalidate();\n              }\n            });\n          }\n        });\n        domMain.on('click', '#cancel-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          var rowData = row.data();\n          isEditing = false;\n          row.data().isEdit = 0;\n          row.cells().invalidate();\n        });\n        domMain.on('click', '#del-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          row.data().isDel = true;\n          var rowData = row.data();\n          $scope.doAction(\"attr-delete\", rowData, function (flg) {\n            if (flg) row.remove().draw(false);\n          });\n        });\n        domMain.on('click', '#release-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          row.data().isDel = true;\n          var rowData = row.data();\n          $scope.doAction(\"release\", rowData);\n        });\n        domMain.on('click', '#history-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          row.data().isDel = true;\n          var rowData = row.data();\n          $scope.doAction(\"history\", rowData);\n        });\n      }]\n    };\n  }]);\n  directives.initDirective('processHistory', ['$timeout', '$compile', '$filter', 'growl', function ($timeout, $compile, $filter, growl) {\n    return {\n      restrict: 'A',\n      controller: ['$scope', '$element', '$attrs', function ($scope, $element, $attrs) {\n        var domMain = $element;\n        var table;\n        var isEditing = false;\n        var itemAttrs;\n        $scope.$on(\"PROCESS\" + \"history\", function (event, args) {\n          if (table) {\n            table.destroy();\n            domMain.empty();\n          }\n\n          isEditing = false;\n          table = domMain.DataTable({\n            dom: args.data && args.data.length > 0 ? $.ProudSmart.datatable.footerdom : '',\n            language: $.ProudSmart.datatable.language,\n            data: args.data,\n            order: [[2, \"desc\"]],\n            columns: [{\n              data: \"name\",\n              title: \"视图名称\"\n            }, {\n              data: \"desc\",\n              title: \"描述\"\n            }, {\n              data: \"createTime\",\n              title: \"发布时间\"\n            }, {\n              data: \"version\",\n              title: \"版本号\"\n            }, {\n              data: \"option\",\n              orderable: false,\n              title: \"操作\",\n              width: \"120px\",\n              visible: $scope.selectedDitem && $scope.selectedDitem.canEdit\n            }],\n            columnDefs: [{\n              targets: 0,\n              data: \"name\",\n              render: function render(data, type, full) {\n                // 返回自定义内容\n                if ((full.isEdit == 2 || full.isEdit == 3) && type == \"display\") return \"<input style='width:100%' class='form-control input-sm' type='text' value='\" + escape(data) + \"'>\";else return escape(data);\n              }\n            }, {\n              targets: 2,\n              data: \"createTime\",\n              render: function render(data, type, full) {\n                // 返回自定义内容\n                var str = $filter('date')(data, 'yyyy-MM-dd HH:mm:ss');\n                return str;\n              }\n            }, {\n              targets: 3,\n              data: \"version\",\n              render: function render(data, type, full) {\n                return data;\n              }\n            }, {\n              targets: 1,\n              data: \"desc\",\n              render: function render(data, type, full) {\n                // 返回自定义内容\n                if ((full.isEdit == 2 || full.isEdit == 3) && type == \"display\") return \"<input maxlength='20' style='width:100%' class='form-control input-sm' type='text' value='\" + escape(data) + \"'>\";else return escape(data);\n              }\n            }, {\n              targets: 4,\n              data: \"option\",\n              render: function render(data, type, full) {\n                // 返回自定义内容\n                var str = \"<div class='btn-group btn-group-sm'>\";\n\n                if ($scope.menuitems['A09_S19']) {\n                  str += \"<button id='look-btn'  class='btn btn-primary' ><i class='fa fa-edit hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 查看</span></button>\";\n                }\n\n                if ($scope.menuitems['A10_S19']) {\n                  str += \"<button id='del-btn'   class='btn btn-default' ><i class='fa fa-trash hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 删除</span></button>\";\n                }\n\n                str += \"</div>\";\n                return str;\n              }\n            }]\n          });\n        });\n        domMain.on('click', '#del-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          row.data().isDel = true;\n          var rowData = row.data();\n          $scope.doAction(\"history-delete\", rowData);\n        });\n        domMain.on('click', '#look-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          row.data().isDel = true;\n          var rowData = row.data();\n          location.href = \"../app-flowsheet/index.html#/historyView/\" + rowData.id;\n        });\n      }]\n    };\n  }]);\n  directives.initDirective('processReleaseDom', ['$timeout', '$compile', '$filter', 'growl', function ($timeout, $compile, $filter, growl) {\n    return {\n      restrict: 'A',\n      controller: ['$scope', '$element', '$attrs', function ($scope, $element, $attrs) {\n        var domMain = $element;\n        var table;\n        var isEditing = false;\n        var itemAttrs;\n        $scope.$on(\"PROCESS-RELEASE\", function (event, args) {\n          if (table) {\n            table.destroy();\n          }\n\n          isEditing = false;\n          table = domMain.DataTable({\n            dom: '<\"row\"<\"col-sm-6\"<\"special-btn\">><\"col-sm-6\"f>><\"row\"<\"clo-sm-12\">>t<\"row\"<\"col-sm-2\"i><\"col-sm-2\"l><\"col-sm-8\"p>>',\n            language: directives.datatable.language,\n            data: args.data,\n            columns: [{\n              data: \"name\",\n              title: \"流程名称\"\n            }, {\n              data: \"desc\",\n              title: \"描述\"\n            }, {\n              data: \"createTime\",\n              title: \"创建时间\"\n            }, {\n              data: \"version\",\n              title: \"版本号\"\n            }, {\n              data: \"option\",\n              orderable: false,\n              title: \"操作\",\n              width: \"120px\",\n              visible: $scope.selectedDitem && $scope.selectedDitem.canEdit\n            }],\n            columnDefs: [{\n              targets: 0,\n              data: \"name\",\n              render: function render(data, type, full) {\n                return escape(data);\n              }\n            }, {\n              targets: 2,\n              data: \"createTime\",\n              render: function render(data, type, full) {\n                // 返回自定义内容\n                var str = $filter('date')(data, 'yyyy-MM-dd HH:mm:ss');\n                return str;\n              }\n            }, {\n              targets: 1,\n              data: \"desc\",\n              render: function render(data, type, full) {\n                return escape(data);\n              }\n            }, {\n              targets: 4,\n              data: \"option\",\n              render: function render(data, type, full) {\n                var str;\n                str = '<div class=\"btn-group  btn-group-sm\">' + '<a id=\"del-btn\" class=\"btn btn-default\" ><i class=\"fa fa-close hidden-lg hidden-md hidden-sm\"></i><span class=\"hidden-xs ng-binding\">删除</span></a></div>';\n                return str;\n              }\n            }]\n          });\n        });\n        domMain.on('click', '#del-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          row.data().isDel = true;\n          var rowData = row.data();\n          $scope.doAction(\"attr-delete\", rowData, function (flg) {\n            if (flg) row.remove().draw(false);\n          });\n        });\n      }]\n    };\n  }]);\n});"],"sourceRoot":"/source/"}