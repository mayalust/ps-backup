{"version":3,"sources":["app-oc/js/directives/alert-rules-dom.js"],"names":["define","directives","BootstrapDialog","datatables","initDirective","$timeout","ngDialog","$compile","$filter","growl","restrict","controller","$scope","$element","$attrs","table","domMain","$on","Event","ALERTRULESINIT","event","args","destroy","empty","DataTable","dom","option","length","$","ProudSmart","datatable","footerdom","language","select","data","order","columns","selectCol","title","visible","menuitems","orderable","optionCol3","columnDefs","targets","render","type","full","escape","isEdit","str","i","allModelLists","id","label","nodeIds","nodeName","split","forEach","nodeId","allDeveicesList","push","projectList","projectName","customerDic","text","domainListDic","toString","kpiCode","kpiLists","condition","refValue","unit","myOptionDic","alertClassifyLists","severityStr","severityBg","enabled","rowCallback","nRow","aData","iDataIndex","selected","addClass","removeClass","on","e","preventDefault","tr","this","closest","row","location","href","trim","doAction","returnObj","code","remove","draw","success","rowData","tableRows","rows","nodes","deselect","invalidate","stopPropagation","abledIndex","unabledIndex","target","checked","count","unabled","selectedCount","abled","$apply","attr","prop","self","param","each","selectedDelete","successCount","errorCount","AlertIdsArr","ifGo","failObjTotal","failObj","successObjTotal","successObj","warning","selectedEnable","cells","selectedUnable","Category","index","extend","alertClassifyInfo","open","template","className","scope","kpiTypeInfo","resourceUIService","notificationType","valueCode","allRoles","roleID","roleName","notificationDic","notificationList","item","templates","map","undefined","noticeWay","join","console","log","findNoticeRuleById","ruleTempName","alertInformsInfo","list","personType","state","contact","userObj","callbackFun"],"mappings":"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","file":"app-oc/js/directives/alert-rules-dom.js","sourcesContent":["define(['directives/directives', 'bootstrap-dialog', 'datatables.net', 'datatables.net-bs', 'datatables.net-select'], function (directives, BootstrapDialog, datatables) {\n  'use strict'; //======================================    告警规则     ===========================================\n\n  directives.initDirective('alertRulesTable', ['$timeout', 'ngDialog', '$compile', '$filter', 'growl', function ($timeout, ngDialog, $compile, $filter, growl) {\n    return {\n      restrict: 'A',\n      controller: ['$scope', '$element', '$attrs', function ($scope, $element, $attrs) {\n        var domMain = $element;\n        var table;\n        var ifShow = false;\n        $scope.$on(Event.ALERTRULESINIT + \"_rules\", function (event, args) {\n          if (table) {\n            table.destroy();\n            domMain.empty();\n          }\n\n          table = domMain.DataTable({\n            dom: args.option && args.option[0].length >= 1 ? $.ProudSmart.datatable.footerdom : '',\n            language: $.ProudSmart.datatable.language,\n            select: $.ProudSmart.datatable.select,\n            data: args.option[0],\n            order: [[8, \"desc\"]],\n            columns: [$.ProudSmart.datatable.selectCol, {\n              data: \"title\",\n              title: \"规则名称\"\n            }, {\n              data: \"domain\",\n              title: \"管理域\"\n            }, {\n              data: \"modelId\",\n              title: \"资源类型\"\n            }, {\n              data: \"condition\",\n              title: \"规则条件\"\n            }, {\n              data: \"alertCode\",\n              title: \"告警类别\"\n            }, {\n              data: \"severity\",\n              title: \"告警级别\"\n            }, {\n              data: \"enabled\",\n              title: \"启用\",\n              visible: $scope.menuitems['A13_S45'] ? true : false,\n              orderable: false\n            }, {\n              data: \"risingTime\",\n              title: \"\",\n              visible: false\n            }, $.ProudSmart.datatable.optionCol3],\n            columnDefs: [{\n              \"targets\": 0,\n              \"orderable\": false,\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                if (type == \"display\") {\n                  if (data) {\n                    return '<input class=\"itemCheckBox\" checked type=\"checkbox\">';\n                  } else {\n                    return '<input class=\"itemCheckBox\" type=\"checkbox\">';\n                  }\n                }\n\n                return \"\";\n              }\n            }, {\n              targets: 1,\n              data: \"title\",\n              render: function render(data, type, full) {\n                var returnDate = '';\n                var data = escape(data); // 返回自定义内容    \n\n                if (full.isEdit == 2 && type == \"display\") {\n                  var str = ' <select style=\"width:100%;\" ng-model=\"selEditInfo.customerId\" class=\"form-control select2\" selectdata=\"CustomerList\" select2></select>';\n                } else {}\n\n                return data;\n              }\n            }, {\n              targets: 3,\n              data: \"modelId\",\n              render: function render(data, type, full) {\n                // 返回自定义内容    \n                if (full.isEdit == 2 && type == \"display\") return \"<input style='width:100%' class='form-control input-sm' autocomplete='off' type='text' value='\" + escape(data) + \"'>\";else {\n                  var str = \"\";\n\n                  if (data) {\n                    for (var i in $scope.allModelLists) {\n                      if ($scope.allModelLists[i].id == data) {\n                        str = $scope.allModelLists[i].label;\n                      }\n                    }\n\n                    if (!str) str = \"【未知类型】\";\n\n                    if (full.nodeIds) {\n                      var nodeName = [];\n                      var nodeIdAry = full.nodeIds.split(\",\");\n                      nodeIdAry.forEach(function (nodeId) {\n                        for (var i in $scope.allDeveicesList) {\n                          if (nodeId == $scope.allDeveicesList[i].id) {\n                            nodeName.push($scope.allDeveicesList[i].label);\n                            break;\n                          }\n                        }\n\n                        for (var i in $scope.projectList) {\n                          if (nodeId == $scope.projectList[i].id) {\n                            nodeName.push($scope.projectList[i].projectName);\n                            break;\n                          }\n                        }\n\n                        if ($scope.customerDic[nodeId]) {\n                          nodeName.push($scope.customerDic[nodeId].text);\n                        }\n\n                        if ($scope.domainListDic[nodeId]) {\n                          nodeName.push($scope.domainListDic[nodeId].label);\n                        }\n                      });\n                      str = \"在\" + str + \"的<b>[\" + nodeName.toString() + \"]</b>有效\";\n                    }\n                  }\n\n                  return str;\n                }\n              }\n            }, {\n              targets: 2,\n              data: \"domain\",\n              render: function render(data, type, full) {\n                var str = \"无权限查看\";\n\n                if (data && $scope.domainListDic[data]) {\n                  str = $scope.domainListDic[data].label;\n                }\n\n                return str;\n              }\n            }, {\n              targets: 4,\n              data: \"condition\",\n              render: function render(data, type, full) {\n                var str = \"\"; //kpi值\n\n                if (full.kpiCode && $scope.kpiLists[full.kpiCode]) {\n                  str += $scope.kpiLists[full.kpiCode].label;\n                } else if (full.kpiCode && !$scope.kpiLists[full.kpiCode]) {\n                  str += \"无kpi指标\";\n                } //条件\n\n\n                for (var i in $scope.condition) {\n                  if (full.condition == $scope.condition[i][\"value\"]) {\n                    if ($scope.condition[i][\"name\"] == \"表达式\") {\n                      str += \"满足条件：\";\n                    } else {\n                      str += $scope.condition[i][\"name\"];\n                    }\n\n                    break;\n                  }\n                }\n\n                str += full.refValue;\n\n                if ($scope.kpiLists && $scope.kpiLists[full.kpiCode] && $scope.kpiLists[full.kpiCode]['unit']) {\n                  var unit = $scope.kpiLists[full.kpiCode]['unit'];\n                  str += $scope.myOptionDic ? $scope.myOptionDic[unit] : \"\";\n                } else {\n                  str += \"\";\n                }\n\n                return str;\n              }\n            }, {\n              targets: 5,\n              data: \"alertCode\",\n              render: function render(data, type, full) {\n                var str = \"\";\n\n                if (data) {\n                  for (var i in $scope.alertClassifyLists) {\n                    if ($scope.alertClassifyLists[i].id == data) {\n                      str = $scope.alertClassifyLists[i].label;\n                    }\n                  }\n                }\n\n                return str;\n              }\n            }, {\n              targets: 6,\n              data: \"severity\",\n              render: function render(data, type, full) {\n                // 返回自定义内容    \n                if (full.isEdit == 2 && type == \"display\") return \"<input style='width:100%' class='form-control input-sm' autocomplete='off' type='text' value='\" + escape(data) + \"'>\";else {\n                  var severityStr = \"无数据\";\n                  var severityBg = \"alerts-warning\";\n\n                  if (data == 4) {\n                    severityStr = \"严重\";\n                    severityBg = \"alerts-critical\";\n                  } else if (data == 3) {\n                    severityStr = \"重要\";\n                    severityBg = \"alerts-major\";\n                  } else if (data == 2) {\n                    severityStr = \"次要\";\n                    severityBg = \"alerts-minor\";\n                  } else if (data == 1) {\n                    severityStr = \"警告\";\n                    severityBg = \"alerts-warning\";\n                  }\n\n                  return \"<span class='label \" + severityBg + \"'>\" + severityStr + \"</span>\";\n                }\n              }\n            }, {\n              targets: 7,\n              data: \"enabled\",\n              visible: $scope.menuitems['A13_S45'] ? true : false,\n              render: function render(data, type, full) {\n                if (type == \"display\") {\n                  if (data) {\n                    return '<input class=\"enabledCheckBox\" checked type=\"checkbox\">';\n                  } else {\n                    return '<input class=\"enabledCheckBox\" type=\"checkbox\">';\n                  }\n                }\n\n                return \"\";\n              }\n            }, {\n              \"targets\": 9,\n              \"data\": \"option\",\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                var str = \"<div class='btn-group btn-group-sm'>\";\n\n                if (full.enabled == true) {\n                  if ($scope.menuitems['A05_S45']) {\n                    str += \"<button id='edit-btn' class='btn btn-primary' disabled='true' ><i class='fa fa-save hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 编辑</span></button>\";\n                  }\n\n                  if ($scope.menuitems['A04_S45']) {\n                    str += \"<button id='del-btn' class='btn btn-default'  disabled='true'><i class='fa fa-save hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 删除</span></button>\";\n                  }\n                } else {\n                  if ($scope.menuitems['A05_S45']) {\n                    str += \"<button id='edit-btn' class='btn btn-primary' ><i class='fa fa-edit hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 编辑</span></button>\";\n                  }\n\n                  if ($scope.menuitems['A04_S45']) {\n                    str += \"<button id='del-btn' class='btn btn-default' ><i class='fa fa-trash hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 删除</span></button>\";\n                  }\n                }\n\n                if ($scope.menuitems['A03_S45'] || $scope.menuitems['A06_S45'] || $scope.menuitems['A12_S45']) {\n                  str += \"<button type='button'  class='btn btn-default dropdown-toggle' data-toggle='dropdown'> 更多<span class='caret'></span></button>\";\n                }\n\n                str += \"<ul class='dropdown-menu' role='menu'>\";\n\n                if ($scope.menuitems['A12_S45']) {\n                  str += \"<li><a role='button' id='view-btn'>查看详情</a></li>\";\n                }\n\n                if ($scope.menuitems['A06_S45']) {\n                  str += \"<li><a role='button' id='copy-btn'>复制规则</a></li>\";\n                }\n\n                if ($scope.menuitems['A03_S45']) {\n                  str += \"<li><a role='button' id='inform-btn'>告警通知</a></li>\";\n                }\n\n                str += \"</ul></div>\";\n                return str;\n              }\n            }],\n            rowCallback: function rowCallback(nRow, aData, iDataIndex) {\n              if (aData.selected) {\n                $(nRow).addClass(\"selected\");\n              } else {\n                $(nRow).removeClass(\"selected\");\n              }\n\n              $compile(nRow)($scope);\n            }\n          });\n        });\n        /**\n         * 监听表格初始化后，添加按钮\n         */\n\n        domMain.on('click', '#edit-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n\n          if (row.data()['nodeIds']) {\n            location.href = \"index.html#/alertRules/special/\" + $.trim(row.data().id) + \"/edit\";\n          } else {\n            location.href = \"index.html#/alertRules/global/\" + $.trim(row.data().id) + \"/edit\";\n          }\n        });\n        domMain.on('click', '#del-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          $scope.doAction('deleteAlertRules', [row.data().id], function (returnObj) {\n            if (returnObj.code == 0) {\n              row.remove().draw(false);\n              growl.success(\"删除成功\", {});\n            }\n          }, true);\n        });\n        domMain.on('click', '#inform-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          var rowData = row.data();\n          location.href = \"index.html#/alertInforms/\" + $.trim(rowData.id);\n        });\n        domMain.on('click', '#view-btn', function (e) {\n          // e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          var rowData = row.data();\n\n          if (row.data()['nodeIds']) {\n            location.href = \"index.html#/alertRules/special/\" + $.trim(row.data().id) + \"/view\";\n          } else {\n            location.href = \"index.html#/alertRules/global/\" + $.trim(row.data().id) + \"/view\";\n          }\n        });\n        domMain.on('click', '#copy-btn', function (e) {\n          // e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          var rowData = row.data();\n          $scope.doAction('copy', row.data(), function (returnObj) {\n            if (returnObj.code == 0) {\n              var tableRows = table.rows({\n                selected: true\n              });\n\n              for (var i = 0; i < tableRows.nodes().length; i++) {\n                var row = table.row(tableRows.nodes()[i]);\n                row.data().selected = false;\n              }\n\n              ;\n              table.rows().deselect();\n              table.rows().invalidate().draw(false);\n            }\n          });\n        });\n        domMain.on('change', '#allselect-btn', function (e) {\n          e.stopPropagation();\n          var abledIndex = 0;\n          var unabledIndex = 0;\n\n          if (e.target.checked) {\n            table.rows().select();\n            var tableRows = table.rows({\n              selected: true\n            });\n\n            for (var i = 0; i < tableRows.nodes().length; i++) {\n              var row = table.row(tableRows.nodes()[i]);\n              row.data().selected = true;\n\n              if (row.data().enabled) {\n                //启用\n                abledIndex++;\n              } else {\n                //停用\n                unabledIndex++;\n              }\n            }\n\n            ;\n\n            if (abledIndex == tableRows.count()) {\n              $scope.unabled = true;\n              $scope.selectedCount = 0;\n            } else if (unabledIndex == tableRows.count()) {\n              $scope.abled = true;\n            } else {\n              $scope.unabled = true;\n              $scope.abled = true;\n              $scope.selectedCount = 0;\n            }\n\n            table.rows().invalidate().draw(false);\n            $scope.$apply();\n          } else {\n            var tableRows = table.rows({\n              selected: true\n            });\n\n            for (var i = 0; i < tableRows.nodes().length; i++) {\n              var row = table.row(tableRows.nodes()[i]);\n              row.data().selected = false;\n            }\n\n            ;\n            table.rows().deselect();\n            table.rows().invalidate().draw(false);\n            $scope.abled = false;\n            $scope.unabled = false;\n            $scope.selectedCount = 0;\n            $scope.$apply();\n          }\n        });\n        domMain.on('change', '.itemCheckBox', function (e) {\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          var abledIndex = 0;\n          var unabledIndex = 0;\n          var tableRows = table.rows({\n            selected: true\n          });\n\n          if (e.target.checked) {\n            row.data().selected = true;\n\n            if (row.data().enabled) {\n              //启用\n              $scope.unabled = true;\n              $scope.selectedCount = 0;\n            } else {\n              $scope.abled = true;\n            }\n          } else {\n            row.data().selected = false;\n            var rows = table.rows();\n\n            for (var i = 0; i < tableRows.nodes().length; i++) {\n              var row = table.row(tableRows.nodes()[i]);\n\n              if (row.data().enabled) {\n                //启用\n                abledIndex++;\n              } else {\n                //停用\n                unabledIndex++;\n              }\n            }\n\n            ;\n\n            if (abledIndex > 0 && unabledIndex == 0) {\n              //说明有启用,无停用\n              $scope.abled = false;\n              $scope.unabled = true;\n              $scope.selectedCount = 0;\n            } else if (unabledIndex > 0 && abledIndex == 0) {\n              //说明有停用,无启用\n              $scope.abled = true;\n              $scope.unabled = false;\n            }\n          }\n\n          if (tableRows.count() != table.rows()[0].length) {\n            $('#allselect-btn').attr('checked', false);\n            $('#allselect-btn').prop('checked', false);\n          } else if (tableRows.count() == table.rows()[0].length) {\n            $('#allselect-btn').attr('checked', true);\n            $('#allselect-btn').prop('checked', true);\n          }\n\n          $scope.$apply();\n        });\n        domMain.on('change', '.enabledCheckBox', function (e) {\n          var self = this;\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          var param = [];\n\n          if (e.target.checked) {\n            row.data().enabled = true;\n            param = [[row.data().id], true];\n          } else {\n            row.data().enabled = false;\n            param = [[row.data().id], false];\n          }\n\n          $scope.doAction(\"AlertEnable\", param, function (returnObj) {\n            if (returnObj.code == 0) {\n              table.rows().invalidate().draw(false);\n\n              if (!e.target.checked) {\n                $(self).prop(\"checked\", false);\n                growl.success(\"停用成功\", {});\n              } else {\n                $(self).attr(\"checked\", true);\n                growl.success(\"启用成功\", {});\n              }\n\n              $(\".itemCheckBox\").each(function () {\n                $(this).attr(\"checked\", false);\n              });\n              $(\"#allselect-btn\").attr(\"checked\", false);\n              table.rows().deselect();\n            } else if (!returnObj) {\n              if (!e.target.checked) {\n                row.data().enabled = true;\n                $(self).prop(\"checked\", true);\n              } else {\n                row.data().enabled = false;\n                $(self).attr(\"checked\", false);\n              }\n            }\n          }, true);\n        }); //多项删除\n\n        $scope.selectedDelete = function () {\n          var tableRows = table.rows({\n            selected: true\n          });\n          var selectedCount = tableRows.count();\n          var nodes = tableRows.nodes();\n\n          if (selectedCount == 0) {\n            growl.warning(\"当前没有选中的告警规则项\", {});\n            return;\n          }\n\n          var successCount = 0;\n          var errorCount = 0;\n          var AlertIdsArr = [];\n          var ifGo = false; // var ifGo = true; //现在由后端判断失败和成功个数，这里就不需要判断ifGo了。故置成true\n\n          for (var i = 0; i < nodes.length; i++) {\n            var row = table.row(nodes[i]);\n            var rowData = row.data();\n\n            if (rowData.id > 0 && !rowData.enabled) {\n              AlertIdsArr.push(rowData.id);\n              successCount++;\n            } else {\n              errorCount++;\n            }\n\n            if (selectedCount == successCount + errorCount) {\n              ifGo = true; // growl.success(\"成功确认\" + successCount + \"个,失败\" + errorCount + \"个\", {});\n            }\n          }\n\n          ;\n\n          if (ifGo) {\n            $scope.doAction(\"deleteAlertRules\", AlertIdsArr, function (returnObj) {\n              if (returnObj.code == 0) {\n                var failObjTotal = returnObj.data.failObj.length;\n                var successObjTotal = returnObj.data.successObj.length;\n                growl.success(\"成功删除\" + successObjTotal + \"个,失败\" + failObjTotal + \"个\", {});\n\n                for (var i = 0; i < nodes.length; i++) {\n                  var row = table.row(nodes[i]);\n\n                  if (!row.data().enabled) {\n                    row.remove().draw(false);\n                  }\n                }\n\n                $(\".itemCheckBox\").each(function () {\n                  $(this).attr(\"checked\", false);\n                });\n                $(\"#allselect-btn\").attr(\"checked\", false);\n                table.rows().deselect();\n              } else if (!returnObj) {\n                $(\".itemCheckBox\").each(function () {\n                  $(this).attr(\"checked\", false);\n                });\n                $(\"#allselect-btn\").attr(\"checked\", false);\n                table.rows().deselect();\n              }\n            });\n          }\n        }; //多项启用\n\n\n        $scope.selectedEnable = function () {\n          var tableRows = table.rows({\n            selected: true\n          });\n          var selectedCount = tableRows.count();\n          var nodes = tableRows.nodes();\n\n          if (selectedCount == 0) {\n            growl.warning(\"当前没有选中的告警规则项\", {});\n            return;\n          }\n\n          var successCount = 0;\n          var errorCount = 0;\n          var AlertIdsArr = [];\n          var ifGo = false; //这是之前前端判断失败成功个数的标志\n          // var ifGo = true; //现在由后端判断失败和成功个数，这里就不需要判断ifGo了。故置成true\n\n          for (var i = 0; i < nodes.length; i++) {\n            var row = table.row(nodes[i]);\n            var rowData = row.data(); // AlertIdsArr.push(rowData.id);\n\n            if (!rowData.enabled) {\n              AlertIdsArr.push(rowData.id);\n              successCount++;\n            } else {\n              errorCount++;\n            }\n\n            if (selectedCount == successCount + errorCount) {\n              ifGo = true; // growl.success(\"成功确认\" + successCount + \"个,失败\" + errorCount + \"个\", {});\n            }\n          }\n\n          ;\n\n          if (ifGo) {\n            $scope.doAction(\"AlertEnable\", [AlertIdsArr, true], function (returnObj) {\n              if (returnObj.code == 0) {\n                var failObjTotal = returnObj.data.failObj.length;\n                var successObjTotal = returnObj.data.successObj.length;\n                growl.success(\"成功启用\" + successObjTotal + \"个,失败\" + failObjTotal + \"个\", {});\n\n                for (var i = 0; i < nodes.length; i++) {\n                  var row = table.row(nodes[i]);\n                  var rowData = row.data();\n                  rowData.enabled = true;\n                  rowData.selected = false;\n                  row.cells().invalidate().draw(false); // var checkedBoxcells = nodes[i].cells;\n                  // var selectcheckBox = nodes[i].cells[checkedBoxcells.length - 2];\n                  // // $(selectcheckBox.children).attr(\"checked\", \"checked\");\n                  // $(selectcheckBox.children).prop(\"checked\", true);\n                }\n\n                $(\"#allselect-btn\").attr(\"checked\", false);\n                table.rows().deselect();\n              } else if (!returnObj) {\n                $(\".itemCheckBox\").each(function () {\n                  $(this).attr(\"checked\", false);\n                });\n                $(\"#allselect-btn\").attr(\"checked\", false);\n                table.rows().deselect();\n              }\n            });\n          }\n        }; //多项停用\n\n\n        $scope.selectedUnable = function () {\n          var tableRows = table.rows({\n            selected: true\n          });\n          var selectedCount = tableRows.count();\n          var nodes = tableRows.nodes();\n\n          if (selectedCount == 0) {\n            growl.warning(\"当前没有选中的告警规则项\", {});\n            return;\n          }\n\n          var successCount = 0;\n          var errorCount = 0;\n          var AlertIdsArr = [];\n          var ifGo = false; //这是之前前端判断失败成功个数的标志\n          // var ifGo = true; //现在由后端判断失败和成功个数，这里就不需要判断ifGo了。故置成true\n\n          for (var i = 0; i < nodes.length; i++) {\n            var row = table.row(nodes[i]);\n            var rowData = row.data(); // AlertIdsArr.push(rowData.id);\n\n            if (rowData.enabled) {\n              AlertIdsArr.push(rowData.id);\n              successCount++;\n            } else {\n              errorCount++;\n            }\n\n            if (selectedCount == successCount + errorCount) {\n              ifGo = true;\n            }\n          }\n\n          ;\n\n          if (ifGo) {\n            $scope.doAction(\"AlertEnable\", [AlertIdsArr, false], function (returnObj) {\n              if (returnObj.code == 0) {\n                var failObjTotal = returnObj.data.failObj.length;\n                var successObjTotal = returnObj.data.successObj.length;\n                growl.success(\"成功停用\" + successObjTotal + \"个,失败\" + failObjTotal + \"个\", {});\n\n                for (var i = 0; i < nodes.length; i++) {\n                  var row = table.row(nodes[i]);\n                  var rowData = row.data();\n                  rowData.enabled = false;\n                  rowData.selected = false;\n                  row.cells().invalidate().draw(false);\n                  /*var checkedBoxcells = nodes[i].cells;\n                  var selectcheckBox = nodes[i].cells[checkedBoxcells.length - 2];\n                  $(selectcheckBox.children).removeAttr(\"checked\");*/\n                }\n\n                $(\"#allselect-btn\").attr(\"checked\", false);\n                table.rows().deselect(); // $(\".itemCheckBox\").each(function() {\n                //   $(this).attr(\"checked\", false);\n                // });\n              } else if (!returnObj) {\n                $(\".itemCheckBox\").each(function () {\n                  $(this).attr(\"checked\", false);\n                });\n                $(\"#allselect-btn\").attr(\"checked\", false);\n                table.rows().deselect();\n              }\n            });\n          }\n        };\n      }]\n    };\n  }]); //======================================    告警类别     ===========================================\n\n  directives.initDirective('alertClassifyTable', ['$timeout', 'ngDialog', '$compile', '$filter', 'growl', function ($timeout, ngDialog, $compile, $filter, growl) {\n    return {\n      restrict: 'A',\n      controller: ['$scope', '$element', '$attrs', function ($scope, $element, $attrs) {\n        var domMain = $element;\n        var table;\n        var ifShow = false;\n        $scope.$on(Event.ALERTRULESINIT + \"_classify\", function (event, args) {\n          if (table) {\n            table.destroy();\n            domMain.empty();\n          } // isEditing = false;\n\n\n          table = domMain.DataTable({\n            dom: args.option && args.option[0].length >= 1 ? $.ProudSmart.datatable.footerdom : '',\n            language: $.ProudSmart.datatable.language,\n            select: $.ProudSmart.datatable.select,\n            data: args.option[0],\n            order: [[4, \"desc\"]],\n            columns: [$.ProudSmart.datatable.selectCol, {\n              data: \"label\",\n              title: \"类别名称\"\n            }, {\n              data: \"name\",\n              title: \"告警码\"\n            }, {\n              data: \"description\",\n              title: \"类别描述\"\n            }, {\n              data: \"risingTime\",\n              title: \"\",\n              visible: false\n            }, $.ProudSmart.datatable.optionCol3],\n            columnDefs: [{\n              \"targets\": 0,\n              \"orderable\": false,\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                if (type == \"display\") {\n                  if (data) {\n                    return '<input class=\"itemCheckBox\" checked type=\"checkbox\">';\n                  } else {\n                    return '<input class=\"itemCheckBox\" type=\"checkbox\">';\n                  }\n                }\n\n                return \"\";\n              }\n            }, {\n              targets: 1,\n              data: \"label\",\n              render: function render(data, type, full) {\n                // 返回自定义内容    \n                if (full.isEdit == 2 && type == \"display\") return \"<input style='width:100%' class='form-control input-sm' autocomplete='off' type='text' value='\" + escape(data) + \"'>\";else {\n                  return escape(data);\n                }\n              }\n            }, {\n              targets: 2,\n              data: \"name\",\n              render: function render(data, type, full) {\n                if (data) {\n                  var Category = $scope.Category;\n\n                  for (var i in $scope.Category) {\n                    if (Category[i].index == data) {\n                      return Category[i].label;\n                    }\n                  }\n                }\n\n                return escape(data);\n              }\n            }, {\n              targets: 3,\n              data: \"description\",\n              render: function render(data, type, full) {\n                // 返回自定义内容    \n                if (full.isEdit == 2 && type == \"display\") return \"<input style='width:100%' class='form-control input-sm' autocomplete='off' type='text' value='\" + escape(data) + \"'>\";else {\n                  return escape(data);\n                }\n              }\n            }, {\n              \"targets\": 5,\n              \"data\": \"option\",\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                var str = \"<div class='btn-group btn-group-sm'>\";\n\n                if (full.isEdit == 2) {\n                  str += \"<button id='save-btn' class='btn btn-primary' ><i class='fa fa-save hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 保存</span></button>\";\n                  str += \"<button id='cancel-btn' class='btn btn-default' ><i class='fa fa-save hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 取消</span></button>\";\n                  str += \"</div>\";\n                } else {\n                  if ($scope.menuitems['D03_A02_S45']) {\n                    str += \"<button id='edit-btn' class='btn btn-primary' ><i class='fa fa-edit hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 编辑</span></button>\";\n                  }\n\n                  if ($scope.menuitems['D02_A02_S45']) {\n                    str += \"<button id='del-btn' class='btn btn-default' ><i class='fa fa-trash hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 删除</span></button>\";\n                  }\n\n                  str += \"</div>\";\n                }\n\n                return str;\n              }\n            }],\n            rowCallback: function rowCallback(nRow, aData, iDataIndex) {\n              $compile(nRow)($scope);\n            }\n          });\n        });\n        domMain.on('change', '#allselect-btn', function (e) {\n          e.stopPropagation();\n\n          if (e.target.checked) {\n            table.rows().select();\n            var tableRows = table.rows({\n              selected: true\n            });\n            $scope.selectedCount = tableRows.count();\n            $scope.$apply();\n\n            for (var i = 0; i < tableRows.nodes().length; i++) {\n              var row = table.row(tableRows.nodes()[i]);\n              row.data().selected = true;\n            }\n\n            ;\n            table.rows().invalidate().draw(false);\n          } else {\n            var tableRows = table.rows({\n              selected: true\n            });\n\n            for (var i = 0; i < tableRows.nodes().length; i++) {\n              var row = table.row(tableRows.nodes()[i]);\n              row.data().selected = false;\n            }\n\n            ;\n            table.rows().deselect();\n            $scope.selectedCount = 0;\n            $scope.$apply();\n            table.rows().invalidate().draw(false);\n          }\n        });\n        domMain.on('change', '.itemCheckBox', function (e) {\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n\n          if (e.target.checked) {\n            row.data().selected = true;\n          } else {\n            row.data().selected = false;\n          }\n\n          var tableRows = table.rows({\n            selected: true\n          });\n          $scope.selectedCount = tableRows.count();\n          $scope.$apply();\n\n          if (tableRows.count() != table.rows()[0].length) {\n            $('#allselect-btn').attr('checked', false);\n            $('#allselect-btn').prop('checked', false);\n          } else if (tableRows.count() == table.rows()[0].length) {\n            $('#allselect-btn').attr('checked', true);\n            $('#allselect-btn').prop('checked', true);\n          }\n        });\n        domMain.on('click', '#edit-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          $.extend($scope.alertClassifyInfo, row.data());\n          ngDialog.open({\n            template: '../partials/dialogue/alert_classification_dia.html',\n            className: 'ngdialog-theme-plain',\n            scope: $scope\n          });\n        });\n        domMain.on('click', '#del-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          $scope.doAction('deleteAlertClassify', [row.data().id], function (returnObj) {\n            if (returnObj == 0) {\n              row.remove().draw(false);\n            }\n          });\n        }); //多项删除\n\n        $scope.selectedDelete = function () {\n          var tableRows = table.rows({\n            selected: true\n          });\n          var selectedCount = tableRows.count();\n          var nodes = tableRows.nodes();\n\n          if (selectedCount == 0) {\n            growl.warning(\"当前没有选中的告警类别项\", {});\n            return;\n          }\n\n          var successCount = 0;\n          var errorCount = 0;\n          var AlertIdsArr = [];\n          var ifGo = false;\n\n          for (var i = 0; i < nodes.length; i++) {\n            var row = table.row(nodes[i]);\n            var rowData = row.data();\n\n            if (rowData.id > 0) {\n              AlertIdsArr.push(rowData.id);\n              successCount++;\n            } else {\n              errorCount++;\n            }\n\n            if (selectedCount == successCount + errorCount) {\n              ifGo = true; // growl.success(\"成功确认\" + successCount + \"个,失败\" + errorCount + \"个\", {});\n            }\n          }\n\n          ;\n\n          if (ifGo) {\n            $scope.doAction(\"deleteAlertClassify\", AlertIdsArr, function (returnObj) {\n              if (returnObj == 0) {\n                for (var i = 0; i < nodes.length; i++) {\n                  var row = table.row(nodes[i]);\n                  row.remove().draw(false);\n                }\n\n                $(\".itemCheckBox\").each(function () {\n                  $(this).attr(\"checked\", false);\n                });\n                $(\"#allselect-btn\").attr(\"checked\", false);\n                table.rows().deselect();\n              }\n            });\n          }\n        };\n      }]\n    };\n  }]); //======================================    数据项     ===========================================\n\n  directives.initDirective('kpiTypeTable', ['$timeout', 'ngDialog', '$compile', '$filter', 'growl', function ($timeout, ngDialog, $compile, $filter, growl) {\n    return {\n      restrict: 'A',\n      controller: ['$scope', '$element', '$attrs', function ($scope, $element, $attrs) {\n        var domMain = $element;\n        var table;\n        var ifShow = false;\n        $scope.$on(Event.ALERTRULESINIT + \"_kpitype\", function (event, args) {\n          if (table) {\n            table.destroy();\n            domMain.empty();\n          }\n\n          table = domMain.DataTable({\n            dom: args.option && args.option[0].length >= 1 ? $.ProudSmart.datatable.footerdom : '',\n            language: $.ProudSmart.datatable.language,\n            select: $.ProudSmart.datatable.select,\n            data: args.option[0],\n            order: [[4, \"desc\"]],\n            columns: [$.ProudSmart.datatable.selectCol, {\n              data: \"name\",\n              title: \"数据项\"\n            }, {\n              data: \"label\",\n              title: \"名称\"\n            }, {\n              data: \"unit\",\n              title: \"单位\"\n            }, {\n              data: \"number\",\n              title: \"是否数值\"\n            }, {\n              data: \"type\",\n              title: \"数据分类\"\n            }, {\n              data: \"range\",\n              title: \"取值范围\"\n            }, {\n              data: \"icon\",\n              title: \"图标\"\n            }, $.ProudSmart.datatable.optionCol3],\n            columnDefs: [{\n              \"targets\": 0,\n              \"orderable\": false,\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                if (type == \"display\") {\n                  if (data) {\n                    return '<input class=\"itemCheckBox\" checked type=\"checkbox\">';\n                  } else {\n                    return '<input class=\"itemCheckBox\" type=\"checkbox\">';\n                  }\n                }\n\n                return \"\";\n              }\n            }, {\n              targets: 1,\n              data: \"name\",\n              render: function render(data, type, full) {\n                // 返回自定义内容\n                if (full.isEdit == 2 && type == \"display\") return \"<input style='width:100%' class='form-control input-sm' autocomplete='off' type='text' value='\" + escape(data) + \"'>\";else {\n                  return escape(data);\n                }\n              }\n            }, {\n              targets: 2,\n              data: \"label\",\n              render: function render(data, type, full) {\n                if (data) {\n                  var Category = $scope.Category;\n\n                  for (var i in $scope.Category) {\n                    if (Category[i].index == data) {\n                      return Category[i].label;\n                    }\n                  }\n                }\n\n                return escape(data);\n              }\n            }, {\n              targets: 3,\n              data: \"unit\",\n              render: function render(data, type, full) {\n                // 返回自定义内容\n                if (full.isEdit == 2 && type == \"display\") return \"<input style='width:100%' class='form-control input-sm' autocomplete='off' type='text' value='\" + escape(data) + \"'>\";else {\n                  return escape(data);\n                }\n              }\n            }, {\n              targets: 4,\n              data: \"number\",\n              render: function render(data, type, full) {\n                // 返回自定义内容\n                if (full.isEdit == 2 && type == \"display\") return \"<input style='width:100%' class='form-control input-sm' autocomplete='off' type='text' value='\" + escape(data) + \"'>\";else {\n                  if (data) {\n                    return \"是\";\n                  } else {\n                    return \"否\";\n                  } // return escape(data);\n\n                }\n              }\n            }, {\n              targets: 5,\n              data: \"type\",\n              render: function render(data, type, full) {\n                // 返回自定义内容\n                if (full.isEdit == 2 && type == \"display\") return \"<input style='width:100%' class='form-control input-sm' autocomplete='off' type='text' value='\" + escape(data) + \"'>\";else {\n                  var str = '';\n\n                  if (data == 'kpi') {\n                    str = '测点';\n                  } else if (data == 'fault') {\n                    str = '故障';\n                  }\n\n                  return str;\n                }\n              }\n            }, {\n              targets: 6,\n              data: \"range\",\n              render: function render(data, type, full) {\n                // 返回自定义内容\n                if (full.isEdit == 2 && type == \"display\") return \"<input style='width:100%' class='form-control input-sm' autocomplete='off' type='text' value='\" + escape(data) + \"'>\";else {\n                  return escape(data);\n                }\n              }\n            }, {\n              targets: 7,\n              data: \"icon\",\n              render: function render(data, type, full) {\n                var str = '';\n\n                if (data) {\n                  str = '<div  class=\"btn btn-social-icon btn-bitbucket btn-sm\"><i  class=\"' + data + '\"></i>';\n                }\n\n                return str;\n              }\n            }, {\n              \"targets\": 8,\n              \"data\": \"option\",\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                var str = \"<div class='btn-group btn-group-sm'>\";\n\n                if (full.isEdit == 2) {\n                  str += \"<button id='save-btn' class='btn btn-primary' ><i class='fa fa-save hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 保存</span></button>\";\n                  str += \"<button id='cancel-btn' class='btn btn-default' ><i class='fa fa-save hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 取消</span></button>\";\n                  str += \"</div>\";\n                } else {\n                  if ($scope.menuitems['D03_A02_S45']) {\n                    str += \"<button id='edit-btn' class='btn btn-primary' ><i class='fa fa-edit hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 编辑</span></button>\";\n                  }\n\n                  if ($scope.menuitems['D02_A02_S45']) {\n                    str += \"<button id='del-btn' class='btn btn-default' ><i class='fa fa-trash hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 删除</span></button>\";\n                  }\n\n                  str += \"</div>\";\n                }\n\n                return str;\n              }\n            }],\n            rowCallback: function rowCallback(nRow, aData, iDataIndex) {\n              $compile(nRow)($scope);\n            }\n          });\n        });\n        domMain.on('change', '#allselect-btn', function (e) {\n          e.stopPropagation();\n\n          if (e.target.checked) {\n            table.rows().select();\n            var tableRows = table.rows({\n              selected: true\n            });\n            $scope.selectedCount = tableRows.count();\n            $scope.$apply();\n\n            for (var i = 0; i < tableRows.nodes().length; i++) {\n              var row = table.row(tableRows.nodes()[i]);\n              row.data().selected = true;\n            }\n\n            ;\n            table.rows().invalidate().draw(false);\n          } else {\n            var tableRows = table.rows({\n              selected: true\n            });\n\n            for (var i = 0; i < tableRows.nodes().length; i++) {\n              var row = table.row(tableRows.nodes()[i]);\n              row.data().selected = false;\n            }\n\n            ;\n            table.rows().deselect();\n            $scope.selectedCount = 0;\n            $scope.$apply();\n            table.rows().invalidate().draw(false);\n          }\n        });\n        domMain.on('change', '.itemCheckBox', function (e) {\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n\n          if (e.target.checked) {\n            row.data().selected = true;\n          } else {\n            row.data().selected = false;\n          }\n\n          var tableRows = table.rows({\n            selected: true\n          });\n          $scope.selectedCount = tableRows.count();\n          $scope.$apply();\n\n          if (tableRows.count() != table.rows()[0].length) {\n            $('#allselect-btn').attr('checked', false);\n            $('#allselect-btn').prop('checked', false);\n          } else if (tableRows.count() == table.rows()[0].length) {\n            $('#allselect-btn').attr('checked', true);\n            $('#allselect-btn').prop('checked', true);\n          }\n        });\n        domMain.on('click', '#edit-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          $.extend($scope.kpiTypeInfo, row.data());\n          ngDialog.open({\n            template: '../partials/dialogue/kpi_type_dia.html',\n            className: 'ngdialog-theme-plain',\n            scope: $scope\n          });\n        });\n        domMain.on('click', '#del-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          $scope.doAction('deleteAlertClassify', [row.data().id], function (returnObj) {\n            if (returnObj == 0) {\n              row.remove().draw(false);\n            }\n          });\n        }); //多项删除\n\n        $scope.selectedDelete = function () {\n          var tableRows = table.rows({\n            selected: true\n          });\n          var selectedCount = tableRows.count();\n          var nodes = tableRows.nodes();\n\n          if (selectedCount == 0) {\n            growl.warning(\"当前没有选中的告警类别项\", {});\n            return;\n          }\n\n          var successCount = 0;\n          var errorCount = 0;\n          var AlertIdsArr = [];\n          var ifGo = false;\n\n          for (var i = 0; i < nodes.length; i++) {\n            var row = table.row(nodes[i]);\n            var rowData = row.data();\n\n            if (rowData.id > 0) {\n              AlertIdsArr.push(rowData.id);\n              successCount++;\n            } else {\n              errorCount++;\n            }\n\n            if (selectedCount == successCount + errorCount) {\n              ifGo = true; // growl.success(\"成功确认\" + successCount + \"个,失败\" + errorCount + \"个\", {});\n            }\n          }\n\n          ;\n\n          if (ifGo) {\n            $scope.doAction(\"deleteAlertClassify\", AlertIdsArr, function (returnObj) {\n              if (returnObj == 0) {\n                for (var i = 0; i < nodes.length; i++) {\n                  var row = table.row(nodes[i]);\n                  row.remove().draw(false);\n                }\n\n                $(\".itemCheckBox\").each(function () {\n                  $(this).attr(\"checked\", false);\n                });\n                $(\"#allselect-btn\").attr(\"checked\", false);\n                table.rows().deselect();\n              }\n            });\n          }\n        };\n      }]\n    };\n  }]); //======================================    告警通知     ===========================================\n\n  directives.initDirective('alertInformTable', ['$timeout', 'resourceUIService', 'ngDialog', '$compile', '$filter', 'growl', function ($timeout, resourceUIService, ngDialog, $compile, $filter, growl) {\n    return {\n      restrict: 'A',\n      controller: ['$scope', '$element', '$attrs', function ($scope, $element, $attrs) {\n        var domMain = $element;\n        var table;\n        var ifShow = false;\n        $scope.$on(Event.ALERTRULESINIT + \"_informs\", function (event, args) {\n          if (table) {\n            table.destroy();\n            domMain.empty();\n          }\n\n          table = domMain.DataTable({\n            dom: args.option && args.option[0].length >= 1 ? $.ProudSmart.datatable.footerdom : '',\n            language: $.ProudSmart.datatable.language,\n            select: $.ProudSmart.datatable.select,\n            data: args.option[0],\n            order: [[5, \"desc\"]],\n            columns: [{\n              data: \"selected\",\n              title: \"是否启用\"\n            }, {\n              data: \"ruleName\",\n              title: \"通知名称\"\n            }, {\n              data: \"personType\",\n              title: \"人员类型\"\n            }, {\n              data: \"noticeRole\",\n              title: \"通知角色\"\n            }, {\n              data: \"templates\",\n              title: \"通知方式\"\n            }, {\n              data: \"risingTime\",\n              title: \"\",\n              visible: false\n            }, $.ProudSmart.datatable.optionCol3],\n            columnDefs: [{\n              \"targets\": 0,\n              \"orderable\": false,\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                if (type == \"display\") {\n                  if (data) {\n                    return '<input class=\"itemCheckBox\" checked type=\"checkbox\">';\n                  } else {\n                    return '<input class=\"itemCheckBox\" type=\"checkbox\">';\n                  }\n                }\n\n                return \"\";\n              }\n            }, {\n              targets: 1,\n              data: \"ruleName\",\n              render: function render(data, type, full) {\n                return escape(data);\n              }\n            }, {\n              targets: 2,\n              data: \"personType\",\n              render: function render(data, type, full) {\n                if (data) {\n                  for (var i in $scope.notificationType) {\n                    if ($scope.notificationType[i].valueCode == data) {\n                      return $scope.notificationType[i].label;\n                    }\n                  }\n                } else {\n                  return \"-\";\n                }\n              }\n            }, {\n              targets: 3,\n              data: \"noticeRole\",\n              render: function render(data, type, full) {\n                var str = '-';\n\n                if (data) {\n                  for (var i in $scope.allRoles) {\n                    if ($scope.allRoles[i].roleID == data) {\n                      str = $scope.allRoles[i].roleName;\n                      break;\n                    }\n                  }\n                }\n\n                return str;\n              }\n            }, {\n              targets: 4,\n              data: \"templates\",\n              render: function render(data, type, full) {\n                // 返回自定义内容 \n                var str = \"\",\n                    notificationDic = {};\n                $scope.notificationList.forEach(function (item) {\n                  notificationDic[item.valueCode] = item;\n                });\n\n                if (full.templates) {\n                  str = full.templates.map(function (item) {\n                    return notificationDic[item.noticeWay] == undefined ? '' : notificationDic[item.noticeWay].label;\n                  }).join(' ,');\n                } // if (full.isEdit == 2 && type == \"display\")\n                //   str = \"<input style='width:100%' class='form-control input-sm' autocomplete='off' type='text' value='\" + escape(data) + \"'>\";\n                // else {\n                //   var notificationTypeDic = {};\n                //   var notificationDic = {};\n                //   $scope.notificationType.forEach(function(item) {\n                //     notificationTypeDic[item.valueCode] = item;\n                //   });\n                //   $scope.notificationList.forEach(function(item) {\n                //     notificationDic[item.valueCode] = item;\n                //   });\n                //   str = notificationDic[full.templates.noticeWay].label + \"通知\" + notificationTypeDic[full.personType].label;\n                // }\n\n\n                return str;\n              }\n            }, {\n              \"targets\": 6,\n              \"data\": \"option\",\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                var str = \"<div class='btn-group btn-group-sm'>\";\n\n                if (full.isEdit == 2) {\n                  str += \"<button id='save-btn' class='btn btn-primary' ><i class='fa fa-save hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 保存</span></button>\";\n                  str += \"<button id='cancel-btn' class='btn btn-default' ><i class='fa fa-save hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 取消</span></button>\";\n                  str += \"</div>\";\n                } else {\n                  str += \"<button id='edit-btn' class='btn btn-primary' ><i class='fa fa-edit hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 编辑</span></button>\";\n                  str += \"<button id='del-btn' class='btn btn-default' ><i class='fa fa-trash hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 删除</span></button>\"; // str += \"<button type='button' class='btn btn-default dropdown-toggle' data-toggle='dropdown'> 更多<span class='caret'></span></button>\";\n                  // str += \"<ul class='dropdown-menu' role='menu'>\";\n                  // str += \"<li><a role='button' id='devicelist-btn'>启用</a></li>\";\n                  // str += \"<li><a role='button' id='devicelist-btn'>通知</a></li>\";\n                  // str += \"</ul></div>\";\n\n                  str += \"</div>\";\n                }\n\n                return str;\n              }\n            }],\n            rowCallback: function rowCallback(nRow, aData, iDataIndex) {\n              $compile(nRow)($scope);\n            }\n          });\n        });\n        domMain.on('change', '#allselect-btn', function (e) {\n          e.stopPropagation();\n\n          if (e.target.checked) {\n            table.rows().select();\n            var tableRows = table.rows({\n              selected: true\n            });\n            $scope.selectedCount = tableRows.count();\n            $scope.$apply();\n\n            for (var i = 0; i < tableRows.nodes().length; i++) {\n              var row = table.row(tableRows.nodes()[i]);\n              row.data().selected = true;\n            }\n\n            ;\n            table.rows().invalidate().draw(false);\n          } else {\n            var tableRows = table.rows({\n              selected: true\n            });\n\n            for (var i = 0; i < tableRows.nodes().length; i++) {\n              var row = table.row(tableRows.nodes()[i]);\n              row.data().selected = false;\n            }\n\n            ;\n            table.rows().deselect();\n            $scope.selectedCount = 0;\n            $scope.$apply();\n            table.rows().invalidate().draw(false);\n          }\n        });\n        domMain.on('change', '.itemCheckBox', function (e) {\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n\n          if (e.target.checked) {\n            row.data().selected = true;\n            $scope.doAction(\"enabled\", row.data());\n          } else {\n            row.data().selected = false;\n            $scope.doAction(\"disabled\", row.data());\n          }\n\n          var tableRows = table.rows({\n            selected: true\n          });\n          $scope.selectedCount = tableRows.count();\n          $scope.$apply();\n\n          if (tableRows.count() != table.rows()[0].length) {\n            $('#allselect-btn').attr('checked', false);\n            $('#allselect-btn').prop('checked', false);\n          } else if (tableRows.count() == table.rows()[0].length) {\n            $('#allselect-btn').attr('checked', true);\n            $('#allselect-btn').prop('checked', true);\n          }\n        });\n        domMain.on('click', '#edit-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          console.log(row.data().templates);\n\n          var callbackFun = function callbackFun(data) {\n            $.extend($scope.alertInformsInfo, data);\n\n            for (var i in data.templates) {\n              if (typeof data.templates[i] == 'boolean') {\n                delete data.templates[i];\n              }\n            }\n\n            $scope.templates.forEach(function (list) {\n              //设置不同人员类型的，为选中状态\n              if (list.personType != data.personType) {\n                list.state = true;\n                list.contact = \"\";\n              } else if (list.personType == data.personType) {\n                //只判断相同人员类型的状态\n                var userObj = data.templates;\n                userObj.forEach(function (item) {\n                  if (!userObj[list.noticeWay]) {\n                    if (list.noticeWay == item.noticeWay && !userObj[list.noticeWay]) {\n                      if (!userObj[item.noticeWay]) {\n                        userObj[list.noticeWay] = true;\n                        list.state = true;\n                        list.contact = item.contact;\n                      }\n                    } else {\n                      // if (!userObj[item.noticeWay]) {\n                      userObj[list.noticeWay] = false;\n                      list.state = false;\n                      list.contact = \"\"; // }\n                    }\n                  }\n                });\n              }\n            });\n            ngDialog.open({\n              template: '../partials/dialogue/alert_inform_dia.html',\n              className: 'ngdialog-theme-plain',\n              scope: $scope\n            });\n          };\n\n          resourceUIService.findNoticeRuleById([row.data().id], function (returnObj) {\n            if (returnObj.code == 0) {\n              returnObj.data.ruleTempName = row.data().ruleTempName;\n              callbackFun(returnObj.data);\n            }\n          });\n        });\n        domMain.on('click', '#del-btn', function (e) {\n          e.preventDefault();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr); //        $scope.doAction('deleteAlertForm', [row.data().id], function(returnObj) { 老版本删除的参数是ID\n\n          $scope.doAction('deleteAlertForm', row.data(), function (returnObj) {\n            if (returnObj == 0) {\n              row.remove().draw(false);\n            }\n          });\n        }); //多项删除\n\n        $scope.selectedDelete = function () {\n          var tableRows = table.rows({\n            selected: true\n          });\n          var selectedCount = tableRows.count();\n          var nodes = tableRows.nodes();\n\n          if (selectedCount == 0) {\n            growl.warning(\"当前没有选中的告警通知项\", {});\n            return;\n          }\n\n          var successCount = 0;\n          var errorCount = 0;\n          var AlertIdsArr = [];\n          var ifGo = false;\n\n          for (var i = 0; i < nodes.length; i++) {\n            var row = table.row(nodes[i]);\n            var rowData = row.data();\n\n            if (rowData.id > 0) {\n              AlertIdsArr.push(rowData.id);\n              successCount++;\n            } else {\n              errorCount++;\n            }\n\n            if (selectedCount == successCount + errorCount) {\n              ifGo = true; // growl.success(\"成功确认\" + successCount + \"个,失败\" + errorCount + \"个\", {});\n            }\n          }\n\n          ;\n\n          if (ifGo) {\n            $scope.doAction(\"deleteAlertForm\", AlertIdsArr, function (returnObj) {\n              if (returnObj == 0) {\n                for (var i = 0; i < nodes.length; i++) {\n                  var row = table.row(nodes[i]);\n                  row.remove().draw(false);\n                }\n\n                $(\".itemCheckBox\").each(function () {\n                  $(this).attr(\"checked\", false);\n                });\n                $(\"#allselect-btn\").attr(\"checked\", false);\n                table.rows().deselect();\n              }\n            });\n          }\n        };\n      }]\n    };\n  }]);\n});"],"sourceRoot":"/source/"}