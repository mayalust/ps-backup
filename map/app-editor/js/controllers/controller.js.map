{"version":3,"sources":["app-editor/js/controllers/controller.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","define","app","dom","codeMirror","profile","commonlib","controller","scope","rootScope","lm","loading","undefined","loginList","name","password","sitem","login","item","window","timeout","styleList","timeformatList","toolBarList","optionType","dm","userInfo","units","viewFlexService","solutionUIService","resourceUIService","currentTarget","viewId","themeChangesUnbind","optionChangesUnbind","codesourceChangesUnbind","resourceChanged_callback","target","event","mid","modelId","resourceId","$","val","findKpis","modelSelect","kpis","getData","filter","element","checked","findNodes","resources","id","applyChart_run","formatStr","timeformat","format","value","category","dataType","timespan","parseInt","_option_","baseOption","data","nodes","savefile","dataPass","saveData","solutionId","groupId","smodelId","errorMsg","msg","title","content","btnlist","text","fn","setFocus","i","allMyView","viewTitle","saveloading","code","callbackmsg","dirty","alert","location","href","message","updateView","saveSolution","elements","saveModelDashboardViewContent","JSON","stringify","console","log","applylistView","selectData","modelShow","j","label","length","slice","inx","first","end","str","push","nodeId","kpiId","mainTitle","type","subTitle","nodeslist","Array","kpislist","option","rs","findresources","elem","setNodeKpiList","startloading","getOptionData","stoploading","legend","show","changeOption","theme","renderDataChanges","optionChanges","newVal","oldVal","tmp","parse","renderDataTarget","codesourceChanges","themeChanges","changeTheme","toolbarDetail","oldNodeId","oldUnit","chartTab","select","psetting","newopen","codeView","ci","text1","text2","limit","kpi","modelnum","kpinum","optionEdit","subList","sub","settingClick","pagesetting","submitDataChange","getValue","enableScroll","codeSource","cancelDataChange","toolbarClick","toolbar","chartPop_click","clickMainTitle","clickSubTitle","subtitle","testClick","subresourceClick","sub_res","filterByType","display","indexOf","back","disableScroll","timeoutFn","saveData_callback","updateView_callback","resourceClick","resource","findChecked","modelClick","model","kpiClick","onlyDifferentKpi","unit","find","each","kpiClickByModel","checkSelected","ciok","kpiok","applyChart","sub_resources","selectNum","substep","tabClick","newProfile","themeClick","returnBtnClick","renderToolbarIcon","image","style","renderToolbarIcon_class","toolDetailClick","createChart","docClick","newfile","newProf","openfile","newFileclose","openTo","openProf","pageCloseBtn","psetting_close_click","applyPage","previewClick","result","row","layout","col","children","domData","renderPreview","domPos","width","widthheightPortion","height","previewClose","resourceClass","res","resourceSelect","datasettingClick","checkTab","nodeNum","num","checkKpiTab","kpiNum","kpiClassFun","kpiMax","Infinity","checkEnabled","subres","kpi_compo","ci_compo","kpiSelected","ciSelected","refreshGraph","dropdownChange","modelPanelData","modelKeyword","getAllModels","then","mrdata","views","findView","modelStructure","root","traverse","ms","modleLabel","modelLabel","lb","newProfLabel","appendix","split","fd","sort","getModelDashboardViewContent","renderGraphList","getKpisByModelId","modelloaded","viewList","k","getResourceByModelId","ArrayHandler","addNewLabel","modelAndResourseComplete_callback","error","$watch","disableBodyScroll","enableBodyScroll","timeCat","on","applyFinished","$apply","step","some","setCurrentSelect","ele","inner","datasource","setValue","config","applied","cancelDataFn","saveDataFn","imgType","toolbox","feature","saveAsImage","myChart","isConnected","getConnectedDataURL","zr","toDataURL","backgroundColor","replace","openImage","getUserInfo","route","current","pathParams","viewData","calculatePos","wh"],"mappings":"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","file":"app-editor/js/controllers/controller.js","sourcesContent":["function _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\ndefine([\"app\", \"dom\", \"codeMirrorEditor\", \"profile\", \"commonlib\"], function (app, dom, codeMirror, profile, commonlib) {\n  app.controller(\"loginController\", [\"$scope\", \"$rootScope\", \"loginManagement\", function (scope, rootScope, lm) {\n    rootScope.loading = undefined; //http://123.56.150.95:48080/app/index_machine.html#/machine\n\n    scope.loginList = [{\n      \"name\": \"18701650256\",\n      \"password\": \"@WSX3edc\"\n    }, {\n      \"name\": \"15652797278\",\n      \"password\": \"@WSX3edc\"\n    }, {\n      \"name\": \"zhaoyanping@proudsmart.com\",\n      \"password\": \"@WSX3edc\"\n    }, {\n      \"name\": \"standard\",\n      \"password\": \"abc123\"\n    }, {\n      \"name\": \"394160008@qq.com\",\n      \"password\": \"@WSX3edc\"\n    }, {\n      \"name\": \"zhangjiang79@qq.com\",\n      \"password\": \"1q2w3e4r\"\n    }, {\n      \"name\": \"adomain@test.com\",\n      \"password\": \"1q2w3e4r\"\n    }, {\n      \"name\": \"1203538033@qq.com\",\n      \"password\": \"lin664181\"\n    }, {\n      \"name\": \"18611560122\",\n      \"password\": \"abc123\"\n    }];\n    scope.sitem = scope.loginList[0];\n\n    scope.login = function (item) {\n      lm.login(item);\n    };\n  }]);\n  app.controller(\"mainController\", [\"$scope\", \"$rootScope\", \"$window\", \"$timeout\", \"styleList\", \"timeformatList\", \"toolBarList\", \"optionType\", \"loginManagement\", \"dataManagement\", \"userInfo\", \"units\", \"viewFlexService\", \"solutionUIService\", \"resourceUIService\", function (scope, rootScope, window, timeout, styleList, timeformatList, toolBarList, optionType, lm, dm, userInfo, units, viewFlexService, solutionUIService, resourceUIService) {\n    var currentTarget;\n    var viewId;\n    var themeChangesUnbind;\n    var optionChangesUnbind;\n    var codesourceChangesUnbind;\n    rootScope.loading = false;\n    scope.callbackmsg = \"获取资源列表\";\n    scope.toolbarDetail = '';\n    scope.modelShow = '';\n    scope.mainTitle = '';\n    scope.subTitle = '';\n    scope.oldNodeId = undefined;\n    scope.oldUnit = undefined;\n    scope.selectData = [];\n    scope.chartTab = \"MAIN\";\n    scope.callbackmsg = false;\n    scope.dirty = false;\n    scope.select = false;\n    scope.psetting = false;\n    scope.newopen = false;\n    scope.codeView = false;\n    scope.errorMsg = errorMsg;\n    scope.toolBarList = toolBarList;\n    scope.optionEdit = optionType;\n    scope.subList = optionType[0].sub;\n    scope.content = optionType[0].sub[0].content;\n    scope.timeformat = timeformatList[0];\n    scope.timeformatList = timeformatList;\n    scope.styleList = styleList;\n    scope.settingClick = settingClick;\n    scope.submitDataChange = submitDataChange;\n    scope.cancelDataChange = cancelDataChange;\n    scope.toolbarClick = toolbarClick;\n    scope.chartPop_click = chartPop_click;\n    scope.clickMainTitle = clickMainTitle;\n    scope.clickSubTitle = clickSubTitle;\n    scope.testClick = testClick;\n    scope.subresourceClick = subresourceClick;\n    scope.filterByType = filterByType;\n    scope.back = back;\n    scope.resourceClick = resourceClick;\n    scope.modelClick = modelClick;\n    scope.kpiClick = kpiClick;\n    scope.kpiClickByModel = kpiClickByModel;\n    scope.checkSelected = checkSelected;\n    scope.applyChart = applyChart_btn_click;\n    scope.selectNum = selectNum;\n    scope.tabClick = tabClick;\n    scope.newProfile = newProfile;\n    scope.themeClick = themeClick;\n    scope.returnBtnClick = returnBtnClick;\n    scope.renderToolbarIcon = renderToolbarIcon;\n    scope.renderToolbarIcon_class = renderToolbarIcon_class;\n    scope.toolDetailClick = toolDetailClick;\n    scope.docClick = docClick;\n    scope.newfile = newfile;\n    scope.openfile = openfile;\n    scope.newFileclose = newFileclose;\n    scope.openTo = openTo;\n    scope.pageCloseBtn = pageCloseBtn;\n    scope.psetting_close_click = psetting_close_click;\n    scope.applyPage = applyPage;\n    scope.previewClick = previewClick;\n    scope.domPos = domPos;\n    scope.previewClose = previewClose;\n    scope.resourceClass = resourceClass;\n    scope.substep = 0;\n    scope.datasettingClick = datasettingClick;\n    scope.checkTab = checkTab;\n    scope.checkKpiTab = checkKpiTab;\n    scope.kpiClassFun = kpiClassFun;\n    scope.checkEnabled = checkEnabled;\n    scope.refreshGraph = refreshGraph;\n    scope.dropdownChange = dropdownChange;\n    scope.modelKeyword = {};\n    /* before 2016.3.15\n     rootScope.$on(\"modelAndResourceComplete\", modelAndResourseComplete_callback);\n     */\n\n    dm.getAllModels().then(function success(event) {\n      modelAndResourseComplete_callback(event);\n    }, function error(error) {\n      console.log(error);\n    });\n    scope.$watch(\"msg\", msgWatcher);\n    scope.$watch(\"dataType\", dataTypeWatcher);\n    timeout(onDomReady); //dm.init();\n\n    function checkTab(resources, dataType, oldNodeId) {\n      if (_typeof(dataType) == 'object' && dataType != null) {\n        var res = oldNodeId ? 1 : 0;\n\n        var nodeNum = res + function (data) {\n          var num = 0;\n\n          for (var i in data) {\n            if (data[i].checked) {\n              num++;\n            }\n          }\n\n          return num;\n        }(resources);\n\n        if (dataType.limit) {\n          if (dataType.limit.ci) {\n            return nodeNum != dataType.limit.ci;\n          } else {\n            return false;\n          }\n        } else {\n          return false;\n        }\n      } else {\n        return false;\n      }\n    }\n\n    function checkKpiTab(kpis, dataType) {\n      if (_typeof(dataType) == 'object' && dataType != null) {\n        var kpiNum = function (data) {\n          var num = 0;\n\n          for (var i in data) {\n            if (data[i].checked) {\n              num++;\n            }\n          }\n\n          return num;\n        }(kpis);\n\n        if (dataType.limit) {\n          if (dataType.limit.kpi) {\n            return kpiNum != dataType.limit.kpi;\n          } else {\n            return false;\n          }\n        } else {\n          return false;\n        }\n      } else {\n        return false;\n      }\n    }\n\n    function dropdownChange(value) {\n      scope.modelPanelData.children.each(function (model) {\n        if (model.resources) {\n          model.resources.each(function (element) {\n            element.checked = false;\n          });\n        }\n\n        model.kpis.each(function (element) {\n          element.checked = false;\n        });\n      });\n      scope.modelSelect = value;\n      scope.oldUnit = undefined;\n    }\n\n    function refreshGraph() {\n      var modelId, kpis, nodes;\n\n      if (scope.solutionId) {\n        modelId = scope.modelSelect.id;\n        kpis = scope.modelSelect.kpis.getData().filter(function (element) {\n          return element.checked;\n        });\n      } else {\n        nodes = scope.modelSelect.resources.getData().filter(function (element) {\n          return element.checked;\n        });\n\n        if (nodes.length > 0) {\n          modelId = nodes[0].modelId;\n        }\n\n        kpis = scope.modelSelect.kpis.getData().filter(function (elem) {\n          return elem.checked;\n        });\n      }\n\n      var result = {\n        formatStr: scope.timeformat.formatStr,\n        format: scope.timeformat.value,\n        category: scope.category,\n        dataType: scope.dataType,\n        modelId: modelId,\n        timespan: parseInt(scope.timespan),\n        _option_: JSON.parse(JSON.stringify(scope.baseOption)),\n        data: {\n          nodes: nodes,\n          kpis: kpis\n        }\n      };\n\n      if (nodes == undefined || nodes.length == 0) {\n        delete result.data.nodes;\n      }\n\n      applyChart_run(result);\n    }\n\n    function checkEnabled(subres, dataType) {\n      var kpi_compo,\n          ci_compo,\n          kpiSelected = 0,\n          ciSelected = 0;\n\n      if (dataType) {\n        if (dataType.limit) {\n          kpi_compo = dataType.limit.kpi;\n          ci_compo = dataType.limit.ci;\n        }\n      }\n\n      for (var i in scope.resources) {\n        (function (resource) {\n          for (var i in resource.kpis) {\n            (function (kpi) {\n              if (kpi.checked) {\n                kpiSelected++;\n              }\n            })(resource.kpis[i]);\n          }\n        })(scope.resources[i]);\n      }\n\n      ;\n\n      if (kpiSelected > 0) {\n        ciSelected++;\n      } else {\n        return true;\n      }\n\n      for (var j in subres) {\n        (function (res) {\n          if (res.checked) {\n            ciSelected++;\n          }\n        })(subres[j]);\n      }\n\n      if (kpi_compo) {\n        if (kpiSelected != kpi_compo) {\n          return true;\n        }\n\n        ;\n      }\n\n      if (ci_compo) {\n        if (ciSelected != ci_compo) {\n          return true;\n        }\n      }\n\n      return false;\n    }\n\n    function datasettingClick() {\n      scope.substep = scope.substep == 0 ? 1 : 0;\n    }\n\n    function domPos(width, widthheightPortion) {\n      console.log(width, widthheightPortion);\n      return {\n        width: width + \"%\",\n        height: 1200 * width / 100 * widthheightPortion + \"px\"\n      };\n    }\n\n    function dataTypeWatcher(newVal, oldVal, scope) {\n      if (newVal) {\n        var result = [];\n\n        for (var i in newVal.category) {\n          var name;\n\n          if (i == 'time') {\n            name = '时间';\n          } else if (i == 'ci') {\n            name = '设备';\n          } else {\n            name = i;\n          }\n\n          result.push({\n            name: name,\n            value: i\n          });\n        }\n\n        scope.timeCat = result;\n      }\n    }\n\n    function resourceClass(res, resource) {\n      var str = '';\n      var id = res.id;\n\n      if (scope.resourceSelect) {\n        if (id == scope.resourceSelect.id) {\n          str += \"current \";\n        }\n      }\n\n      var find = function (data) {\n        for (var i in data) {\n          if (data[i].checked) {\n            return true;\n          }\n        }\n\n        return false;\n      }(res.kpis);\n\n      if (find) {\n        str += \"active \";\n      }\n\n      return str;\n    }\n\n    function kpiClassFun(kpi, unit, kpis, dataType) {\n      if (dataType != null) {\n        if (dataType.limit) {\n          var kpiMax = dataType.limit.kpi ? dataType.limit.kpi : Infinity;\n        } else {\n          var kpiMax = Infinity;\n        }\n      } else {\n        var kpiMax = Infinity;\n      }\n\n      var kpiNum = function (data) {\n        var num = 0;\n\n        for (var i in data) {\n          if (data[i].checked) {\n            num++;\n          }\n        }\n\n        return num;\n      }(kpis);\n\n      if (kpi.checked) {\n        return \"\";\n      }\n\n      if (kpiNum >= kpiMax) {\n        return \"disabled\";\n      }\n\n      if (unit ? kpi.unit != unit : false) {\n        return \"disabled\";\n      }\n\n      return \"\";\n    }\n\n    function previewClick() {\n      var result = [];\n      var data = dom.saveData();\n\n      for (var i in data.data) {\n        var row = data.data[i].layout.row;\n        var col = data.data[i].layout.col;\n\n        if (!result[row]) {\n          result[row] = {};\n          result[row].children = [];\n        }\n\n        result[row].children[col] = data.data[i];\n      }\n\n      scope.domData = result;\n      dom.disableScroll();\n      dom.renderPreview(result);\n    }\n\n    function previewClose() {\n      scope.domData = undefined;\n      dom.enableScroll();\n    }\n\n    function resourceChanged_callback(target, event) {\n      currentTarget = target;\n      var mid = target.modelId;\n      var resourceId = $(event.target).val();\n      var findKpis = scope.modelSelect.kpis.getData().filter(function (element) {\n        return element.checked;\n      });\n      var findNodes = scope.resources.filter(function (element) {\n        return element.id == resourceId;\n      });\n      applyChart_run({\n        formatStr: scope.timeformat.formatStr,\n        format: scope.timeformat.value,\n        category: scope.category,\n        dataType: scope.dataType,\n        modelId: mid,\n        timespan: parseInt(scope.timespan),\n        _option_: currentTarget.baseOption,\n        data: {\n          nodes: findNodes,\n          kpis: findKpis\n        }\n      });\n    }\n\n    function onDomReady() {\n      dom.fn(toolBarList);\n      dom.on(\"optionUpdated\", editBtnClick_callback);\n      dom.on(\"resBtn_click\", dataBtnClick_callback);\n      dom.on(\"codeBtn_click\", codeBtn_click_callback);\n      dom.on(\"saveImage\", saveImage_callback);\n      dom.on(\"resourceChanged\", resourceChanged_callback);\n      profile.on(\"chartChanged\", chartChanged_callback);\n      profile.on(\"onError\", onError_callback);\n      scope.userInfo = userInfo.getUserInfo();\n\n      function onError_callback(event) {\n        scope.$apply(applied);\n\n        function applied() {\n          scope.msg = {\n            title: event.errorMsg,\n            content: event.error.message,\n            btnlist: [{\n              text: \"关闭\",\n              fn: function fn() {\n                scope.msg = undefined;\n              }\n            }]\n          };\n        }\n      }\n\n      function chartChanged_callback(event) {\n        scope.dirty = true;\n      }\n\n      function saveImage_callback(target, config) {\n        scope.$apply(applied);\n\n        function applied() {\n          scope.msg = {\n            title: \"是否保存此视图\",\n            content: \"点击确认，则在新页面开启图片，之后请用右键另存为保存图片。点击取消，放弃保存。\",\n            btnlist: [{\n              text: \"取消\",\n              fn: cancelDataFn\n            }, {\n              text: \"保存\",\n              fn: saveDataFn\n            }]\n          };\n\n          function cancelDataFn() {\n            scope.msg = undefined;\n          }\n\n          function saveDataFn() {\n            scope.msg = undefined;\n            timeout(timeoutFn, 1000);\n            var saveOption = target.option.toolbox.feature.saveAsImage;\n            var imgType = saveOption.type || 'png';\n\n            if (imgType != 'png' && imgType != 'jpeg') {\n              imgType = 'png';\n            }\n\n            var image;\n\n            if (!target.myChart.isConnected()) {\n              image = target.zr.toDataURL('image/' + imgType, target.option.backgroundColor && target.option.backgroundColor.replace(' ', '') === 'rgba(0,0,0,0)' ? '#fff' : target.option.backgroundColor);\n            } else {\n              image = target.myChart.getConnectedDataURL(imgType);\n            }\n\n            dom.openImage(image);\n\n            function timeoutFn() {\n              scope.callbackmsg = \"视图保存成功\";\n              timeout(timeoutFn, 1000);\n\n              function timeoutFn() {\n                scope.callbackmsg = \"\";\n              }\n            }\n          }\n        }\n      }\n\n      function dataBtnClick_callback(event) {\n        scope.$apply(applyFinished);\n\n        function applyFinished() {\n          scope.option = undefined;\n          var timespan = event.timespan;\n          var stepToStr;\n          var nodes = event.nodes;\n          var kpis = event.kpis;\n          var modelId = event.modelId;\n          var result = [];\n          stepToStr = \"MODEL\";\n          scope.baseOption = event.baseOption;\n          scope.type = event.type;\n          scope.theme = event.theme;\n          scope.step = \"\";\n          scope.substep = 0;\n          scope.timespan = timespan ? timespan : 360;\n          scope.category = event.category;\n          scope.dataType = event.dataType;\n          scope.step = stepToStr;\n          scope.oldNodeId = nodes ? nodes[0] : undefined;\n          scope.oldUnit = undefined;\n\n          if (scope.solutionId) {\n            if (scope.smodelId != 0) {\n              scope.modelSelect = {\n                id: scope.smodelId\n              };\n              resourceUIService.getKpisByModelId(scope.smodelId, function (event) {\n                if (event.code == '0') {\n                  scope.modelSelect.kpis = new commonlib.ArrayHandler(event.data);\n                  scope.modelSelect.kpis.each(function (element) {\n                    var find;\n\n                    if (kpis instanceof Array) {\n                      find = kpis.some(function (elem) {\n                        return elem == element.id;\n                      });\n                    }\n\n                    if (find) {\n                      element.checked = true;\n                    } else {\n                      element.checked = false;\n                    }\n                  });\n                }\n              });\n            } else if (scope.groupId != 0) {\n              scope.modelSelect = {\n                id: scope.groupId\n              };\n              resourceUIService.getKpisByModelId(scope.groupId, function (event) {\n                if (event.code == '0') {\n                  scope.modelSelect.kpis = new commonlib.ArrayHandler(event.data);\n                  scope.modelSelect.kpis.each(function (element) {\n                    var find = kpis.some(function (elem) {\n                      return elem == element.id;\n                    });\n\n                    if (find) {\n                      element.checked = true;\n                    } else {\n                      element.checked = false;\n                    }\n                  });\n                }\n              });\n            }\n          } else if (nodes instanceof Array && nodes.length > 0) {\n            scope.modelSelect = scope.modelPanelData.children.getData().find(function (element) {\n              return element.id == modelId;\n            });\n            scope.modelKeyword.setCurrentSelect(scope.modelSelect);\n            scope.modelSelect = scope.modelSelect ? scope.modelSelect : scope.modelPanelData.children.first();\n            scope.modelSelect.resources.each(function (element) {\n              element.checked = false;\n            });\n            scope.modelSelect.kpis.each(function (element) {\n              element.checked = false;\n            });\n            var findNodes = scope.modelSelect.resources.getData().filter(function (element) {\n              return nodes.indexOf(element.id) != -1;\n            });\n            var findKpis = scope.modelSelect.kpis.getData().filter(function (element) {\n              return kpis.indexOf(element.id) != -1;\n            });\n            console.log(findNodes, findKpis);\n\n            for (var i in findNodes) {\n              findNodes[i].checked = true;\n            }\n\n            for (var j in findKpis) {\n              findKpis[j].checked = true;\n            }\n            /*\n            for(var i in scope.modelSelect.kpis){\n            \tvar nodeId = scope.resources[i].id;\n            \tif((modelId == scope.resources[i].modelId)&&(nodeId != nodes[0])){\n            \t\tvar clone = JSON.parse(JSON.stringify(scope.resources[i]));\n            \t\tvar find = (function(id, nodes){\n            \t\t\tfor(var i in nodes){\n            \t\t\t\tif(id == nodes[i]){\n            \t\t\t\t\treturn true;\n            \t\t\t\t}\n            \t\t\t}\n            \t\t\treturn false;\n            \t\t})(scope.resources[i].id, nodes);\n            \t\tif(find){\n            \t\t\tclone.checked = true;\n            \t\t}\n            \t\telse\n            \t\t{\n            \t\t\tclone.checked = false;\n            \t\t}\n            \t\tresult.push(clone);\n            \t}\n            \tif(nodeId == nodes[0]){\n            \t\tscope.resourceSelect = scope.resources[i];\n            \t}\n            \tfor(var j in scope.resources[i].kpis){\n            \t\tif(nodeId == nodes[0]){\n            \t\t\tvar find = (function(id, kpis){\n            \t\t\t\tfor(var i in kpis){\n            \t\t\t\t\tif(id == kpis[i]){\n            \t\t\t\t\t\treturn true;\n            \t\t\t\t\t}\n            \t\t\t\t}\n            \t\t\t\treturn false;\n            \t\t\t})(scope.resources[i].kpis[j].id, kpis);\n            \t\t\tscope.resources[i].kpis[j].checked = find;\n            \t\t\tif(find)\n            \t\t\t{\n            \t\t\t\tscope.oldUnit = scope.resources[i].kpis[j].unit;\n            \t\t\t}\n             \t\t}\n            \t\telse\n            \t\t{\n            \t\t\tscope.resources[i].kpis[j].checked = false;\n            \t\t}\n            \t}\n            }\n            var find = (function(data){\n            \tfor(var i in data){\n            \t\tfor(var j in data[i].kpis){\n            \t\t\tif(data[i].kpis[j].checked){\n            \t\t\t\treturn data[i];\n            \t\t\t}\n            \t\t}\n            \t}\n            \treturn undefined;\n            })(scope.resources);\n             */\n\n\n            if (findKpis.length > 0) {\n              scope.oldUnit = scope.oldUnit ? scope.oldUnit : findKpis[0].unit; //scope.oldNodeId = find.id;\n\n              /*\n              var result = [];\n              for(var i in scope.resources)\n              {\n              \tif((scope.resources[i].modelId == find.modelId)&&(scope.resources[i].id != find.id)){\n              \t\tresult.push(JSON.parse(JSON.stringify(scope.resources[i])))\n              \t}\n              }\n              scope.sub_resources = scope.sub_resources ? scope.sub_resources : result;\n              console.log(scope.sub_resources);\n              */\n            } else {\n              scope.oldUnit = undefined;\n              /*\n              scope.oldNodeId = undefined;\n              scope.sub_resources = undefined;\n              */\n            }\n          } else if (modelId != undefined && modelId != null && modelId != \"\") {\n            if (kpis instanceof Array && kpis.length > 0) {\n              var kpiId = kpis[0];\n              scope.oldUnit = kpis[0];\n            } else {\n              delete scope.oldUnit;\n            }\n\n            scope.modelSelect = scope.modelPanelData.children.getData().find(function (element) {\n              return element.id == modelId;\n            });\n            scope.modelSelect.kpis.each(function (element) {\n              var find = kpis.some(function (ele) {\n                return ele == element.id;\n              });\n\n              if (find) {\n                element.checked = true;\n              } else {\n                element.checked = false;\n              }\n            });\n          } else {\n            if (scope.solutionId) {\n              scope.modelSelect = undefined;\n\n              for (var i in scope.modelPanelData.children.getData()) {\n                (function (index, elem) {\n                  elem.kpis.each(function (inner) {\n                    inner.checked = false;\n                  });\n                })(i, scope.modelPanelData.children.getData()[i]);\n              }\n            } else {\n              scope.modelSelect = scope.modelPanelData.children.first();\n\n              if (scope.modelSelect.resources) {\n                scope.modelSelect.resources.each(function (element) {\n                  element.checked = false;\n                });\n              }\n\n              scope.modelSelect.kpis.each(function (element) {\n                element.checked = false;\n              });\n            }\n          }\n\n          scope.sub_resources = result.length > 0 ? result : undefined;\n          applylistView();\n          currentTarget = event.target;\n          scope.type = event.type;\n          scope.datasource = event.option;\n        }\n      }\n\n      function editBtnClick_callback(event) {\n        scope.$apply(applyFinished);\n\n        function applyFinished() {\n          if (themeChangesUnbind) {\n            themeChangesUnbind();\n          }\n\n          ;\n\n          if (optionChangesUnbind) {\n            optionChangesUnbind();\n          }\n\n          ;\n          currentTarget = event.target;\n          scope.option = JSON.parse(JSON.stringify(event.option));\n          scope.type = event.type;\n          scope.theme = event.theme;\n        }\n\n        themeChangesUnbind = scope.$watch(\"theme\", themeChanges, true);\n        optionChangesUnbind = scope.$watch(\"option\", optionChanges, true);\n      }\n\n      function codeBtn_click_callback(event) {\n        scope.$apply(applyFinished);\n\n        function applyFinished() {\n          if (codesourceChangesUnbind) {\n            codesourceChangesUnbind();\n          }\n\n          dom.disableScroll();\n          scope.codeView = true;\n          scope.theme = event.theme;\n          currentTarget = event.target;\n          scope.codeSource = JSON.parse(JSON.stringify(event.option));\n          codeMirror.setValue(scope.codeSource);\n        }\n\n        codesourceChangesUnbind = scope.$watch(\"codeSource\", codesourceChanges, true);\n      }\n    }\n\n    function psetting_close_click() {\n      scope.psetting = false;\n    }\n\n    function pageCloseBtn() {\n      scope.psetting = false;\n    }\n\n    function settingClick() {\n      dom.pagesetting();\n      scope.psetting = true;\n    }\n\n    function applyPage() {\n      scope.psetting = false;\n      dom.applyPage();\n    }\n\n    function newfile() {\n      lm.newProf();\n    }\n\n    function submitDataChange() {\n      var value = JSON.parse(codeMirror.getValue());\n      dom.enableScroll();\n      scope.codeSource = value;\n      scope.codeView = false;\n    }\n\n    function docClick() {\n      scope.newopen = false;\n    }\n\n    function cancelDataChange() {\n      dom.enableScroll();\n      scope.codeView = false;\n    }\n\n    function openfile() {\n      scope.newopen = false;\n      scope.select = true;\n    }\n\n    function newFileclose() {\n      scope.select = false;\n    }\n\n    function savefile() {\n      var dataPass = dom.saveData();\n\n      if (scope.solutionId) {\n        dataPass.solutionId = scope.solutionId;\n        dataPass.groupId = scope.groupId;\n        dataPass.smodelId = scope.smodelId;\n      }\n\n      if (dataPass.errorMsg) {\n        var cancelDataFn = function cancelDataFn() {\n          scope.msg = \"\";\n          dom.setFocus();\n        };\n\n        scope.msg = {\n          title: \"未绑定数据\",\n          content: \"有视图未绑定数据\",\n          btnlist: [{\n            text: \"关闭\",\n            fn: cancelDataFn\n          }]\n        };\n      } else {\n        var find = function (data) {\n          var title = data.title;\n\n          for (var i in scope.allMyView) {\n            if (title == scope.allMyView[i].viewTitle && viewId != scope.allMyView[i].viewId) {\n              return true;\n            }\n          }\n\n          return false;\n        }(dataPass);\n\n        if (find) {\n          var _cancelDataFn = function _cancelDataFn() {\n            scope.msg = \"\";\n            dom.setFocus();\n          };\n\n          scope.msg = {\n            title: \"视图重名\",\n            content: \"当前视图名称已被占用，请修改\",\n            btnlist: [{\n              text: \"关闭\",\n              fn: _cancelDataFn\n            }]\n          };\n        } else {\n          var saveData_callback = function saveData_callback(event) {\n            if (event.code == 0) {\n              timeout(function () {\n                scope.saveloading = false;\n                scope.callbackmsg = \"数据保存成功\";\n                scope.dirty = false;\n                timeout(function () {\n                  scope.callbackmsg = undefined;\n                }, 1000);\n              }, 1000);\n              viewId = event.data.viewId;\n            } else if (event.code == 10020) {\n              alert(\"需要用户登录才能使用\");\n              window.location.href = event.data;\n            } else {\n              var timeoutFn = function timeoutFn() {\n                scope.saveloading = false;\n                scope.callbackmsg = event.message;\n                timeout(timeoutFinished, 1000);\n\n                function timeoutFinished() {\n                  scope.callbackmsg = undefined;\n                }\n              };\n\n              timeout(timeoutFn, 1000);\n            }\n          };\n\n          var updateView_callback = function updateView_callback(event) {\n            if (event.code == 0) {\n              viewId = event.data.viewId;\n              timeout(function () {\n                scope.saveloading = false;\n                scope.callbackmsg = \"数据更新成功\";\n                scope.dirty = false;\n                timeout(function () {\n                  scope.callbackmsg = undefined;\n                }, 1000);\n              }, 1000);\n            } else if (event.code == 10020) {\n              alert(\"需要用户登录才能使用\");\n              window.location.href = event.data;\n            } else {\n              timeout(function () {\n                scope.saveloading = false;\n                scope.callbackmsg = event.message;\n                timeout(function () {\n                  scope.callbackmsg = undefined;\n                }, 1000);\n              }, 1000);\n            }\n          };\n\n          scope.saveloading = true;\n\n          if (viewId == undefined) {\n            dm.saveData(dataPass, saveData_callback);\n          } else {\n            dm.updateView(viewId, dataPass, updateView_callback);\n          }\n        }\n      }\n    }\n\n    function saveSolution() {\n      var dataPass = dom.saveData();\n      var content = {\n        title: \"title\",\n        elements: dataPass.data\n      };\n      /*\n      if(scope.solutionId)\n      {\n      \tdataPass.solutionId = scope.solutionId;\n      \tdataPass.groupId = scope.groupId;\n      \tdataPass.smodelId = scope.smodelId;\n      }\n      */\n      //var modelId = dataPass.data[0].modelId;\n\n      solutionUIService.saveModelDashboardViewContent(scope.solutionId, scope.groupId, scope.smodelId, JSON.stringify(content), function (event) {\n        console.log(event);\n        window.location.href = \"../app-ac/index.html#/myView\";\n      });\n      console.log(dataPass);\n    }\n\n    function modelAndResourseComplete_callback(mrdata) {\n      console.log(\"modelAndResourseComplete_callback\", mrdata);\n      scope.callbackmsg = undefined;\n      scope.solutionId = mrdata.solutionId;\n      scope.groupId = mrdata.groupId;\n      scope.smodelId = mrdata.smodelId;\n      scope.allMyView = mrdata.views;\n\n      if (mrdata.viewId) {\n        viewId = parseInt(mrdata.viewId);\n        var findView = scope.allMyView.find(function (element) {\n          return element.viewId == viewId;\n        });\n\n        if (findView) {\n          findView.JSON = JSON.parse(findView.content);\n          console.log(findView);\n        }\n      }\n\n      if (scope.solutionId) {\n        scope.savefile = saveSolution;\n      } else {\n        scope.savefile = savefile;\n      }\n\n      scope.modelPanelData = function (data) {\n        var result = {\n          label: '企业',\n          children: data\n          /* before 2016.3.15\n           var result = [{id:'', label : '所有模型'}];\n           for(var i in data){\n           if(data[i].resources ? data[i].resources.length > 0 : false){\n           result.push(data[i]);\n           }\n           }*/\n\n        };\n        return result;\n      }(mrdata.modelStructure.root);\n\n      scope.resources = function (data) {\n        var result = [];\n        mrdata.modelStructure.traverse.each(function (ms) {\n          var modelId = ms.id;\n          var modleLabel = ms.label;\n          var kpis = ms.kpis;\n\n          if (ms.resources) {\n            ms.resources.each(function (resource) {\n              resource.modelId = modelId;\n              resource.modelLabel = modleLabel;\n              resource.kpis = JSON.parse(JSON.stringify(kpis.getData()));\n              result.push(resource);\n            });\n          }\n        });\n        /* before 2016.3.15\n         for(var i in data){\n         for(var j in data[i].resources){\n         var clone = data[i].resources[j];\n         clone.modelId = data[i].id;\n         clone.modelLabel = data[i].label;\n         clone.kpis = JSON.parse(JSON.stringify(data[i].kpis));\n         result.push(data[i].resources[j]);\n         }\n         }\n         }*/\n\n        return result;\n      }(mrdata.modelStructure);\n\n      scope.modelShow = \"\";\n      scope.timespan = (scope.modelShow ? scope.modelShow.timespan != undefined ? scope.modelShow.timespan : 3600 * 24 * 30 : 3600 * 24 * 30) / 60 / 1000;\n      var lb = [];\n\n      var newProfLabel = function (obj) {\n        for (var i in obj) {\n          var title = obj[i].viewTitle;\n          var find = title.indexOf(\"新建运营分析视图\");\n\n          if (find != -1) {\n            var appendix = title.split(\"新建运营分析视图\")[1];\n            var fd = appendix.indexOf(\"(\");\n\n            if (fd != -1) {\n              var inx = parseInt(appendix.split(\"(\")[1].split(\")\")[0]);\n              lb.push(inx);\n            } else {\n              lb.push(0);\n            }\n          }\n        }\n\n        lb = lb.sort();\n\n        if (lb.length > 0) {\n          return \"新建运营分析视图(\" + (lb[lb.length - 1] + 1) + \")\";\n        } else {\n          return \"新建运营分析视图\";\n        }\n      }(scope.allMyView);\n\n      if (scope.solutionId) {\n        solutionUIService.getModelDashboardViewContent(scope.solutionId, scope.groupId, scope.smodelId, function (event) {\n          console.log(event);\n          var result = [];\n\n          if (event.data != null) {\n            var views = JSON.parse(event.data);\n            console.log(views);\n\n            for (var i in views.elements) {\n              var row = views.elements[i].layout ? views.elements[i].layout.row : i + 1;\n              var col = views.elements[i].layout ? views.elements[i].layout.col : 1;\n\n              if (!result[row]) {\n                result[row] = {};\n                result[row].children = [];\n              }\n\n              result[row].children[col] = views.elements[i];\n            }\n\n            dom.renderGraphList(views.elements.title, result, function (target) {\n              console.log(target);\n              target.startloading();\n              var nodeslist;\n              var option = target.option;\n              var dataType = target.dataType;\n              var category = target.category;\n              var format = timeformatList.find(function (element) {\n                return element.formatStr == target.formatStr;\n              });\n              var timespan = target.timespan;\n              var modelId = scope.smodelId == 0 ? scope.groupId : scope.smodelId;\n              var model = scope.modelPanelData.children.find(\"id\", modelId);\n\n              if (model == undefined) {\n                model = {\n                  id: modelId\n                };\n                resourceUIService.getKpisByModelId(modelId, function (event) {\n                  if (event.code == 0) {\n                    console.log(event);\n                  }\n                });\n              } else {\n                modelloaded();\n              }\n\n              function modelloaded() {\n                if (model.resources) {\n                  nodeslist = model.resources.getData().filter(function (element) {\n                    if (target.nodes instanceof Array) {\n                      return target.nodes.indexOf(element.id) != -1;\n                    } else {\n                      return false;\n                    }\n                  });\n                }\n\n                var kpislist = model.kpis.getData().filter(function (element) {\n                  if (target.kpis) {\n                    return target.kpis.indexOf(element.id) != -1;\n                  } else {\n                    return false;\n                  }\n                });\n\n                if (nodeslist) {\n                  if (!nodeslist instanceof Array || nodeslist.length == 0) {\n                    nodeslist = undefined;\n                  }\n                }\n\n                dm.getOptionData(dataType, category, format ? format.value : 'hh:mm', option, nodeslist, kpislist, timespan * 60 * 1000, getOptionData_callback);\n\n                function getOptionData_callback(event, data) {\n                  target.stoploading();\n                  renderDataTarget(event.option, target, data);\n                }\n              }\n            });\n          } else {}\n        });\n      } else {\n        if (mrdata.viewList != undefined) {\n          var result = [];\n          var data = mrdata.viewList;\n\n          for (var k in mrdata.viewList) {\n            console.log(mrdata.viewList[k]);\n          }\n\n          for (var i in data) {\n            var row = data[i].layout ? data[i].layout.row : i + 1;\n            var col = data[i].layout ? data[i].layout.col : 1;\n\n            if (!result[row]) {\n              result[row] = {};\n              result[row].children = [];\n            }\n\n            result[row].children[col] = data[i];\n          }\n\n          dom.renderGraphList(mrdata.viewTitle, result, function (target) {\n            console.log(target);\n            target.startloading();\n            var option = target.option;\n            var nodeslist = [];\n            var dataType = target.dataType;\n            var category = target.category;\n            var format = timeformatList.find(function (element) {\n              return element.formatStr == target.formatStr;\n            });\n            var timespan = target.timespan;\n            var modelId = target.modelId;\n            var model = scope.modelPanelData.children.find(\"id\", modelId);\n\n            if (model == undefined) {\n              model = {\n                id: modelId\n              };\n              resourceUIService.getResourceByModelId(modelId, function (event) {\n                if (event.code == 0) {\n                  resourceUIService.getKpisByModelId(modelId, function (event) {\n                    if (event.code == 0) {\n                      console.log(event);\n                      model.kpis = new commonlib.ArrayHandler(event.data);\n                      modelloaded();\n                    }\n                  });\n                  console.log(event);\n                  model.resources = new commonlib.ArrayHandler(event.data);\n                }\n              });\n            } else {\n              modelloaded();\n            }\n\n            function modelloaded() {\n              if (model.resources) {\n                nodeslist = model.resources.getData().filter(function (element) {\n                  if (target.nodes instanceof Array) {\n                    return target.nodes.indexOf(element.id) != -1;\n                  } else {\n                    return false;\n                  }\n                });\n              }\n\n              var kpislist = model.kpis.getData().filter(function (element) {\n                return target.kpis.indexOf(element.id) != -1;\n              });\n\n              if (nodeslist.length == 0) {\n                if (model.resources) {\n                  var first = model.resources.first();\n\n                  if (first) {\n                    nodeslist = [model.resources.first()];\n                  } else {\n                    nodeslist = undefined;\n                  }\n                } else {\n                  nodeslist = undefined;\n                }\n              }\n\n              dm.getOptionData(dataType, category, format.value, option, nodeslist, kpislist, timespan * 60 * 1000, getOptionData_callback);\n\n              function getOptionData_callback(event, data) {\n                target.stoploading();\n                renderDataTarget(event.option, target, data);\n              }\n            }\n          }); //add new\n        } else {\n          dom.addNewLabel(newProfLabel);\n        }\n\n        ;\n      }\n    }\n\n    function themeClick(value) {\n      if (value != \"customer\") {\n        scope.theme = value;\n      } else {\n        //scope.theme = \"default\";\n        scope.chartTab = \"DETAIL\";\n      }\n    }\n\n    function returnBtnClick() {\n      scope.chartTab = \"MAIN\";\n    }\n\n    function openTo(viewId) {\n      lm.openProf(viewId);\n      scope.select = false;\n    }\n\n    function newProfile() {\n      //lm.newProf();\n      scope.newopen = !scope.newopen;\n    }\n\n    function tabClick(value) {\n      scope.substep = value;\n    }\n\n    function selectNum(model, substep) {\n      var inx = 0;\n\n      if (model) {\n        if (substep == 0) {\n          for (var i in model.resources) {\n            if (model.resources[i].checked == true) {\n              inx++;\n            }\n          }\n        } else if (substep == 1) {\n          for (var i in model.kpis) {\n            if (model.kpis[i].checked == true) {\n              inx++;\n            }\n          }\n        }\n      }\n\n      return inx;\n    }\n\n    function msgWatcher(newVal, oldVal, scope) {\n      if (newVal) {\n        dom.disableBodyScroll();\n      } else {\n        dom.enableBodyScroll();\n      }\n    }\n\n    function applylistView() {\n      scope.selectData = [];\n      var modelShow = scope.modelShow;\n\n      for (var i in modelShow.resources) {\n        for (var j in modelShow.kpis) {\n          if (modelShow.resources[i].checked && modelShow.kpis[j].checked) {\n            var findSame = function findSame(name) {\n              var find = function (obj) {\n                for (var i in obj) {\n                  if (obj[i].value == name) {\n                    return true;\n                  }\n                }\n\n                return false;\n              }(scope.selectData);\n\n              return find;\n            };\n\n            var name = modelShow.resources[i].label + \"(\" + modelShow.kpis[j].label + \")\";\n\n            if (name.length > 6) {\n              name = name.slice(0, 4) + \"...\";\n            }\n\n            var inx = 1;\n\n            while (findSame(name)) {\n              var first = name.slice(-3, -2);\n              var end = name.slice(-1);\n\n              if (first == \"(\" && end == \")\") {\n                var str = name.slice(0, -3);\n                str += \"(\" + inx + \")\";\n                name = str;\n              } else {\n                name += \"(\" + inx + \")\";\n              }\n\n              inx++;\n            }\n\n            scope.selectData.push({\n              nodeId: modelShow.resources[i].id,\n              name: modelShow.kpis[j].name,\n              kpiId: modelShow.kpis[j].id,\n              value: name\n            });\n          }\n        }\n      }\n\n      scope.mainTitle = scope.modelShow.label;\n\n      switch (scope.type) {\n        case \"line\":\n          scope.subTitle = \"线状视图\";\n          break;\n\n        case \"bar\":\n          scope.subTitle = \"柱状视图\";\n          break;\n\n        case \"pie\":\n          scope.subTitle = \"饼状视图\";\n          break;\n\n        case \"gauge\":\n          scope.subTitle = \"告警视图\";\n          break;\n      }\n    }\n\n    function applyChart_btn_click(resources) {\n      var nodes = [];\n      var kpis = [];\n      var modelId;\n\n      for (var i in resources) {\n        var find = false;\n\n        for (var j in resources[i].kpis) {\n          if (resources[i].kpis[j].checked) {\n            find = true;\n            modelId = resources[i].modelId;\n            kpis.push({\n              id: resources[i].kpis[j].id,\n              name: resources[i].kpis[j].name,\n              label: resources[i].kpis[j].label,\n              units: resources[i].kpis[j].unit\n            });\n          }\n        }\n\n        if (find) {\n          nodes.push({\n            modelId: resources[i].modelId,\n            id: resources[i].id,\n            label: resources[i].label\n          });\n        }\n      }\n\n      for (var i in scope.sub_resources) {\n        if (scope.sub_resources[i].checked) {\n          nodes.push({\n            modelId: scope.sub_resources[i].modelId,\n            id: scope.sub_resources[i].id,\n            label: scope.sub_resources[i].label\n          });\n        }\n      }\n\n      applyChart_run({\n        formatStr: scope.timeformat.formatStr,\n        format: scope.timeformat.value,\n        category: scope.category,\n        dataType: scope.dataType,\n        modelId: modelId,\n        timespan: parseInt(scope.timespan),\n        _option_: JSON.parse(JSON.stringify(scope.baseOption)),\n        data: {\n          nodes: nodes,\n          kpis: kpis\n        }\n      });\n    }\n\n    function applyChart_run(event) {\n      var nodeslist = event.data.nodes;\n\n      if (nodeslist) {\n        if (!nodeslist instanceof Array || nodeslist.length == 0) {\n          nodeslist = undefined;\n        }\n      }\n\n      var kpislist = event.data.kpis;\n      var formatStr = event.formatStr;\n      var format = event.format;\n      var category = event.category;\n      var modelId = event.modelId;\n      var timespan = event.timespan;\n      var dataType = event.dataType;\n      var option = event._option_; //var oldSeries = JSON.parse(JSON.stringify(scope.datasource.series[0]));\n\n      var nodes = function (obj) {\n        var rs = [];\n\n        for (var i in obj) {\n          rs.push(obj[i].id);\n        }\n\n        return rs;\n      }(nodeslist);\n\n      var kpis = function (obj) {\n        var rs = [];\n\n        for (var i in obj) {\n          rs.push(obj[i].id);\n        }\n\n        return rs;\n      }(kpislist);\n\n      var findresources = scope.resources.filter(function (elem) {\n        return elem.modelId == modelId;\n      });\n      currentTarget.setNodeKpiList({\n        formatStr: formatStr,\n        category: category,\n        modelId: modelId,\n        nodes: nodes,\n        kpis: kpis,\n        resources: findresources,\n        timespan: timespan\n      });\n      currentTarget.startloading();\n      dm.getOptionData(dataType, category, format, option, nodeslist, kpislist, timespan * 60 * 1000, getOptionData_callback);\n\n      function getOptionData_callback(event) {\n        currentTarget.stoploading();\n        renderDataChanges(event.option);\n      }\n    }\n\n    ;\n\n    function errorMsg(modelShow, dataType) {\n      var ci;\n      var kpi;\n      var text1 = '';\n      var text2 = '';\n\n      if (dataType ? dataType.limit : false) {\n        ci = dataType.limit.ci;\n        kpi = dataType.limit.kpi;\n      }\n\n      modelnum = function (obj) {\n        var inx = 0;\n\n        if (obj) {\n          for (var i in obj.resources) {\n            if (obj.resources[i].checked == true) {\n              inx++;\n            }\n          }\n        }\n\n        return inx;\n      }(modelShow);\n\n      kpinum = function (obj) {\n        var inx = 0;\n\n        if (obj) {\n          for (var i in obj.kpis) {\n            if (obj.kpis[i].checked == true) {\n              inx++;\n            }\n          }\n        }\n\n        return inx;\n      }(modelShow);\n\n      if (modelnum > 0) {\n        if (ci) {\n          text1 = ci == modelnum ? '' : ' [ 此视图需要' + ci + '个设备 ] ';\n        }\n      } else {\n        text1 = ' [ 设备不能为空 ] ';\n      }\n\n      if (kpinum > 0) {\n        if (ci) {\n          text2 = ci == kpinum ? '' : ' [ 此视图需要' + ci + '个指标 ] ';\n        }\n      } else {\n        text2 = ' [ 指标不能为空 ] ';\n      }\n\n      if (text1 != '' && text2 != '') {\n        return text1 + \",\" + text2;\n      } else if (text1 == '' && text2 != '') {\n        return text2;\n      } else if (text1 != '' && text2 == '') {\n        return text1;\n      } else {\n        return '';\n      }\n    }\n\n    function checkSelected(modelShow, dataType) {\n      var ci;\n      var kpi;\n\n      if (dataType ? dataType.limit : false) {\n        ci = dataType.limit.ci;\n        kpi = dataType.limit.kpi;\n      }\n\n      modelnum = function (obj) {\n        var inx = 0;\n\n        if (obj) {\n          for (var i in obj.resources) {\n            if (obj.resources[i].checked == true) {\n              inx++;\n            }\n          }\n        }\n\n        return inx;\n      }(modelShow);\n\n      kpinum = function (obj) {\n        var inx = 0;\n\n        if (obj) {\n          for (var i in obj.kpis) {\n            if (obj.kpis[i].checked == true) {\n              inx++;\n            }\n          }\n        }\n\n        return inx;\n      }(modelShow);\n\n      var ciok;\n      var kpiok;\n\n      if (ci) {\n        if (modelnum == ci) {\n          ciok = true;\n        } else {\n          ciok = false;\n        }\n      } else {\n        ciok = true;\n      }\n\n      if (kpi) {\n        if (kpinum == kpi) {\n          kpiok = true;\n        } else {\n          kpiok = false;\n        }\n      } else {\n        kpiok = true;\n      }\n\n      return !(ciok && kpiok && modelnum > 0 && kpinum > 0);\n    }\n\n    function kpiClick(kpi, onlyDifferentKpi, model) {\n      if (onlyDifferentKpi == true) {\n        if (scope.oldUnit ? scope.oldUnit == kpi.unit : true) {\n          kpi.checked = !kpi.checked;\n          scope.oldUnit = kpi.unit;\n        } else {\n          scope.callbackmsg = \"请选择相同单位数据\";\n          timeout(function () {\n            scope.callbackmsg = undefined;\n          }, 1000);\n        }\n\n        var find = function (data) {\n          for (var i in data) {\n            for (var j in data[i].kpis) {\n              if (data[i].kpis[j].checked) {\n                return data[i];\n              }\n            }\n          }\n\n          return undefined;\n        }(scope.resources);\n\n        if (find) {\n          scope.oldUnit = scope.oldUnit ? scope.oldUnit : kpi.unit;\n          scope.oldNodeId = find.nodeId;\n        } else {\n          scope.oldUnit = undefined;\n          scope.oldNodeId = undefined;\n        }\n\n        applylistView();\n      } else {\n        if (scope.oldUnit ? scope.oldUnit == kpi.unit : true) {\n          kpi.checked = !kpi.checked;\n          scope.oldUnit = kpi.unit;\n        } else {\n          scope.callbackmsg = \"单位不同，原先选择将被重置。\";\n          scope.modelSelect.kpis.each(function (element) {\n            if (kpi != element) {\n              element.checked = false;\n            } else {\n              element.checked = true;\n              scope.oldUnit = element.unit;\n            }\n          });\n          timeout(function () {\n            scope.callbackmsg = undefined;\n          }, 1000);\n        }\n\n        applylistView();\n        nodes = scope.modelSelect.resources.getData().filter(function (elem) {\n          return elem.checked;\n        });\n        var findChecked = scope.modelSelect.kpis.getData().filter(function (elem) {\n          return elem.checked;\n        });\n\n        if (nodes.length > 0 && findChecked.length > 0) {\n          applyChart_run({\n            formatStr: scope.timeformat.formatStr,\n            format: scope.timeformat.value,\n            category: scope.category,\n            dataType: scope.dataType,\n            modelId: scope.modelSelect.id,\n            timespan: parseInt(scope.timespan),\n            _option_: JSON.parse(JSON.stringify(scope.baseOption)),\n            data: {\n              nodes: nodes,\n              kpis: findChecked\n            }\n          });\n        }\n      }\n    }\n\n    function kpiClickByModel(kpi, onlyDifferentKpi, model) {\n      if (onlyDifferentKpi == true) {\n        if (scope.oldUnit ? scope.oldUnit == kpi.unit : true) {\n          kpi.checked = !kpi.checked;\n        } else {\n          scope.callbackmsg = \"请选择相同单位数据\";\n          timeout(function () {\n            scope.callbackmsg = undefined;\n          }, 1000);\n        }\n\n        var find = function (data) {\n          for (var i in data) {\n            for (var j in data[i].kpis) {\n              if (data[i].kpis[j].checked) {\n                return data[i];\n              }\n            }\n          }\n\n          return undefined;\n        }(scope.resources);\n\n        if (find) {\n          scope.oldUnit = scope.oldUnit ? scope.oldUnit : kpi.unit;\n          scope.oldNodeId = find.nodeId;\n        } else {\n          scope.oldUnit = undefined;\n          scope.oldNodeId = undefined;\n        }\n\n        applylistView();\n      } else {\n        /*\n         if(scope.oldUnit == undefined){\n         scope.callbackmsg = \"其它指标只能选择与此单位相同者\"\n         timeout(function(){\n         scope.callbackmsg = undefined;\n         },3000);\n         }\n         */\n        if (scope.oldUnit ? scope.oldUnit == kpi.unit : true) {\n          kpi.checked = !kpi.checked;\n          scope.oldUnit = kpi.unit;\n        } else {\n          scope.oldUnit = kpi.unit;\n          scope.callbackmsg = \"单位不同，已勾选项将被清除。\";\n          timeout(function () {\n            scope.callbackmsg = undefined;\n          }, 1000);\n\n          for (var i in scope.modelSelect.kpis.getData()) {\n            (function (index, element) {\n              if (element.id == kpi.id) {\n                element.checked = true;\n                scope.oldUnit = kpi.unit;\n              } else {\n                element.checked = false;\n              }\n            })(i, scope.modelSelect.kpis.getData()[i]);\n          }\n        }\n\n        applylistView();\n      }\n\n      var findChecked = scope.modelSelect.kpis.getData().filter(function (elem) {\n        return elem.checked;\n      });\n\n      if (findChecked.length > 0) {\n        applyChart_run({\n          formatStr: scope.timeformat.formatStr,\n          format: scope.timeformat.value,\n          category: scope.category,\n          dataType: scope.dataType,\n          modelId: model.id,\n          timespan: parseInt(scope.timespan),\n          _option_: JSON.parse(JSON.stringify(scope.baseOption)),\n          data: {\n            kpis: findChecked\n          }\n        });\n      }\n    }\n    /*\n    function modelClick(model){\n    \tscope.modelShow = model == scope.modelShow ? \"\" : model;\n    \tscope.step = \"NODE\";\n    }\n    */\n\n\n    function modelClick(model) {\n      scope.modelSelect = model;\n      var findKpis = scope.modelSelect.kpis.getData().filter(function (element) {\n        return element.checked;\n      });\n\n      if (findKpis.length > 0) {\n        applyChart_run({\n          formatStr: scope.timeformat.formatStr,\n          format: scope.timeformat.value,\n          category: scope.category,\n          dataType: scope.dataType,\n          modelId: model.id,\n          timespan: parseInt(scope.timespan),\n          _option_: JSON.parse(JSON.stringify(scope.baseOption)),\n          data: {\n            kpis: findKpis\n          }\n        });\n      }\n    }\n\n    function resourceClick(resource) {\n      //scope.resourceSelect = resource;\n      if (resource.checked) {\n        resource.checked = false;\n      } else {\n        resource.checked = true;\n      }\n\n      var nodes = scope.modelSelect.resources.getData().filter(function (elem) {\n        return elem.checked;\n      });\n      var findChecked = scope.modelSelect.kpis.getData().filter(function (elem) {\n        return elem.checked;\n      });\n\n      if (nodes.length > 0 && findChecked.length > 0) {\n        applyChart_run({\n          formatStr: scope.timeformat.formatStr,\n          format: scope.timeformat.value,\n          category: scope.category,\n          dataType: scope.dataType,\n          modelId: scope.modelSelect.id,\n          timespan: parseInt(scope.timespan),\n          _option_: JSON.parse(JSON.stringify(scope.baseOption)),\n          data: {\n            nodes: nodes,\n            kpis: findChecked\n          }\n        });\n      }\n\n      applylistView();\n    }\n\n    function subresourceClick(sub_res) {\n      sub_res.checked = sub_res.checked ? !sub_res.checked : true;\n    }\n\n    function back() {\n      if (scope.dirty) {\n        var cancelDataFn = function cancelDataFn() {\n          scope.msg = undefined;\n        };\n\n        var saveDataFn = function saveDataFn() {\n          scope.msg = {\n            loading: \"数据保存中请稍后\"\n          };\n          timeout(timeoutFn, 1000);\n\n          function timeoutFn() {\n            if (scope.solutionId) {\n              saveSolution();\n            } else if (viewId == undefined) {\n              dm.saveData(dataPass, saveData_callback);\n            } else {\n              dm.updateView(viewId, dataPass, updateView_callback);\n            }\n\n            function saveData_callback(event) {\n              scope.msg = undefined;\n              lm.back();\n            }\n\n            function updateView_callback(event) {\n              scope.msg = undefined;\n              lm.back();\n            }\n          }\n        };\n\n        var dataPass = dom.saveData();\n        dom.disableScroll();\n        scope.msg = {\n          title: \"当前视图尚未保存\",\n          content: \"是否不保存，直接退出！\",\n          btnlist: [{\n            text: \"取消\",\n            fn: cancelDataFn\n          }, {\n            text: \"保存退出\",\n            fn: saveDataFn\n          }, {\n            text: \"直接退出\",\n            fn: function fn() {\n              if (scope.solutionId) {\n                window.location.href = \"../app-ac/index.html#/myView\";\n              } else {\n                lm.back();\n              }\n\n              scope.msg = '';\n            }\n          }]\n        };\n        ;\n      } else {\n        if (scope.solutionId) {\n          window.location.href = \"../app-ac/index.html#/myView\";\n        } else {\n          lm.back();\n        }\n      }\n    }\n\n    function filterByType(item) {\n      if (scope.type) {\n        return item.display.indexOf(scope.type) != -1;\n      } else {\n        return true;\n      }\n    }\n\n    function testClick() {\n      scope.option.title.text = \"asdasd\";\n    }\n\n    function clickSubTitle(subtitle) {\n      scope.subTitle = subtitle.id;\n      scope.content = subtitle.content;\n    }\n\n    function clickMainTitle(mainTitle) {\n      scope.mainTitle = mainTitle.id;\n      scope.subList = mainTitle.sub;\n      scope.subTitle = 0;\n      scope.content = scope.subList[0].content;\n    }\n\n    function optionChanges(newVal, oldVal, scope) {\n      if (currentTarget && newVal) {\n        var tmp = JSON.parse(JSON.stringify(newVal));\n\n        if (tmp.legend) {\n          if (tmp.legend.show == 'false') {\n            delete tmp.legend;\n          }\n        }\n\n        currentTarget.changeOption(tmp, scope.theme, true);\n      }\n    }\n\n    function renderDataTarget(option, target, data) {\n      if (option.legend) {\n        if (option.legend.show == 'false') {\n          delete option.legend;\n        }\n      }\n\n      target.changeOption(option, scope.theme, true, data);\n    }\n\n    function renderDataChanges(option) {\n      if (option.legend) {\n        if (option.legend.show == 'false') {\n          delete option.legend;\n        }\n      }\n\n      currentTarget.changeOption(option, scope.theme, true);\n    }\n\n    function codesourceChanges(newVal, oldVal, scope) {\n      if (currentTarget && newVal) {\n        var tmp = JSON.parse(JSON.stringify(newVal));\n\n        if (tmp.legend) {\n          if (tmp.legend.show == 'false') {\n            delete tmp.legend;\n          }\n        }\n\n        currentTarget.changeOption(tmp, scope.theme, true);\n      }\n    }\n\n    function themeChanges(newVal, oldVal, scope) {\n      if (currentTarget && newVal) {\n        currentTarget.changeTheme(newVal, scope.option);\n      }\n    }\n\n    function renderToolbarIcon(image) {\n      var style = {};\n      style[\"background-image\"] = \"url(images/icons/\" + image + \".svg)\";\n      return style;\n    }\n\n    function renderToolbarIcon_class(image) {\n      var style = {};\n      style[\"background-image\"] = \"url(images/icons/\" + image + \".svg)\";\n      return style;\n    }\n\n    function toolbarClick(toolbar) {\n      scope.toolbarDetail = toolbar;\n    }\n\n    function chartPop_click() {\n      scope.toolbarDetail = '';\n    }\n\n    function toolDetailClick(type, option, dataType) {\n      dom.createChart(type, option, dataType);\n      scope.toolbarDetail = '';\n    }\n  }]);\n  app.controller(\"prevController\", [\"$scope\", \"$rootScope\", \"$route\", function (scope, rootScope, route) {\n    var result = [];\n    var data = JSON.parse(route.current.pathParams.viewData);\n\n    for (var i in data.data) {\n      var row = data.data[i].layout.row;\n      var col = data.data[i].layout.col;\n\n      if (!result[row]) {\n        result[row] = {};\n        result[row].children = [];\n      }\n\n      result[row].children[col] = data.data[i];\n    }\n\n    scope.domData = result;\n    scope.calculatePos = calculatePos;\n\n    function calculatePos(width, wh) {\n      return {\n        width: width + \"%\",\n        height: \"100px\"\n      };\n    }\n\n    console.log(result);\n  }]);\n});"],"sourceRoot":"/source/"}