{"version":3,"sources":["toolkit/angular-custom/angular-popup.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","window","angular","undefined","runFun","fun","params","i","arguments","push","apply","objToValue","data","value","objectToArray","addName","rs","attr","elem","indexOf","insert","$clone","$name","arrayToObject","array","angularPopupDirective","timeout","popup","angularStyle","keySet","growl","rootScope","restrict","priority","templateUrl","link","scope","element","panelSubmit","show","checkDataValiad","info","index","getIndex","parameters","getParameters","style","getStyle","echart","getEchart","getSource","advance","getAdvance","error","$panelCancel","$panelSubmit","selectedView","items","item","initViewItems","length","ad","condition","JSONparse","saveViewItems","sort","a","b","parseInt","tabs","forEach","view","id","label","name","viewTitle","default","viewId","content","list","attrItem","addViewItem","filter","addItem","jQuery","extend","deleteViewItem","delId","splice","open","onCommandKeyWith","exampleDirective","template","$","wrap","dom","removeAttr","css","width","height","position","overflow","type","url","background-size","background-position","background-repeat","background-image","text","find","append","$root","$$childHead","autocompleteDirective","ngModel","source","inputBox","autocomplete","select","event","ui","$apply","split","$watch","n","o","s","val","request","responce","input","term","src","map","on","key","this","module","directive","provider","self","$get","kqiManagerUIService","serviceCenterService","dictionaryService","resourceUIService","dialogue","configUIService","originalSource","originalEchart","originalParameter","originalStyle","originalAdvance","combination","all","getUsed","clone","hasOwnProperty","getUsedAll","traverse","v","at","attribute","Array","getNoused","getAll","getcss","callback","$attr","isDiff","JSON","stringify","treeObj","echartStyle","each","target","compare","series","arraylike","j","children","styleVal","traverseChild","treeToObject","setContent","title","domHtml","html","fd","selected","bool","getSelectStyle","getAllStyle","isArray","result","loop","regroup","folder","arr","objectToArrayObj","parent","createArr","click","deleteFn","$remove","visible","add","st","lastElement","delete","subInx","combo","change","run","addEvent","selectItem","options","eventName","$EVENTS","trigger","getConfigsByGroupName","code","renderSub","renderlist","format","rest","addVal","el","inputvalue","inputname","ec","adv","param","chosen","choseTemplate","styleGroup","echartGroup","advGroup","paramGroup","resource","kpi","preview","rootDomain","get","then","rootCi","success","models","getKpiByModelId","kpiMap","kpis","inx","getResourceByModelId","resourceMap","resources","modelMap","modelTypeOnChange","getDataItemsByModelId","getBymodelId","model","onChange","modelTypes","resfilltypes","aggregate_rules","cur","init","getAggregate_period_back","valueCode","granularityUnits","concat","getAggregate_type_back","aggregate_types","getAggregate_instance_back","aggregate_instances","getDictValues","getKqiModels","kqiModels","kqiModel","modelType","modelId","getRootModel","getModelByIds","renderData","bind","legend","render","xAxis","yAxis","toHelpDoc","parameter","applied","dataToX","resfilltype","timespan","multipleCi","multipleKpi","frequency","aggregate_type","granularityUnit","aggregate_instance","aggregate_rule","autoFillBlank","xAxisType","yAxisType","$$","loadExternalJs","dateHandler","valueListHandler","endTime","startTime","getTimeStamp","time","unit","getTime","vlh","setTimeRange","e","message","submitPanel"],"mappings":"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","file":"toolkit/angular-custom/angular-popup.js","sourcesContent":["function _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\n(function (window, angular, undefined) {\n  'use strict';\n\n  var runFun = function runFun() {\n    var fun;\n    var params = [];\n\n    for (var i in arguments) {\n      if (i == 0) {\n        fun = arguments[i];\n      } else {\n        params.push(arguments[i]);\n      }\n    }\n\n    if (typeof fun == 'function') {\n      fun.apply(window, params);\n    }\n  };\n\n  var setAttr = function setAttr(target, attr, value) {\n    for (var i in target) {\n      target[i].$attr(attr, value);\n    }\n  };\n\n  var objToValue = function objToValue(data) {\n    for (var i in data) {\n      data[i] = data[i].value;\n    }\n\n    return data;\n  };\n\n  var objectToArray = function objectToArray(data, addName) {\n    var rs = [];\n\n    for (var i in data) {\n      (function (attr, elem) {\n        var find = addName ? addName.indexOf(attr) == -1 : true;\n\n        if (find) {\n          var insert = elem.$clone();\n          insert.$name = attr;\n          rs.push(insert);\n        }\n      })(i, data[i]);\n    }\n\n    return rs;\n  };\n\n  var objectToArrayObj = function objectToArrayObj(data, addName) {\n    var rs = [];\n\n    for (var i in data) {\n      (function (attr, elem) {\n        rs.push(traverse(attr, elem));\n      })(i, data[i]);\n    }\n\n    function traverse(attr, data) {\n      var clone = data ? data.$clone() : {};\n      var find = addName ? addName.indexOf(attr) == -1 : true;\n\n      if (angular.isArray(data)) {\n        var rs = {\n          $name: attr,\n          folder: function () {\n            var arr = [];\n\n            for (var i in data) {\n              arr.push(traverse(attr, data[i]));\n            }\n\n            return arr;\n          }()\n        };\n        return rs;\n      } else {\n        clone.$name = attr;\n\n        if (find) {\n          return clone;\n        }\n      }\n    }\n\n    return rs;\n  };\n\n  var arrayToObject = function arrayToObject(array) {\n    var rs = {};\n\n    for (var i in array) {\n      (function (index, elem) {\n        rs[elem.$name] = elem;\n        delete rs[elem.$name].$name;\n      })(i, array[i].$clone());\n    }\n\n    return rs;\n  };\n\n  var getHtml = function getHtml(element) {\n    return $(\"<div></div>\").append(element).html();\n  };\n\n  var angularPopupDirective = [\"$timeout\", \"popup\", \"angular-style\", \"keySet\", 'growl', '$rootScope', function (timeout, popup, angularStyle, keySet, growl, rootScope) {\n    return {\n      restrict: \"A\",\n      priority: 600,\n      templateUrl: \"../partials/popup.html\",\n      link: function link(scope, element, attr) {\n        function panelopen() {\n          scope.show = true;\n          runFun(popup['onPanelOpen']);\n        }\n\n        function panelCancel() {\n          scope.show = false;\n          runFun(popup['onPanelClose']);\n        }\n\n        function panelSubmit() {\n          scope.show = false;\n          popup.checkDataValiad(function (info) {\n            if (info == \"success\") {\n              runFun(popup['onPanelSubmit'], {\n                index: popup.getIndex(),\n                parameters: popup.getParameters(),\n                style: popup.getStyle(),\n                echart: popup.getEchart(),\n                data: popup.getSource(),\n                advance: popup.getAdvance()\n              });\n            } else {\n              growl.error(info);\n            }\n          });\n        }\n\n        scope.show = false;\n        scope.$panelCancel = panelCancel;\n        scope.$panelSubmit = panelSubmit;\n        scope.selectedView = {\n          items: [],\n          item: null\n        };\n\n        scope.initViewItems = function () {\n          if (scope.selectedView.items.length > 0) return;\n          var ad = popup.getAdvance();\n          if (ad.data.condition) scope.selectedView.items = JSONparse(ad.data.condition);else scope.selectedView.items = [];\n        };\n\n        scope.saveViewItems = function () {\n          scope.selectedView.items.sort(function (a, b) {\n            return parseInt(a.index) - parseInt(b.index);\n          });\n          var tabs = [];\n          scope.selectedView.items.forEach(function (view) {\n            tabs.push({\n              id: view.index,\n              index: view.index,\n              label: view.label,\n              name: view.label,\n              viewTitle: view.viewTitle,\n              default: view.viewTitle,\n              viewId: view.viewId,\n              show: view.show\n            });\n          });\n          var advance = popup.content[popup.content.length - 1];\n          advance.content.condition = tabs;\n          advance.list.forEach(function (attrItem) {\n            if (attrItem.$name == \"condition\") {\n              attrItem.value = tabs;\n            }\n          });\n        };\n\n        scope.addViewItem = function () {\n          if (scope.selectedView.item) {\n            var find = scope.selectedView.items.filter(function (item) {\n              if (item.viewId == scope.selectedView.item.viewId) return true;\n            });\n\n            if (find.length == 0) {\n              var addItem = jQuery.extend({}, scope.selectedView.item, true);\n              addItem.index = scope.selectedView.items.length;\n              scope.selectedView.items.push(addItem);\n            }\n          }\n        };\n\n        scope.deleteViewItem = function (delId) {\n          for (var i = scope.selectedView.items.length - 1; i > -1; i--) {\n            if (scope.selectedView.items[i].viewId == delId) {\n              scope.selectedView.items.splice(i, 1);\n              break;\n            }\n          }\n        };\n\n        popup.open = panelopen;\n        keySet.onCommandKeyWith('enter', function () {\n          panelSubmit();\n        });\n        scope.popup = popup;\n      }\n    };\n  }];\n  var exampleDirective = [\"$timeout\", function (timeout) {\n    return {\n      scope: {\n        \"template\": \"=\",\n        \"element\": \"=\"\n      },\n      restrict: \"A\",\n      link: function link(scope, element, attr) {\n        timeout(domReady);\n        scope.$root.$$childHead.initViewItems();\n\n        function domReady() {\n          var label = scope.template.label ? $(\"<div>\" + scope.template.label + \"</div>\") : null;\n          var wrap = $($(\"<table style='width:100%;height:100%;'><tr><td style='vertical-align: middle;'></td></tr></table>\"));\n          var dom = $(scope.element);\n          dom.removeAttr(\"css\");\n\n          var renderCss = function renderCss(style) {\n            dom.css(style);\n            dom.css(\"height\", \"50px\");\n          };\n\n          var renderText = function renderText(style) {\n            dom.text(\"文字样例\");\n            dom.css(style);\n          };\n\n          var renderImage = function renderImage(url) {\n            dom.css({\n              \"background-size\": \"contain\",\n              \"background-position\": \"center\",\n              \"background-repeat\": \"none\",\n              \"width\": \"100%\",\n              \"height\": \"100%\",\n              \"background-image\": \"url(\" + url + \")\"\n            });\n          };\n\n          wrap.css({\n            width: \"100%\",\n            height: \"80px\",\n            position: \"relative\",\n            overflow: \"hidden\"\n          });\n\n          if (scope.template.type == 'css') {\n            renderCss(scope.template['style']);\n          } else if (scope.template.type == 'image') {\n            renderImage(scope.template['url']);\n          } else if (scope.template.type == 'text') {\n            renderText(scope.template['style']);\n          }\n\n          wrap.find('td').append(dom);\n\n          if (label != null) {\n            element.append(label);\n          }\n\n          element.append(wrap);\n        }\n      }\n    };\n  }];\n  var autocompleteDirective = [\"$timeout\", function (timeout) {\n    return {\n      scope: {\n        ngModel: \"=\",\n        \"source\": \"=\"\n      },\n      restrict: \"A\",\n      link: function link(scope, element, attr) {\n        var inputBox = $(\"<input class='form-control'/>\");\n        timeout(domReady);\n\n        function domReady() {\n          element.append(inputBox);\n          inputBox.autocomplete({\n            select: function select(event, ui) {\n              scope.$apply(function () {\n                var name = ui.item.value;\n                var find = scope.source.find(function (elem) {\n                  return elem.label == name.split(\"(\")[0];\n                });\n                scope.ngModel = find.$name;\n              });\n            }\n          });\n          scope.$watch(\"ngModel\", function (n, o, s) {\n            if (n == undefined) {\n              inputBox.val(\"\");\n            }\n          });\n          scope.$watch(\"source\", function (n, o, s) {\n            if (n) {\n              var sourceFn = function sourceFn(request, responce) {\n                var input = request.term;\n                var src = n.map(function (element) {\n                  return element.label + \"(\" + element.$name + \")\";\n                }).filter(function (element) {\n                  return input == \"___ALL___\" ? true : element.indexOf(input) != -1;\n                });\n                responce(src);\n              };\n\n              inputBox.autocomplete(\"option\", \"source\", sourceFn);\n            }\n          });\n          inputBox.on(\"click\", function (event) {\n            var key = $(this).val() != \"\" ? $(this).val() : \"___ALL___\";\n            inputBox.autocomplete(\"search\", key);\n          });\n        }\n      }\n    };\n  }];\n\n  var angularPopupProvider = function angularPopupProvider() {\n    var self = this;\n    this.$get = [\"angular-style\", \"kqiManagerUIService\", \"serviceCenterService\", \"dictionaryService\", \"resourceUIService\", \"dialogue\", \"configUIService\", \"$timeout\", \"keySet\", \"growl\", function (angularStyle, kqiManagerUIService, serviceCenterService, dictionaryService, resourceUIService, dialogue, configUIService, timeout, keySet, growl) {\n      var rs = {},\n          rootModel;\n      var dirty = false;\n      var originalSource = {};\n      var originalEchart = {};\n      var originalParameter = {};\n      var originalStyle = {};\n      var originalAdvance = {};\n      self['style'] = angularStyle.getStyle();\n      self['echart'] = angularStyle.getEchart();\n      self['parameters'] = angularStyle.getParameters();\n      self['source'] = angularStyle.getSource();\n      self['advance'] = angularStyle.getAdvance(); //self['getChanged'] = angularStyle.getChanged();\n\n      function on(event, callback) {\n        rs[event] = callback;\n      }\n\n      function combination(all) {\n        return {\n          getUsed: function getUsed(input) {\n            var clone = input.$clone();\n\n            if (_typeof(all) == 'object' && all != null) {\n              for (var i in clone) {\n                (function (attr, val) {\n                  if (all.hasOwnProperty(attr)) {\n                    if (_typeof(all[attr]) == \"object\" && all[attr] != null) {\n                      clone[attr] = all[attr];\n                      clone[attr].value = val;\n                    }\n                  } else {\n                    delete clone[attr];\n                  }\n                })(i, clone[i]);\n              }\n            }\n\n            return clone;\n          },\n          getUsedAll: function getUsedAll(input) {\n            var clone;\n\n            if (_typeof(all) == 'object' && all != null) {\n              clone = all.$clone();\n\n              var traverse = function traverse(attr, val) {\n                for (var i in val) {\n                  (function (at, v) {\n                    var attribute = attr ? attr + \"/\" + at : at;\n\n                    if (_typeof(v) == \"object\" && at != 'data' && !(v instanceof Array)) {\n                      traverse(attribute, v);\n                    } else {\n                      if (_typeof(clone[attribute]) == 'object') {\n                        clone[attribute].value = v;\n                      }\n                    }\n                  })(i, val[i]);\n                }\n              };\n\n              traverse(undefined, input);\n            }\n\n            return clone;\n          },\n          getNoused: function getNoused(input) {\n            var clone;\n\n            if (_typeof(all) == 'object' && all != null) {\n              clone = all.$clone();\n\n              for (var i in input) {\n                (function (attr, val) {\n                  delete clone[attr];\n                })(i, input[i]);\n              }\n            }\n\n            return clone;\n          },\n          getAll: function getAll() {\n            return all.$clone();\n          },\n          getcss: function getcss(attr) {\n            return all[attr];\n          }\n        };\n      }\n\n      function setContent(data, element, index, title, url, type) {\n        rs.domHtml = getHtml(element);\n\n        function hideall(array) {\n          for (var i in array) {\n            array[i].show = false;\n          }\n        }\n\n        ;\n        keySet.onCommandKeyWith('e', function (event) {\n          var find = rs.content.find(function (elem) {\n            return elem.$name == \"advance\";\n          });\n\n          if (find) {\n            self['index'] = rs.content.indexOf(find);\n            ;\n            var fd = find.list.find(function (elem) {\n              return elem.$name == \"expression\";\n            });\n            rs.selected = find;\n            timeout(function () {\n              fd.open();\n            });\n          }\n\n          ;\n        });\n        rs.content = data.map(function (element) {\n          var clone = element.$clone();\n\n          clone.click = function () {\n            self['index'] = rs.content.indexOf(this);\n            rs.selected = clone;\n          };\n\n          if (element.$name == 'style') {\n            style(clone);\n          } else if (element.$name == 'parameters') {\n            parameters(clone);\n          } else if (element.$name == 'template') {\n            template();\n          } else if (element.$name == 'echart') {\n            echart(clone);\n          } else if (element.$name == 'source') {\n            source(clone);\n          } else if (element.$name == 'advance') {\n            advance(clone);\n          }\n\n          function source(clone, bool) {\n            if (bool != false) {\n              originalSource = clone.content.$clone();\n              originalSource.resource = originalSource.resource || [];\n              originalSource.kpi = originalSource.kpi || [];\n            }\n\n            ;\n            clone.preview = {};\n            var combo = self[clone.$name];\n\n            for (var i in clone.content) {\n              (function (attr) {\n                if (combo[attr]) {\n                  var val = clone.content[attr];\n                  clone.content[attr] = combo[attr];\n                  clone.content[attr].value = val;\n                }\n              })(i);\n            }\n\n            ;\n            serviceCenterService.rootDomain.get().then(getRootCi);\n\n            function getRootCi(rootCi) {\n              var success = function success(models) {\n                var getKpiByModelId = function getKpiByModelId(data) {\n                  var kpiMap = function kpiMap(elem) {\n                    return elem;\n                  };\n\n                  var rs = [];\n                  clone.kpis = data.map(kpiMap);\n\n                  var loop = function loop(inx, kpis) {\n                    if (_typeof(kpis[inx]) != \"object\") {\n                      var find = clone.kpis.find(function (elem) {\n                        return elem.id == kpis[inx];\n                      });\n\n                      if (find) {\n                        rs.push(find);\n                      }\n                    } else {\n                      rs.push(kpis[inx]);\n                    }\n                  };\n\n                  for (var i in clone.content.kpi) {\n                    loop(i, clone.content.kpi);\n                  }\n\n                  clone.content.kpi = rs;\n                };\n\n                var getResourceByModelId = function getResourceByModelId(data) {\n                  var resourceMap = function resourceMap(elem) {\n                    return elem;\n                  };\n\n                  var rs = [];\n                  clone.resources = data.map(resourceMap);\n\n                  var loop = function loop(inx, resources) {\n                    if (_typeof(resources[inx]) != \"object\") {\n                      var find = clone.resources.find(function (elem) {\n                        return elem.id == resources[inx];\n                      });\n\n                      if (find) {\n                        rs.push(find);\n                      }\n                    } else {\n                      rs.push(resources[inx]);\n                    }\n                  };\n\n                  for (var i in clone.content.resource) {\n                    loop(i, clone.content.resource);\n                  }\n\n                  clone.content.resource = rs;\n                };\n\n                var modelMap = function modelMap(element) {\n                  clone.content.modelTypeOnChange = function (id) {\n                    if (id != 0) {\n                      resourceUIService.getDataItemsByModelId(id, function (event) {\n                        if (event.code == 0) {\n                          getKpiByModelId(event.data);\n                        }\n                      });\n                      serviceCenterService.kpis.getBymodelId(id).then(getKpiByModelId);\n\n                      if (window[\"model_\" + id]) {\n                        getResourceByModelId(window[\"model_\" + id]);\n                      } else {\n                        resourceUIService.getResourceByModelId([id], function (event) {\n                          if (event.code == 0) {\n                            window[\"model_\" + id] = event.data;\n                            getResourceByModelId(event.data);\n                          }\n                        });\n                      }\n\n                      ;\n                      /** serviceCenterService.resources.getBymodelId(this.id).then(getResourceByModelId); */\n\n                      clone.content.resource = [];\n                      clone.content.kpi = [];\n                    } else {\n                      clone.content.model = clone.models[0];\n                      clone.content.model.onChange();\n                    }\n                  };\n\n                  clone.modelTypes = [{\n                    id: 0,\n                    label: \"模版\"\n                  }, {\n                    id: 300,\n                    label: \"管理域\"\n                  }, {\n                    id: 301,\n                    label: \"客户\"\n                  }, {\n                    id: 302,\n                    label: \"项目\" // ,{\n                    //   id : 303,\n                    //   label : \"企业\"\n                    // }\n\n                  }];\n                  clone.resfilltypes = [{\n                    id: \"manual\",\n                    label: \"指定\"\n                  }, {\n                    id: \"parameter\",\n                    label: \"传递参数\"\n                  }];\n                  clone.aggregate_rules = [{\n                    id: 0,\n                    label: \"取区间末位\"\n                  }, {\n                    id: 1,\n                    label: \"取区间首位\"\n                  }, {\n                    id: 2,\n                    label: \"取区平均值\"\n                  }];\n\n                  element.onChange = function () {\n                    resourceUIService.getDataItemsByModelId(this.id, function (event) {\n                      if (event.code == 0) {\n                        getKpiByModelId(event.data);\n                      }\n                    });\n                    serviceCenterService.kpis.getBymodelId(this.id).then(getKpiByModelId);\n                    var cur = this;\n\n                    if (window[\"model_\" + cur.id]) {\n                      getResourceByModelId(window[\"model_\" + cur.id]);\n                    } else {\n                      resourceUIService.getResourceByModelId([this.id], function (event) {\n                        if (event.code == 0) {\n                          window[\"model_\" + cur.id] = event.data;\n                          getResourceByModelId(event.data);\n                        }\n                      });\n                    }\n\n                    ;\n                    /** serviceCenterService.resources.getBymodelId(this.id).then(getResourceByModelId); */\n\n                    clone.content.resource = [];\n                    clone.content.kpi = [];\n                  };\n\n                  return element;\n                };\n\n                var init = function init(id) {\n                  var getAggregate_period_back = function getAggregate_period_back(data) {\n                    var a = [{\n                      label: \"无\",\n                      valueCode: null\n                    }];\n                    clone.granularityUnits = a.concat(data);\n                  };\n\n                  var getAggregate_type_back = function getAggregate_type_back(data) {\n                    //;\n                    clone.aggregate_types = data;\n                  };\n\n                  var getAggregate_instance_back = function getAggregate_instance_back(data) {\n                    clone.aggregate_instances = data;\n                  };\n\n                  resourceUIService.getDataItemsByModelId(id, function (event) {\n                    if (event.code == 0) {\n                      getKpiByModelId(event.data);\n                    }\n                  });\n                  resourceUIService.getResourceByModelId(id, function (event) {\n                    if (event.code == 0) {\n                      getResourceByModelId(event.data);\n                    }\n                  }); //serviceCenterService.resources.getBymodelId(id).then(getResourceByModelId);\n\n                  dictionaryService.getDictValues(\"KqiGranularityUnit\", function (event) {\n                    if (event.code == 0) {\n                      getAggregate_period_back(event.data.filter(function (elem) {\n                        return elem.label == \"月\" || elem.label == \"季度\" || elem.label == \"年\";\n                      }));\n                    }\n                  });\n                  dictionaryService.getDictValues(\"aggregateType\", function (event) {\n                    if (event.code == 0) {\n                      getAggregate_type_back(event.data);\n                    }\n                  });\n                  getAggregate_instance_back([{\n                    'label': '不使用',\n                    'id': 0\n                  }, {\n                    'label': '行业',\n                    'id': 1\n                  }, {\n                    'label': '区域',\n                    'id': 2\n                  }, {\n                    'label': '能源',\n                    'id': 3\n                  }, {\n                    'label': '行业简称',\n                    'id': 4\n                  }]);\n                };\n\n                clone.models = models.map(modelMap);\n                clone.content.model = clone.models.find(function (elem) {\n                  if (clone.content.model) {\n                    return elem.id == clone.content.model.id;\n                  } else {\n                    return false;\n                  }\n                });\n\n                var getKqiModels = function getKqiModels(data) {\n                  clone.kqiModels = data;\n                  clone.content.kqiModel = clone.kqiModels.find(function (elem) {\n                    if (clone.content.kqiModel) {\n                      return elem.id == clone.content.kqiModel.id;\n                    } else {\n                      return false;\n                    }\n                  });\n                };\n\n                kqiManagerUIService.getKqiModels(function (event) {\n                  if (event.code == 0) {\n                    getKqiModels(event.data);\n                  }\n                });\n\n                if (clone.content.modelType == 0) {\n                  if (clone.content.model) {\n                    init(clone.content.model.id);\n                  } else {\n                    clone.content.model = clone.models[0];\n                  }\n                } else {\n                  var modelId = clone.content.modelType;\n                  init(modelId);\n                }\n              };\n\n              var getRootModel = function getRootModel(event) {\n                //rootModel = event.data[0];\n                serviceCenterService.models.getAll().then(success);\n              };\n\n              resourceUIService.getModelByIds([rootCi.modelId], getRootModel);\n            }\n\n            ;\n\n            clone.renderData = function () {\n              for (var i in clone.content.bind) {\n                if (clone.content.hasOwnProperty(i)) {\n                  clone.content[i].value = clone.content.bind[i];\n                }\n              }\n\n              clone.content.legend.render(clone.content.legend.value);\n              clone.content.xAxis.render(clone.content.xAxis.value);\n              clone.content.yAxis.render(clone.content.yAxis.value);\n              clone.content.series.render(clone.content.series.value);\n            };\n          }\n\n          function echart(clone, bool) {\n            if (bool != false) {\n              originalEchart = clone.content.$clone();\n            }\n\n            ;\n\n            var getSelectStyle = function getSelectStyle(name) {\n              var rs = self[clone.$name].$attr(name);\n\n              if (rs == undefined) {//;\n              }\n\n              return rs;\n            };\n\n            var getStyle = function getStyle(attr, data) {\n              var combo, temp;\n              var style = getSelectStyle(attr);\n\n              if (style != undefined) {\n                temp = getSelectStyle(attr)['content'];\n                combo = combination(temp);\n                return combo.getUsedAll(data);\n              } else {\n                return undefined;\n              }\n            };\n\n            var getAllStyle = function getAllStyle(attr) {\n              var combo, temp;\n              temp = getSelectStyle(attr)['content'];\n              combo = combination(temp);\n              return combo.getAll();\n            };\n\n            var loop = function loop(attr, val) {\n              var regroup = function regroup(attr, data) {\n                if (angular.isArray(data)) {\n                  var result = [];\n\n                  var loop = function loop(item) {\n                    var style;\n\n                    if (attr == \"series\" || attr == \"visualMap\") {\n                      var style = getStyle(attr + \"/options/\" + item.type, item);\n                    } else {\n                      var style = getStyle(attr + \"/options/\" + attr, item);\n                    }\n\n                    if (style) {\n                      result.push(style);\n                    }\n                  };\n\n                  for (var i in data) {\n                    loop(data[i]);\n                  }\n\n                  return result;\n                } else {\n                  return getStyle(attr, data);\n                }\n              };\n\n              clone.content[attr] = regroup(attr, val);\n            };\n\n            for (var i in clone.content) {\n              loop(i, clone.content[i]);\n            }\n\n            ;\n            clone.list = objectToArrayObj(clone.content, false);\n            traverseByChild(clone.list, function (index, elem, parent) {\n              var name = elem.$name;\n              var style = getSelectStyle(name);\n\n              if (style) {\n                return createArr(style, elem, parent);\n              }\n            });\n\n            function createArr(style, elem, parent) {\n              var result = {},\n                  add;\n\n              var click = function click() {\n                self['subIndex'] = clone.list.indexOf(this);\n                clone.selected = result;\n              };\n\n              var deleteFn = function deleteFn() {\n                parent.$remove(function (index, element) {\n                  return result == element;\n                });\n              };\n\n              var select = function select() {\n                result.visible = !result.visible;\n              };\n\n              if (elem.$name == \"series\" || elem.$name == \"visualMap\") {\n                add = function add(type) {\n                  var st = getAllStyle(result.$name + \"/options/\" + type, data[i]);\n                  result.children.push(createArr(style, st, result.children));\n                };\n              } else {\n                add = function add() {\n                  var st, type;\n\n                  if (result.$name == 'series' || elem.$name == \"visualMap\") {\n                    var lastElement = result.children[result.children.length - 1];\n                    type = lastElement.children.find(function (elem) {\n                      return elem.$name == \"type\";\n                    }).value;\n                  } else {\n                    type = result.$name;\n                  }\n\n                  st = getAllStyle(result.$name + \"/options/\" + type, data[i]);\n                  result.children.push(createArr(style, st, result.children));\n                };\n              }\n\n              result = {\n                add: add,\n                click: click,\n                delete: deleteFn,\n                select: select,\n                arraylike: elem.folder != undefined,\n                $name: style.$name,\n                label: style.label,\n                visible: false\n              };\n\n              if (elem.folder == undefined) {\n                result.children = objectToArray(elem, ['$name']);\n              } else {\n                result.children = elem.folder;\n              }\n\n              return result;\n            }\n\n            function traverseByChild(data, callback) {\n              traverse(data);\n\n              function traverse(data) {\n                for (var i in data) {\n                  if (data[i].folder) {\n                    traverse(data[i].folder);\n                  }\n\n                  data[i] = callback(i, data[i], data);\n                }\n              }\n            }\n\n            if (index) {\n              if (index.length > 1) {\n                var subInx = index[1];\n                subInx = subInx > clone.list.length ? 0 : subInx;\n              } else {\n                subInx = 0;\n              }\n            } else {\n              subInx = 0;\n            }\n\n            clone.selected = clone.list[subInx];\n          }\n\n          function template() {\n            if (clone.content) {\n              clone.list = clone.content.map(function (elem) {\n                var st = elem.style;\n                var ec = elem.echart;\n                var adv = elem.advance;\n                var param = elem.parameters;\n                delete elem.chosen;\n\n                elem.choseTemplate = function () {\n                  dirty = true;\n\n                  for (var i in clone.content) {\n                    delete clone.content[i].chosen;\n                  }\n\n                  ;\n                  elem.chosen = true;\n\n                  if (st) {\n                    var styleGroup = rs.content.find(function (elem) {\n                      return elem.$name == 'style';\n                    });\n                    styleGroup.content = st;\n                    style(styleGroup, false);\n                  }\n\n                  if (ec) {\n                    var echartGroup = rs.content.find(function (elem) {\n                      return elem.$name == 'echart';\n                    });\n                    echartGroup.content = ec;\n                    echart(echartGroup, false);\n                  }\n\n                  if (adv) {\n                    var advGroup = rs.content.find(function (elem) {\n                      return elem.$name == 'advance';\n                    });\n                    advGroup.content = adv;\n                    advance(advGroup, false);\n                  }\n\n                  if (param) {\n                    var paramGroup = rs.content.find(function (elem) {\n                      return elem.$name == 'parameters';\n                    });\n                    paramGroup.content = param;\n                    parameters(paramGroup, false);\n                  }\n                };\n\n                return elem;\n              });\n            }\n          }\n\n          function parameters(clone, bool) {\n            if (bool != false) {\n              originalParameter = clone.content.$clone();\n            }\n\n            var getParameters = function getParameters(name) {\n              var rs = self[clone.$name].$attr(name);\n              return rs;\n            };\n\n            var combo = combination(self[clone.$name]);\n\n            var renderSub = function renderSub(element) {\n              element.change = function () {\n                ;\n                dirty = true;\n              };\n\n              var run = function run() {\n                var addEvent = function addEvent(elem) {\n                  if (element.select == elem.value) {\n                    element.selectItem = elem;\n                  }\n\n                  ;\n\n                  elem.click = function () {\n                    ;\n                    element.select = elem.value;\n                    element.selectItem = elem;\n                  };\n\n                  elem.change = function () {\n                    ;\n                  };\n                };\n\n                if (element.options) {\n                  for (var i in element.options) {\n                    addEvent(element.options[i]);\n                  }\n                }\n              };\n\n              if (element.$name == \"fileInput\") {\n                element.on = function (eventName, callback) {\n                  if (!element.$EVENTS) {\n                    element.$EVENTS = {};\n                  }\n\n                  element.$EVENTS[eventName] = callback;\n                };\n\n                element.trigger = function (eventName, data) {\n                  element.$EVENTS[eventName](data);\n                };\n\n                element.on(\"imageFileUploaded\", function (data) {\n                  ;\n                });\n              }\n\n              if (element.$name == \"imgSrc\") {\n                configUIService.getConfigsByGroupName(\"dashboardImage\", function (event) {\n                  if (event.code == \"0\") {\n                    Array.prototype.push.apply(element.options, event.data);\n                    run();\n                  }\n                });\n              } else {\n                run();\n              }\n\n              ;\n              return element;\n            };\n\n            clone.list = objectToArray(combo.getUsed(clone.content)).map(function (elem) {\n              return renderSub(elem);\n            });\n            ;\n          }\n\n          function style(clone, bool) {\n            if (bool != false) {\n              originalStyle = clone.content.$clone();\n            }\n\n            var combo = combination(self[clone.$name]);\n\n            clone.addVal = function (name) {\n              var item = clone.rest.find(function (el) {\n                return el.$name == name;\n              });\n              dirty = true;\n\n              if (item) {\n                var attr = item.$name;\n                var value = item.value;\n                rs.inputvalue = undefined;\n                rs.inputname = undefined;\n                var obj = arrayToObject(clone.list);\n                obj[attr] = combo.getcss(attr);\n                obj[attr].value = value;\n                clone.content = objToValue(obj);\n                renderlist();\n              }\n            };\n\n            renderlist();\n\n            function renderlist() {\n              clone.format = {\n                'label': function label(elem) {\n                  return elem.label;\n                },\n                'value': '$name'\n              };\n              clone.list = objectToArray(combo.getUsed(clone.content)).map(function (elem) {\n                var name = elem.$name;\n\n                elem.change = function () {\n                  dirty = true;\n                  ;\n                };\n\n                elem.delete = function () {\n                  var obj = arrayToObject(clone.list);\n                  delete obj[name];\n                  clone.content = objToValue(obj);\n                  renderlist();\n                };\n\n                return elem;\n              });\n\n              if (typeof combo.getNoused == 'function') {\n                clone.rest = objectToArray(combo.getNoused(clone.content));\n              } else {\n                clone.rest = [];\n              }\n            }\n          }\n\n          ;\n\n          function advance(clone, bool) {\n            if (bool != false) {\n              originalAdvance = clone.content.$clone();\n            }\n\n            var combo = combination(self[clone.$name]);\n\n            var renderSub = function renderSub(element) {\n              var addEvent = function addEvent(elem) {\n                if (element.select == elem.value) {\n                  element.selectItem = elem;\n                }\n\n                elem.click = function () {\n                  ;\n                  element.select = elem.value;\n                  element.selectItem = elem;\n                };\n\n                elem.change = function () {\n                  ;\n                };\n              };\n\n              if (element.options) {\n                for (var i in element.options) {\n                  addEvent(element.options[i]);\n                }\n              }\n\n              element.change = function () {\n                ;\n              };\n\n              return element;\n            };\n\n            clone.list = objectToArray(combo.getUsed(clone.content)).map(function (elem) {\n              return renderSub(elem);\n            });\n          }\n\n          return clone;\n        });\n        rs.selected = rs.content[index ? index[0] : 0];\n\n        rs.toHelpDoc = function () {\n          ;\n          url = url || \"../app-free-style/index.html#/help\";\n          window.open(url, \"blank\");\n        };\n\n        rs.label = title;\n        rs.type = type;\n      }\n\n      ;\n\n      function checkDataValiad(callback) {\n        var source = arrayToObject(this.content).$attr('source/content');\n\n        if (source) {\n          $$.loadExternalJs(['toolkit/date-handler', 'toolkit/value-list-handler'], function (dateHandler, valueListHandler) {\n            var getTime = function getTime(time) {\n              if (time) {\n                switch (time.unit) {\n                  case \"second\":\n                    return time.value * 1000;\n                    break;\n\n                  case \"minute\":\n                    return time.value * 60 * 1000;\n                    break;\n\n                  case \"hour\":\n                    return time.value * 60 * 60 * 1000;\n                    break;\n\n                  case \"day\":\n                    return time.value * 24 * 60 * 60 * 1000;\n                    break;\n\n                  case \"month\":\n                    return time.value * 30 * 24 * 60 * 60 * 1000;\n                    break;\n\n                  default:\n                    return time.value;\n                    break;\n                }\n              } else {\n                return 0;\n              }\n            };\n\n            var frequency = source.frequency;\n            var timespan = source.timespan;\n\n            if (timespan) {\n              var endTime = dateHandler.init();\n              var startTime = dateHandler.init(endTime.getTimeStamp() - getTime(timespan));\n              var vlh = valueListHandler.init();\n\n              try {\n                vlh.setTimeRange(startTime, endTime, frequency);\n                callback(\"success\");\n              } catch (e) {\n                callback(e.message);\n              }\n\n              ;\n            } else {\n              callback(\"success\");\n            }\n          }, function (error) {\n            ;\n          });\n        } else {\n          callback(\"success\");\n        }\n\n        ;\n      }\n\n      ;\n\n      function getSource() {\n        var source = arrayToObject(this.content).$attr('source/content');\n\n        if (source) {\n          source.legend = source.legend ? source.$attr(\"legend/value\") : undefined;\n          source.xAxis = source.xAxis ? source.$attr(\"xAxis/value\") : undefined;\n          source.series = source.series ? source.$attr(\"series/value\") : undefined;\n          source.kpi = source.kpi || [];\n          source.resource = source.resource || [];\n          var rs = {\n            applied: source.applied,\n            dataToX: source.dataToX,\n            text: source.text,\n            model: source.model,\n            kpi: source.kpi,\n            modelType: source.modelType,\n            resfilltype: source.resfilltype,\n            resource: source.resource,\n            kqiModel: source.kqiModel,\n            timespan: source.timespan,\n            format: source.format,\n            multipleCi: source.multipleCi,\n            multipleKpi: source.multipleKpi,\n            frequency: source.frequency,\n            aggregate_type: source.aggregate_type,\n            granularityUnit: source.granularityUnit,\n            aggregate_instance: source.aggregate_instance,\n            aggregate_rule: source.aggregate_rule,\n            autoFillBlank: source.autoFillBlank,\n            condition: source.condition,\n            legend: source.legend,\n            xAxis: source.xAxis,\n            xAxisType: source.xAxisType ? source.xAxisType : undefined,\n            yAxis: source.yAxis ? source.yAxis : undefined,\n            yAxisType: source.yAxisType ? source.yAxisType : undefined,\n            series: source.series\n          };\n\n          for (var i in rs) {\n            if (rs[i] == undefined) {\n              delete rs[i];\n            }\n          }\n\n          ;\n          return {\n            isDiff: JSON.stringify(source) != JSON.stringify(originalSource),\n            data: rs\n          };\n        } else {\n          return {\n            isDiff: false,\n            data: null\n          };\n        }\n      }\n\n      function getStyle() {\n        var style = objToValue(arrayToObject(arrayToObject(this.content).$attr('style/list')));\n        return {\n          isDiff: JSON.stringify(style) != JSON.stringify(originalStyle),\n          data: style\n        };\n      }\n\n      ;\n\n      function getParameters() {\n        var parameter = objToValue(arrayToObject(arrayToObject(this.content).$attr('parameters/list')));\n        return {\n          isDiff: JSON.stringify(parameter) != JSON.stringify(originalParameter),\n          data: parameter\n        };\n      }\n\n      ;\n\n      function getAdvance() {\n        var advance = objToValue(arrayToObject(arrayToObject(this.content).$attr('advance/list')));\n        return {\n          isDiff: JSON.stringify(advance) != JSON.stringify(originalAdvance),\n          data: advance\n        };\n      }\n\n      ;\n\n      function getEchart() {\n        var echartStyle = arrayToObject(this.content).$attr('echart/list');\n\n        var treeToObject = function treeToObject(data) {\n          var rs = {};\n          var echartStyle = self['echart'];\n          traverseChild(rs, data);\n\n          function traverseChild(target, data) {\n            for (var i in data) {\n              var name = data[i].$name;\n\n              if (data[i].arraylike) {\n                if (data[i].hasOwnProperty(\"children\")) {\n                  target[name] = [];\n\n                  for (var j in data[i].children) {\n                    (function (index, elem) {\n                      var obj = {};\n                      var styleVal, type;\n\n                      if (name == 'series' || name == 'visualMap') {\n                        var type = elem.children.find(function (elem) {\n                          return elem.$name == 'type';\n                        }).value;\n                        styleVal = echartStyle[name]['options'][type];\n                        target[name].push(obj);\n                        series(obj, elem.children, styleVal);\n                      } else {\n                        type = name;\n                        styleVal = echartStyle[name]['options'][type];\n                        target[name].push(obj);\n                        each(obj, elem.children, styleVal);\n                      }\n                    })(j, data[i].children[j]);\n                  }\n                }\n              } else {\n                if (data[i].hasOwnProperty(\"children\")) {\n                  var styleVal = echartStyle[name];\n                  target[name] = {};\n                  each(target[name], data[i].children, styleVal);\n                }\n              }\n            }\n          }\n\n          function each(target, data, compare) {\n            for (var i in data) {\n              (function (index, elem) {\n                var name = elem.$name;\n\n                if (elem.value != compare['content'][name].value) {\n                  target.$attr(name, elem.value);\n                }\n              })(i, data[i]);\n            }\n          }\n\n          function series(target, data, compare) {\n            for (var i in data) {\n              (function (index, elem) {\n                var name = elem.$name;\n\n                if (elem.value != compare['content'][name].value || name == \"type\") {\n                  target.$attr(name, elem.value);\n                }\n              })(i, data[i]);\n            }\n          }\n\n          return rs;\n        };\n\n        var treeObj = treeToObject(echartStyle);\n        return {\n          isDiff: JSON.stringify(treeObj) != JSON.stringify(originalEchart),\n          data: treeObj\n        };\n      }\n\n      ;\n\n      function getIndex() {\n        return [self[\"index\"] ? self[\"index\"] : 0, self[\"subIndex\"] ? self[\"subIndex\"] : 0];\n      }\n\n      ;\n      rs = {\n        content: {},\n        on: on,\n        getIndex: getIndex,\n        getStyle: getStyle,\n        getEchart: getEchart,\n        setContent: setContent,\n        getParameters: getParameters,\n        getSource: getSource,\n        checkDataValiad: checkDataValiad,\n        getAdvance: getAdvance,\n        submitPanel: function submitPanel(callback) {\n          var cur = this;\n          cur.checkDataValiad(function (info) {\n            if (info == \"success\") {\n              callback({\n                index: cur.getIndex(),\n                parameters: cur.getParameters(),\n                style: cur.getStyle(),\n                echart: cur.getEchart(),\n                data: cur.getSource(),\n                advance: cur.getAdvance()\n              });\n            } else {\n              growl.error(info);\n              callback(null);\n            }\n          });\n        }\n      };\n      return rs;\n    }];\n  };\n\n  angular.module(\"ngAngularPopup\", []).directive(\"example\", exampleDirective).directive(\"autocompletecustom\", autocompleteDirective).directive(\"popup\", angularPopupDirective).provider(\"popup\", angularPopupProvider);\n})(window, angular);"],"sourceRoot":"/source/"}