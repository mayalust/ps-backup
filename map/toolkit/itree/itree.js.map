{"version":3,"sources":["toolkit/itree/itree.js"],"names":["define","treeDataHandler","init","dom","data","format","rootUl","$","children","remove","addClass","append","treeMenu","rootNode","events","searchbox","input","button","searchIcon","css","attr","prop","on","event","stopPropagation","val","prototype","eventName","callback","open","keyCode","close","buttons","node","BUTTONS","createBtn","inx","elem","clickFn","$attr","icon","label","class","text","disabled","i","cbox","span","CBOX","check","removeClass","uncheck","half","traverse","parent","parentDom","searchCondition","alwaysShow","hasDesChecked","lv","checkbox","level","li","showDescription","onOpenFn","onCloseFn","searchBtn","sbtnIns","description","buttongroup","btngroupIns","updateIcon","customeIconWrap","hline","vline","circle","isLast","descriptionDom","setTimeout","customeIcon","iconwrap","item","ICONIMAGEPLUS","ICONIMAGEDOWN","wrap","find","folderStyle","setLabel","folderOpenAndClose","_preventdefault","preventdefault","closeOtherWhileOpen","traverseBrothers","brother","hasClass","checkboxclick","value","setCheckboxValue","checkboxs","getDescendants","child","undefined","showfold","setHighlight","hideOther","fd","hl","show","hide","search","alwaysShowFn","searchable","pass","filterKey","push","length","indexOf","remapcss","state","this","resetcheck","setDescription","str","childrend","checked","all","traverseDescendants","traverseParents","checkboxdom","mcbox","updateNode","nd","update","triggerEvent","ul","removeAttr","exposeToLeve","$on","hideRootNode"],"mappings":"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","file":"toolkit/itree/itree.js","sourcesContent":["define(['./tree-data-handler'], function (treeDataHandler) {\n  return {\n    init: function init(dom, data, format) {\n      var rootUl = $(\"<div></div>\");\n      dom.children().remove();\n      rootUl.addClass(\"ul\");\n      dom.append(rootUl);\n\n      var treeMenu = function treeMenu(rootNode) {\n        var events = {};\n        var searchbox = {\n          init: function init(dom) {\n            var events = {};\n            var input = $(\"<input/>\");\n            var button = $(\"<span></span>\");\n            var searchIcon = $(\"<span></span>\");\n\n            var searchbox = function searchbox(dom) {\n              input.css(\"margin-left\", \"5px\");\n              input.attr(\"placeholder\", \"检索下一级内容\");\n              button.addClass(\"searchbox\");\n              searchIcon.addClass(\"glyphicon glyphicon-search\");\n              button.prop(\"disabled\", \"disabled\");\n              button.css(\"margin\", \"0 5px\");\n              button.append(searchIcon);\n              dom.append(input);\n              dom.append(button);\n              dom.on(\"click\", function (event) {\n                event.stopPropagation();\n              });\n              button.on(\"click\", function (event) {\n                if (input.css(\"display\") != \"none\") {\n                  events['search'](input.val());\n                }\n              });\n            };\n\n            searchbox.prototype.on = function (eventName, callback) {\n              events[eventName] = callback;\n            };\n\n            searchbox.prototype.open = function () {\n              input.css(\"display\", \"inline-block\");\n              input.on(\"keypress\", function (event) {\n                if (event.keyCode == 13) {\n                  events['search'](input.val());\n                }\n              });\n            };\n\n            searchbox.prototype.close = function () {\n              input.css(\"display\", \"none\");\n            };\n\n            return new searchbox(dom);\n          }\n        };\n        var buttons = {\n          init: function init(dom, node) {\n            var span = $(\"<span></span>\");\n            var events = {};\n\n            var BUTTONS = function BUTTONS(dom) {\n              dom.addClass(\"btn-group\");\n              dom.css(\"float\", \"right\");\n\n              var createBtn = function createBtn(inx, elem) {\n                var clickFn = elem.$attr(\"on/click\");\n                var button = $(\"<button></button>\");\n                var icon = $(\"<span></span>\");\n                var label = $(\"<span></span>\");\n                button.addClass(elem.class || \"btn btn-default\");\n                icon.addClass(elem.icon);\n                label.text(elem.label);\n\n                if (elem.disabled) {\n                  button.attr(\"disabled\", \"disabled\");\n                }\n\n                button.append(icon);\n                button.append(label);\n                button.on(\"click\", function (event) {\n                  event.stopPropagation();\n\n                  if (clickFn) {\n                    clickFn(node);\n                  }\n                });\n                return button;\n              };\n\n              for (var i in node.buttons) {\n                dom.append(createBtn(i, node.buttons[i]));\n              }\n            };\n\n            BUTTONS.prototype.on = function (eventName, callback) {\n              events[eventName] = callback;\n            };\n\n            return new BUTTONS(dom);\n          }\n        };\n        var cbox = {\n          init: function init(dom) {\n            var span = $(\"<span></span>\");\n\n            var CBOX = function CBOX(dom) {\n              dom.addClass(\"checkbox\");\n              span.addClass(\"glyphicon glyphicon-ok\");\n              dom.append(span);\n            };\n\n            CBOX.prototype.check = function () {\n              span.css(\"opacity\", 1);\n              span.removeClass().addClass(\"glyphicon glyphicon-ok\");\n            };\n\n            CBOX.prototype.uncheck = function () {\n              span.css(\"opacity\", 0);\n            };\n\n            CBOX.prototype.half = function () {\n              span.css(\"opacity\", 1);\n              span.removeClass().addClass(\"glyphicon glyphicon-minus\");\n            };\n\n            return new CBOX(dom);\n          }\n        };\n\n        var traverse = function traverse(node) {\n          //console.log(node.domains.split(\"/\").length);\n          if (!node.parent) {\n            node.parentDom = rootUl;\n          }\n\n          ;\n\n          var searchCondition = function searchCondition() {\n            return true;\n          };\n\n          var alwaysShow = function alwaysShow(node) {\n            return node.hasDesChecked() != \"none\" || node.$attr(\"checkbox/value\") || !node.parent;\n          };\n\n          var checkbox = node.checkbox;\n          var lv = node.level;\n          var li = $(\"<div></div>\");\n          var showDescription = node.$attr(\"showDescription\");\n          var clickFn = node.$attr(\"on/click\");\n          var onOpenFn = node.$attr(\"on/open\");\n          var onCloseFn = node.$attr(\"on/close\");\n          var searchBtn = $(\"<span></span>\");\n          var sbtnIns = searchbox.init(searchBtn);\n          var description = $(\"<span></span>\");\n          var buttongroup = $(\"<div></div>\");\n\n          if (!showDescription) {\n            description.css(\"display\", \"none\");\n          }\n\n          var btngroupIns = buttons.init(buttongroup, node);\n\n          var updateIcon = function updateIcon(icon) {\n            customeIconWrap.removeClass();\n            customeIconWrap.addClass(icon);\n          };\n\n          if (node.parent) {\n            var hline = $(\"<div></div>\");\n            var vline = $(\"<div></div>\");\n            var circle = $(\"<div></div>\");\n            vline.addClass(\"vline\");\n            circle.addClass(\"circle\");\n\n            if (node.isLast) {\n              if (node.isLast()) {\n                hline.addClass(\"hline_short\");\n              } else {\n                hline.addClass(\"hline\");\n              }\n\n              ;\n            } else {\n              hline.addClass(\"hline_short\");\n            }\n\n            ;\n            vline.css(\"left\", 20 * lv - 10);\n            hline.css(\"left\", 20 * lv - 10);\n            circle.css(\"left\", 20 * lv - 4);\n            li.append(hline);\n            li.append(vline);\n            li.append(circle);\n          }\n\n          ;\n          description.addClass(\"description\");\n          description.text(node.description);\n          node.dom = li;\n          node.btngroupIns = btngroupIns;\n          node.descriptionDom = description;\n          setTimeout(function () {\n            node.parentDom.append(li);\n          });\n          var customeIconWrap = $(\"<span></span>\");\n          var customeIcon = $(\"<div></div>\");\n          var iconwrap = $(\"<div></div>\");\n          customeIconWrap.append(customeIcon); //customeIconWrap.css(\"display\", \"inline-block\");\n\n          iconwrap.addClass(\"plusminus\");\n          var icon = $(\"<span></span>\");\n          li.addClass(\"li\");\n          var text = $(\"<span></span>\");\n          text.addClass(\"text\");\n          var item = $(\"<div></div>\");\n          item.css(\"padding-left\", 20 * lv);\n          item.addClass(\"item\");\n          item.addClass(\"level-\" + lv);\n          var wrap = $(\"<div></div>\");\n          item.on(\"mouseenter\", function () {\n            dom.find(\".item\").removeClass(\"focus\");\n            item.addClass(\"focus\");\n          });\n          node.item = item;\n          wrap.addClass(\"wrap\");\n          var ICONIMAGEPLUS, ICONIMAGEDOWN;\n\n          if (node.folderStyle == 1) {\n            iconwrap.addClass(\"folder_1\");\n            ICONIMAGEPLUS = \"glyphicon-triangle-left\";\n            ICONIMAGEDOWN = \"glyphicon-triangle-bottom\";\n          } else {\n            iconwrap.addClass(\"folder\");\n            ICONIMAGEPLUS = \"glyphicon-plus\";\n            ICONIMAGEDOWN = \"glyphicon-minus\";\n          }\n\n          ;\n          iconwrap.append(icon);\n\n          var setLabel = function setLabel(label) {\n            text.text(label);\n          };\n\n          setLabel(node.label);\n\n          var folderOpenAndClose = function folderOpenAndClose(event) {\n            event.stopPropagation();\n            var _preventdefault = false;\n            var event = {\n              node: node,\n              preventdefault: function preventdefault() {\n                _preventdefault = true;\n              }\n            };\n\n            if (node.closeOtherWhileOpen) {\n              node.traverseBrothers(function (brother) {\n                brother.close();\n              });\n            }\n\n            if (!_preventdefault) {\n              if (li.hasClass(\"active\")) {\n                if (node.close) {\n                  node.close();\n                }\n\n                ;\n\n                if (onCloseFn) {\n                  onCloseFn(event);\n                }\n\n                ;\n              } else {\n                if (node.open) {\n                  node.open();\n                }\n\n                ;\n\n                if (onOpenFn) {\n                  onOpenFn(event);\n                }\n              }\n\n              ;\n            }\n\n            ;\n          };\n\n          var setCheckValue = function setCheckValue(val) {\n            var val = val || node.checkbox.value;\n            node.remapcss(val == true ? \"all\" : \"none\");\n            node.traverseDescendants(function (child) {\n              child.setCheckboxValue(val);\n              child.remapcss(val == true ? \"all\" : \"none\");\n            });\n            node.traverseParents(function (node) {\n              var state = node.hasDesChecked();\n              node.remapcss(state);\n              node.resetcheck(state);\n              node.setDescription();\n            });\n          };\n\n          var checkboxclick = function checkboxclick(event) {\n            event.stopPropagation();\n            var val = !node.checkbox.value;\n            node.setCheckboxValue(val);\n            var checkboxs = rootNode.getDescendants(function (child) {\n              return child.$attr(\"checkbox/value\");\n            });\n            events[\"check\"](checkboxs);\n          };\n\n          if (node.icon) {\n            updateIcon(node.icon);\n            item.append(customeIconWrap);\n          }\n\n          ;\n\n          if (node.children != undefined && node.showfold != false) {\n            item.append(iconwrap);\n          }\n\n          ;\n\n          node.setHighlight = function (hideOther) {\n            if (hideOther) {\n              rootNode.traverse(function (node) {\n                var fd = node.dom;\n                if (!fd) return;\n                var hl = fd.find(\".highlight\");\n                if (!hl) return;\n                hl.removeClass(\"highlight\");\n              });\n            }\n\n            item.addClass(\"highlight\");\n          };\n\n          node.searchBtn = sbtnIns;\n\n          node.show = function () {\n            node.dom.css(\"display\", \"block\");\n          };\n\n          node.hide = function () {\n            node.dom.css(\"display\", \"none\");\n          };\n\n          node.search = function (callback, alwaysShowFn) {\n            searchCondition = callback || searchCondition;\n            alwaysShow = alwaysShowFn || alwaysShow;\n\n            var traverse = function traverse(child) {\n              if (child.searchable != false) {\n                var pass = child.getDescendants(function (child) {\n                  return searchCondition(child);\n                });\n                var parent = child.parent || {};\n                var filterKey = parent.filterKey || \"\";\n\n                if (searchCondition(child)) {\n                  pass.push(child);\n                }\n\n                ;\n\n                if (pass.length > 0 && child.label.indexOf(filterKey) != -1 || alwaysShow(child)) {\n                  if (child.open) {\n                    child.open();\n                  }\n\n                  child.show();\n                } else {\n                  child.hide();\n                }\n\n                ;\n              }\n\n              ;\n            };\n\n            node.traverse(traverse);\n          };\n\n          node.remapcss = function (state) {\n            this.dom.removeClass(\"some-checked\");\n            this.dom.removeClass(\"all-checked\");\n\n            if (state == \"all\") {\n              this.dom.addClass(\"all-checked\");\n            } else if (state == \"some\") {\n              this.dom.addClass(\"some-checked\");\n            }\n          };\n\n          node.resetcheck = function (state) {\n            if (this.checkbox) {\n              if (state == \"all\") {\n                this.checkbox.cbox.check();\n                this.checkbox.value = true;\n              } else if (state == \"some\") {\n                this.checkbox.cbox.half();\n                this.checkbox.value = true;\n              } else {\n                this.checkbox.cbox.uncheck();\n                this.checkbox.value = false;\n              }\n            }\n\n            ;\n          };\n\n          node.setDescription = function (str) {\n            if (str) {\n              this.descriptionDom.text(str);\n            } else {\n              var childrend = this.getDescendants(function (child) {\n                return child.$attr(\"checkbox/value\");\n              });\n\n              if (childrend.length > 0) {\n                this.descriptionDom.text(\"(已选:\" + childrend.length + \"个)\");\n              } else {\n                this.descriptionDom.text(\"\");\n              }\n            }\n\n            ;\n          };\n\n          node.hasDesChecked = function () {\n            var node = this;\n            var checked = node.getDescendants(function (child) {\n              return child.$attr(\"checkbox/value\") == true;\n            });\n            var all = node.getDescendants();\n\n            if (all.length > 0) {\n              if (checked.length > 0 && checked.length < all.length) {\n                return \"some\";\n              } else if (checked.length == all.length) {\n                return \"all\";\n              }\n            }\n\n            ;\n            return \"none\";\n          };\n\n          node.setCheckboxValue = function (value) {\n            var node = this;\n\n            if (node.checkbox) {\n              node.checkbox.value = value != undefined ? value : node.checkbox.value;\n\n              if (node.checkbox.value) {\n                node.checkbox.cbox.check();\n              } else {\n                node.checkbox.cbox.uncheck();\n              }\n            }\n\n            ;\n            setCheckValue(value);\n          }; //var state = node.hasDesChecked();\n\n\n          if (node.checkbox) {\n            var checkboxdom = $(\"<div></div>\");\n            var mcbox = cbox.init(checkboxdom);\n            node.checkbox.cbox = mcbox;\n            node.setCheckboxValue();\n            /**if(node.checkbox){\n              state = \"all\";\n            }*/\n\n            checkboxdom.on(\"click\", checkboxclick);\n          } //node.remapcss(state);\n\n\n          item.append(checkboxdom);\n          item.append(text);\n          item.append(description);\n          li.append(item);\n\n          node.remove = function () {\n            node.dom.remove();\n          };\n\n          node.updateNode = function (nd) {\n            updateIcon(nd.icon);\n            setLabel(nd.label);\n          };\n\n          node.update = function () {\n            node.remove();\n            node.traverse(traverse);\n          };\n\n          if (node.triggerEvent == \"fold\") {\n            item.on(\"click\", function (event) {\n              folderOpenAndClose(event);\n\n              if (clickFn) {\n                clickFn(node);\n              }\n\n              ;\n            });\n          } else if (node.triggerEvent == \"checkbox\") {\n            item.on(\"click\", checkboxclick);\n          } else {\n            item.on(\"click\", function (event) {\n              if (clickFn) {\n                clickFn(node);\n              }\n\n              ;\n            });\n          }\n\n          ;\n          sbtnIns.on(\"search\", function (value) {\n            node.filterKey = value;\n            rootNode.search();\n          });\n\n          if (node.children != undefined) {\n            item.addClass(\"has-children\");\n\n            if (node.children.length == 0) {\n              var empty = {\n                label: \"暂无数据\",\n                parentDom: wrap,\n                parent: node,\n                level: lv + 1\n              };\n              traverse(empty);\n            }\n\n            li.append(wrap);\n            icon.addClass(\"glyphicon \" + ICONIMAGEPLUS);\n\n            if (item.searchable) {\n              item.append(searchBtn);\n            }\n\n            ;\n\n            for (var i in node.children) {\n              var ul = $(\"<div></div>\");\n              ul.addClass(\"ul\");\n              wrap.append(ul);\n              node.children[i].parentDom = ul;\n            }\n\n            node.open = function () {\n              sbtnIns.open();\n              searchBtn.removeAttr(\"disabled\");\n              li.addClass(\"active\");\n              icon.removeClass(ICONIMAGEPLUS);\n              icon.addClass(ICONIMAGEDOWN);\n            };\n\n            node.close = function () {\n              sbtnIns.close();\n              searchBtn.prop(\"disabled\", \"disabled\");\n              li.removeClass(\"active\");\n              icon.addClass(ICONIMAGEPLUS);\n              icon.removeClass(ICONIMAGEDOWN);\n            };\n\n            iconwrap.on(\"click\", function (event) {\n              event.stopPropagation();\n              folderOpenAndClose(event);\n            });\n          }\n\n          ;\n          item.append(buttongroup);\n        };\n\n        rootNode.on = function (eventName, callback) {\n          events[eventName] = callback;\n        };\n\n        rootNode.traverse(traverse);\n\n        treeMenu.prototype.exposeToLeve = function (lv) {\n          rootNode.traverse(function (node) {\n            if (node.level < lv) {\n              if (node.open) node.open();\n            } else {\n              if (node.close) node.close();\n            }\n          });\n        };\n\n        rootNode.$on(\"rootNodeRefresh\", function () {\n          rootNode.update();\n        });\n\n        rootNode.hideRootNode = function () {\n          rootNode.item.css(\"display\", \"none\");\n        };\n\n        return rootNode;\n      };\n\n      return new treeMenu(treeDataHandler.init(data, format));\n    }\n  };\n});"],"sourceRoot":"/source/"}