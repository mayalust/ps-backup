{"version":3,"sources":["toolkit/component/kpilist4.js"],"names":["define","ultility","data","expression","dom","$","element","style","$$","runExpression","$attr","funRes","code","fnResult","system","console","error","message","initFn","render","wrap","document","createElement","colorObj","1","2","4","3","padding","item","i","format","head","name","background","appendChild","body","value","kpiCode","find","on","e","navigateTo","sensor","dataItems","target","dataset","runExpressionSuccess"],"mappings":"AAAAA,OAAO,CAAC,oDAAqD,SAAUC,GACrE,OAAO,SAAUC,GACf,IAGIC,EAHAC,EAAMC,EAAE,eACRC,EAAUJ,EAAKI,QACfC,EAAQL,EAAKI,QAAQC,MA4EzB,OA1EAC,GAAGC,cAAcH,EAAQI,MAAM,sBAAuB,SAAUC,GAC9D,GAAmB,KAAfA,EAAOC,KAAa,CACtB,IAAIC,EAAWF,EAAOT,KAQtBC,GALEA,EADqB,mBAAZU,EACIA,EAASX,EAAMY,QAEfD,IAGY,QAE3BV,EAAa,GACbY,QAAQC,MAAML,EAAOM,UAMzB,SAA8Bd,GAC5B,IAAIe,EAASf,EAAWO,MAAM,WAC9BH,EAAQA,GAAgB,GA4CxB,GAFAD,EAAQa,OAxCK,SAAgBjB,GAC3B,IAAIkB,EAAOC,SAASC,cAAc,OAE9BC,EAAW,CACbC,EAAG,mGACHC,EAAG,mGACHC,EAAG,mGACHC,EAAG,oGAEDpB,EAAQL,EAAKK,OAAS,CACxBqB,QAAS,YAEPC,EAAOxB,EAAE,eAEb,IAAK,IAAIyB,KAAK5B,EAAK6B,OAAQ,CACzB,IAAIC,EAAO3B,EAAE,SAAWH,EAAK6B,OAAOD,GAAGG,KAAO,WAC9CD,EAAK,GAAGzB,MAAMqB,QAAUrB,EAAMqB,QAC9BI,EAAK,GAAGzB,MAAM2B,WAAa,UAC3BL,EAAK,GAAGM,YAAYH,EAAK,IAG3B,IAAK,IAAIF,KAAK5B,EAAKA,KAAM,CACvB,IAAIkC,EAAO/B,EAAE,sFAAwFH,EAAKA,KAAK4B,GAAG5B,EAAK6B,OAAO,GAAGM,OAAS,qCAAuCd,EAASrB,EAAKA,KAAK4B,GAAG5B,EAAK6B,OAAO,GAAGM,QAAU,iBAAmBnC,EAAKA,KAAK4B,GAAGQ,QAAU,mBAC1QT,EAAK,GAAGM,YAAYC,EAAK,IACzBA,EAAKG,KAAK,cAAcC,GAAG,QAAS,SAAUC,GAC5CnC,EAAQoC,WAAW,QAAS,OAAQ,CAGlCC,OAAQ,KACRC,UAAWH,EAAEI,OAAOC,QAAQT,UAOlCjB,EAAKe,YAAYN,EAAK,IACtBzB,EAAI,GAAG+B,YAAYf,IAKjBF,EACF,IACEA,EAAO,CACL2B,OAAQvC,IAEV,MAAOmC,KAtDXM,CAAqB5C,KA0DhBC","file":"toolkit/component/kpilist4.js","sourcesContent":["define(['../../../node_modules/ps-ultility/ps-ultility.js'], function (ultility) {\n  return function (data) {\n    var dom = $(\"<div></div>\");\n    var element = data.element;\n    var style = data.element.style;\n    var expression;\n    $$.runExpression(element.$attr(\"advance/expression\"), function (funRes) {\n      if (funRes.code == \"0\") {\n        var fnResult = funRes.data;\n\n        if (typeof fnResult == 'function') {\n          expression = fnResult(data, system);\n        } else {\n          expression = fnResult;\n        }\n\n        expression = expression || {};\n      } else {\n        expression = {};\n        console.error(funRes.message);\n      }\n\n      runExpressionSuccess(expression);\n    });\n\n    function runExpressionSuccess(expression) {\n      var initFn = expression.$attr(\"on/init\");\n      style = style ? style : {};\n\n      var render = function render(data) {\n        var wrap = document.createElement(\"div\"); // 根据告警级别判断颜色\n\n        var colorObj = {\n          1: \"width: 15px;height: 15px;border-radius: 50%;background:#00bb7b;margin: 0 26% 0 0;cursor: pointer\",\n          2: \"width: 15px;height: 15px;border-radius: 50%;background:#efd80b;margin: 0 26% 0 0;cursor: pointer\",\n          4: \"width: 15px;height: 15px;border-radius: 50%;background:#cc0000;margin: 0 26% 0 0;cursor: pointer\",\n          3: \"width: 15px;height: 15px;border-radius: 50%;background:#ff8800;margin: 0 26% 0 0;cursor: pointer\"\n        };\n        var style = data.style || {\n          padding: \"4px 18px\"\n        };\n        var item = $(\"<div></div>\");\n\n        for (var i in data.format) {\n          var head = $(\"<span>\" + data.format[i].name + \"</span>\");\n          head[0].style.padding = style.padding;\n          head[0].style.background = \"#214767\";\n          item[0].appendChild(head[0]);\n        }\n\n        for (var i in data.data) {\n          var body = $(\"<div style='display: flex;justify-content: space-between;padding: 6px 0 0 0'><span>\" + data.data[i][data.format[0].value] + \"</span><span class='click' style='\" + colorObj[data.data[i][data.format[1].value]] + \"' data-value='\" + data.data[i].kpiCode + \"'></span></div>\");\n          item[0].appendChild(body[0]);\n          body.find(\"span.click\").on(\"click\", function (e) {\n            element.navigateTo(\"index\", \"专业分析\", {\n              // id: elem.row.nodeId,\n              // specialty:elem.row.specialtyProp,\n              sensor: \"02\",\n              dataItems: e.target.dataset.value // startdate: new Date(elem.row.arisingTime).getTime()- 2*60*60*1000,\n              // enddate:new Date(elem.row.arisingTime).getTime() + 1*60*60*1000\n\n            });\n          });\n        }\n\n        wrap.appendChild(item[0]);\n        dom[0].appendChild(wrap);\n      };\n\n      element.render = render;\n\n      if (initFn) {\n        try {\n          initFn({\n            target: element\n          });\n        } catch (e) {}\n      }\n    }\n\n    return dom;\n  };\n});"],"sourceRoot":"/source/"}