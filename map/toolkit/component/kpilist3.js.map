{"version":3,"sources":["toolkit/component/kpilist3.js"],"names":["define","ultility","data","expression","dom","$","element","style","$$","runExpression","$attr","funRes","code","fnResult","system","console","error","message","initFn","render","kpiValueObj","kpiDic","alertLevelObj1","wrap","document","createElement","colorObj","1","2","3","4","item","i","value","toFixed","unit","levelColor","items","kpiName","appendChild","find","on","e","navigateTo","sensor","dataItems","target","runExpressionSuccess"],"mappings":"AAAAA,OAAO,CAAC,oDAAqD,SAAUC,GACrE,OAAO,SAAUC,GACf,IAGIC,EAHAC,EAAMC,EAAE,eACRC,EAAUJ,EAAKI,QACfC,EAAQL,EAAKI,QAAQC,MAoEzB,OAlEAC,GAAGC,cAAcH,EAAQI,MAAM,sBAAuB,SAAUC,GAC9D,GAAmB,KAAfA,EAAOC,KAAa,CACtB,IAAIC,EAAWF,EAAOT,KAQtBC,GALEA,EADqB,mBAAZU,EACIA,EAASX,EAAMY,QAEfD,IAGY,QAE3BV,EAAa,GACbY,QAAQC,MAAML,EAAOM,UAMzB,SAA8Bd,GAC5B,IAAIe,EAASf,EAAWO,MAAM,WAC9BH,EAAQA,GAAgB,GAoCxB,GAFAD,EAAQa,OAhCK,SAAgBjB,EAAMkB,EAAaC,EAAQC,GACtD,IAAIC,EAAOC,SAASC,cAAc,OAE9BC,EAAW,CACbC,EAAG,UACHC,EAAG,UACHC,EAAG,UACHC,EAAG,WAEDC,EAAO1B,EAAE,qDAEb,IAAK,IAAI2B,KAAK9B,EAAM,CAClB,IAAI+B,EAAQb,EAAYY,IAAMZ,EAAYY,GAAGC,MAAQ,GAAGC,QAAQ,GAAKb,EAAOW,GAAGG,KAAO,IAClFC,EAAad,EAAeU,GAAKN,EAASJ,EAAeU,GAAGC,OAAS,UACrEI,EAAQhC,EAAE,4GAA8GH,EAAK8B,GAAGM,QAAU,uHAAyHF,EAAa,qCAAuCH,EAAQ,iBACnUF,EAAK,GAAGQ,YAAYF,EAAM,IAC1BA,EAAMG,KAAK,cAAcC,GAAG,QAAS,SAAUC,GAC7CpC,EAAQqC,WAAW,QAAS,OAAQ,CAGlCC,OAAQ,KACRC,UAAWb,MAOjBT,EAAKgB,YAAYR,EAAK,IACtB3B,EAAI,GAAGmC,YAAYhB,IAKjBL,EACF,IACEA,EAAO,CACL4B,OAAQxC,IAEV,MAAOoC,KA9CXK,CAAqB5C,KAkDhBC","file":"toolkit/component/kpilist3.js","sourcesContent":["define(['../../../node_modules/ps-ultility/ps-ultility.js'], function (ultility) {\n  return function (data) {\n    var dom = $(\"<div></div>\");\n    var element = data.element;\n    var style = data.element.style;\n    var expression;\n    $$.runExpression(element.$attr(\"advance/expression\"), function (funRes) {\n      if (funRes.code == \"0\") {\n        var fnResult = funRes.data;\n\n        if (typeof fnResult == 'function') {\n          expression = fnResult(data, system);\n        } else {\n          expression = fnResult;\n        }\n\n        expression = expression || {};\n      } else {\n        expression = {};\n        console.error(funRes.message);\n      }\n\n      runExpressionSuccess(expression);\n    });\n\n    function runExpressionSuccess(expression) {\n      var initFn = expression.$attr(\"on/init\");\n      style = style ? style : {};\n\n      var render = function render(data, kpiValueObj, kpiDic, alertLevelObj1) {\n        var wrap = document.createElement(\"div\"); // 根据告警级别判断颜色\n\n        var colorObj = {\n          1: \"#00bb7b\",\n          2: \"#efd80b\",\n          3: \"#ff8800\",\n          4: \"#cc0000\"\n        };\n        var item = $(\"<div style='display: flex;flex-wrap: wrap'></div>\"); // 拼接所有的数据项\n\n        for (var i in data) {\n          var value = kpiValueObj[i] ? (kpiValueObj[i].value - 0).toFixed(2) + kpiDic[i].unit : \"-\";\n          var levelColor = alertLevelObj1[i] ? colorObj[alertLevelObj1[i].value] : \"#00bb7b\";\n          var items = $(\"<div style='margin:5px 0px;text-align: right;width: 32%'><span style='color:#b4b5b5;margin-right: 6px; '>\" + data[i].kpiName + \"</span><span class='click' style='cursor: pointer; width: 60px;display: inline-block; border-radius: 8px;background:\" + levelColor + \";text-align: center;color: white'>\" + value + \"</span></div>\");\n          item[0].appendChild(items[0]);\n          items.find(\"span.click\").on(\"click\", function (e) {\n            element.navigateTo(\"index\", \"专业分析\", {\n              // id: elem.row.nodeId,\n              // specialty:elem.row.specialtyProp,\n              sensor: \"01\",\n              dataItems: i // startdate: new Date(elem.row.arisingTime).getTime()- 2*60*60*1000,\n              // enddate:new Date(elem.row.arisingTime).getTime() + 1*60*60*1000\n\n            });\n          });\n        }\n\n        wrap.appendChild(item[0]);\n        dom[0].appendChild(wrap);\n      };\n\n      element.render = render;\n\n      if (initFn) {\n        try {\n          initFn({\n            target: element\n          });\n        } catch (e) {}\n      }\n    }\n\n    return dom;\n  };\n});"],"sourceRoot":"/source/"}