{"version":3,"sources":["toolkit/component/video.js"],"names":["define","data","expression","element","timeout","autostart","$attr","innerContent","$","videotype","url","style","geturl","$$","runExpression","funRes","code","fnResult","system","initFn","render","obj","loadExternalJs","jwplayer","setup","file","width","parent","height","title","aspectratio","events","onComplete","onPause","analytics","enabled","provider","http.startparam","embed","attr","append","video","css","flashvars","f","a","c","p","s","lv","params","bgcolor","allowFullScreen","allowScriptAccess","wmode","CKobject","embedSWF","live","EZUIPlayer","target","e","getCurrentResource","resource","values","VIDEO"],"mappings":"AAGAA,OAAO,GAAI,WACT,OAAO,SAAUC,GACf,IAUIC,EAVAC,EAAUF,EAAKE,QACfC,EAAUH,EAAKG,QACfC,EAAYF,EAAQG,MAAM,wBAC1BC,EAAeC,EAAE,0BACjBC,EAAYN,EAAQG,MAAM,wBAC1BI,EAAMP,EAAQG,MAAM,kBACpBK,EAAQR,EAAQG,MAAM,SAGtBM,GAFWT,EAAQG,MAAM,uBACdH,EAAQG,MAAM,uBAChBH,EAAQG,MAAM,mBAE3BO,GAAGC,cAAcX,EAAQG,MAAM,sBAAuB,SAAUS,GAC9D,GAAmB,KAAfA,EAAOC,KAAa,CACtB,IAAIC,EAAWF,EAAOd,KAQtBC,GALEA,EADqB,mBAAZe,EACIA,EAAShB,EAAMiB,QAEfD,IAGwB,QAEvCf,EAAa,KAIjB,IAAIiB,EAASjB,EAAWI,MAAM,WAE1Bc,EAAS,SAAgBC,GAC3B,GAAiB,SAAbZ,EACFI,GAAGS,eAAe,CAAC,YAAa,WAC9BlB,EAAQ,WAEOmB,SAAS,SAASC,MAAM,CACnCC,KAAMJ,EAAIX,IACVgB,MAAOnB,EAAaoB,SAASD,QAC7BE,OAAQjB,EAAQA,EAAMiB,OAAS,IAC/BC,MALU,GAMVxB,UAAWA,EACXyB,YAAa,OACbC,OAAQ,CACNC,WAAY,aAEZC,QAAS,cAGXC,UAAW,CACTC,SAAS,GAEXC,SAAU,OACVC,kBAAmB,uBAIpB,GAAiB,SAAb5B,EAAsB,CAC/B,IAAI6B,EAAQ9B,EAAE,mBACd8B,EAAMC,KAAK,MAAOlB,EAAIX,KACtB4B,EAAMC,KAAK,UAAW,QACtBD,EAAMC,KAAK,QAAS,UACpBD,EAAMC,KAAK,QAAS,QACpBD,EAAMC,KAAK,SAAU5B,EAAQA,EAAMiB,OAAS,KAC5CU,EAAMC,KAAK,YAAa,2BACxBD,EAAMC,KAAK,oBAAqB,UAChCD,EAAMC,KAAK,mBAAmB,GAC9BD,EAAMC,KAAK,OAAQ,eACnBD,EAAMC,KAAK,OAAQ,iCACnBhC,EAAaiC,OAAOF,QACf,GAAiB,UAAb7B,EAAuB,CAChC,IAAIgC,EAAQjC,EAAE,8BACdiC,EAAMC,IAAI,QAASnC,EAAaoB,SAASD,QAAU,MACnDe,EAAMC,IAAI,SAAU/B,EAAQA,EAAMiB,OAAS,KAC3Cf,GAAGS,eAAe,CAAC,YAAa,WAC9B,IAAIqB,EAAY,CACdC,EAAG,wCACHC,EAAGxB,EAAIX,IACPoC,EAAG,EAEHC,EAAG,EAEHC,EAAG,EAEHC,GAAI,GAGFC,EAAS,CACXC,QAAS,OACTC,iBAAiB,EACjBC,kBAAmB,SACnBC,MAAO,eAETlD,EAAQ,WACNmD,SAASC,SAAS,mCAAoC,YAAa,QAAS,OAAQ,OAAQb,EAAWO,OAG3G3C,EAAaiC,OAAOC,QACf,GAAiB,QAAbhC,EAAqB,CAC9B,IAAIgD,EAAOjD,EAAE,4FACbJ,EAAQ,WACNqD,EAAKf,IAAI,QAASnC,EAAaoB,SAASD,QAAU,MAClD+B,EAAKf,IAAI,SAAU/B,EAAQA,EAAMiB,OAAS,KAC1C6B,EAAKlB,KAAK,MAAOlB,EAAIX,KACrBH,EAAaiC,OAAOiB,GACpB5C,GAAGS,eAAe,CAAC,WAAY,WAChB,IAAIoC,WAAW,kBAUpC,GAFAvD,EAAQiB,OAASA,EAEbD,EACF,IACEA,EAAO,CACLwC,OAAQxD,IAEV,MAAOyD,QAMK,gBAAVhD,EACFT,EAAQ0D,mBAAmB,SAAUC,GAC/BA,GACF1C,EAAO,CACLV,IAAKoD,EAASC,OAAOC,UAK3B5C,EAAO,CACLV,IAAKA,IAQX,OAAOH","file":"toolkit/component/video.js","sourcesContent":["/**\n * Created by leonlin on 16/11/3.\n */\ndefine([], function () {\n  return function (data) {\n    var element = data.element;\n    var timeout = data.timeout;\n    var autostart = element.$attr(\"parameters/autostart\");\n    var innerContent = $(\"<div id='video'></div>\");\n    var videotype = element.$attr(\"parameters/videotype\");\n    var url = element.$attr(\"parameters/url\");\n    var style = element.$attr(\"style\");\n    var username = element.$attr(\"parameters/username\");\n    var password = element.$attr(\"parameters/password\");\n    var geturl = element.$attr(\"advance/geturl\");\n    var expression;\n    $$.runExpression(element.$attr(\"advance/expression\"), function (funRes) {\n      if (funRes.code == \"0\") {\n        var fnResult = funRes.data;\n\n        if (typeof fnResult == 'function') {\n          expression = fnResult(data, system);\n        } else {\n          expression = fnResult;\n        }\n\n        expression = expression ? expression : {};\n      } else {\n        expression = {};\n        ; //throw new Error(funRes.message);\n      }\n    });\n    var initFn = expression.$attr(\"on/init\");\n\n    var render = function render(obj) {\n      if (videotype == \"video\") {\n        $$.loadExternalJs([\"jwplayer\"], function () {\n          timeout(function () {\n            var title = \"\";\n            var player = jwplayer('video').setup({\n              file: obj.url,\n              width: innerContent.parent().width(),\n              height: style ? style.height : 300,\n              title: title,\n              autostart: autostart,\n              aspectratio: '16:9',\n              events: {\n                onComplete: function onComplete() {//getPlayPosition();\n                },\n                onPause: function onPause() {//getPlayPosition();\n                }\n              },\n              analytics: {\n                enabled: true\n              },\n              provider: \"http\",\n              \"http.startparam\": \"starttime\"\n            });\n          });\n        });\n      } else if (videotype == \"embed\") {\n        var embed = $(\"<embed></embed>\");\n        embed.attr(\"src\", obj.url);\n        embed.attr(\"quality\", \"high\");\n        embed.attr(\"align\", \"middle\");\n        embed.attr(\"width\", '100%');\n        embed.attr(\"height\", style ? style.height : 300);\n        embed.attr(\"flashvars\", \"autoplay=true&play=true\");\n        embed.attr(\"allowScriptAccess\", \"always\");\n        embed.attr(\"allowFullScreen\", true);\n        embed.attr(\"mode\", \"transparent\");\n        embed.attr(\"type\", \"application/x-shockwave-flash\");\n        innerContent.append(embed);\n      } else if (videotype == \"camera\") {\n        var video = $('<div id=\"videoPlay\"></div>');\n        video.css(\"width\", innerContent.parent().width() + \"px\");\n        video.css(\"height\", style ? style.height : 300);\n        $$.loadExternalJs(['ckplayer'], function () {\n          var flashvars = {\n            f: '../../../../toolkit/ckplayer/m3u8.swf',\n            a: obj.url,\n            c: 0,\n            // 0-使用ckplayer.js的配置 1-使用ckplayer.xml的配置\n            p: 1,\n            // 1-默认播放 0-默认暂停\n            s: 4,\n            // 4-使用swf视频流插件播放\n            lv: 1 // 1-直播 0-普通方式\n\n          };\n          var params = {\n            bgcolor: '#FFF',\n            allowFullScreen: true,\n            allowScriptAccess: 'always',\n            wmode: 'transparent'\n          };\n          timeout(function () {\n            CKobject.embedSWF(\"../toolkit/ckplayer/ckplayer.swf\", \"videoPlay\", \"video\", \"100%\", \"100%\", flashvars, params);\n          });\n        });\n        innerContent.append(video);\n      } else if (videotype == \"live\") {\n        var live = $('<video id=\"myPlayer\" poster=\"\" controls playsInline webkit-playsinline autoplay></video>');\n        timeout(function () {\n          live.css(\"width\", innerContent.parent().width() + \"px\");\n          live.css(\"height\", style ? style.height : 300);\n          live.attr('src', obj.url);\n          innerContent.append(live);\n          $$.loadExternalJs(['ezuikit'], function () {\n            var player = new EZUIPlayer('myPlayer');\n          });\n        });\n      }\n\n      ;\n    };\n\n    element.render = render;\n\n    if (initFn) {\n      try {\n        initFn({\n          target: element\n        });\n      } catch (e) {\n        ;\n      }\n\n      ;\n    } else {\n      if (geturl == \"fromResource\") {\n        element.getCurrentResource(function (resource) {\n          if (resource) {\n            render({\n              url: resource.values.VIDEO\n            });\n          }\n        });\n      } else {\n        render({\n          url: url\n        });\n      }\n\n      ;\n    }\n\n    ;\n    return innerContent;\n  };\n});"],"sourceRoot":"/source/"}