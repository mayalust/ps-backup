{"version":3,"sources":["toolkit/configure/alarm.js"],"names":["define","d3","init","tg","option","smallMode","AlARMPOINT","title","svg","select","wholewrap","selectAll","append","wrap","alarmWrapShadow","defs","alarmWrap","alarm","alarmShadow","alarmHighlight","text","hitarea","events","creatGradient","id","config","color1","color2","type","x1","y1","x2","r","y2","fx","fy","offset1","offset2","linearGradient","attr","style","setAttr","i","this","setStyle","threeDbar","call","transform","text-anchor","fill","font-size","font-weight","text-shadow","cx","cy","width","height","opacity","cursor","on","event","prototype","setPos","pos","x","y","eventName","handler","setAlarmStatus","status","color"],"mappings":"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","file":"toolkit/configure/alarm.js","sourcesContent":["/**\n * Created by leonlin on 16/11/3.\n */\ndefine(['d3'], function (d3) {\n  return {\n    init: function init(tg, option) {\n      var smallMode = option.smallMode;\n      var WIDTH = 30;\n      var HEIGHT = 30; //var AlARMPOINT = WIDTH / 3.2;\n\n      var AlARMPOINT = WIDTH / 4.2;\n      var color = \"#2d8ee5\";\n      var alarmColor = \"#00e55d\";\n      var title = option.title;\n      var svg = d3.select(tg);\n      var viewport = svg.selectAll(\".viewport\");\n      var wholewrap = viewport.append(\"g\");\n      var wrap = wholewrap.append(\"g\");\n      var rect = wrap.append(\"rect\");\n      var alarmWrapShadow = wrap.append(\"circle\");\n      var defs = svg.select(\"defs\");\n      var alarmWrap = wrap.append(\"circle\");\n      var alarm = wrap.append(\"circle\");\n      var alarmShadow = wrap.append(\"circle\");\n      var alarmHighlight = wrap.append(\"circle\");\n      var text = wholewrap.append(\"text\");\n      var hitarea = wholewrap.append(\"rect\");\n      var events = {};\n\n      var creatGradient = function creatGradient(id, config) {\n        var id = id;\n        var color1 = config.color1 || \"#000\";\n        var color2 = config.color2 || \"#fff\";\n        var type = config.type || \"linearGradient\";\n        var x1 = config.x1 || \"0%\";\n        var y1 = config.y1 || \"0%\";\n        var x2 = config.x2 || \"100%\";\n        var y2 = config.y2 || \"0%\";\n        var r = config.r * 0.5;\n        var fx = config.fx;\n        var fy = config.fy;\n        var offset1 = config.offset1 || \"0%\";\n        var offset2 = config.offset2 || \"100%\";\n        var linearGradient = defs.append(type).attr(\"id\", id).attr(\"x1\", x1).attr(\"y1\", y1).attr(\"x2\", x2).attr(\"r\", r).attr(\"fx\", fx).attr(\"fy\", fy);\n        var stop1 = linearGradient.append(\"stop\").attr(\"offset\", offset1).style(\"stop-color\", color1);\n        var stop2 = linearGradient.append(\"stop\").attr(\"offset\", offset2).style(\"stop-color\", color2);\n      };\n\n      var setAttr = function setAttr(config) {\n        var cur = this;\n\n        for (var i in config) {\n          cur.attr(i, config[i]);\n        }\n      };\n\n      var setStyle = function setStyle(config) {\n        var cur = this;\n\n        for (var i in config) {\n          cur.style(i, config[i]);\n        }\n      };\n\n      function threeDbar() {\n        wrap.attr(\"transform\", \"scale(1,-1)\");\n        text.text(title);\n\n        if (smallMode) {\n          setAttr.call(text, {\n            transform: \"translate(\" + WIDTH * .6 + \", 0)\"\n          });\n        } else {\n          setAttr.call(text, {\n            transform: \"translate(0, -\" + HEIGHT * .7 + \")\"\n          });\n        }\n\n        setStyle.call(text, {\n          \"text-anchor\": smallMode ? \"left\" : \"middle\",\n          fill: \"#fff\",\n          \"font-size\": smallMode ? \"10px\" : \"12px\",\n          \"font-weight\": \"bold\",\n          \"text-shadow\": \"1px 1px 3px rgba(0,0,0,.8)\"\n        });\n        creatGradient(\"wrapShadow\", {\n          color1: \"#999\",\n          color2: \"#ccc\",\n          x1: \"0%\",\n          x2: \"0%\",\n          y1: \"100%\"\n        });\n        creatGradient(\"alarmShadow\", {\n          type: \"radialGradient\",\n          color1: \"rgba(0,0,0,0)\",\n          color2: \"rgba(0,0,0,.3)\",\n          x1: \"0%\",\n          x2: \"0%\",\n          r: \"50%\",\n          fx: \"50%\",\n          fy: \"50%\"\n        });\n        creatGradient(\"alarmWrapShadow\", {\n          type: \"radialGradient\",\n          color1: \"rgba(0,0,0,.3)\",\n          color2: \"rgba(0,0,0,0)\",\n          x1: \"0%\",\n          x2: \"0%\",\n          r: \"50%\",\n          fx: \"50%\",\n          fy: \"50%\"\n        });\n        creatGradient(\"alarmHighlight\", {\n          color1: \"rgba(250,250,250,1)\",\n          color2: \"rgba(250,250,250,0)\",\n          x1: \"0%\",\n          y1: \"100%\",\n          x2: \"0%\",\n          y2: \"0%\",\n          offset2: \"50%\"\n        });\n        setAttr.call(alarmWrap, {\n          cx: 0,\n          cy: AlARMPOINT * .3,\n          r: AlARMPOINT * 1.2\n        });\n        setStyle.call(alarmWrap, {\n          fill: \"url(#wrapShadow)\"\n        });\n        setAttr.call(alarmWrapShadow, {\n          cx: 0,\n          cy: AlARMPOINT * .3,\n          r: AlARMPOINT * 3\n        });\n        setStyle.call(alarmWrapShadow, {\n          fill: \"url(#alarmWrapShadow)\"\n        });\n        setAttr.call(alarm, {\n          cx: 0,\n          cy: AlARMPOINT * .3,\n          r: AlARMPOINT\n        });\n        setStyle.call(alarm, {\n          fill: alarmColor\n        });\n        setAttr.call(alarmShadow, {\n          cx: 0,\n          cy: AlARMPOINT * .3,\n          r: AlARMPOINT\n        });\n        setAttr.call(hitarea, {\n          width: WIDTH,\n          height: HEIGHT,\n          transform: \"translate(-\" + WIDTH / 2 + \",-\" + HEIGHT / 2 + \")\"\n        });\n        setStyle.call(hitarea, {\n          fill: \"blue\",\n          opacity: 0,\n          cursor: \"pointer\"\n        });\n        setStyle.call(alarmShadow, {\n          fill: \"url(#alarmShadow)\"\n        });\n        setAttr.call(alarmHighlight, {\n          cx: 0,\n          cy: AlARMPOINT * .3,\n          r: AlARMPOINT * .8\n        });\n        setStyle.call(alarmHighlight, {\n          fill: \"url(#alarmHighlight)\"\n        });\n        text.on(\"click\", function (event) {\n          if (events[\"textClick\"]) {\n            events[\"textClick\"](event);\n          }\n\n          ;\n        });\n        hitarea.on(\"click\", function (event) {\n          if (events[\"click\"]) {\n            events[\"click\"](event);\n          }\n\n          ;\n        });\n        hitarea.on(\"mouseover\", function (event) {\n          if (events[\"mouseover\"]) {\n            events[\"mouseover\"](event);\n          }\n\n          ;\n        });\n      }\n\n      ;\n\n      threeDbar.prototype.setPos = function (pos) {\n        wholewrap.attr(\"transform\", \"translate(\" + pos.x + \",\" + pos.y + \")\");\n      };\n\n      threeDbar.prototype.on = function (eventName, handler) {\n        events[eventName] = handler;\n      };\n\n      threeDbar.prototype.setAlarmStatus = function (status) {\n        var color = \"\";\n        var color3D = \"\";\n\n        switch (status) {\n          case 4:\n            color = \"#e74e53\";\n            color3D = \"rgba(72,13,8,.7)\";\n            break;\n\n          case 3:\n            color = \"#ee6b1c\";\n            color3D = \"rgba(72,13,8,.7)\";\n            break;\n\n          case 2:\n            color = \"#ece417\";\n            color3D = \"rgba(94,86,6,.7)\";\n            break;\n\n          case 1:\n            color = \"#00bc79\";\n            color3D = \"rgba(11,86,64,.7)\";\n            break;\n\n          default:\n            color = \"#00bc79\";\n            color3D = \"rgba(11,86,64,.7)\";\n            break;\n        }\n\n        setStyle.call(alarm, {\n          fill: color\n        });\n      };\n\n      return new threeDbar(tg);\n    }\n  };\n});"],"sourceRoot":"/source/"}