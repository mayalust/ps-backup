{"version":3,"sources":["toolkit/dataTable-ctrl/data-table-ctrl.js"],"names":["root","factory","define","amd","F$","FjQuery","this","dataTableInstance","arr","extend","a","b","i","dataTable","dom","data","columns","dataRemap","api","init","self","$","rowCallback","row","index","tds","children","html","node","length","render","fun","attr","get","append","prototype","remove","inx","indexOf","splice","draw","update","output","hasOwnProperty","d","push","add","search","keywords","prepend","unshift","toArray","each","callback","slice","find","filter","reduce","map"],"mappings":"CAGA,SAAWA,EAAMC,GACO,mBAAXC,QAAyBA,OAAOC,IAEzCD,OAAO,GAAI,WACT,OAAOD,EAAQD,KAIjBA,EAAKI,GAAKJ,EAAKK,QAAUJ,EAAQD,GARrC,CAUGM,KAAM,SAAUN,GACjB,IAAIO,EACAC,EAAM,GAEV,SAASC,EAAOC,EAAGC,GACjB,IAAK,IAAIC,KAAKD,EACZD,EAAEE,GAAKD,EAAEC,GAiHb,OAvGA,SAASC,EAAUC,EAAKC,EAAMC,GAC5B,IAAIC,EAAWC,EAEXC,EAAON,EAAUM,KAAO,SAAUL,EAAKC,EAAMC,GAC/C,IAAII,EAAOd,KACXC,EAAoBc,EAAEP,GAAKD,UAAU,CACnCE,KAAMA,EACNC,QAASA,EACTM,YAAa,SAAqBC,EAAKR,EAAMS,GAC3C,IAAIC,EAAMJ,EAAEE,GAAKG,SAAS,MAC1BD,EAAIE,KAAK,IACT,IAAIC,EAAOR,EAAKI,GAAS,IAAIX,EAAUU,IAAIR,GAC3CK,EAAKS,OAASL,EAAQ,EAAIJ,EAAKS,OAASL,EAAQ,EAAIJ,EAAKS,OAEzD,IAAK,IAAIjB,EAAI,EAAGA,EAAII,EAAQa,OAAQjB,IAClC,GAAgC,mBAArBI,EAAQJ,GAAGkB,OAAsB,CAC1C,IAAIC,EAAMf,EAAQJ,GAAGkB,OACjBE,EAAOhB,EAAQJ,GAAGG,KACtBM,EAAEI,EAAIQ,IAAIrB,IAAIsB,OAAOH,EAAIH,EAAMA,EAAKI,SAK5Cd,EAAMX,EAAkBW,OAGtBK,EAAMV,EAAUU,IAAM,SAAUR,GAClCN,EAAOH,KAAMS,IAwEf,OArEAQ,EAAIY,UAAUC,OAAS,WACrB,IAAIC,EAAMpB,EAAUqB,QAAQhC,MACpBY,EAAIK,IAAIc,GACdD,SACFnB,EAAUsB,OAAOF,EAAK,GACtBnB,EAAIsB,QAGNjB,EAAIY,UAAUM,OAAS,WACrB,IAAIJ,EAAMpB,EAAUqB,QAAQhC,MACpBY,EAAIK,IAAIc,GACdtB,KAAKE,EAAUgB,IAAII,IACrBnB,EAAIsB,QAGNjB,EAAIY,UAAUpB,KAAO,WACnB,IAAI2B,EAAS,GAEb,IAAK,IAAI9B,KAAKN,KACRA,KAAKqC,eAAe/B,KACtB8B,EAAO9B,GAAKN,KAAKM,IAIrB,OAAO8B,GAGTjC,EAAOU,EAAKgB,UAAW,CACrBN,OAAQ,EACRI,IAAK,SAAaI,GAEhB,OADWpB,EAAUoB,GACTtB,QAEdmB,OAAQ,SAAgBU,GACtBtC,KAAKuC,KAAK,IAAIhC,EAAUU,IAAIqB,IAC5B1B,EAAIK,IAAIuB,IAAIF,GACZtC,KAAKkC,QAEPA,KAAM,WACJtB,EAAIsB,QAENO,OAAQ,SAAgBC,KACxBC,QAAS,SAAiBL,GACxBtC,KAAK4C,QAAQ,IAAIrC,EAAUU,IAAIqB,KAEjCO,QAAS,WAGP,IAFA,IAAIT,EAAS,GAEJ9B,EAAI,EAAGA,EAAIK,EAAUY,OAAQjB,IACpC8B,EAAOG,KAAK5B,EAAUL,GAAGG,QAG3B,OAAO2B,GAETU,KAAM,SAAcC,GAClB,IAAK,IAAIzC,EAAI,EAAGA,EAAIN,KAAKuB,OAAQjB,IAC/ByC,EAASzC,EAAGN,KAAKM,KAGrBiC,KAAMrC,EAAIqC,KACVS,MAAO9C,EAAI8C,MACXf,OAAQ/B,EAAI+B,OACZD,QAAS9B,EAAI8B,QACbiB,KAAM/C,EAAI+C,KACVC,OAAQhD,EAAIgD,OACZC,OAAQjD,EAAIiD,OACZC,IAAKlD,EAAIkD,MAEXzC,EAAY,IAAIJ,EAAUM,KAAKL,EAAKC,EAAMC","file":"toolkit/dataTable-ctrl/data-table-ctrl.js","sourcesContent":["/**\n * data-table-controller Created by leonlin.\n */\n(function (root, factory) {\n  if (typeof define === \"function\" && define.amd) {\n    /** for AMD use*/\n    define([], function () {\n      return factory(root);\n    });\n  } else {\n    /** for Global use*/\n    root.F$ = root.FjQuery = factory(root);\n  }\n})(this, function (root) {\n  var dataTableInstance,\n      arr = [];\n\n  function extend(a, b) {\n    for (var i in b) {\n      a[i] = b[i];\n    }\n  }\n\n  function wrapHtml(dom) {\n    var wrap = $(\"<div></div>\");\n    wrap.append(dom);\n    return wrap.html();\n  }\n\n  function dataTable(dom, data, columns) {\n    var dataRemap, api;\n\n    var init = dataTable.init = function (dom, data, columns) {\n      var self = this;\n      dataTableInstance = $(dom).dataTable({\n        data: data,\n        columns: columns,\n        rowCallback: function rowCallback(row, data, index) {\n          var tds = $(row).children(\"td\");\n          tds.html(\"\");\n          var node = self[index] = new dataTable.row(data);\n          self.length = index + 1 > self.length ? index + 1 : self.length;\n\n          for (var i = 0; i < columns.length; i++) {\n            if (typeof columns[i].render == \"function\") {\n              var fun = columns[i].render;\n              var attr = columns[i].data;\n              $(tds.get(i)).append(fun(node, node[attr]));\n            }\n          }\n        }\n      });\n      api = dataTableInstance.api();\n    };\n\n    var row = dataTable.row = function (data) {\n      extend(this, data);\n    };\n\n    row.prototype.remove = function () {\n      var inx = dataRemap.indexOf(this);\n      var r = api.row(inx);\n      r.remove();\n      dataRemap.splice(inx, 1);\n      api.draw();\n    };\n\n    row.prototype.update = function () {\n      var inx = dataRemap.indexOf(this);\n      var r = api.row(inx);\n      r.data(dataRemap.get(inx));\n      api.draw();\n    };\n\n    row.prototype.data = function () {\n      var output = {};\n\n      for (var i in this) {\n        if (this.hasOwnProperty(i)) {\n          output[i] = this[i];\n        }\n      }\n\n      return output;\n    };\n\n    extend(init.prototype, {\n      length: 0,\n      get: function get(inx) {\n        var node = dataRemap[inx];\n        return node.data();\n      },\n      append: function append(d) {\n        this.push(new dataTable.row(d));\n        api.row.add(d);\n        this.draw();\n      },\n      draw: function draw() {\n        api.draw();\n      },\n      search: function search(keywords) {},\n      prepend: function prepend(d) {\n        this.unshift(new dataTable.row(d));\n      },\n      toArray: function toArray() {\n        var output = [];\n\n        for (var i = 0; i < dataRemap.length; i++) {\n          output.push(dataRemap[i].data());\n        }\n\n        return output;\n      },\n      each: function each(callback) {\n        for (var i = 0; i < this.length; i++) {\n          callback(i, this[i]);\n        }\n      },\n      push: arr.push,\n      slice: arr.slice,\n      splice: arr.splice,\n      indexOf: arr.indexOf,\n      find: arr.find,\n      filter: arr.filter,\n      reduce: arr.reduce,\n      map: arr.map\n    });\n    dataRemap = new dataTable.init(dom, data, columns);\n    return dataRemap;\n  }\n\n  ;\n  return dataTable;\n});"],"sourceRoot":"/source/"}