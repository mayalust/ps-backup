{"version":3,"sources":["app-sc/js/directives/tglibrary-dom.js"],"names":["define","directives","echarts","slick","tgSlickDir","q","timeout","compile","serviceCenterService","directive","restrict","scope","previewList","mode","click","link","element","$previewList_watcher","n","o","s","data","Array","length","j","$","find","size","removeAllSlick","units","getAll","then","i","index","TOP_TEXT","BLOCK_IMAGE","BOTTOM_TEXT","$slickItem","$pdom","$block","$idom","$h5dom","unit","console","log","kpi","unitSymbol","ele","unitCode","unitName","attr","addClass","css","width","height","append","on","$apply","dots","arrows","draggable","slidesToScroll","variableWidth","infinite","$watch","tgImageDir","blk","window","event","ipcamDir","ic","url","document","tooltip","position","my","at","using","feedback","this","vertical","horizontal","appendTo","openCam","value","closeCam","removeAttr","requesturl","ipcaminfo","loginauth","goalurl","resizable","handle","containment","parent","snap","snapMode","ajax","type","contenttype","success","parseJSON","username","password","ip","port","tgDragDir","chart","target","helper","result","border","revert","cursor","cursorAt","tgDropDir","onDrop","droppable","drop","ui","ready","tgElementDir","stopResize","stopMove","aspectRatio","scale","stop","echartsDir","setOption","option","_option_","pushData","time","series","shift","xAxis","push","parseFloat","ci","init","id","resize","tgRotateDir","rotate","highLight","clearTimeout","to","setTimeout","animate","opacity","scrollbarDir","control","setValue","slider","onChange","range","slide","onSlide","sendDeviceDirective","blinkDir","startBlink","blinkFn","selector","duration","complete","stopBlink","toggleDir","template","tg","removeClass","parseInt","registerDirective","$inject"],"mappings":"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","file":"app-sc/js/directives/tglibrary-dom.js","sourcesContent":["define(['directives/directives', 'echarts', 'jquery-ui', 'slick', 'Array'], function (directives, echarts, slick) {\n  'use strict';\n\n  directives.registerDirective(\"tgSlick\", tgSlickDir);\n  tgSlickDir.$inject = ['$q', '$timeout', '$compile', 'serviceCenterService'];\n\n  function tgSlickDir(q, timeout, compile, serviceCenterService) {\n    var directive = {};\n    directive.restrict = \"A\";\n    directive.scope = {\n      previewList: \"=\",\n      mode: \"@\",\n      click: \"&\"\n    };\n\n    directive.link = function (scope, element) {\n      //use : 1. add a attribute 'tg-slick' to your tab (with or without a value);\n      timeout(domReady);\n\n      function domReady() {\n        initSlick();\n        scope.$watch(\"previewList\", $previewList_watcher);\n      }\n\n      function initSlick() {\n        $(element).slick({\n          dots: false,\n          arrows: true,\n          draggable: false,\n          slidesToScroll: 5,\n          variableWidth: true,\n          infinite: false\n        });\n      }\n\n      function $previewList_watcher(n, o, s) {\n        var newLength, oldLength;\n        newLength = n instanceof Array ? n.length : 0; //oldLength = o instanceof Array ? o.length : 0;\n\n        if (newLength > 0) {\n          removeAllSlick();\n          renderSlick(n);\n        }\n\n        function removeAllSlick() {\n          //remove all slick element one by one.\n          var length = $(element).find(\".slick-list [slickItem]\").size();\n\n          for (var j = length - 1; j > -1; j--) {\n            $(element).slick('slickRemove', j);\n          }\n        }\n\n        function renderSlick(data) {\n          serviceCenterService.units.getAll().then(function (units) {\n            for (var i in data) {\n              (function (index) {\n                var TOP_TEXT, BLOCK_IMAGE, BOTTOM_TEXT, $wrap, $slickItem, $pdom, $block, $idom, $h5dom;\n                console.log(scope.previewList);\n                var unit;\n\n                if (scope.previewList[index].kpi != null) {\n                  unit = scope.previewList[index].kpi.unit;\n                }\n\n                var unitSymbol = units.find(function (ele) {\n                  return ele.unitCode == unit;\n                }); //initialize 3 parameters used to display kpi information\n\n                TOP_TEXT = \"previewList[\" + index + \"].value + '\" + (unitSymbol ? unitSymbol.unitName : '') + \"'\";\n                BLOCK_IMAGE = \"previewList[\" + index + \"].kpi.icon\";\n                BOTTOM_TEXT = \"previewList[\" + index + \"].label\"; //prepare jquery dom object to compile.\n                //$wrap = $('<div>{{mode}}</div>');\n\n                $slickItem = $('<div></div>').attr(\"slickItem\", '').addClass(\"box-body\");\n                $pdom = $('<p></p>').addClass(\"text-muted text-center\").attr(\"ng-bind\", TOP_TEXT);\n                $block = $('<div></div>').addClass(\"btn btn-ps-normal\").css({\n                  width: \"72px\",\n                  height: \"72px\"\n                });\n                $idom = $('<i></i>').addClass(\"ps-lg\").attr(\"ng-class\", BLOCK_IMAGE);\n                $h5dom = $('<h5></h5>').addClass(\"text-center\").attr(\"ng-bind\", BOTTOM_TEXT);\n                $block.append($idom);\n                $slickItem.append($pdom).append($block).append($h5dom); //$wrap.append($slickItem);\n                //compile jquery object to angularjs.\n\n                $(element).slick('slickAdd', compile($slickItem)(scope));\n                $slickItem.on(\"click\", function () {\n                  scope.$apply(function () {\n                    scope.click();\n                  });\n                });\n              })(i);\n            }\n          }); //render slick in a clean and empty container.\n        }\n      }\n    };\n\n    return directive;\n  }\n\n  directives.registerDirective(\"tgImage\", tgImageDir);\n  tgImageDir.$inject = ['$q', '$timeout'];\n\n  function tgImageDir(q, timeout) {\n    var directive = {};\n    directive.restrict = \"A\";\n    directive.scope = {\n      blk: \"=\"\n    };\n\n    directive.link = function (scope, element, attr) {\n      timeout(function () {\n        var width = $(element).width();\n        $(element).height(width * 720 / 1024);\n      });\n      $(window).on(\"resize\", function (event) {\n        var width = $(element).width();\n        $(element).height(width * 720 / 1024);\n      });\n    };\n\n    return directive;\n  }\n\n  directives.registerDirective(\"ipcam\", ipcamDir);\n  ipcamDir.$inject = ['$q', '$timeout'];\n\n  function ipcamDir(q, timeout) {\n    var directive = {};\n    directive.restrict = \"A\";\n    directive.scope = {\n      ic: \"=\"\n    };\n\n    directive.link = function (scope, element, attr) {\n      var url;\n      $(function () {\n        $(document).tooltip({\n          position: {\n            my: \"center bottom-20\",\n            at: \"center top\",\n            using: function using(position, feedback) {\n              $(this).css(position);\n              $(\"<div>\").addClass(\"arrow\").addClass(feedback.vertical).addClass(feedback.horizontal).appendTo(this);\n            }\n          }\n        });\n      });\n      timeout(function () {\n        scope.$watch(\"ic\", function (n, o, s) {\n          if (n) {\n            n.openCam = function (value) {\n              if (url) {\n                $(element).find(\"#videoDiv\").attr(\"src\", url);\n              }\n            };\n\n            n.closeCam = function (value) {\n              if (url) {\n                $(element).find(\"#videoDiv\").removeAttr(\"src\");\n              }\n            };\n          }\n        });\n        var ipcaminfo = {},\n            loginauth = \"\",\n            goalurl = \"\";\n        $(element).find(\".camWrap\").resizable();\n        $(element).find(\".camWrap\").draggable({\n          handle: $(element).find(\".camWrap .camHeader\"),\n          containment: $(element).parent(),\n          snap: true,\n          snapMode: \"both\"\n        });\n        requestipcam(\"localdb/ipcam.json\", \"bigimg\");\n\n        function requestipcam(requesturl, imgId) {\n          $.ajax({\n            url: requesturl,\n            type: \"Get\",\n            contenttype: \"application/json\",\n            success: function success(data) {\n              if (null != data && data != \"\") {\n                if (typeof data == \"string\") ipcaminfo = $.parseJSON(data);else ipcaminfo = data;\n                loginauth = \"user=\" + ipcaminfo.username + \"&pwd=\" + ipcaminfo.password + \"&res=0\";\n                goalurl = \"http://\" + ipcaminfo.ip + \":\" + ipcaminfo.port;\n                url = goalurl + \"/videostream.cgi?\" + loginauth + \"&resolution=320*240&rate=12\"; //$(element).find(\"#videoDiv\").attr(\"src\", url);\n                //+ \"&resolution=320*240&rate=12\"\n              }\n            }\n          });\n        }\n      });\n    };\n\n    return directive;\n  }\n\n  directives.registerDirective(\"tgDrag\", tgDragDir);\n  tgDragDir.$inject = ['$q', '$timeout'];\n\n  function tgDragDir(q, timeout) {\n    var directive = {};\n    directive.restrict = \"A\";\n    directive.scope = {\n      chart: \"=\",\n      target: \"=\"\n    };\n\n    directive.link = function (scope, element, attr) {\n      timeout(domReady);\n\n      function domReady() {\n        $(element).draggable({\n          helper: function helper() {\n            var result = $(\"<div class='tg-helper'></div>\").css({\n              width: scope.target[scope.target.type].width,\n              height: scope.target[scope.target.type].height,\n              border: \"1px dashed #bbb\"\n            });\n            return result;\n          },\n          handle: $(element).find(\"#moveBtn\"),\n          revert: false,\n          cursor: \"move\",\n          cursorAt: [50, 50],\n          appendTo: $(\"body\")\n        });\n      }\n    };\n\n    return directive;\n  }\n\n  directives.registerDirective(\"tgDrop\", tgDropDir);\n  tgDropDir.$inject = ['$q', '$timeout'];\n\n  function tgDropDir(q, timeout) {\n    var directive = {};\n    directive.restrict = \"A\";\n    directive.scope = {\n      onDrop: \"&\"\n    };\n\n    directive.link = function (scope, element, attr) {\n      timeout(domReady);\n\n      function domReady() {\n        $(element).droppable({\n          drop: drop\n        });\n\n        function drop(event, ui) {\n          scope.$apply(ready);\n\n          function ready() {\n            if ($(ui.draggable).attr(\"id\") == \"tg-drag\") {\n              scope.onDrop({\n                ui: ui\n              });\n            }\n          }\n        }\n      }\n    };\n\n    return directive;\n  }\n\n  directives.registerDirective(\"tgElement\", tgElementDir);\n  tgElementDir.$inject = ['$q', '$timeout'];\n\n  function tgElementDir(q, timeout) {\n    var directive = {};\n    directive.restrict = \"A\";\n    directive.scope = {\n      stopResize: \"&\",\n      stopMove: \"&\",\n      target: \"=\"\n    };\n\n    directive.link = function (scope, element, attr) {\n      timeout(domReady);\n\n      function domReady() {\n        $(element).resizable({\n          aspectRatio: scope.target.scale,\n          stop: function stop(event, ui) {\n            scope.$apply(ready);\n\n            function ready() {\n              scope.stopResize({\n                ui: ui\n              });\n            }\n          }\n        });\n        $(element).draggable({\n          containment: $(\".drawingArea\"),\n          stop: function stop(event, ui) {\n            scope.$apply(ready);\n\n            function ready() {\n              scope.stopMove({\n                ui: ui\n              });\n            }\n          }\n        });\n      }\n    };\n\n    return directive;\n  }\n\n  directives.registerDirective(\"tgEcharts\", echartsDir);\n  echartsDir.$inject = ['$q', '$timeout'];\n\n  function echartsDir(q, timeout) {\n    var directive = {};\n    directive.restrict = \"C\";\n    directive.scope = {\n      chart: \"=\"\n    };\n\n    directive.link = function (scope, element, attr) {\n      var target;\n\n      var _option_;\n\n      timeout(function () {\n        scope.$watch(\"chart\", function (n, o, s) {\n          if (n) {\n            n.setOption = function (option) {\n              this._option_ = option;\n              target.setOption(this._option_);\n            };\n\n            n.pushData = function (value, time) {\n              if (this._option_) {\n                if (this._option_.series[0].data.length > 25) {\n                  this._option_.series[0].data.shift();\n\n                  this._option_.xAxis.data.shift();\n                }\n\n                this._option_.series[0].data.push(parseFloat(value));\n\n                this._option_.xAxis.data.push(time);\n\n                target.setOption(this._option_);\n              }\n            };\n          }\n        });\n        var ci = scope.chart.ci;\n        var kpi = scope.chart.kpi;\n        var option = scope.chart.option;\n        target = echarts.init(element[0], \"macarons\");\n\n        if (option) {\n          target.setOption(option);\n        }\n\n        $(window).on(\"resize.\" + attr.id, function (event) {\n          target.resize();\n        });\n      });\n    };\n\n    return directive;\n  }\n\n  directives.registerDirective(\"tgRotate\", tgRotateDir);\n  tgRotateDir.$inject = ['$q', '$timeout'];\n\n  function tgRotateDir(q, timeout) {\n    var directive = {};\n    directive.restrict = \"A\";\n    directive.scope = {\n      rotate: \"=\"\n    };\n\n    directive.link = function (scope, element, attr) {\n      timeout(function () {\n        scope.$watch(\"rotate\", function (n, o, s) {\n          if (n) {\n            n.highLight = function () {\n              $(element).stop();\n              $(element).css(\"opacity\", 1);\n              clearTimeout(n.to);\n              n.to = setTimeout(function () {\n                if (parseFloat($(element).css(\"opacity\")) > 0.6) {\n                  $(element).animate({\n                    \"opacity\": .6\n                  }, 200);\n                }\n              }, 1000);\n            };\n          }\n        });\n        $(element).css(\"opacity\", .8);\n      });\n    };\n\n    return directive;\n  }\n\n  directives.registerDirective(\"tgScrollbar\", scrollbarDir);\n  scrollbarDir.$inject = ['$q', '$timeout'];\n\n  function scrollbarDir(q, timeout) {\n    var directive = {};\n    directive.restrict = \"C\";\n    directive.scope = {\n      control: \"=\"\n    };\n\n    directive.link = function (scope, element, attr) {\n      timeout(function () {\n        scope.$watch(\"control\", function (n, o, s) {\n          if (n) {\n            n.setValue = function (value) {\n              n.value = value;\n              $(element).slider(\"value\", value);\n              n.onChange(value);\n            };\n          }\n        });\n        $(element).slider({\n          range: \"min\",\n          slide: function slide(event, ui) {\n            scope.$apply(function () {\n              if (scope.control.onSlide) {\n                scope.control.onSlide(ui.value);\n              }\n\n              scope.control.value = ui.value;\n            });\n          },\n          stop: function stop(event, ui) {\n            scope.$apply(function () {\n              if (scope.control.onChange) {\n                scope.control.onChange(ui.value);\n              }\n\n              if (typeof scope.control.sendDeviceDirective == 'functioin') {\n                scope.control.sendDeviceDirective(ui.value);\n              }\n\n              scope.control.value = ui.value;\n            });\n          }\n        });\n\n        if (scope.control.value == '-') {\n          $(element).slider(\"value\", 0);\n        } else {\n          $(element).slider(\"value\", scope.control.value ? scope.control.value : 0);\n        }\n      });\n    };\n\n    return directive;\n  }\n\n  directives.registerDirective(\"tgBlink\", blinkDir);\n  blinkDir.$inject = ['$q', '$timeout'];\n\n  function blinkDir(q, timeout) {\n    var directive = {};\n    directive.restrict = \"A\";\n    directive.scope = {\n      blk: \"=\"\n    };\n\n    directive.link = function (scope, element, attr) {\n      scope.$watch(\"blk\", function (n, o, s) {\n        if (n) {\n          n.startBlink = function () {\n            timeout(function () {\n              $(function () {\n                blinkFn($(element));\n              });\n            });\n          };\n\n          n.stopBlink = function () {\n            $(element).stop();\n            $(element).css({\n              opacity: 0\n            });\n          };\n        }\n      });\n      timeout(function () {\n        $(function () {\n          $(element).css(\"opacity\", 0);\n        });\n      });\n\n      function blinkFn(selector) {\n        $(selector).animate({\n          'opacity': 1\n        }, {\n          duration: 300,\n          complete: function complete() {\n            $(selector).animate({\n              'opacity': 0\n            }, {\n              duration: 300,\n              complete: function complete() {\n                blinkFn($(selector));\n              }\n            });\n          }\n        });\n      }\n    };\n\n    return directive;\n  }\n\n  directives.registerDirective(\"tgToggle\", toggleDir);\n  toggleDir.$inject = ['$q', '$timeout'];\n\n  function toggleDir(q, timeout) {\n    var directive = {};\n    directive.restrict = \"C\";\n    directive.template = \"<div class='toggle-wrap'><div class='toggle-inner'></div></div>\";\n    directive.scope = {\n      tg: \"=\"\n    };\n\n    directive.link = function (scope, element, attr) {\n      scope.$watch(\"tg\", function (n, o, s) {\n        if (n) {\n          n.setValue = function (value) {\n            n.value = value > 0;\n\n            if (value > 0) {\n              $(element).find('.toggle-wrap').addClass(\"active\");\n            } else {\n              $(element).find('.toggle-wrap').removeClass(\"active\");\n            }\n\n            if (n.onChange) {\n              n.onChange(value > 0);\n            }\n          };\n        }\n      });\n      timeout(function () {\n        $(function () {\n          var val;\n\n          if (typeof scope.tg.value == 'string') {\n            val = parseInt(scope.tg.value);\n          } else {\n            val = scope.tg.value;\n          }\n\n          if (val > 0) {\n            $(element).find('.toggle-wrap').addClass(\"active\");\n          } else {\n            $(element).find('.toggle-wrap').removeClass(\"active\");\n          }\n\n          $(element).on(\"click\", function () {\n            scope.$apply(function () {\n              scope.tg.value = parseInt(scope.tg.value) > 0 ? 0 : 1;\n\n              if (scope.tg.value > 0) {\n                $(element).find('.toggle-wrap').addClass(\"active\");\n              } else {\n                $(element).find('.toggle-wrap').removeClass(\"active\");\n              }\n\n              if (typeof scope.tg.onChange == \"function\") {\n                scope.tg.onChange(!scope.tg.value);\n              }\n\n              if (typeof scope.tg.sendDeviceDirective == 'functioin') {\n                scope.tg.sendDeviceDirective(scope.tg.value);\n              }\n            });\n          });\n        });\n      });\n    };\n\n    return directive;\n  }\n});"],"sourceRoot":"/source/"}