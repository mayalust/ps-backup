{"version":3,"sources":["app-topo/js/directives/directive.js"],"names":["define","angular","module","directive","timeout","content","scope","ngModel","pos","replace","restrict","link","element","attrs","$","draggable","helper","revert","cursor","cursorAt","appendTo","datepicker","dateFormat","onSelect","value","$apply","receive","containment","handle","stop","event","ui","top","offset","left","onDrop","dropEvent","droppable","accept","drop","hoverClass","q","options","change","require","lib","selection","console","log","optionElmList","deferred","defer","promise","$watch","n","o","s","then","i","option","data","attr","removeAttr","ArrayHandler","children","remove","append","each","optionElm","text","label","push","selectmenu","item","width","resolve"],"mappings":"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","file":"app-topo/js/directives/directive.js","sourcesContent":["define([\"angular\", \"jquery\", \"jquery-ui\"], function (angular) {\n  var module = angular.module(\"myapp\");\n  module.directive(\"sensorIcon\", [\"$timeout\", function (timeout) {\n    var content = {};\n    content.scope = {\n      ngModel: \"=\",\n      pos: \"=\"\n    };\n    content.replace = false;\n    content.restrict = \"C\";\n    content.link = link;\n\n    function link(scope, element, attrs) {\n      timeout(domReady);\n\n      function domReady() {\n        $(element).draggable({\n          helper: \"clone\",\n          revert: false,\n          cursor: \"move\",\n          cursorAt: [25, 25],\n          appendTo: $(\"body\")\n        });\n      }\n    }\n\n    return content;\n  }]);\n  module.directive(\"kpiIcon\", [\"$timeout\", function (timeout) {\n    var content = {};\n    content.scope = {\n      ngModel: \"=\",\n      pos: \"=\"\n    };\n    content.replace = false;\n    content.restrict = \"C\";\n    content.link = link;\n\n    function link(scope, element, attrs) {\n      timeout(domReady);\n\n      function domReady() {\n        $(element).draggable({\n          helper: \"clone\",\n          revert: false,\n          cursor: \"move\",\n          cursorAt: [25, 25]\n        });\n      }\n    }\n\n    return content;\n  }]);\n  module.directive(\"datepicker\", [\"$timeout\", function (timeout) {\n    var content = {};\n    content.scope = {\n      ngModel: \"=\"\n    };\n    content.replace = false;\n    content.restrict = \"C\";\n    content.link = link;\n\n    function link(scope, element, attrs) {\n      timeout(domReady);\n\n      function domReady() {\n        $(\"#Datepicker\").datepicker({\n          dateFormat: \"yy-mm-dd\",\n          onSelect: function onSelect(value) {\n            scope.$apply(function () {\n              scope.ngModel = value;\n            });\n          }\n        });\n      }\n    }\n\n    return content;\n  }]);\n  module.directive(\"handleWrap\", [\"$timeout\", function (timeout) {\n    var content = {};\n    content.scope = {\n      receive: \"=\"\n    };\n    content.replace = false;\n    content.restrict = \"C\";\n    content.link = link;\n\n    function link(scope, element, attrs) {\n      $(element).draggable({\n        containment: $(\".profinner\"),\n        handle: \".iconpart\",\n        stop: function stop(event, ui) {\n          scope.$apply(function () {\n            scope.receive.top = ui.offset.top - $(\".profinner\").offset().top;\n            scope.receive.left = ui.offset.left - $(\".profinner\").offset().left;\n          });\n        }\n      });\n    }\n\n    return content;\n  }]);\n  module.directive(\"dropArea\", [\"$timeout\", function (timeout) {\n    var content = {};\n    content.scope = {\n      onDrop: \"&\"\n    };\n    content.replace = false;\n    content.restrict = \"C\";\n    content.link = link;\n\n    function link(scope, element, attrs) {\n      timeout(function () {\n        $(element).droppable({\n          accept: \"[class*=-icon]\",\n          drop: dropEvent,\n          hoverClass: \"drop-hover\"\n        });\n      });\n\n      function dropEvent(event, ui) {\n        scope.$apply(function () {\n          scope.onDrop({\n            ui: ui,\n            offset: $(element).offset()\n          });\n        });\n      }\n    }\n\n    return content;\n  }]);\n  module.directive(\"dropdown\", [\"$timeout\", \"$q\", function (timeout, q) {\n    var content = {};\n    content.scope = {\n      ngModel: \"=\",\n      options: \"=\",\n      change: \"&\"\n    };\n    content.replace = false;\n    content.restrict = \"C\";\n    content.link = link;\n\n    function link(scope, element, attrs) {\n      require(['commonlib'], function (lib) {\n        console.log(scope.ngModel);\n        var selection;\n        var optionElmList = [];\n        var deferred = q.defer();\n        var promise = deferred.promise;\n        scope.$watch(\"ngModel\", ngModelWatcher);\n        scope.$watch(\"options\", optionWatcher);\n\n        function ngModelWatcher(n, o, s) {\n          if (n) {\n            promise.then(function success() {\n              for (var i in optionElmList) {\n                (function (option) {\n                  var data = option.data(\"option\");\n\n                  if (n == data) {\n                    option.attr(\"selected\", \"selected\");\n                  } else {\n                    option.removeAttr(\"selected\");\n                  }\n                })(optionElmList[i]);\n              } //selection.selectmenu(\"refresh\");\n\n            });\n          }\n        }\n\n        function optionWatcher(n, o, s) {\n          if (n) {\n            var change = function change(event, ui) {\n              var element = $(ui.item.element);\n              var value = element.data(\"option\");\n              s.ngModel = value;\n              s.change();\n            };\n\n            var options = new lib.ArrayHandler(n);\n            selection = $(\"<select></select>\");\n            element.children().remove();\n            element.append(selection);\n            options.each(function (option) {\n              var optionElm = $(\"<option></option>\");\n              optionElm.text(option.label);\n              optionElm.data(\"option\", option);\n              selection.append(optionElm);\n              optionElmList.push(optionElm);\n            });\n            selection.selectmenu({\n              change: change,\n              width: element.width()\n            });\n            deferred.resolve(\"optionLoaded!\");\n          }\n        }\n      });\n    }\n\n    return content;\n  }]);\n});"],"sourceRoot":"/source/"}