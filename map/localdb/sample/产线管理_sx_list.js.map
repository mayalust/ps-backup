{"version":3,"sources":["localdb/sample/产线管理_sx_list.js"],"names":["expression","theme","on","init","event","target","scope","getRootScope","resource","getValue","format","name","label","index","composory","attrs","type","min","popuptype","stretch","hide","manual","text","path","btnstatus","content","icon","click","row","columnIndex","popupHandler","deleteDeviceFaultBookById","id","returnObj","code","growl","readerData","inputparam","status","objfmt","filter","fmt","fileName","filePath","undefined","obj","colnum","createSystemPopupByLocalPath","width","title","submit","data","destroy","statuc","hasOwnProperty","value","qualifiedName","saveDeviceFaultBook","extendParam","paras4list","deviceId","faultLedgerCode","k","getDeviceFaultBookList","sort","workArray","tablefmt","render","map","elem","popupaddclick","$on","maintainStandard","fileList","listsearchclick","param","args"],"mappings":"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","file":"localdb/sample/产线管理_sx_list.js","sourcesContent":["expression = {\n  \"theme\": \"dark\",\n  \"on\": {\n    \"init\": function init(event) {\n      var target = event.target;\n      var scope = target.getRootScope();\n      var resource = target.getValue(\"global/resource\");\n      var taskStatusAry = [{\n        id: 0,\n        label: \"启用\"\n      }, {\n        id: 1,\n        label: \"停用\"\n      }];\n      var format = [{\n        name: \"bookId\",\n        label: \"故障处理手顺书编号\",\n        index: 6\n      }, {\n        name: \"name\",\n        label: \"故障处理手顺书名称\",\n        composory: true,\n        // type: \"date\"\n        index: 1\n      }, {\n        name: \"faultLedgerCode\",\n        label: \"故障台账编号\",\n        composory: true,\n        index: 3\n      }, {\n        name: \"faultPosition\",\n        label: \"故障部位\",\n        index: 2\n      }, {\n        name: \"handleTotalTime\",\n        label: \"处理累计时间(h)\",\n        attrs: {\n          type: \"number\",\n          min: 0\n        },\n        index: 5\n      }, {\n        name: \"faultPerfor\",\n        label: \"故障现象\",\n        composory: true,\n        popuptype: \"textarea\",\n        stretch: true,\n        index: 9\n      }, {\n        name: \"reason\",\n        label: \"故障原因\",\n        composory: true,\n        popuptype: \"textarea\",\n        stretch: true,\n        index: 10\n      }, {\n        name: \"createTime\",\n        label: \"创建日期\",\n        type: \"date\",\n        popuptype: \"datePicker\",\n        hide: true,\n        index: 8\n      }, {\n        name: \"handleTime\",\n        label: \"处理时间\",\n        type: \"date\",\n        popuptype: \"datePicker\",\n        composory: true,\n        hide: true\n      }, {\n        name: \"createby\",\n        label: \"创建人\",\n        index: 7,\n        hide: true\n      }, {\n        name: \"technology\",\n        label: \"技术要点\",\n        popuptype: \"textarea\",\n        composory: true,\n        stretch: true,\n        hide: true,\n        index: 11\n      }, {\n        name: \"tools\",\n        label: \"使用工具\",\n        popuptype: \"textarea\",\n        composory: true,\n        stretch: true,\n        hide: true,\n        index: 12\n      }, {\n        name: \"handleCondition\",\n        label: \"处理条件安全要点\",\n        composory: true,\n        popuptype: \"textarea\",\n        stretch: true,\n        hide: true,\n        index: 13\n      }, {\n        name: \"faultName\",\n        label: \"故障名称\",\n        composory: true,\n        hide: true,\n        index: 4\n      }, {\n        name: \"externalDevId\",\n        label: \"设备编号\",\n        stretch: true,\n        hide: true\n      }, {\n        name: \"1\",\n        label: \"附件\",\n        popuptype: \"uploadFile2\",\n        stretch: true,\n        manual: true,\n        text: \"\",\n        //文件的名称\n        path: \"\",\n        //文件的路径\n        btnstatus: \"delete,download\",\n        index: 14\n      }, {\n        label: \"操作\",\n        type: \"buttonGroup\",\n        content: [{\n          label: \"详情\",\n          icon: \"null\",\n          on: {\n            click: function click(index, row, columnIndex) {\n              popupHandler(index.row, 0);\n            }\n          }\n        }, {\n          label: \"编辑\",\n          icon: \"null\",\n          on: {\n            click: function click(index, row, columnIndex) {\n              popupHandler(index.row, 1);\n            }\n          }\n        }, {\n          label: \"删除\",\n          icon: \"null\",\n          on: {\n            click: function click(index, row, columnIndex) {\n              target.deleteDeviceFaultBookById(index.row.id, function (returnObj) {\n                if (returnObj.code == 0) {\n                  target.growl(\"删除成功\");\n                  readerData();\n                }\n              });\n            }\n          }\n        }]\n      }];\n\n      var render = function render(workArray) {\n        //只有让有hide=false的传递到datatable\n        var tablefmt = format.filter(function (fmt) {\n          if (!fmt.hide) return fmt;\n        });\n        target.render({\n          data: workArray,\n          format: tablefmt.map(function (elem) {\n            return {\n              \"name\": elem.label,\n              \"value\": elem.name,\n              \"type\": elem.type || \"text\",\n              \"content\": elem.content,\n              \"render\": elem.render\n            };\n          })\n        });\n      };\n\n      var popupHandler = function popupHandler(inputparam, status) {\n        //只有让有index的传递到popup\n        var objfmt = format.filter(function (fmt) {\n          if (fmt.name == \"1\") {\n            fmt.text = inputparam.fileName;\n            fmt.path = inputparam.filePath;\n          }\n\n          if (fmt.index != undefined) return fmt;\n        });\n        var obj = {\n          resource: inputparam,\n          format: objfmt,\n          status: status,\n          colnum: 3\n        };\n        target.createSystemPopupByLocalPath(\"popup\", {\n          width: \"80%\",\n          title: \"手顺书信息\",\n          on: {\n            submit: function submit(data, destroy) {\n              if (data.statuc == \"success\" && data.data) {\n                debugger;\n\n                if (data.data.hasOwnProperty(\"1\")) {\n                  if (data.data[\"1\"]) {\n                    data.data.fileName = data.data[\"1\"].label;\n                    data.data.filePath = data.data[\"1\"].value.qualifiedName;\n                  } else {\n                    data.data.fileName = \"\";\n                    data.data.filePath = \"\";\n                  }\n                }\n\n                target.saveDeviceFaultBook(data.data, function (returnObj) {\n                  if (returnObj) {\n                    target.growl(\"保存成功\");\n                    readerData();\n                    if (destroy) destroy();\n                  }\n                });\n              }\n            }\n          }\n        }, obj);\n      };\n\n      var extendParam = {};\n\n      var readerData = function readerData() {\n        var paras4list = {\n          deviceId: resource.id,\n          name: \"\",\n          faultLedgerCode: \"\"\n        };\n        var sort = {\n          \"sort\": \"bookId\"\n        };\n\n        for (var k in extendParam) {\n          paras4list[k] = extendParam[k];\n        }\n\n        target.getDeviceFaultBookList([paras4list, sort], function (returnObj) {\n          render(returnObj);\n        });\n      }; //监听别的地方告诉我添加\n\n\n      if (scope.popupaddclick) {\n        scope.popupaddclick();\n        scope.popupaddclick = null;\n      }\n\n      scope.popupaddclick = scope.$on(\"POPUPADDCLICK\", function () {\n        popupHandler({\n          maintainStandard: {\n            fileList: []\n          },\n          deviceId: resource.id\n        }, 1);\n      });\n\n      if (scope.listsearchclick) {\n        scope.listsearchclick();\n        scope.listsearchclick = null;\n      }\n\n      scope.listsearchclick = scope.$on(\"LISTSEARCHCLICK\", function (param, args) {\n        extendParam = args;\n        readerData();\n      });\n\n      if (resource) {\n        readerData();\n      }\n\n      target.on(\"tree_resourceChange\", function (obj) {\n        resource = obj.resource;\n        readerData();\n      });\n    }\n  }\n};"],"sourceRoot":"/source/"}