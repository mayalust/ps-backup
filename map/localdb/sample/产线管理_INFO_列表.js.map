{"version":3,"sources":["localdb/sample/产线管理_INFO_列表.js"],"names":["expression","theme","on","init","event","target","scope","getRootScope","resource","getValue","format","name","label","composory","index","render","data","type","full","item","myDicts","sparePartType","find","valueCode","popuptype","selectId","selectLabel","options","attrs","id","content","icon","click","row","columnIndex","popupHandler","deleteSparePart","returnObj","code","growl","readerData","inputparam","status","obj","filter","fmt","undefined","createSystemPopupByLocalPath","width","title","submit","destroy","statuc","saveSparePart","getSparePartByDeviceId","workArray","map","elem","value","popupaddclick","$on","values","deviceId"],"mappings":"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","file":"localdb/sample/产线管理_INFO_列表.js","sourcesContent":["expression = {\n  \"theme\": \"dark\",\n  \"on\": {\n    \"init\": function init(event) {\n      var target = event.target;\n      var scope = target.getRootScope();\n      var resource = target.getValue(\"global/resource\");\n      var format = [{\n        name: \"label\",\n        label: \"易耗件名称\",\n        composory: true,\n        index: 0\n      }, {\n        name: \"values.type\",\n        label: \"类型\",\n        render: function render(data, type, full) {\n          var item;\n\n          if (scope.myDicts.sparePartType) {\n            item = scope.myDicts.sparePartType.find(function (item) {\n              if (item.valueCode == data) return item;\n            });\n          }\n\n          if (item) {\n            return item.label;\n          }\n\n          return data;\n        },\n        popuptype: \"select\",\n        selectId: \"valueCode\",\n        selectLabel: \"label\",\n        options: scope.myDicts.sparePartType,\n        composory: true,\n        index: 2\n      }, {\n        name: \"model\",\n        label: \"规格型号\",\n        index: 4\n      }, {\n        name: \"values.manufacturer\",\n        label: \"生产厂家\",\n        index: 3\n      }, {\n        name: \"name\",\n        label: \"编码\",\n        composory: true,\n        index: 1\n      }, {\n        name: \"values.position\",\n        label: \"应用位置\",\n        index: 5\n      }, {\n        name: \"originalNumber\",\n        label: \"库存\",\n        composory: true,\n        attrs: {\n          type: \"number\"\n        },\n        index: 6\n      }, {\n        name: \"status\",\n        label: \"状态\",\n        popuptype: \"select\",\n        selectId: \"id\",\n        selectLabel: \"label\",\n        options: [{\n          id: 0,\n          label: \"在线\"\n        }, {\n          id: 1,\n          label: \"离线\"\n        }, {\n          id: 2,\n          label: \"报废\"\n        }],\n        composory: true\n      }, {\n        label: \"操作\",\n        type: \"buttonGroup\",\n        content: [{\n          label: \"详情\",\n          icon: \"null\",\n          on: {\n            click: function click(index, row, columnIndex) {\n              popupHandler(index.row, 0);\n            }\n          }\n        }, {\n          label: \"编辑\",\n          icon: \"null\",\n          on: {\n            click: function click(index, row, columnIndex) {\n              popupHandler(index.row, 1);\n            }\n          }\n        }, {\n          label: \"删除\",\n          icon: \"null\",\n          on: {\n            click: function click(index, row, columnIndex) {\n              target.deleteSparePart(index.row.id, function (returnObj) {\n                if (returnObj.code == 0) {\n                  target.growl(\"删除成功\");\n                  readerData();\n                }\n              });\n            }\n          }\n        }]\n      }];\n\n      var popupHandler = function popupHandler(inputparam, status) {\n        //只有让有index的传递到popup\n        var objfmt = format.filter(function (fmt) {\n          if (fmt.index != undefined) return fmt;\n        });\n        var obj = {\n          resource: inputparam,\n          format: objfmt,\n          status: status\n        };\n        target.createSystemPopupByLocalPath(\"popup\", {\n          width: \"40%\",\n          title: \"易耗件信息\",\n          on: {\n            submit: function submit(data, destroy) {\n              if (data.statuc == \"success\" && data.data) {\n                target.saveSparePart(data.data, function (returnObj) {\n                  if (returnObj) {\n                    target.growl(\"保存成功\");\n                    readerData();\n                    if (destroy) destroy();\n                  }\n                });\n              }\n            }\n          }\n        }, obj);\n      };\n\n      var render = function render(workArray) {\n        target.render({\n          data: workArray,\n          format: format.map(function (elem) {\n            return {\n              \"name\": elem.label,\n              \"value\": elem.name,\n              \"type\": elem.type || \"text\",\n              \"content\": elem.content,\n              \"render\": elem.render\n            };\n          })\n        });\n      };\n\n      var readerData = function readerData() {\n        target.getSparePartByDeviceId(resource.id, function (returnObj) {\n          render(returnObj);\n        });\n      }; //监听别的地方告诉我添加\n\n\n      if (scope.popupaddclick) {\n        scope.popupaddclick();\n        scope.popupaddclick = null;\n      }\n\n      scope.popupaddclick = scope.$on(\"POPUPADDCLICK\", function () {\n        popupHandler({\n          values: {},\n          deviceId: resource.id\n        }, 1);\n      });\n\n      if (resource) {\n        readerData();\n      }\n\n      target.on(\"tree_resourceChange\", function (obj) {\n        resource = obj.resource;\n        readerData();\n      });\n    }\n  }\n};"],"sourceRoot":"/source/"}