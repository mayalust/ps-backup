{"version":3,"sources":["localdb/sample/产线管理_辊道备修_备修委托_list.js"],"names":["expression","theme","on","init","event","target","scope","getRootScope","resource","getValue","tickeTaskStatusDic","receiving","waitrepairing","repairing","receiveparting","end","format","name","label","popuptype","stretch","index","render","data","type","full","options","content","icon","click","row","columnIndex","doTask4Baogang","ticketNo","returnObj","code","trigger","readerData","growl","","extendParam","params","categorys","validNotFinish","ticketStatus","firstTimeFrom","firstTimeTo","attrs","commitTime","rollerNo","values","rollerPart.rollerNo","getDealTicketList","tc","workArray","map","elem","hide","value","popupaddclick","$on","inputparam","status","obj","itemList","deviceId","id","filter","fmt","undefined","createSystemPopupByLocalPath","width","title","submit","destroy","statuc","rollerPartList","paramValues","remark","RollerPerson","rollerTrust","e"],"mappings":"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","file":"localdb/sample/产线管理_辊道备修_备修委托_list.js","sourcesContent":["expression = {\n  \"theme\": \"dark\",\n  \"on\": {\n    \"init\": function init(event) {\n      var target = event.target;\n      var scope = target.getRootScope(); // 获取设备的信息\n\n      var resource = target.getValue(\"global/resource\"); //进度位字典\n\n      var tickeTaskStatusDic = {\n        \"receiving\": \"待接收\",\n        \"waitrepairing\": \"待维修\",\n        \"repairing\": \"维修中\",\n        \"receiveparting\": \"待收货\",\n        \"end\": \"已完成\" //format是列表和popup的来源，index用户popup排序，hide表示不显示在list\n\n      };\n      var format = [{\n        name: \"values.rollerPart.rollerName\",\n        label: \"辊道名称\"\n      }, {\n        name: \"values.rollerPart.rollerNo\",\n        label: \"辊道编号\"\n      }, {\n        name: \"values.rollerPart.rollerName\",\n        label: \"下机原因\"\n      }, {\n        name: \"values.remark\",\n        label: \"备注\",\n        popuptype: \"textarea\",\n        stretch: true,\n        index: 1\n      }, {\n        name: \"values.theCreateUserName\",\n        label: \"申请人\"\n      }, {\n        name: \"values.tickeTaskStatus\",\n        label: \"进度位\",\n        render: function render(data, type, full) {\n          return tickeTaskStatusDic[data];\n        }\n      }, {\n        name: \"commitTime\",\n        label: \"备修委托时间\",\n        type: \"date\"\n      }, {\n        label: \"操作\",\n        type: \"valueBased\",\n        name: \"values.tickeTaskStatus\",\n        options: {\n          // 待收货时有按钮\n          \"receiveparting\": {\n            name: \"操作\",\n            type: \"buttonGroup\",\n            content: [{\n              label: \"收货\",\n              icon: \"null\",\n              on: {\n                click: function click(index, row, columnIndex) {\n                  target.doTask4Baogang(index.row.ticketNo, {}, function (returnObj) {\n                    if (returnObj.code == 0) {\n                      target.trigger(\"queryTabelList2\", {});\n                      readerData();\n                      target.growl(\"操作成功\");\n                    }\n                  });\n                }\n              }\n            }, {\n              label: \"备修报告\",\n              icon: \"null\",\n              on: {\n                click: function click(index, row, columnIndex) {}\n              }\n            }]\n          },\n          \"\": {\n            name: \"操作\",\n            type: \"label\",\n            render: function render() {\n              return \"\";\n            }\n          }\n        }\n      }];\n\n      var render = function render(workArray) {\n        target.render({\n          data: workArray,\n          format: format.map(function (elem) {\n            if (elem.hide) return false;\n            return {\n              \"name\": elem.label,\n              \"value\": elem.name,\n              \"type\": elem.type || \"text\",\n              \"content\": elem.content,\n              \"render\": elem.render,\n              \"options\": elem.options\n            };\n          })\n        });\n      }; // 弹出框  status==1 是可以编辑  0 是不可以编辑\n\n\n      var popupHandler = function popupHandler(inputparam, status) {\n        //只有让有index的传递到popup\n        var objfmt = format.filter(function (fmt) {\n          if (fmt.index != undefined) return fmt;\n        });\n        var obj = {\n          resource: inputparam,\n          format: objfmt,\n          status: status\n        };\n        target.createSystemPopupByLocalPath(\"popup\", {\n          width: \"800px\",\n          title: \"辊道备修信息\",\n          on: {\n            submit: function submit(data, destroy) {\n              if (data.statuc == \"success\" && data.data) {\n                var rollerPartList = data.data.rollerPartList;\n                var paramValues = {\n                  remark: data.data.values.remark,\n                  RollerPerson: \"baowu_gd\"\n                };\n                target.rollerTrust(rollerPartList, paramValues, function (returnObj) {\n                  if (returnObj) {\n                    target.growl(\"保存成功\");\n                    readerData();\n\n                    if (destroy) {\n                      destroy();\n                    }\n                  }\n                });\n              }\n            }\n          }\n        }, obj);\n      }; // 查询表格的接口\n\n\n      var extendParam = {};\n\n      var readerData = function readerData() {\n        var params = {\n          categorys: \"220\",\n          validNotFinish: false,\n          ticketStatus: 100\n        };\n\n        if (extendParam.firstTimeFrom || extendParam.firstTimeTo) {\n          params.attrs = {\n            commitTime: [extendParam.firstTimeFrom, extendParam.firstTimeTo]\n          };\n        }\n\n        if (extendParam.rollerNo) {\n          params.values = {\n            \"rollerPart.rollerNo\": extendParam.rollerNo\n          };\n        }\n\n        target.getDealTicketList(params, function (tc) {\n          render(tc);\n        });\n      }; //监听别的地方告诉我添加\n\n\n      if (scope.popupaddclick) {\n        scope.popupaddclick();\n        scope.popupaddclick = null;\n      }\n\n      scope.popupaddclick = scope.$on(\"POPUPADDCLICK\", function () {\n        popupHandler({\n          itemList: [],\n          deviceId: resource.id,\n          values: {}\n        }, 1);\n      }); //如果有选中的设备，直接查询\n\n      if (resource) {\n        readerData();\n      }\n\n      target.on(\"tree_resourceChange\", function (obj) {\n        resource = obj.resource;\n        readerData();\n      });\n      target.on(\"queryTabelList1\", function (e) {\n        extendParam = e;\n        readerData();\n      });\n    }\n  }\n};"],"sourceRoot":"/source/"}