{"version":3,"sources":["localdb/sample/POPUP展示列表.js"],"names":["expression","theme","on","init","event","target","scope","getRootScope","params","getValue","getPopupData","resource","editList","status","k","$","isArray","editModel","editObj","baserender","data","display","full","fmt","isEdit","value","format","name","label","render","index","type","content","sublabel","icon","click","row","columnIndex","extend","$parent","forEach","item","popupHandler","tableElement","removeRow","splice","workArray","rowCallbackKey","map","elem","hide","popup2addclick","$on","growl","push"],"mappings":"AAAAA,WAAa,CACXC,MAAS,OACTC,GAAM,CACJC,KAAQ,SAAcC,GAEpB,IAAIC,EAASD,EAAMC,OACfC,EAAQD,EAAOE,eAEfC,GADWH,EAAOI,SAAS,mBAClBJ,EAAOK,eAAeC,UAI/BC,GAHSP,EAAOK,eAAeG,OAGpBR,EAAOK,eAAeE,SAAWP,EAAOK,eAAeE,SAAW,IAEjF,IAAKA,EAEH,IAAK,IAAIE,KAAKN,EACZ,GAAIO,EAAEC,QAAQR,EAAOM,IAAK,CACxBF,EAAWJ,EAAOM,GAClB,MAKN,IAAIG,GAAY,EAChBX,EAAMY,QAAU,GAEhB,IAAIC,EAAa,SAAoBC,EAAMC,EAASC,EAAMC,GAGxD,OAFKH,IAAMA,EAAO,IAEdE,EAAKE,OACA,gBAAkBD,EAAIE,MAAQ,uBAAyBF,EAAIE,MAAQ,gEAAkEL,EAAO,KAG9IA,GAKLM,EAAS,CAAC,CACZC,KAAM,aACNC,MAAO,KACPC,OAAQV,EACRW,MAAO,GACN,CACDH,KAAM,gBACNC,MAAO,UACPC,OAAQV,EACRW,MAAO,GACN,CACDF,MAAO,KACPG,KAAM,cACNC,QAAS,CAAC,CACRJ,MAAO,KACPK,SAAU,KACVC,KAAM,OACNP,KAAM,SACNzB,GAAI,CACFiC,MAAO,SAAef,EAAMgB,EAAKC,GAO7BpB,EANEA,GACFL,EAASQ,EAAKU,OAASf,EAAEuB,OAAO,GAAIhC,EAAMiC,QAAQrB,SAAS,GAC3DN,EAAS4B,QAAQ,SAAUC,GACzBA,EAAKjB,QAAS,MAEhBlB,EAAMiC,QAAQrB,QAAU,MAGxBN,EAASQ,EAAKU,OAAON,QAAS,EAC9BlB,EAAMiC,QAAQrB,QAAUN,EAASQ,EAAKU,QAC1B,GAGdY,OAGH,CACDd,MAAO,KACPM,KAAM,OACNhC,GAAI,CACFiC,MAAO,SAAef,EAAMgB,EAAKC,GAC/BpB,GAAY,EAERL,EAASQ,EAAKU,OAAOa,cACvB/B,EAASQ,EAAKU,OAAOa,aAAaC,YAClChC,EAASiC,OAAOzB,EAAKU,MAAO,KAE5BlB,EAASiC,OAAOzB,EAAKU,MAAO,GAC5BY,WAONb,EAAS,SAAgBiB,GAC3BzC,EAAOwB,OAAO,CACZT,KAAM0B,EACNC,eAAgB,aAChBrB,OAAQA,EAAOsB,IAAI,SAAUC,GAC3B,OAAIA,EAAKC,MACF,CACLvB,KAAQsB,EAAKrB,MACbH,MAASwB,EAAKtB,KACdI,KAAQkB,EAAKlB,MAAQ,OACrBC,QAAWiB,EAAKjB,QAChBH,OAAUoB,EAAKpB,aAMnBa,EAAe,WACjBb,EAAOjB,IAILN,EAAM6C,iBACR7C,EAAM6C,iBACN7C,EAAM6C,eAAiB,MAGzB7C,EAAM6C,eAAiB7C,EAAM8C,IAAI,iBAAkB,WAC5CnC,EAWHZ,EAAOgD,MAAM,WAAY,SAVzBpC,GAAY,EAEZL,EAAS4B,QAAQ,SAAUC,GACzBA,EAAKjB,QAAS,IAEhBZ,EAAS0C,KAAK,CACZ9B,QAAQ,IAEVkB,OAMAlC,GACFqB,EAAOjB","file":"localdb/sample/POPUP展示列表.js","sourcesContent":["expression = {\n  \"theme\": \"dark\",\n  \"on\": {\n    \"init\": function init(event) {\n      debugger;\n      var target = event.target;\n      var scope = target.getRootScope();\n      var resource = target.getValue(\"global/resource\");\n      var params = target.getPopupData().resource;\n      var status = target.getPopupData().status; //0表示查看，1表示编辑\n      //这里把需要的list变成标准的editList\n\n      var editList = target.getPopupData().editList ? target.getPopupData().editList : \"\";\n\n      if (!editList) {\n        //如果没有设置的话，查找params里是array的保存\n        for (var k in params) {\n          if ($.isArray(params[k])) {\n            editList = params[k];\n            break;\n          }\n        }\n      }\n\n      var editModel = false;\n      scope.editObj = {};\n\n      var baserender = function baserender(data, display, full, fmt) {\n        if (!data) data = \"\";\n\n        if (full.isEdit) {\n          return \"<input name='\" + fmt.value + \"' ng-model='editObj.\" + fmt.value + \"' style='width:100%' class='form-control' type='text' value='\" + data + \"'>\";\n        }\n\n        return data;\n      };\n      /********以下是需要修改的地方********/\n\n\n      var format = [{\n        name: \"itemNumber\",\n        label: \"序号\",\n        render: baserender,\n        index: 0\n      }, {\n        name: \"repairContent\",\n        label: \"修复内容及要求\",\n        render: baserender,\n        index: 1\n      }, {\n        label: \"操作\",\n        type: \"buttonGroup\",\n        content: [{\n          label: \"编辑\",\n          sublabel: \"保存\",\n          icon: \"null\",\n          name: \"isEdit\",\n          on: {\n            click: function click(data, row, columnIndex) {\n              if (editModel) {\n                editList[data.index] = $.extend({}, scope.$parent.editObj, true);\n                editList.forEach(function (item) {\n                  item.isEdit = false;\n                });\n                scope.$parent.editObj = {};\n                editModel = false;\n              } else {\n                editList[data.index].isEdit = true;\n                scope.$parent.editObj = editList[data.index];\n                editModel = true;\n              }\n\n              popupHandler();\n            }\n          }\n        }, {\n          label: \"删除\",\n          icon: \"null\",\n          on: {\n            click: function click(data, row, columnIndex) {\n              editModel = false;\n\n              if (editList[data.index].tableElement) {\n                editList[data.index].tableElement.removeRow();\n                editList.splice(data.index, 1);\n              } else {\n                editList.splice(data.index, 1);\n                popupHandler();\n              }\n            }\n          }\n        }]\n      }];\n\n      var render = function render(workArray) {\n        target.render({\n          data: workArray,\n          rowCallbackKey: \"itemNumber\",\n          format: format.map(function (elem) {\n            if (elem.hide) return false;\n            return {\n              \"name\": elem.label,\n              \"value\": elem.name,\n              \"type\": elem.type || \"text\",\n              \"content\": elem.content,\n              \"render\": elem.render\n            };\n          })\n        });\n      };\n\n      var popupHandler = function popupHandler() {\n        render(editList);\n      }; //监听别的地方告诉我添加\n\n\n      if (scope.popup2addclick) {\n        scope.popup2addclick();\n        scope.popup2addclick = null;\n      }\n\n      scope.popup2addclick = scope.$on(\"POPUP2ADDCLICK\", function () {\n        if (!editModel) {\n          editModel = true; //恢复所有的编辑状态\n\n          editList.forEach(function (item) {\n            item.isEdit = false;\n          });\n          editList.push({\n            isEdit: true\n          });\n          popupHandler();\n        } else {\n          target.growl(\"当前有编辑的内容\", \"info\");\n        }\n      });\n\n      if (params) {\n        render(editList);\n      }\n    }\n  }\n};"],"sourceRoot":"/source/"}