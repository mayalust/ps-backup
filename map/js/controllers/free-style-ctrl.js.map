{"version":3,"sources":["js/controllers/free-style-ctrl.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","define","controllers","freeStyleCtrl","scope","rootScope","viewFlexService","resourceUIService","timeout","window","Info","freeboardservice","growl","routeParams","freeboardBaseService","userLoginUIService","input","viewId","viewTitle","page","pa","parameter","naviClick","link","param","location","href","encodeURIComponent","JSON","stringify","exportImage","html2canvas","$","taintTest","useCORS","onrendered","canvas","id","image","toDataURL","replace","timestamp","Date","getTime","$a","document","createElement","setAttribute","evObj","createEvent","initMouseEvent","dispatchEvent","setCurrentTab","str","console","log","bgColorFn","bgColor","background-color","instance","renderData","dt","$$","runExpression","setting","funRes","code","fnResult","data","system","hasOwnProperty","vt","va_arr","vt_arr","split","parse","length","base","rs","loop","inx","elem","find","element","path","tabLabel","push","label","slice","parseInt","i","navigation","arr","allAvaliableViews","template","modelId","resourceId","concat","getManagedViewsByTypeAndRole","event","getDefaultView","templateDefault","templateExtent","user","roleResList","some","resId","resType","getViewById","model","resource","content","getModelByIds","getResource_back","clone","layout","editData","replaceCiKpi","setMode","renderLayout","getResourceById","getResources","resources","itemchange","error","tabIndex","indexOf","tabs","groups","getViewById_back","message","init","test","get","info","selectEditDataGroup","tab","renderBoard","isAuthenticated","$on","evt","d","controller","$inject"],"mappings":"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","file":"js/controllers/free-style-ctrl.js","sourcesContent":["function _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\ndefine(['controllers/controllers', 'Array'], function (controllers) {\n  'use strict';\n\n  controllers.controller('freeStyleCtrl', freeStyleCtrl);\n  freeStyleCtrl.$inject = [\"$scope\", \"$rootScope\", \"viewFlexService\", \"resourceUIService\", \"$timeout\", \"$window\", \"Info\", \"freeboardservice\", 'growl', '$routeParams', 'freeboardBaseService', 'userLoginUIService'];\n\n  function freeStyleCtrl(scope, rootScope, viewFlexService, resourceUIService, timeout, window, Info, freeboardservice, growl, routeParams, freeboardBaseService, userLoginUIService) {\n    var input,\n        viewId,\n        currentView,\n        viewTitle = routeParams.page ? routeParams.page : 'index',\n        pa = routeParams.parameter;\n    viewId = routeParams.viewId;\n\n    scope.naviClick = function (link, param) {\n      window.location.href = \"../app-free-style/index.html#/\" + viewId + \"/\" + link + \"/\" + encodeURIComponent(JSON.stringify(param));\n    };\n\n    scope.exportImage = function () {\n      html2canvas($(\"#export\"), {\n        taintTest: false,\n        // allowTaint: true,\n        useCORS: true,\n        onrendered: function onrendered(canvas) {\n          canvas.id = \"mycanvas\";\n          var image = canvas.toDataURL(\"image/png\").replace(\"image/png\", \"image/octet-stream\");\n          var timestamp = new Date().getTime();\n          var $a = document.createElement('a');\n          $a.setAttribute(\"href\", image);\n          $a.setAttribute(\"download\", timestamp + \".png\");\n          var evObj = document.createEvent('MouseEvents');\n          evObj.initMouseEvent('click', true, true, window, 0, 0, 0, 0, 0, false, false, true, false, 0, null);\n          $a.dispatchEvent(evObj);\n        }\n      });\n    };\n\n    rootScope.setCurrentTab = function (str) {\n      console.log(\"asd\" + str);\n    };\n\n    scope.bgColorFn = function (bgColor) {\n      return {\n        \"background-color\": bgColor ? bgColor : \"#eee\"\n      };\n    };\n\n    scope.instance = {};\n\n    var renderData = function renderData(dt) {\n      $$.runExpression(dt.setting, function (funRes) {\n        if (funRes.code == \"0\") {\n          var fnResult = funRes.data;\n\n          if (typeof fnResult == 'function') {\n            scope.setting = fnResult(data, system);\n          } else {\n            scope.setting = fnResult;\n          }\n\n          scope.setting = scope.setting ? scope.setting : {};\n        } else {\n          scope.setting = {};\n        }\n      }); //scope.setting = dt.setting;\n\n      if (dt.hasOwnProperty(\"groups\")) {\n        var vt,\n            vt_arr = viewTitle.split(\"|\"),\n            va_arr;\n\n        if (pa) {\n          va_arr = JSON.parse(pa);\n        } else {\n          va_arr = [];\n        }\n\n        if (vt_arr.length > 0) {\n          vt = vt_arr[vt_arr.length - 1];\n        } else {\n          vt = viewTitle;\n          vt_arr = [viewTitle];\n        }\n\n        var base = '',\n            rs = [];\n\n        var loop = function loop(inx, elem) {\n          var find = dt[\"groups\"].find(function (element) {\n            return elem == element.path;\n          });\n\n          if (find) {\n            base = base == \"\" ? elem : base + \"|\" + elem;\n            var param = va_arr[inx],\n                tabLabel;\n\n            if (_typeof(param) == \"object\" && param != null) {\n              tabLabel = param.tabLabel;\n            }\n\n            rs.push({\n              label: tabLabel ? tabLabel : find.label,\n              link: base,\n              param: va_arr.slice(0, parseInt(inx) + 1)\n            });\n          }\n\n          ;\n        };\n\n        for (var i in vt_arr) {\n          loop(i, vt_arr[i]);\n        }\n\n        ;\n        scope.navigation = rs;\n\n        var getLastElement = function getLastElement(arr) {\n          return arr[arr.length - 1];\n        };\n\n        var parameter = {};\n\n        if (routeParams.parameter) {\n          parameter = getLastElement(JSON.parse(routeParams.parameter));\n        }\n\n        ;\n        rootScope.parameter = parameter;\n\n        if (vt == \"panel\") {\n          var modelId = parameter.modelId;\n          var resourceId = parameter.resourceId;\n          scope.navigation = scope.navigation.concat({\n            label: parameter.tabLabel ? parameter.tabLabel : \"设备仪表板\",\n            link: base + \"|panel\"\n          });\n          var allAvaliableViews, defaultViews, template;\n\n          var getManagedViewsByType_back = function getManagedViewsByType_back(event) {\n            if (event.code == 0) {\n              allAvaliableViews = event.data;\n\n              var getDefaultView_back = function getDefaultView_back(event) {\n                if (event.code == \"0\") {\n                  defaultViews = event.data;\n                  var templateDefault = defaultViews.find(function (elem) {\n                    if (elem.template) {\n                      if (elem.template.resourceId == modelId) {\n                        return true;\n                      } else {\n                        return false;\n                      }\n                    } else {\n                      return false;\n                    }\n                  });\n                  var templateExtent = allAvaliableViews.find(function (elem) {\n                    var viewId = elem.viewId;\n\n                    if (elem.template) {\n                      if (elem.template.resourceId == modelId) {\n                        var findRoleRes = function findRoleRes(elem) {\n                          return elem.resId == viewId && elem.resType == 21;\n                        };\n\n                        var authorized = userLoginUIService.user.roleResList.some(findRoleRes);\n                        return authorized;\n                      } else {\n                        return false;\n                      }\n                    } else {\n                      return false;\n                    }\n                  });\n\n                  if (templateExtent) {\n                    template = templateExtent;\n                  } else if (templateDefault) {\n                    template = templateDefault;\n                  }\n\n                  if (template) {\n                    var getViewById_back = function getViewById_back(event) {\n                      var model, resource, content;\n\n                      if (event.code == \"0\") {\n                        var content = event.data.content;\n\n                        var getModel_back = function getModel_back(event) {\n                          if (event.code == \"0\") {\n                            model = event.data[0];\n                          }\n\n                          var getResource_back = function getResource_back(event) {\n                            if (event.code == \"0\") {\n                              resource = event.data;\n\n                              if (content != null) {\n                                var clone = JSON.parse(content);\n                                var input = {\n                                  layout: clone.data ? clone.data : clone.layout,\n                                  setting: clone.setting\n                                };\n                                delete clone.data;\n                                var editData = new freeboardservice.replaceCiKpi(input, function () {\n                                  timeout(function () {\n                                    scope.instance.setMode(true);\n                                    scope.instance.renderLayout(editData);\n                                  });\n                                }, {\n                                  model: model,\n                                  resource: resource\n                                }, clone);\n                              }\n                            }\n                          };\n\n                          if (resourceId) {\n                            resourceUIService.getResourceById(resourceId, getResource_back);\n                          } else {\n                            var getResources_back = function getResources_back(event) {\n                              if (event.code == 0) {\n                                scope.resources = event.data;\n                                /** console.log(scope.resources); */\n\n                                scope.resource = scope.resources[0];\n\n                                scope.itemchange = function (event) {\n                                  var id = event.id.split(\"number:\")[1];\n                                  var find = scope.resources.find(function (elem) {\n                                    return elem.id == id;\n                                  });\n\n                                  if (find) {\n                                    getResource_back({\n                                      code: 0,\n                                      data: find\n                                    });\n                                  }\n                                };\n\n                                getResource_back({\n                                  code: 0,\n                                  data: scope.resources[0]\n                                });\n                              }\n\n                              ;\n                            };\n\n                            resourceUIService.getResources(getResources_back);\n                          }\n\n                          ;\n                        };\n\n                        resourceUIService.getModelByIds([modelId], getModel_back);\n                      }\n                    };\n\n                    viewFlexService.getViewById(template.viewId, getViewById_back);\n                  } else {\n                    scope.error = \"没有找到相应的设备仪表板视图，点击<a href='#/views/dashboard' style='cursor:pointer; text-decoration: underline;'>Dashboard管理</a>创建设备仪表板\";\n                  }\n                } else {\n                  scope.error = \"视图列表为空，请联系系统管理员\";\n                }\n              };\n\n              viewFlexService.getDefaultView(modelId, getDefaultView_back);\n            } else {\n              scope.error = \"获取视图列表发生错误，请联系系统管理员\";\n            }\n          };\n\n          viewFlexService.getManagedViewsByTypeAndRole('dashboard', getManagedViewsByType_back);\n        } else if (vt == \"json:\") {} else {\n          //var parameter = JSON.parse($routeParams.parameter);\n          var find = dt[\"groups\"].find(function (element) {\n            return vt == element.path;\n          });\n          scope.tabIndex = find ? dt['groups'].indexOf(find) : 0;\n          scope.tabs = dt.groups;\n          input = {\n            layout: dt.groups[scope.tabIndex].layout,\n            setting: dt.setting\n          };\n          var editData = new freeboardservice.replaceCiKpi(input, function () {\n            timeout(function () {\n              scope.instance.setMode(true);\n              scope.instance.renderLayout(editData);\n            });\n          }, null, dt, scope);\n        }\n      } else if (dt.hasOwnProperty(\"data\")) {\n        scope.navigation = [{\n          label: '运营首页'\n        }];\n        input = {\n          layout: dt.data,\n          setting: dt.setting\n        };\n        var editData = new freeboardservice.replaceCiKpi(input, function () {\n          timeout(function () {\n            scope.instance.setMode(true);\n            scope.instance.renderLayout(editData);\n          });\n        }, null, dt, scope);\n      } else if (dt.hasOwnProperty(\"layout\")) {\n        scope.navigation = [{\n          label: '运营首页'\n        }];\n        input = {\n          layout: dt.layout,\n          setting: dt.setting\n        };\n        var editData = new freeboardservice.replaceCiKpi(input, function () {\n          timeout(function () {\n            scope.instance.setMode(true);\n            scope.instance.renderLayout(editData);\n          });\n        }, null, dt, scope);\n      }\n\n      ;\n    };\n\n    var getViewById_back = function getViewById_back(event) {\n      if (event.code == 0 && event.data != null) {\n        var input;\n        var content = event.data.content;\n        var dt = JSON.parse(content);\n        renderData(dt);\n      } else {\n        scope.error = \"此用户无配置首页视图\" + (event.message ? \",\" + event.message : \"\");\n      }\n\n      ;\n    };\n\n    var init = function init() {\n      var numExp = /\\d+/g;\n\n      if (numExp.test(viewId)) {\n        viewFlexService.getViewById(viewId, getViewById_back);\n      } else {\n        var path = \"../localdb/echartTemplate/\" + viewId + \".json\";\n        Info.get(path, function (info) {\n          renderData(info);\n        });\n      }\n\n      ;\n    };\n\n    scope.selectEditDataGroup = function (tab) {\n      scope.tabIndex = tab.id;\n      input = {\n        layout: tab.layout,\n        setting: scope.editData.setting\n      };\n      scope.editData = new freeboardservice.replaceCiKpi(input, function () {\n        timeout(function () {\n          console.log(scope.editData);\n          scope.editData.renderBoard(true, true);\n        });\n      });\n    };\n\n    if (!userLoginUIService.user.isAuthenticated) {\n      scope.$on('loginStatusChanged', function (evt, d) {\n        if (userLoginUIService.user.isAuthenticated) {\n          init();\n        }\n      });\n    } else {\n      init();\n    }\n\n    ;\n  }\n});"],"sourceRoot":"/source/"}