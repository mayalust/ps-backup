{"version":3,"sources":["js/controllers/dashboard-ver3-ctrl.js"],"names":["_typeof","obj","Symbol","iterator","constructor","prototype","define","controllers","Dashboard_ver3Ctrl","scope","userEnterpriseService","q","rootScope","viewFlexService","resourceUIService","timeout","window","Info","freeboardservice","growl","routeParams","freeboardBaseService","userLoginUIService","roleViewService","viewTitle","page","pa","s","decodeURIComponent","parameter","signClick","location","href","naviClick","link","param","encodeURIComponent","JSON","stringify","setCurrentTab","str","console","log","bgColorFn","bgColor","background-color","$parent","user","roleID","defer","ready","resView","code","serviceViewId","data","viewId","instance","getViewById","event","input","view","content","dt","parse","setting","color","hasOwnProperty","vt","va_arr","vt_arr","split","length","base","rs","loop","inx","elem","find","element","path","tabLabel","push","label","slice","parseInt","i","navigation","allAvaliableViews","template","arr","modelId","resourceId","concat","getManagedViewsByTypeAndRole","getDefaultView","templateDefault","templateExtent","roleResList","some","resId","resType","model","resource","getModelByIds","getResource_back","clone","layout","editData","replaceCiKpi","setMode","renderLayout","getResourceById","getResources","resources","itemchange","id","error","tabIndex","indexOf","tabs","groups","message","selectEditDataGroup","tab","renderBoard","queryEnterpriseRole","returnObj","role","item","resolve","reject","promise","then","objLike","arrLike","description","RegExp","test","getViewByFunctionName","toolbars","name","registerController","$inject"],"mappings":"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","file":"js/controllers/dashboard-ver3-ctrl.js","sourcesContent":["function _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\ndefine(['controllers/controllers', 'Array'], function (controllers) {\n  'use strict';\n\n  controllers.registerController('Dashboard_ver3Ctrl', Dashboard_ver3Ctrl);\n  Dashboard_ver3Ctrl.$inject = [\"$scope\", \"userEnterpriseService\", \"$q\", \"$rootScope\", \"viewFlexService\", \"resourceUIService\", \"$timeout\", \"$window\", \"Info\", \"freeboardservice\", 'growl', '$routeParams', 'freeboardBaseService', 'userLoginUIService', 'roleViewService'];\n\n  function Dashboard_ver3Ctrl(scope, userEnterpriseService, q, rootScope, viewFlexService, resourceUIService, timeout, window, Info, freeboardservice, growl, routeParams, freeboardBaseService, userLoginUIService, roleViewService) {\n    var allViews,\n        currentView,\n        viewTitle = routeParams.page ? routeParams.page : 'index';\n\n    var pa = function (s) {\n      if (!s) return undefined;\n      return decodeURIComponent(routeParams.parameter);\n    }(pa);\n\n    function getRoleByID(roleID) {\n      var defer = q.defer();\n      userEnterpriseService.queryEnterpriseRole(function (returnObj) {\n        if (returnObj.code == 0) {\n          var role = returnObj.data.find(function (item) {\n            return item.roleID == roleID;\n          });\n          defer.resolve(role);\n        } else {\n          defer.reject(returnObj);\n        }\n      });\n      return defer.promise;\n    }\n\n    function parseJson(str) {\n      var objLike = new RegExp(\"^\\\\{.*\\\\}$\", \"g\");\n      var arrLike = new RegExp(\"^\\\\[.*\\\\]$\", \"g\");\n\n      if (objLike.test(str) || arrLike.test(str)) {\n        return JSON.parse(str);\n      } else {\n        return null;\n      }\n    }\n\n    scope.signClick = function () {\n      window.location.href = \"../app-freeboard/index.html#/service/view/scenter\" + (currentView ? '/' + currentView.viewId : '');\n    };\n\n    scope.naviClick = function (link, param) {\n      window.location.href = \"../app-oc/index.html#/dashboard/\" + link + \"/\" + encodeURIComponent(JSON.stringify(param));\n    };\n\n    rootScope.setCurrentTab = function (str) {\n      console.log(\"asd\" + str);\n    };\n\n    scope.bgColorFn = function (bgColor) {\n      return {\n        \"background-color\": bgColor ? bgColor : \"#eee\"\n      };\n    };\n\n    console.log(scope.$parent, rootScope);\n\n    var ready = function ready(resView) {\n      if (resView.code == 0) {\n        var serviceViewId = resView.data.viewId;\n        scope.instance = {};\n\n        var getViewById_back = function getViewById_back(event) {\n          if (event.code == 0 && event.data != null) {\n            var input,\n                view = event.data;\n            var content = event.data.content;\n            var dt = JSON.parse(content);\n\n            if (typeof dt.setting == \"string\") {\n              dt.setting = JSON.parse(dt.setting);\n            }\n\n            scope.setting = dt.setting;\n\n            if (dt.setting) {\n              scope.bgColor = dt.setting.color;\n            }\n\n            if (dt.hasOwnProperty(\"groups\")) {\n              var vt,\n                  vt_arr = viewTitle.split(\"|\"),\n                  va_arr;\n\n              if (pa) {\n                va_arr = JSON.parse(pa);\n              } else {\n                va_arr = [];\n              }\n\n              if (vt_arr.length > 0) {\n                vt = vt_arr[vt_arr.length - 1];\n              } else {\n                vt = viewTitle;\n                vt_arr = [viewTitle];\n              }\n\n              var base = '',\n                  rs = [];\n\n              var loop = function loop(inx, elem) {\n                var find = dt[\"groups\"].find(function (element) {\n                  return elem == element.path;\n                });\n\n                if (find) {\n                  base = base == \"\" ? elem : base + \"|\" + elem;\n                  var param = va_arr[inx],\n                      tabLabel;\n\n                  if (_typeof(param) == \"object\" && param != null) {\n                    tabLabel = param.tabLabel;\n                  }\n\n                  rs.push({\n                    label: tabLabel ? tabLabel : find.label,\n                    link: base,\n                    param: va_arr.slice(0, parseInt(inx) + 1)\n                  });\n                }\n\n                ;\n              };\n\n              for (var i in vt_arr) {\n                loop(i, vt_arr[i]);\n              }\n\n              ;\n              scope.navigation = rs;\n\n              if (vt == \"panel\") {\n                var getLastElement = function getLastElement(arr) {\n                  return arr[arr.length - 1];\n                };\n\n                var parameter = getLastElement(JSON.parse(routeParams.parameter));\n                var modelId = parameter.modelId;\n                var resourceId = parameter.resourceId;\n                scope.navigation = scope.navigation.concat({\n                  label: parameter.tabLabel ? parameter.tabLabel : \"设备仪表板\",\n                  link: base + \"|panel\"\n                });\n                var allAvaliableViews, defaultViews, template;\n\n                var getManagedViewsByType_back = function getManagedViewsByType_back(event) {\n                  if (event.code == 0) {\n                    allAvaliableViews = event.data;\n\n                    var getDefaultView_back = function getDefaultView_back(event) {\n                      if (event.code == \"0\") {\n                        defaultViews = event.data;\n                        var templateDefault = defaultViews.find(function (elem) {\n                          if (elem.template) {\n                            if (elem.template.resourceId == modelId) {\n                              return true;\n                            } else {\n                              return false;\n                            }\n                          } else {\n                            return false;\n                          }\n                        });\n                        var templateExtent = allAvaliableViews.find(function (elem) {\n                          var viewId = elem.viewId;\n\n                          if (elem.template) {\n                            if (elem.template.resourceId == modelId) {\n                              var findRoleRes = function findRoleRes(elem) {\n                                return elem.resId == viewId && elem.resType == 21;\n                              };\n\n                              var authorized = userLoginUIService.user.roleResList.some(findRoleRes);\n                              return authorized;\n                            } else {\n                              return false;\n                            }\n                          } else {\n                            return false;\n                          }\n                        });\n\n                        if (templateExtent) {\n                          template = templateExtent;\n                        } else if (templateDefault) {\n                          template = templateDefault;\n                        }\n\n                        if (template) {\n                          var getViewById_back = function getViewById_back(event) {\n                            var model, resource, content;\n\n                            if (event.code == \"0\") {\n                              var content = event.data.content;\n\n                              var getModel_back = function getModel_back(event) {\n                                if (event.code == \"0\") {\n                                  model = event.data[0];\n                                }\n\n                                var getResource_back = function getResource_back(event) {\n                                  if (event.code == \"0\") {\n                                    resource = event.data;\n\n                                    if (content != null) {\n                                      var clone = JSON.parse(content);\n                                      var input = {\n                                        layout: clone.data ? clone.data : clone.layout,\n                                        setting: clone.setting\n                                      };\n                                      delete clone.data;\n                                      var editData = new freeboardservice.replaceCiKpi(input, function () {\n                                        timeout(function () {\n                                          scope.instance.setMode(true);\n                                          scope.instance.renderLayout(editData, null, view, scope);\n                                        });\n                                      }, {\n                                        model: model,\n                                        resource: resource\n                                      }, clone);\n                                    }\n                                  }\n                                };\n\n                                if (resourceId) {\n                                  resourceUIService.getResourceById(resourceId, getResource_back);\n                                } else {\n                                  var getResources_back = function getResources_back(event) {\n                                    if (event.code == 0) {\n                                      scope.resources = event.data;\n                                      /** console.log(scope.resources); */\n\n                                      scope.resource = scope.resources[0];\n\n                                      scope.itemchange = function (event) {\n                                        var id = event.id.split(\"number:\")[1];\n                                        var find = scope.resources.find(function (elem) {\n                                          return elem.id == id;\n                                        });\n\n                                        if (find) {\n                                          getResource_back({\n                                            code: 0,\n                                            data: find\n                                          });\n                                        }\n                                      };\n\n                                      getResource_back({\n                                        code: 0,\n                                        data: scope.resources[0]\n                                      });\n                                    }\n\n                                    ;\n                                  };\n\n                                  resourceUIService.getResources(getResources_back);\n                                }\n\n                                ;\n                              };\n\n                              resourceUIService.getModelByIds([modelId], getModel_back);\n                            }\n                          };\n\n                          viewFlexService.getViewById(template.viewId, getViewById_back);\n                        } else {\n                          scope.error = \"没有找到相应的设备仪表板视图，点击<a href='#/views/dashboard' style='cursor:pointer; text-decoration: underline;'>Dashboard管理</a>创建设备仪表板\";\n                        }\n                      } else {\n                        scope.error = \"视图列表为空，请联系系统管理员\";\n                      }\n                    };\n\n                    viewFlexService.getDefaultView(modelId, getDefaultView_back);\n                  } else {\n                    scope.error = \"获取视图列表发生错误，请联系系统管理员\";\n                  }\n                };\n\n                viewFlexService.getManagedViewsByTypeAndRole('dashboard', getManagedViewsByType_back);\n              } else {\n                //var parameter = JSON.parse($routeParams.parameter);\n                var find = dt[\"groups\"].find(function (element) {\n                  return vt == element.path;\n                });\n                scope.tabIndex = find ? dt['groups'].indexOf(find) : 0;\n                scope.tabs = dt.groups;\n                input = {\n                  layout: dt.groups[scope.tabIndex].layout,\n                  setting: dt.setting\n                };\n                var editData = new freeboardservice.replaceCiKpi(input, function () {\n                  timeout(function () {\n                    scope.instance.setMode(true);\n                    scope.instance.renderLayout(editData, null, view, scope);\n                  });\n                }, null, dt, scope);\n              }\n            } else if (dt.hasOwnProperty(\"data\")) {\n              scope.navigation = [{\n                label: '运营首页'\n              }];\n              input = {\n                layout: dt.data,\n                setting: dt.setting\n              };\n              var editData = new freeboardservice.replaceCiKpi(input, function () {\n                timeout(function () {\n                  scope.instance.setMode(true);\n                  scope.instance.renderLayout(editData, null, view, scope);\n                });\n              }, null, dt, scope);\n            } else if (dt.hasOwnProperty(\"layout\")) {\n              scope.navigation = [{\n                label: '运营首页'\n              }];\n              input = {\n                layout: dt.layout,\n                setting: dt.setting\n              };\n              var editData = new freeboardservice.replaceCiKpi(input, function () {\n                timeout(function () {\n                  scope.instance.setMode(true);\n                  scope.instance.renderLayout(editData, null, view, scope);\n                });\n              }, null, dt, scope);\n            }\n\n            ;\n          } else {\n            scope.error = \"此用户无配置首页视图\" + (event.message ? \",\" + event.message : \"\");\n          }\n\n          ;\n        };\n\n        viewFlexService.getViewById(serviceViewId, getViewById_back);\n      } else {\n        scope.error = resView.message;\n      }\n\n      scope.selectEditDataGroup = function (tab) {\n        scope.tabIndex = tab.id;\n        var input = {\n          layout: tab.layout,\n          setting: scope.editData.setting\n        };\n        scope.editData = new freeboardservice.replaceCiKpi(input, function () {\n          timeout(function () {\n            console.log(scope.editData);\n            scope.editData.renderBoard(true, true);\n          });\n        });\n      };\n    };\n\n    var roleID = function (user) {\n      if (_typeof(user) != \"object\") return null;\n      if (typeof user.roleID != \"string\") return null;\n      return user.roleID.split(\",\")[0];\n    }(userLoginUIService.user);\n\n    if (roleID) {\n      getRoleByID(roleID).then(function (role) {\n        var json = parseJson(role.description);\n\n        if (json) {\n          var view = {\n            viewId: 224265044620000\n          };\n          ready({\n            code: 0,\n            data: view\n          });\n        } else {\n          roleViewService.getViewByFunctionName(\"运营首页\", ready);\n        }\n      });\n    } else {\n      roleViewService.getViewByFunctionName(\"运营首页\", ready);\n    }\n\n    scope.toolbars = [{\n      id: \"1\",\n      name: \"工具1\"\n    }, {\n      id: \"2\",\n      name: \"工具2\"\n    }, {\n      id: \"3\",\n      name: \"工具3\"\n    }, {\n      id: \"4\",\n      name: \"工具4\"\n    }, {\n      id: \"5\",\n      name: \"工具5\"\n    }];\n  }\n});"],"sourceRoot":"/source/"}