{"version":3,"sources":["js/directives/report-dom.js"],"names":["define","directives","datatables","initDirective","$timeout","$compile","restrict","controller","$scope","$element","$attrs","table","domMain","$on","Event","REPORTTREEINIT","event","args","destroy","DataTable","dom","language","$","ProudSmart","datatable","data","datalist","columns","columnDefs","scrollX","on","e","stopPropagation","name","this","text","search","length","footerdom","title","optionCol2","targets","render","type","full","str","Date","Format","tr","closest","rowDate","row","window","open","url","reportName","reportFileName","optionCol3"],"mappings":"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","file":"js/directives/report-dom.js","sourcesContent":["define(['directives/directives', 'datatables.net', 'datatables.net-bs'], function (directives, datatables) {\n  'use strict';\n\n  directives.initDirective('durationTable', ['$timeout', '$compile', function ($timeout, $compile) {\n    return {\n      restrict: 'A',\n      controller: ['$scope', '$element', '$attrs', function ($scope, $element, $attrs) {\n        var domMain = $element;\n        var table;\n        var isEditing = false; // $scope.$on(Event.CMDBINFOSINIT+\"_shadows\", function(event, args) {\n\n        $scope.$on(Event.REPORTTREEINIT + \"_duration\", function (event, args) {\n          if (table) {\n            table.destroy();\n          }\n\n          isEditing = false;\n          table = domMain.DataTable({\n            dom: '<\"row\"<\"col-sm-6\"<\"special-btn\">><\"col-sm-6\">><\"row\"<\"clo-sm-12\">>t<\"row\"<\"col-sm-2\"i><\"col-sm-2\"l><\"col-sm-8\"p>>',\n            language: $.ProudSmart.datatable.language,\n            data: args.datalist,\n            columns: args.columns,\n            columnDefs: args.columnDefs,\n            scrollX: true\n          });\n        });\n        domMain.on('click', '#designname', function (e) {\n          e.stopPropagation();\n          var name = $(this).text();\n          $scope.search(name, \"1001\");\n        });\n        domMain.on('click', '#clientnum', function (e) {\n          e.stopPropagation();\n          var name = $(this).text();\n          $scope.search(name, \"1000\");\n        });\n      }]\n    };\n  }]);\n  directives.initDirective('reportLookTable', ['$timeout', '$compile', function ($timeout, $compile) {\n    return {\n      restrict: 'A',\n      controller: ['$scope', '$element', '$attrs', function ($scope, $element, $attrs) {\n        var domMain = $element;\n        var table;\n        var isEditing = false; // $scope.$on(Event.CMDBINFOSINIT+\"_shadows\", function(event, args) {\n\n        $scope.$on(\"reportLook\", function (event, args) {\n          if (table) {\n            table.destroy();\n          }\n\n          isEditing = false;\n          table = domMain.DataTable({\n            dom: args && args.length > 0 ? $.ProudSmart.datatable.footerdom : '',\n            language: $.ProudSmart.datatable.language,\n            data: args,\n            columns: [{\n              title: \"报表名称\",\n              data: \"reportName\"\n            }, {\n              title: \"生成时间\",\n              data: \"insertTime\"\n            }, {\n              title: \"报表格式\",\n              data: \"fileType\"\n            }, $.ProudSmart.datatable.optionCol2],\n            columnDefs: [{\n              \"targets\": 1,\n              \"data\": \"insertTime\",\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                var str = \"\";\n\n                var chGMT = function chGMT(dateStr) {\n                  var mydate = new Date(dateStr);\n                  return mydate.Format(\"yyyy-MM-dd hh:mm:ss\");\n                };\n\n                if (data) {\n                  str = chGMT(data);\n                }\n\n                return str;\n              }\n            }, {\n              \"targets\": 3,\n              \"data\": \"option\",\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                var str = \"<div class='btn-group btn-group-sm'>\"; // str += \"<a id='del-btn' class='btn btn-default btn-sm'><i class='fa fa-save  hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 删除</span></a>\";\n\n                str += \"<a id='download-btn' class='btn btn-default btn-sm' ><i class='fa fa-times hidden-lg hidden-md hidden-sm '></i><span class='hidden-xs'> 下载</span></a>\";\n                str += \"</div>\";\n                return str;\n              }\n            }]\n          });\n        });\n        domMain.on('click', '#del-btn', function (e) {\n          e.stopPropagation();\n          var name = $(this).text();\n          $scope.search(name, \"1001\");\n        });\n        domMain.on('click', '#download-btn', function (e) {\n          e.stopPropagation();\n          var tr = $(this).closest('tr');\n          var row = table.row(tr);\n          var rowDate = row.data();\n          /*var url = \"\"+$scope.url+\"/\"+rowDate.url+\"\";\n          var elemIF = document.createElement(\"iframe\");\n          elemIF.src = url;\n          elemIF.style.display = \"none\";\n          document.body.appendChild(elemIF);*/\n\n          window.open(\"\" + $scope.url + \"/api/rest/downloadReport/reportUIService/download?reportName=\" + rowDate.reportName + \"&reportFileName=\" + rowDate.reportFileName + \"\");\n        });\n      }]\n    };\n  }]);\n  directives.initDirective('reportRuleTable', ['$timeout', '$compile', function ($timeout, $compile) {\n    return {\n      restrict: 'A',\n      controller: ['$scope', '$element', '$attrs', function ($scope, $element, $attrs) {\n        var domMain = $element;\n        var table;\n        var isEditing = false; // $scope.$on(Event.CMDBINFOSINIT+\"_shadows\", function(event, args) {\n\n        $scope.$on(\"reportRule\", function (event, args) {\n          if (table) {\n            table.destroy();\n          }\n\n          isEditing = false;\n          table = domMain.DataTable({\n            dom: args && args.length > 0 ? $.ProudSmart.datatable.footerdom : '',\n            language: $.ProudSmart.datatable.language,\n            data: args,\n            columns: [{\n              title: \"规则名称\",\n              data: \"userName\"\n            }, {\n              title: \"邮件模板\",\n              data: \"userName\"\n            }, {\n              title: \"报表名称\",\n              data: \"userName\"\n            }, {\n              title: \"接收人\",\n              data: \"userName\"\n            }, {\n              title: \"启用状态\",\n              data: \"userName\"\n            }, $.ProudSmart.datatable.optionCol3],\n            columnDefs: [{\n              \"targets\": 5,\n              \"data\": \"option\",\n              \"render\": function render(data, type, full) {\n                // 返回自定义内容\n                var str = \"<div class='btn-group btn-group-sm'>\";\n                str += \"<a id='edit-btn' class='btn btn-default btn-sm'><i class='fa fa-save  hidden-lg hidden-md hidden-sm'></i><span class='hidden-xs'> 编辑</span></a>\";\n                str += \"<a id='del-btn' class='btn btn-default btn-sm' ><i class='fa fa-times hidden-lg hidden-md hidden-sm '></i><span class='hidden-xs'> 删除</span></a>\";\n                str += \"</div>\";\n                return str;\n              }\n            }]\n          });\n        });\n        domMain.on('click', '#del-btn', function (e) {\n          e.stopPropagation();\n          var name = $(this).text();\n          $scope.search(name, \"1001\");\n        });\n      }]\n    };\n  }]);\n  directives.initDirective('yieldTable', ['$timeout', '$compile', function ($timeout, $compile) {\n    return {\n      restrict: 'A',\n      controller: ['$scope', '$element', '$attrs', function ($scope, $element, $attrs) {\n        var domMain = $element;\n        var table;\n        var isEditing = false; // $scope.$on(Event.CMDBINFOSINIT+\"_shadows\", function(event, args) {\n\n        $scope.$on(Event.REPORTTREEINIT + \"_yield2\", function (event, args) {\n          if (table) {\n            table.destroy();\n          }\n\n          isEditing = false;\n          table = domMain.DataTable({\n            dom: '<\"row\"<\"col-sm-6\"<\"special-btn\">><\"col-sm-6\">><\"row\"<\"clo-sm-12\">>t<\"row\"<\"col-sm-2\"i><\"col-sm-2\"l><\"col-sm-8\"p>>',\n            language: $.ProudSmart.datatable.language,\n            data: args.datalist,\n            columns: args.columns,\n            columnDefs: args.columnDefs,\n            scrollX: true\n          });\n        });\n      }]\n    };\n  }]);\n});"],"sourceRoot":"/source/"}