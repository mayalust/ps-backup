{"version":3,"sources":["js/directives/ps-tree-dom.js"],"names":["define","directives","pstree","psTreeViewDir","q","timeout","$location","viewFlexService","restrict","template","replace","scope","ngModel","option","init","link","elem","treeIns","$watch","n","o","s","d","runtime","console","log","value","animate","themes","data","on","event","cur","this","depth","open","group","createGroup","str","view","viewTitle","viewId","text","createText","float","color","addBtn","createButton","e","$apply","path","modelId","id","appendChild","render","click","destroy","children","remove","registerDirective","dataTableDir","directive","$inject"],"mappings":"AAAAA,OAAO,CAAC,wBAAyB,UAAW,SAAUC,EAAYC,GAChE,aAKA,SAASC,EAAcC,EAAGC,EAASC,EAAWC,GAC5C,MAAO,CACLC,SAAU,IACVC,SAAU,cACVC,SAAS,EACTC,MAAO,CACLC,QAAS,IACTC,OAAQ,IACRC,KAAM,KAERC,KAAM,SAAcJ,EAAOK,GACzB,IAAIC,EAgDJN,EAAMO,OAAO,SAAU,SAAUC,EAAGC,EAAGC,GA9CvC,IAAgBC,EA+CdC,QAAQ,SACRC,QAAQC,IAAI,IAAKN,GACjBA,GAjDcG,EAiDHH,EAhDXF,EAAUf,EAAOc,EAAK,GAAI,CACxBU,MAAOf,EAAMC,QACbe,SAAS,EACTC,OAAQ,YACRC,KAAMP,EACNQ,GAAI,CACFhB,KAAM,SAAciB,GAElB,IAAIC,EAAMC,KAEO,EAAbA,KAAKC,QACPD,KAAKE,MAAO,GAGd,IAAIC,EAAQH,KAAKI,YAAY,SACzBC,EAAML,KAAKM,KAAON,KAAKM,KAAKC,UAAY,IAAMP,KAAKM,KAAKE,OAAS,IAAM,IACvEC,EAAOT,KAAKU,WAAW,KAAML,EAAK,CACpCM,MAAO,QACPC,MAAO,SAELC,EAASb,KAAKc,aAAa,MAAO,KAAM,CAC1CH,MAAO,SACN,SAAUI,GACXrC,EAAMsC,OAAO,WACX3C,EAAU4C,KAAK,iBAAmBlB,EAAImB,QAAU,IAAMnB,EAAIoB,QAG9DhB,EAAMiB,YAAYP,GAClBV,EAAMiB,YAAYX,GAClBT,KAAKqB,OAAOlB,IAEdmB,MAAO,SAAexB,QAG1BpB,EAAMG,KAAK,CACTG,QAASA,IAEXM,QAAQ,WAIRN,GAAWA,EAAQuC,UACnBxC,EAAKyC,WAAWC,cA3DxBzD,EAAW0D,mBAAqB1D,EAAW0D,kBAAkB,aAAcC,eAAiB3D,EAAW4D,UAAU,aAAc1D,GAC/HA,EAAc2D,QAAU,CAAC,KAAM,WAAY,YAAa","file":"js/directives/ps-tree-dom.js","sourcesContent":["define(['directives/directives', 'pstree'], function (directives, pstree) {\n  'use strict';\n\n  directives.registerDirective && directives.registerDirective(\"psTreeView\", dataTableDir) || directives.directive('psTreeView', psTreeViewDir);\n  psTreeViewDir.$inject = ['$q', '$timeout', '$location', 'viewFlexService'];\n\n  function psTreeViewDir(q, timeout, $location, viewFlexService) {\n    return {\n      restrict: \"E\",\n      template: \"<div></div>\",\n      replace: true,\n      scope: {\n        ngModel: \"=\",\n        option: \"=\",\n        init: \"&\"\n      },\n      link: function link(scope, elem) {\n        var treeIns, dt;\n\n        function create(d) {\n          treeIns = pstree(elem[0], {\n            value: scope.ngModel,\n            animate: false,\n            themes: \"show-line\",\n            data: d,\n            on: {\n              init: function init(event) {\n                //console.log(this);\n                var cur = this;\n\n                if (this.depth > 1) {\n                  this.open = false;\n                }\n\n                var group = this.createGroup(\"group\");\n                var str = this.view ? this.view.viewTitle + \"[\" + this.view.viewId + \"]\" : \"无\";\n                var text = this.createText(\"id\", str, {\n                  float: \"right\",\n                  color: \"#999\"\n                });\n                var addBtn = this.createButton(\"add\", \"选择\", {\n                  float: \"right\"\n                }, function (e) {\n                  scope.$apply(function () {\n                    $location.path(\"/rview_select/\" + cur.modelId + \"/\" + cur.id);\n                  });\n                });\n                group.appendChild(addBtn);\n                group.appendChild(text);\n                this.render(group);\n              },\n              click: function click(event) {}\n            }\n          });\n          scope.init({\n            treeIns: treeIns\n          });\n          runtime('树加载完成');\n        }\n\n        function destroy() {\n          treeIns && treeIns.destroy();\n          elem.children().remove();\n        }\n\n        scope.$watch(\"option\", function (n, o, s) {\n          runtime('n数值改变');\n          console.log(\"n\", n);\n          n ? create(n) : destroy();\n        });\n      }\n    };\n  }\n\n  ;\n});"],"sourceRoot":"/source/"}