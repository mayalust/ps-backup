{"version":3,"sources":["js/directives/dashboard-dom.js"],"names":["define","directives","echarts","dragging","editBtn_directive","timeout","variables","route","directive","restrict","scope","dashboard","link","element","attr","current","params","mode","$","addClass","removeClass","on","$apply","callback","_EDITMODE_","_VIEWMODE_","colorSelector_directive","bgcolor","colors","wrap","i","showBlock","color","block","css","width","height","margin","float","display","append","event","stopPropagation","off","attributes","offset","top","left","hideBlock","prepend","iconSelector_directive","icon","icons","find","ciSelectmenu_directive","tool","$resources","get","then","data","obj","option","text","label","id","this","call","nodeId","ci","modelId","getModelIdByNodeId","$kpis","getBymodelId","onChange","error","err","console","log","selectmenu","change","ui","parseInt","item","value","aciSelectmenu_directive","getCurrent","index","getAttrByNodeId","ciSelectmenuChart_directive","kpiCache","chart","$watch","n","o","s","add","fill","kpiObjects","some","push","kpiObj","length","nodes","kpiSelectmenuChart_directive","target","kpis","children","remove","prop","render","filter","kpi","map","selectmenu_directive","attrSelectmenu_directive","attrId","bootinputfree_directive","model","oldValue","inputDom","cols","col","arr","val","split","reduce","prev","next","alert","elem","bootinput_directive","wrapDiv","colDiv","numberInput","unitDiv","sum","parts","draggable_directive","draggable","start","stop","handle","cursor","appendTo","revert","helper","drag","currentTarget","layout","JSON","parse","stringify","layouts","result","divDom","revertDuration","zIndex","connectToSortable","droppable_directive","q","kpiDataService","resourceUIService","viewFlexService","growl","basicline","basicpie","location","window","Info","ticketTaskService","solutionUIService","templates","$Array","bootEditor","object","cur","structure","resize","toJSON","each","type","echart","dragconfig","cursorAt","opacity","clone","size","cl","pointer-events","mouseEvent","mouseover","mouseout","dropconfig","tolerance","drop","rowWrap","rowInput","variable","dragId","$randomString","eachRow","domId","hasClass","rowId","parent","colId","eachCol","rows","temp","box","boxHeader","before","traverse","init","$tree","insertAfter","getData","root","row","boxBody","droppable","inputTitle","toolbar","moveBtn","deleteBtn","insertBefore","innerContent","innerWrap","checkbox","show","removeAttr","title","column","j","inrow","designView","totalItems","progress","downTab","attrTab","header","content","getOption","elements","listone","listtwo","sparkline","document","removed","param","emptyRow","undefined","eRow","emptyCol","mydata","dom","renderlayout","deferreds","kpiResDefer","deferred","defer","promise","kpisDes","nodesDes","category","dataType","formatStr","$rootDomain","kpiQueryModel","isRealTimeData","timePeriod","timespan","nodeIds","kpiCodes","startTime","endTime","timeRange","statisticType","condList","def1","resolve","all","getValueList","valueList","vlistGroup","nodeDes","kpiId","kpiDes","vg","date","Date","getTime","year","getYear","month","getMonth","dt","getDate","values","kpiCode","arisingTime","replace","timeStamp","xAxis","legend","optionFormat","vlGroup","$valueListGroup","op","$option","series","clearSeries","getLegend","getxAxisByTime","eachValueListMerged","name","$valueList","pushSeries","first","firstSeries","setFirstxAxis","setLegend","itemStyle","normal","lineStyle","areaStyle","markPoint","markLine","animation","getKpiHierarchyValueList","code","ul","recordList","Array","alert_code_count","li","after","currentKpi","inner","number","indexOf","getResourceById","getDataByModelId","getValueByRootKpi","unit","href","$units","units","unitCode","unitName","addErrorMessage","kpiDefs","outer","kpiIds","getValueListByRootKpis","vlist","myvalues","slice","el","barColor","baseoption","dashboardOption","backgroundColor","subtext","sublink","textStyle","tooltip","trigger","formatter","seriesName","bmap","center","zoom","roam","mapStyle","styleJson","coordinateSystem","symbolSize","position","emphasis","showEffectOn","rippleEffect","brushType","hoverAnimation","shadowBlur","shadowColor","zlevel","info","styleJson_dark","statDeviceByStandardAddress","returnObj","citys","北京市","city","geoCoord","prg","getByKpiIds","html","valueDom","disc","old","rate","Math","abs","random","fun","uldom","eval","message","lidom","format","createTime","time","exec","t","tbody","status","priorityCode","ticketNo","fn","extend","setOption","arguments","dashboardView","beditor","viewId","changeView","save","solutionId","saveManageViewContent","open","success","viewTitle","viewName","viewType","saveManageDashboard","delete","deleteViews","initDirective","$inject"],"mappings":"AAAAA,OAAO,CAAC,wBAAyB,UAAW,YAAa,WAAY,QAAS,SAAUC,WAAYC,SAClG,aAEA,IAAIC,UAAW,EAIf,SAASC,kBAAkBC,EAASC,EAAWC,GAC7C,IAAIC,EAAY,CAChBC,SAAqB,IACrBC,MAAkB,CAChBC,UAAW,KAGbC,KAAiB,SAAUF,EAAOG,EAASC,GACzCT,EAAQ,WAC2B,QAA7BE,EAAMQ,QAAQC,OAAOC,MACvBC,EAAE,aAAaC,SAAS,QACxBD,EAAE,cAAcC,SAAS,QACzBT,EAAMC,UAAUM,KAAO,aAEvBC,EAAE,aAAaE,YAAY,QAC3BF,EAAE,cAAcE,YAAY,QAC5BV,EAAMC,UAAUM,KAAO,cAG3BC,EAAEL,GAASQ,GAAG,QAAS,WACrBX,EAAMY,OAAO,WACAJ,EAAE,QAETR,EAAMC,UAAUY,UAClBb,EAAMC,UAAUY,WAGdb,EAAMC,UAAUM,MAAQX,EAAUkB,YACpCN,EAAE,aAAaE,YAAY,QAC3BF,EAAE,cAAcE,YAAY,QAC5BV,EAAMC,UAAUM,KAAOX,EAAUmB,aAEjCP,EAAE,aAAaC,SAAS,QACxBD,EAAE,cAAcC,SAAS,QACzBT,EAAMC,UAAUM,KAAOX,EAAUkB,kBAMzC,OAAOhB,EAMT,SAASkB,wBAAwBrB,EAASC,GAUxC,IAAIE,EAAY,CAChBC,SAAqB,IACrBC,MAAkB,CAChBiB,QAAS,KAGXf,KAAiB,SAAUF,EAAOG,EAASC,GACzCT,EAAQ,WACN,IAAIuB,EAAS,CAAC,SAAU,YAAa,UAAW,UAAW,gBAAiB,WAAY,UAAW,UAAW,WAAY,UAAW,YAAa,aAAc,YAAa,YAAa,WAAY,YAClMC,EAAOX,EAAE,kDAGb,IAAK,IAAIY,KAFTZ,EAAEL,GAASQ,GAAG,WAAYU,GAEZH,GACZ,SAAWI,GACT,IAAIC,EAAQf,EAAE,yBAA2Bc,EAAQ,YACjDC,EAAMC,IAAI,CACRC,MAAO,GACPC,OAAQ,GACRC,OAAQ,EACRC,MAAO,OACPC,QAASN,IAEXJ,EAAKW,OAAOP,GACZA,EAAMZ,GAAG,cAAe,SAAUoB,GAChCA,EAAMC,kBACNb,EAAKK,IAAI,UAAW,QACpBhB,EAAE,QAAQyB,IAAI,cACdzB,EAAEL,GAAS8B,IAAI,YACfzB,EAAEL,GAASQ,GAAG,WAAYU,GAC1BrB,EAAMY,OAAO,WACPZ,EAAMiB,QAAQiB,WAChBlC,EAAMiB,QAAQiB,WAAWZ,MAAQA,EAEjCtB,EAAMiB,QAAQiB,WAAa,CACzBZ,MAAOA,GAIXd,EAAEL,GAASO,cAAcD,SAAS,aAAaA,SAASa,OAzB9D,CA4BGJ,EAAOE,IAEVpB,EAAMiB,QAAQiB,WAAWZ,MAAQJ,EAAO,GAG1C,SAASG,EAAUU,GACjBA,EAAMC,kBACNb,EAAKK,IAAI,UAAW,SACpBL,EAAKK,IAAI,MAAOhB,EAAEL,GAASgC,SAASC,KACpCjB,EAAKK,IAAI,OAAQhB,EAAEL,GAASgC,SAASE,KAAO,IAC5C7B,EAAEL,GAAS8B,IAAI,YACfzB,EAAEL,GAASQ,GAAG,WAAY2B,GAC1B9B,EAAE,QAAQG,GAAG,aAAc2B,GAK7B,SAASA,EAAUP,GACjBA,EAAMC,kBACNb,EAAKK,IAAI,UAAW,QACpBhB,EAAE,QAAQyB,IAAI,cACdzB,EAAEL,GAAS8B,IAAI,YACfzB,EAAEL,GAASQ,GAAG,WAAYU,GAG5Bb,EAAE,QAAQ+B,QAAQpB,GAClBA,EAAKR,GAAG,cAAe,WACrBoB,MAAMC,wBAKZ,OAAOlC,EAMT,SAAS0C,uBAAuB7C,EAASC,GACvC,IAAIE,EAAY,CAChBC,SAAqB,IACrBC,MAAkB,CAChByC,KAAM,KAGRvC,KAAiB,SAAUF,EAAOG,EAASC,GACzCT,EAAQ,WAKN,IAAI+C,EAAQ,CAAC,UAAW,WAAY,cAAe,cAAe,wBAAyB,sBAAuB,kBAAmB,cAAe,eAAgB,UAAW,0BAA2B,aAAc,YAAa,kBAAmB,qBAAsB,YAAa,cAAe,kBAAmB,WAAY,SAAU,sBAAuB,oBAAqB,SAAU,sBAAuB,mBAAoB,gBAAiB,cAAe,sBAAuB,cAAe,UAAW,WAAY,YAAa,YAAa,UACviBvB,EAAOX,EAAE,iDAGb,IAAK,IAAIY,KAFTZ,EAAEL,GAASQ,GAAG,WAAYU,GAEZqB,GACZ,SAAWD,GACT,IAAIlB,EAAQf,EAAE,6CAA+CiC,EAAO,kFACpElB,EAAMC,IAAI,CACRC,MAAO,GACPC,OAAQ,GACRC,OAAQ,EACRC,MAAO,OACPC,QAASN,IAEXJ,EAAKW,OAAOP,GACZA,EAAMZ,GAAG,cAAe,SAAUoB,GAChCA,EAAMC,kBACNb,EAAKK,IAAI,UAAW,SACpBhB,EAAE,QAAQyB,IAAI,cACdd,EAAKK,IAAI,UAAW,QACpBhB,EAAEL,GAAS8B,IAAI,YACfzB,EAAEL,GAASQ,GAAG,WAAYU,GAC1BrB,EAAMY,OAAO,WACPZ,EAAMyC,KAAKP,WACblC,EAAMyC,KAAKP,WAAWO,KAAOA,EAE7BzC,EAAMyC,KAAKP,WAAa,CACtBO,KAAMA,GAIVjC,EAAEL,GAASwC,KAAK,KAAKjC,cAAcD,SAAS,cAAgBgC,OA1BlE,CA6BGC,EAAMtB,IAETpB,EAAMyC,KAAKP,WAAWO,KAAOC,EAAM,GAGrC,SAASrB,EAAUU,GACjBA,EAAMC,kBACNb,EAAKK,IAAI,MAAOhB,EAAEL,GAASgC,SAASC,KACpCjB,EAAKK,IAAI,OAAQhB,EAAEL,GAASgC,SAASE,KAAO,IAC5ClB,EAAKK,IAAI,UAAW,SACpBhB,EAAEL,GAAS8B,IAAI,YACfzB,EAAEL,GAASQ,GAAG,WAAY2B,GAC1B9B,EAAE,QAAQG,GAAG,aAAc2B,GAK7B,SAASA,EAAUP,GACjBA,EAAMC,kBACNb,EAAKK,IAAI,UAAW,QACpBhB,EAAE,QAAQyB,IAAI,cACdzB,EAAEL,GAAS8B,IAAI,YACfzB,EAAEL,GAASQ,GAAG,WAAYU,GAG5Bb,EAAE,QAAQ+B,QAAQpB,GAClBA,EAAKR,GAAG,cAAe,WACrBoB,MAAMC,wBAKZ,OAAOlC,EAMT,SAAS8C,uBAAuBjD,EAASC,GACvC,IAAIE,EAAY,CAChBC,SAAqB,IACrBC,MAAkB,CAChB6C,KAAM,KAGR3C,KAAiB,SAAUF,EAAOG,EAASC,GACzCT,EAAQ,WACNC,EAAUkD,WAAWC,MAAMC,KAAK,SAAiBC,GAC/C,IAAK,IAAI7B,KAAK6B,GACZ,SAAWC,GACT,IAAIC,EAAS3C,EAAE,qBACf2C,EAAOC,KAAKF,EAAIG,OAChBF,EAAO/C,KAAK,QAAS8C,EAAII,IACzBC,KAAKzB,OAAOqB,KACXK,KAAKhD,EAAEL,GAAU8C,EAAK7B,IAG3B,IAAIqC,EAASR,EAAK,GAAGK,GACrBtD,EAAM6C,KAAKX,WAAWwB,GAAKD,EAC3B,IAAIE,EAAU/D,EAAUkD,WAAWc,mBAAmBH,GACtD7D,EAAUiE,MAAMC,aAAaH,GAASX,KAAK,SAAiBC,GAC1DjD,EAAM6C,KAAKkB,SAASd,IACnB,SAASe,EAAMC,GAChBC,QAAQC,IAAIH,KAEdxD,EAAEL,GAASiE,WAAW,CACpB3C,MAAO,IACP4C,OAAQ,SAAgBtC,EAAOuC,GAC7B,IAAIb,EAASc,SAASD,EAAGE,KAAKC,OAC9BzE,EAAM6C,KAAKX,WAAWwB,GAAKD,EAC3B,IAAIE,EAAU/D,EAAUkD,WAAWc,mBAAmBH,GACtD7D,EAAUiE,MAAMC,aAAaH,GAASX,KAAK,SAAiBC,GAC1DjD,EAAM6C,KAAKkB,SAASd,IACnB,SAASe,EAAMC,GAChBC,QAAQC,IAAIH,SAIjB,SAAeC,UAItB,OAAOnE,EAOT,SAAS4E,wBAAwB/E,EAASC,GACxC,IAAIE,EAAY,CAChBC,SAAqB,IACrBC,MAAkB,CAChBI,KAAM,KAGRF,KAAiB,SAAUF,EAAOG,EAASC,GACzCT,EAAQ,WACNC,EAAUkD,WAAW6B,aAAa3B,KAAK,SAAiBC,GACtD,IAAK,IAAI7B,KAAK6B,GACZ,SAAW2B,EAAO1B,GAChB,GAAa,GAAT0B,EAAY,CACd,IAAIzB,EAAS3C,EAAE,qBACf2C,EAAOC,KAAKF,EAAIG,OAChBF,EAAO/C,KAAK,QAAS8C,EAAII,IACzBC,KAAKzB,OAAOqB,MAEbK,KAAKhD,EAAEL,GAAUiB,EAAG6B,EAAK7B,IAG9B,IAAIqC,EAASR,EAAK,GAAGK,GACrBtD,EAAMI,KAAK8B,WAAWwB,GAAKD,EAC3B7D,EAAUkD,WAAW+B,gBAAgBpB,GAAQT,KAAK,SAAiBC,GACjEjD,EAAMI,KAAK2D,SAASd,IACnB,SAASe,EAAMC,GAChBC,QAAQC,IAAIH,KAEdxD,EAAEL,GAASiE,WAAW,CACpB3C,MAAO,IACP4C,OAAQ,SAAgBtC,EAAOuC,GAC7B,IAAIb,EAASc,SAASD,EAAGE,KAAKC,OAC9B7E,EAAUkD,WAAW+B,gBAAgBpB,GAAQT,KAAK,SAAiBC,GACjEjD,EAAMI,KAAK2D,SAASd,IACnB,SAASe,EAAMC,GAChBC,QAAQC,IAAIH,SAIjB,SAAeC,UAItB,OAAOnE,EAOT,SAASgF,4BAA4BnF,EAASC,GAC5C,IACImF,EADAjF,EAAY,GAoFhB,OAlFAA,EAAUC,SAAW,IACrBD,EAAUE,MAAQ,CAChBgF,MAAO,KAGTlF,EAAUI,KAAO,SAAUF,EAAOG,EAASC,GACzCJ,EAAMiF,OAAO,QAAS,SAAUC,EAAGC,EAAGC,GAChCF,IACFA,EAAEG,IAAM,WACN,IAAIC,EAEJ,IAAK,IAAIlE,KAAK2D,EAAU,CAKtB,IAJW/E,EAAMgF,MAAMO,WAAWC,KAAK,SAAUrF,GAC/C,OAAO4E,EAAS3D,GAAGkC,IAAMnD,EAAQmD,KAGxB,CACTgC,EAAO,CACLhC,GAAIyB,EAAS3D,GAAGkC,IAElB,OAIJtD,EAAMgF,MAAMO,WAAWE,KAAKH,GAC5B,IAAII,EAAS1F,EAAMgF,MAAMO,WACzB5F,EAAQ,WACN+F,EAAOA,EAAOC,OAAS,GAAG5B,SAASgB,SAK3CpF,EAAQ,WACNC,EAAUkD,WAAWC,MAAMC,KAAK,SAAiBC,GAC/C,IAAK,IAAI7B,KAAK6B,GACZ,SAAWC,GACT,IAAIC,EAAS3C,EAAE,qBACf2C,EAAOC,KAAKF,EAAIG,OAChBF,EAAO/C,KAAK,QAAS8C,EAAII,IACzBC,KAAKzB,OAAOqB,KACXK,KAAKhD,EAAEL,GAAU8C,EAAK7B,IAG3B,IAAIqC,EAASR,EAAK,GAAGK,GACrBtD,EAAMgF,MAAM9C,WAAW0D,MAAQ,CAACnC,GAChC,IAAIE,EAAU/D,EAAUkD,WAAWc,mBAAmBH,GACtD7D,EAAUiE,MAAMC,aAAaH,GAASX,KAAK,SAAiBC,GAC1D8B,EAAW9B,EACXjD,EAAMgF,MAAMO,WAAa,CAAC,CACxBjC,GAAIL,EAAK,GAAGK,KAEd3D,EAAQ,WACNK,EAAMgF,MAAMO,WAAW,GAAGxB,SAASd,MAEpC,SAASe,EAAMC,GAChBC,QAAQC,IAAIH,KAEdxD,EAAEL,GAASiE,WAAW,CACpB3C,MAAO,IACP4C,OAAQ,SAAgBtC,EAAOuC,GAC7BtE,EAAMY,OAAO,WACX,IAAI6C,EAASc,SAASD,EAAGE,KAAKC,OAC9BzE,EAAMgF,MAAM9C,WAAW0D,MAAQ,CAACnC,GAChC,IAAIE,EAAU/D,EAAUkD,WAAWc,mBAAmBH,GACtD7D,EAAUiE,MAAMC,aAAaH,GAASX,KAAK,SAAiBC,GAC1D8B,EAAW9B,EACXjD,EAAMgF,MAAMO,WAAa,CAAC,CACxBjC,GAAIL,EAAK,GAAGK,KAEd3D,EAAQ,WACNK,EAAMgF,MAAMO,WAAW,GAAGxB,SAASd,MAEpC,SAASe,EAAMC,GAChBC,QAAQC,IAAIH,WAKnB,SAAeC,SAIfnE,EAOT,SAAS+F,6BAA6BlG,EAASC,GAC7C,IAAIE,EAAY,CAChBC,SAAqB,IACrBC,MAAkB,CAChBgF,MAAO,IACPc,OAAQ,MAoEV,OAjEAhG,EAAUI,KAAO,SAAUF,EAAOG,EAASC,GACzCJ,EAAMiF,OAAO,QAAS,SAAUC,EAAGC,EAAGC,GAChCF,IACFA,EAAEnB,SAAW,SAAUgC,IA0B3B,SAAgB9C,GAGd,IAAK,IAAI7B,KAFTZ,EAAEL,GAAS6F,WAAWC,SAERhD,GACZ,SAAWC,GACT,IAAIC,EAAS3C,EAAE,qBACf2C,EAAOC,KAAKF,EAAIG,OAChBF,EAAO/C,KAAK,QAAS8C,EAAII,IAErBtD,EAAMgF,MAAM1B,IAAMJ,EAAII,IACxBH,EAAO+C,KAAK,WAAY,YAG1B3C,KAAKzB,OAAOqB,KACXK,KAAKhD,EAAEL,GAAU8C,EAAK7B,IAGZZ,EAAEL,GAASiE,WAAW,YAGnC5D,EAAEL,GAASiE,WAAW,WAEtB5D,EAAEL,GAASiE,WAAW,CACpB3C,MAAO,IACP4C,OAAQ,SAAgBtC,EAAOuC,GAC7BtE,EAAMY,OAAO,WACXZ,EAAMgF,MAAM1B,GAAKiB,SAASD,EAAGE,KAAKC,YAtCtC0B,CAbaJ,EAAKK,OAAO,SAAUC,GACjC,IAAK,IAAIjF,KAAKgE,EAAEgB,OAAQ,CAKtB,KAJqBhG,EAEnBgB,EAFyBqD,EAEtBW,EAAEgB,OAAOhF,GADLiF,EAAIjG,IAASqE,GAIpB,OAAO,EALE,IAAUrE,EAAMqE,EAS7B,OAAO,SAMfzE,EAAMiF,OAAO,WAAY,SAAUC,EAAGC,EAAGC,GACnCF,IACFE,EAAEU,OAAO5D,WAAW6D,KAAOX,EAAEU,OAAOP,WAAWe,IAAI,SAAUnG,GAC3D,OAAOA,EAAQmD,SAyChBxD,EAMT,SAASyG,qBAAqB5G,EAASC,GACrC,IAAIE,EAAY,CAChBC,SAAqB,IACrBC,MAAkB,CAChB6C,KAAM,IACNuD,OAAQ,MAwDV,OArDAtG,EAAUI,KAAO,SAAUF,EAAOG,EAASC,GACzCJ,EAAMiF,OAAO,OAAQ,SAAUC,EAAGC,EAAGC,GAC/BF,IACFA,EAAEnB,SAAW,SAAUgC,IAmB3B,SAAgB9C,GAGd,IAAK,IAAI7B,KAFTZ,EAAEL,GAAS6F,WAAWC,SAERhD,GACZ,SAAWC,GACT,IAAIC,EAAS3C,EAAE,qBACf2C,EAAOC,KAAKF,EAAIG,OAChBF,EAAO/C,KAAK,QAAS8C,EAAII,IACzBC,KAAKzB,OAAOqB,KACXK,KAAKhD,EAAEL,GAAU8C,EAAK7B,IAGZZ,EAAEL,GAASiE,WAAW,YAGnC5D,EAAEL,GAASiE,WAAW,WAEtB5D,EAAEL,GAASiE,WAAW,CACpB3C,MAAO,IACP4C,OAAQ,SAAgBtC,EAAOuC,GAC7BtE,EAAM6C,KAAKX,WAAWmE,IAAM9B,SAASD,EAAGE,KAAKC,UAKnDzE,EAAM6C,KAAKX,WAAWmE,IAAMpD,EAAK,GAAGK,GA9BhC6C,CAbaJ,EAAKK,OAAO,SAAUC,GACjC,IAAK,IAAIjF,KAAKgE,EAAEgB,OAAQ,CAKtB,KAJqBhG,EAEnBgB,EAFyBqD,EAEtBW,EAAEgB,OAAOhF,GADLiF,EAAIjG,IAASqE,GAIpB,OAAO,EALE,IAAUrE,EAAMqE,EAS7B,OAAO,UAsCV3E,EAMT,SAAS0G,yBAAyB7G,EAASC,GACzC,IAAIE,EAAY,CAChBC,SAAqB,IACrBC,MAAkB,CAChBI,KAAM,IACNgG,OAAQ,MAwDV,OArDAtG,EAAUI,KAAO,SAAUF,EAAOG,EAASC,GACzCJ,EAAMiF,OAAO,OAAQ,SAAUC,EAAGC,EAAGC,GAC/BF,IACFA,EAAEnB,SAAW,SAAUgC,IAmB3B,SAAgB9C,GAGd,IAAK,IAAI7B,KAFTZ,EAAEL,GAAS6F,WAAWC,SAERhD,GACZ,SAAWC,GACT,IAAIC,EAAS3C,EAAE,qBACf2C,EAAOC,KAAKF,EAAIG,OAChBF,EAAO/C,KAAK,QAAS8C,EAAII,IACzBC,KAAKzB,OAAOqB,KACXK,KAAKhD,EAAEL,GAAU8C,EAAK7B,IAGZZ,EAAEL,GAASiE,WAAW,YAGnC5D,EAAEL,GAASiE,WAAW,WAEtB5D,EAAEL,GAASiE,WAAW,CACpB3C,MAAO,IACP4C,OAAQ,SAAgBtC,EAAOuC,GAC7BtE,EAAMI,KAAK8B,WAAWuE,OAASlC,SAASD,EAAGE,KAAKC,UAKtDzE,EAAMI,KAAK8B,WAAWuE,OAASxD,EAAK,GAAGK,GA9BnC6C,CAbaJ,EAAKK,OAAO,SAAUC,GACjC,IAAK,IAAIjF,KAAKgE,EAAEgB,OAAQ,CAKtB,KAJqBhG,EAEnBgB,EAFyBqD,EAEtBW,EAAEgB,OAAOhF,GADLiF,EAAIjG,IAASqE,GAIpB,OAAO,EALE,IAAUrE,EAAMqE,EAS7B,OAAO,UAsCV3E,EAMT,SAAS4G,wBAAwB/G,EAASC,GACxC,IAAIE,EAAY,CAChBC,SAAqB,IACrBC,MAAkB,CAChB2G,MAAO,MAkDT,OA/CA7G,EAAUI,KAAO,SAAUF,EAAOG,EAASC,GACzC,IAAIwG,EAAW,GACfjH,EAAQ,WACN,IAcc8E,EACVoC,EAfApC,EAAQ,GAEZ,IAAK,IAAIrD,KAAKpB,EAAM2G,MAAMG,KACpB1F,GAAKpB,EAAM2G,MAAMG,KAAKnB,OAAS,EACjClB,GAASzE,EAAM2G,MAAMG,KAAK1F,GAAG2F,IAE7BtC,GAASzE,EAAM2G,MAAMG,KAAK1F,GAAG2F,IAAM,IAQzBtC,EAJdmC,EAAWnC,GAKPoC,EAAWrG,EAAE,cACRG,GAAG,OAAQ,SAAUoB,GAC5B/B,EAAMY,OAEN,WACE,IAAIoG,EAAMxG,EAAEuB,EAAM+D,QAAQmB,MAAMC,MAAM,KAK3B,IAJDF,EAAIG,OAAO,SAAUC,EAAMC,GACnC,OAAO9C,SAAS6C,GAAQ7C,SAAS8C,MAIjC7G,EAAEuB,EAAM+D,QAAQmB,IAAIL,GACpBU,MAAM,iBAENV,EAAWpG,EAAEuB,EAAM+D,QAAQmB,MAC3BjH,EAAM2G,MAAMG,KAAOE,EAAIV,IAAI,SAAUiB,GACnC,MAAO,CACLR,IAAKQ,UAMfV,EAASI,IAAIxC,GACbjE,EAAEL,GAAS6F,WAAWC,SACtBzF,EAAEL,GAAS2B,OAAO+E,MAIf/G,EAMT,SAAS0H,oBAAoB7H,EAASC,GACpC,IAAIE,EAAY,CAChBC,SAAqB,IACrBC,MAAkB,CAChB2G,MAAO,MAiET,OA9DA7G,EAAUI,KAAO,SAAUF,EAAOG,EAASC,GACzCT,EAAQ,YAIR,SAASwG,IACP,IAAIsB,EAAUjH,EAAE,oCAEhB,IAAK,IAAIY,KAAKpB,EAAM2G,MAAMG,MACxB,SAAWlC,EAAOmC,GAChB,IAAIW,EAASlH,EAAE,4BAA8BuG,EAAIA,IAAM,iIACnDY,EAAcnH,EAAE,4BACpBmH,EAAYV,IAAIF,EAAIA,KACpBY,EAAYnG,IAAI,SAAU,WAC1BkG,EAAO5F,OAAO6F,GAEd,IAAK,IAAIvG,EAAI,EAAGA,EAAI2F,EAAIA,IAAK3F,IAAK,CAChC,IAAIwG,EAAUpH,EAAE,qCAAuC,IAAMuG,EAAIA,IAAM,uCACvEW,EAAO/E,KAAK,UAAUb,OAAO8F,GAG/BF,EAAO/E,KAAK,UAAUb,OAAOtB,EAAE,kEAC/BiH,EAAQ3F,OAAO4F,GACfC,EAAYhH,GAAG,SAAU,SAAUoB,GACjC/B,EAAMY,OAAO,WACX,IAAI6D,EAAQF,SAAS/D,EAAEuB,EAAM+D,QAAQmB,OAEjCxC,EAAQ,EACVA,EAAQ,EACCA,EAAQ,GAAKzE,EAAM2G,MAAMG,KAAKnB,OAAS,IAChDlB,EAAQ,GAAKzE,EAAM2G,MAAMG,KAAKnB,OAAS,GAGzC,IAAIkC,EAAM,EACNC,EAAQ,EAEZ,IAAK,IAAI1G,KAAKpB,EAAM2G,MAAMG,KACpB9G,EAAM2G,MAAMG,KAAK1F,IAAM2F,GACzBc,GAAO7H,EAAM2G,MAAMG,KAAK1F,GAAG2F,IAC3Be,GAAS9H,EAAM2G,MAAMG,KAAK1F,GAAG2F,KAE7Bc,GAAOpD,EAKTsC,EAAIA,IADFc,GAAO,GACCpD,EAEA,GAAKqD,EAGjB3B,QA1CN,CA6CG/E,EAAGpB,EAAM2G,MAAMG,KAAK1F,IAGzBZ,EAAEL,GAAS6F,WAAWC,SACtBzF,EAAEL,GAAS2B,OAAO2F,GAxDlBtB,MA4DGrG,EAMT,SAASiI,oBAAoBpI,EAASC,GACpC,IAAIE,EAAY,CAChBC,SAAqB,IACrBC,MAAkB,CAChBC,UAAW,KAGbC,KAAiB,SAAUF,EAAOG,EAASC,GACzCI,EAAEL,GAAS6H,UAAU,CACnBC,MAAO,SAAelG,EAAOuC,GAC3B7E,UAAW,GAEbyI,KAAM,SAAcnG,EAAOuC,GACzB7E,UAAW,GAEb0I,OAAQ3H,EAAEL,GAASwC,KAAK,YACxByF,OAAQ,OACRC,SAAU,OACVC,QAAQ,EACRC,OAAQ,SAAgBjE,GACtB,GAAiB,WAAblE,EAAKoI,KAAmB,CAC1B,IAAIlF,EAAK9C,EAAE8D,EAAGmE,eAAerI,KAAK,MAC9BsI,EAASC,KAAKC,MAAMD,KAAKE,UAAUjJ,EAAUkJ,QAAQ1C,OAAO,SAAUsC,GACxE,OAAOA,EAAOpF,IAAMA,IACnB,KACCyF,EAASvI,EAAE,kCAEf,IAAK,IAAIY,KAAKsH,EAAO5B,KAAM,CACzB,IAAIC,EAAM2B,EAAO5B,KAAK1F,GAClB4H,EAASxI,EAAE,4BAA8BuG,EAAIA,IAAM,YACvDgC,EAAOjH,OAAOkH,SAEX,GAAiB,eAAb5I,EAAKoI,KACVO,EAASvI,EAAE,kCAAkCgB,IAAI,CACnDE,OAAQ,eAEL,GAAiB,cAAbtB,EAAKoI,KACVO,EAASvI,EAAE,kCAAkCgB,IAAI,CACnDC,MAAO,QACPC,OAAQ,eAEL,GAAiB,YAAbtB,EAAKoI,KACVO,EAASvI,EAAE,kCAAkCgB,IAAI,CACnDC,MAAO,QACPC,OAAQ,eAEL,GAAiB,WAAbtB,EAAKoI,KACVO,EAASvI,EAAE,kCAAkCgB,IAAI,CACnDC,MAAO,QACPC,OAAQ,eAEL,GAAiB,WAAbtB,EAAKoI,KACVO,EAASvI,EAAE,kCAAkCgB,IAAI,CACnDC,MAAO,QACPC,OAAQ,eAEL,GAAiB,aAAbtB,EAAKoI,KACVO,EAASvI,EAAE,kCAAkCgB,IAAI,CACnDC,MAAO,QACPC,OAAQ,eAEL,GAAiB,YAAbtB,EAAKoI,KACVO,EAASvI,EAAE,kCAAkCgB,IAAI,CACnDC,MAAO,QACPC,OAAQ,eAEL,GAAiB,UAAbtB,EAAKoI,KACVO,EAASvI,EAAE,kCAAkCgB,IAAI,CACnDC,MAAO,QACPC,OAAQ,eAEL,GAAiB,WAAbtB,EAAKoI,KACVO,EAASvI,EAAE,kCAAkCgB,IAAI,CACnDC,MAAO,QACPC,OAAQ,eAEL,GAAiB,WAAbtB,EAAKoI,KACVO,EAASvI,EAAE,kCAAkCgB,IAAI,CACnDC,MAAO,QACPC,OAAQ,eAEL,GAAiB,OAAbtB,EAAKoI,KACVO,EAASvI,EAAE,kCAAkCgB,IAAI,CACnDC,MAAO,QACPC,OAAQ,eAEL,GAAiB,aAAbtB,EAAKoI,KACVO,EAASvI,EAAE,kCAAkCgB,IAAI,CACnDC,MAAO,QACPC,OAAQ,eAEL,GAAiB,eAAbtB,EAAKoI,KACVO,EAASvI,EAAE,kCAAkCgB,IAAI,CACnDC,MAAO,QACPC,OAAQ,UAIZ,OAAOqH,GAETE,eAAgB,EAChBC,OAAQ,QACRC,kBAAmB,gBAIvB,OAAOrJ,EAMT,SAASsJ,oBAAoBC,EAAG1J,QAASC,UAAW0J,eAAgBC,kBAAmBC,gBAAiBC,MAAOC,UAAWC,SAAUC,SAAUC,OAAQC,KAAMC,kBAAmBC,mBAC7K,IAAIC,UAAY,IAAIC,OAAOtK,UAAUkJ,SACjChJ,UAAY,GA0EhB,SAASqK,WAAWC,QAClB,IAAIC,IAAM9G,KACN+G,UACArK,UAAYmK,OAAOnK,UACvBA,UAAUU,GAAG,aAAc,WACzBhB,QAAQ,WACN0K,IAAIE,UACH,OAEL/J,EAAEqJ,QAAQlJ,GAAG,SAAU,WACrBhB,QAAQ,WACN0K,IAAIE,UACH,OAGLF,IAAIG,OAAS,WACX,OAAOF,UAAUE,UAGnBH,IAAIE,OAAS,WACXD,UAAUG,KAAK,SAAUtK,GACvB,GAAoB,cAAhBA,EAAQuK,MAAwC,aAAhBvK,EAAQuK,MAAuC,YAAhBvK,EAAQuK,KACzE,IAAK,IAAItJ,KAAKjB,EAAQX,QACpBW,EAAQX,QAAQ4B,GAAGuJ,OAAO,SAAU,aAM5C,IAAIC,WAAa,CACfC,SAAU,CACRzI,IAAK,EACLC,KAAM,KAER4F,MAAO,SAAelG,EAAOuC,GAC3B9D,EAAEuB,EAAM+D,QAAQtE,IAAI,UAAW,QAC/B/B,UAAW,GAEbyI,KAAM,SAAcnG,EAAOuC,GACzB9D,EAAEuB,EAAM+D,QAAQtE,IAAI,UAAW,SAC/B/B,UAAW,GAEb4I,SAAU,OACVY,eAAgB,EAChBb,OAAQ,OACRE,QAAQ,EACRY,OAAQ,KACR4B,QAAS,GACTvC,OAAQ,SAAgBjE,GACtB,IAAIyG,EAAQvK,EAAE8D,EAAGmE,eAAesC,QAC5BpI,EAAOoI,EAAMpI,KAAK,aAClBxB,EAAOX,EAAE,qCA6Bb,OA3BkB,EAAdmC,EAAKqI,OACPrI,EAAKqD,SAAS,iBAAiBA,WAAWyE,KAAK,SAAU7F,EAAOzE,GAC9D,IAAI8K,EAAKzK,EAAEL,GAAS4K,QACpBE,EAAGjF,WAAWC,SAE2B,GAArCgF,EAAG7E,OAAO,iBAAiB4E,QAC7BC,EAAGxK,SAAS,oBAGdU,EAAKW,OAAOmJ,KAGdF,EAAM/E,SAAS,iBAAiBA,WAAWyE,KAAK,SAAU7F,EAAOzE,GAC/D,IAAI8K,EAAKzK,EAAEL,GAAS4K,QACpBE,EAAGjF,WAAWC,SAE2B,GAArCgF,EAAG7E,OAAO,iBAAiB4E,QAC7BC,EAAGxK,SAAS,oBAGdU,EAAKW,OAAOmJ,KAIhB9J,EAAKK,IAAI,CACP0J,iBAAkB,SAEb/J,IAGPgK,WAAa,CACfC,UAAW,SAAmBrJ,EAAOuC,GAC/B7E,UACWe,EAAEuB,EAAM+D,QACdrF,SAAS,cAGpB4K,SAAU,SAAkBtJ,EAAOuC,GAC7B7E,UACWe,EAAEuB,EAAM+D,QACdpF,YAAY,eAIrB4K,WAAa,CACfC,UAAW,UACXC,KAAM,SAAczJ,EAAOuC,GACzB,IAAImH,EAASC,EACTC,EAAW,GACX3D,EAAYxH,EAAE8D,EAAG0D,WACjB4D,EAAS5D,EAAU5H,KAAK,MACxB0F,EAAStF,EAAEuB,EAAM+D,QAErB,GAAwC,EAApCkC,EAAU5B,OAAO,UAAU4E,OAAY,CACzC,IAAIN,EAAO1C,EAAU5H,KAAK,QAC1BqL,EAAUjL,EAAE,YAAcqL,cAAc,IAAM,iCAC9CF,EAAWhD,KAAKC,MAAMD,KAAKE,UAAUjJ,UAAU8K,GAAMtE,OAAO,SAAUuF,GACpE,OAAOA,EAASrI,IAAMsI,IACrB,MACM9F,OAAS2F,OAElBnB,UAAUwB,QAAQ,SAAU3L,GAC1B,IAAI4L,EAAQvL,EAAEL,EAAQ2F,QAAQ1F,KAAK,MAE/BwL,GAAUG,IACZzB,UAAUrE,OAAO9F,GACjBwL,EAAWxL,KAGfsL,EAAUE,EAAS7F,OAGrB,GAAIA,EAAOkG,SAAS,iBAAkB,CACpC,IACWC,EAkBX,GAdEA,EAFEnG,EAAOoG,SAASF,SAAS,aAC3BG,EAAQrG,EAAOoG,SAASA,SAASA,SAASA,SAAS9L,KAAK,MAChD0F,EAAOoG,SAASA,SAASA,SAAS9L,KAAK,QAE/C+L,EAAQrG,EAAOoG,SAASA,SAAS9L,KAAK,MAC9B0F,EAAOoG,SAAS9L,KAAK,OAG/BkK,UAAU8B,QAAQ,SAAUjM,GAC1B,IAAI4L,EAAQvL,EAAEL,EAAQ2F,QAAQ1F,KAAK,MAE/B+L,GAASJ,IACX1G,EAAMlF,KAINkF,EAAIgH,KAAM,CACZ,IAAIC,EAAO,GAEX,IAAK,IAAIlL,KAAKiE,EAAIgH,KACZJ,GAAS5G,EAAIgH,KAAKjL,GAAG0E,OAAO1F,KAAK,OACnCkM,EAAK7G,KAAKkG,GAGZW,EAAK7G,KAAKJ,EAAIgH,KAAKjL,IAGrBiE,EAAIgH,KAAOC,EAGb,GAAa,YAATH,EAAqB,CACvB,IAAII,EAAM/L,EAAE,8BACRgM,EAAYhM,EAAE,mJAGlBkL,EAAWlL,EAAE,gCACbiL,EAAQzF,WAAWC,SACnBwF,EAAQ3J,OAAOyK,GACfA,EAAIzK,OAAO0K,GACXD,EAAIzK,OAAO4J,OACN,CAGa,GAFd/I,EAAO8I,EAAQ9I,KAAK,cAEfqI,QAEPS,EAAQ9I,KAAK,QAAQsD,SAGvBwF,EAAQzF,WAAWC,SACnByF,EAAWD,EAGT3F,EAAOoG,SAASF,SAAS,YAC3BlG,EAAOoG,SAASA,SAASA,SAASO,OAAOhB,GAEzC3F,EAAOoG,SAASO,OAAOhB,QAEpB,GAAI3F,EAAOkG,SAAS,gBAAiB,CAC1C,IAAI3G,EAAK8G,EAsBT,GAnBEA,EADErG,EAAOoG,SAASF,SAAS,YACnBlG,EAAOoG,SAASA,SAASA,SAAS9L,KAAK,MAEvC0F,EAAOoG,SAAS9L,KAAK,MAG/BkK,UAAU8B,QAAQ,SAAUjM,GAC1B,IAAI4L,EAAQvL,EAAEL,EAAQ2F,QAAQ1F,KAAK,MAE/B+L,GAASJ,IACX1G,EAAMlF,KAINkF,EAAIgH,KACNhH,EAAIgH,KAAK5G,KAAKkG,GAEdtG,EAAIgH,KAAO,CAACV,GAGD,YAATQ,EAAqB,CACnBI,EAAM/L,EAAE,qBACRgM,EAAYhM,EAAE,mJASlB,GANAkL,EAAWlL,EAAE,gCACbiL,EAAQ3J,OAAOyK,GACfA,EAAIzK,OAAO0K,GACXD,EAAIzK,OAAO4J,GAGO,GAFd/I,EAAO8I,EAAQ9I,KAAK,cAEfqI,OAAY,CACnB,IAAIhF,EAAWrD,EAAKqD,WACpByF,EAAQ9I,KAAK,QAAQsD,SACrBwF,EAAQ3J,OAAOkE,GACfyF,EAAQzF,WAAWC,SACnBwF,EAAQ3J,OAAOyK,QAEfb,EAAS5J,OAAO2J,EAAQzF,gBAErB,CACL,IAAIrD,EAEc,GAFdA,EAAO8I,EAAQ9I,KAAK,cAEfqI,QAEPS,EAAQ9I,KAAK,QAAQsD,SAGvBwF,EAAQzF,WAAWC,SACnByF,EAAWD,EAGT3F,EAAOoG,SAASF,SAAS,YAC3BlG,EAAOoG,SAASA,SAASO,OAAOhB,GAEhC3F,EAAO2G,OAAOhB,GAIlB3F,EAAOpF,YAAY,aACnBgM,SAAShB,EAAUC,GACnBhM,QAAQ,WACN0K,IAAIE,UACH,KAE+C,GAA9C/J,EAAE,aAAawF,SAAS,YAAYgF,QACtCxK,EAAE,aAAawF,SAAS,iBAAiBxE,IAAI,SAAU,WAM7D,SAASmL,KAAKvC,GACZE,UAAY,IAAIsC,MAAMjE,KAAKC,MAAMD,KAAKE,UAAUuB,EAAOnH,QACvD,IAAI4J,EAAcrM,EAAE,oCAGpB,IAAK,IAAIY,KAFTkJ,UAAUwC,UAAUhH,OAASsE,EAAO2C,KAEtBzC,UAAUwC,UAAUT,KAAM,CACtC,IAAIW,EAAM1C,UAAUwC,UAAUT,KAAKjL,GAC/BqK,EAAUjL,EAAE,YAAcqL,cAAc,IAAM,gCAC9CU,EAAM/L,EAAE,2BACRgM,EAAYhM,EAAE,mIAGdyM,EAAUzM,EAAE,iCAChBwM,EAAIlH,OAAS2F,GACL3J,OAAOyK,GACfA,EAAIzK,OAAO0K,GACXD,EAAIzK,OAAOmL,GACX3C,UAAUwC,UAAUhH,OAAOhE,OAAO2J,GAClCiB,SAASO,EAASD,GAGpB1C,UAAUwC,UAAUhH,OAAOhE,OAAO+K,GAClCA,EAAYK,UAAU5B,YACtBuB,EAAYlM,GAAGwK,YAKjB,SAASuB,SAAS5G,EAAQkH,GACxB,IAAIG,EAAa3M,EAAE,uEACf4M,EAAU5M,EAAE,+BACZ6M,EAAU7M,EAAE,uEACZ8M,EAAY9M,EAAE,2EACd+M,EAAe/M,EAAE,qCACjBgN,EAAehN,EAAE,wCACjBiN,EAAYjN,EAAE,iCAElB,GAAIsF,EAAOkG,SAAS,YAAa,CAC/B,IAAI0B,EAAWlN,EAAE,6EAuBjB,GAtBA4M,EAAQtL,OAAOqL,GAAYrL,OAAOwL,GAAWxL,OAAOuL,GAASvL,OAAO4L,GAEpD,GAAZV,EAAIW,MACNX,EAAIW,MAAO,EACXD,EAAS/K,KAAK,SAASuD,KAAK,UAAW,WACvCJ,EAAOoG,SAASA,SAASxL,YAAY,cAErCsM,EAAIW,MAAO,EACXD,EAAS/K,KAAK,SAASiL,WAAW,WAClC9H,EAAOoG,SAASA,SAASzL,SAAS,aAGpCiN,EAAS/K,KAAK,SAAShC,GAAG,QAAS,SAAUoB,GACvCvB,EAAE+C,MAAM2C,KAAK,YACf8G,EAAIW,MAAO,EACX7H,EAAOoG,SAASA,SAASxL,YAAY,cAErCsM,EAAIW,MAAO,EACX7H,EAAOoG,SAASA,SAASzL,SAAS,eAIlCuM,EAAIa,MACNV,EAAWxK,KAAK,WAAWsE,IAAI+F,EAAIa,OACpB/H,EAAOoG,SAASvJ,KAAK,aAC3BS,KAAK4J,EAAIa,OAGpBV,EAAWxK,KAAK,WAAWhC,GAAG,SAAU,SAAUoB,GAChD,IAAIqI,EAAS5J,EAAEuB,EAAM+D,QACNA,EAAOoG,SAASvJ,KAAK,aAC3BS,KAAKgH,EAAOnD,OACrB+F,EAAIa,MAAQzD,EAAOnD,oBAGd+F,EAAIW,KACXP,EAAQtL,OAAOwL,GAAWxL,OAAOuL,GAMnC,GAFAvH,EAAOhE,OAAOyL,GAAczL,OAAOsL,GAAStL,OAAO0L,GAEnC,UAAZR,EAAItC,KAAkB,CACxB,IAAI5D,EAAOkG,EAAIlG,KAEf,IAAK,IAAI1F,KAAK0F,EAAM,CAClB,IAAIgH,EAAStN,EAAE,gBAAkBqL,cAAc,IAAM,0BAA4B/E,EAAK1F,GAAG2F,IAAM,YAC3F8F,EAAcrM,EAAE,oCAChBuG,EAAMD,EAAK1F,GAGf,IAAK,IAAI2M,KAFThH,EAAIjB,OAASgI,EAEC/G,EAAIsF,KAAM,CACtB,IAAIZ,EAAUjL,EAAE,YAAcqL,cAAc,IAAM,gCAClDiC,EAAOhM,OAAO2J,GACd,IAAIuC,EAAQjH,EAAIsF,KAAK0B,GAErBrB,SADAsB,EAAMlI,OAAS2F,EACGuC,GAGpBF,EAAOhM,OAAO+K,GACdW,EAAa1L,OAAOgM,GACpBjB,EAAYK,UAAU5B,YACtBuB,EAAYlM,GAAGwK,kBAEZ,GAAgB,cAAZ6B,EAAItC,KAAsB,CACnC8C,EAAa1L,OAAO2L,GACXQ,WAAWR,EAAWT,QAC1B,GAAgB,cAAZA,EAAItC,KAAsB,CACnC8C,EAAa1L,OAAO2L,GACXS,WAAWT,EAAWT,QAC1B,GAAgB,YAAZA,EAAItC,KAAoB,CACjC8C,EAAa1L,OAAO2L,GACXU,SAASV,EAAWT,QACxB,GAAgB,WAAZA,EAAItC,KAAmB,CAChC8C,EAAa1L,OAAO2L,GACXW,QAAQX,EAAWT,QACvB,GAAgB,WAAZA,EAAItC,KAAmB,CAChC8C,EAAa1L,OAAO2L,GACXY,QAAQZ,EAAWT,QACvB,GAAgB,UAAZA,EAAItC,KAAkB,CAC/B8C,EAAa1L,OAAO2L,GACXa,OAAOb,EAAWT,QACtB,GAAgB,aAAZA,EAAItC,KAAqB,CAClC8C,EAAa1L,OAAO2L,GACpBT,EAAIuB,QAAU7E,UAAU8E,YACxBxB,EAAIuB,QAAQE,SAAS,GAAG7I,MAAQoH,EAAI9K,WAAW0D,MAC/CoH,EAAIuB,QAAQE,SAAS,GAAG1I,KAAOiH,EAAI9K,WAAW6D,KACrCkI,WAAWR,EAAWT,QAC1B,GAAgB,YAAZA,EAAItC,KAAoB,CACjC8C,EAAa1L,OAAO2L,GACpBT,EAAIuB,QAAU5E,SAAS6E,YACvBxB,EAAIuB,QAAQE,SAAS,GAAG7I,MAAQoH,EAAI9K,WAAW0D,MAC/CoH,EAAIuB,QAAQE,SAAS,GAAG1I,KAAOiH,EAAI9K,WAAW6D,KACrCkI,WAAWR,EAAWT,QAC1B,GAAgB,WAAZA,EAAItC,KAAmB,CAChC8C,EAAa1L,OAAO2L,GACXiB,QAAQjB,EAAWT,QACvB,GAAgB,WAAZA,EAAItC,KAAmB,CAChC8C,EAAa1L,OAAO2L,GACXkB,QAAQlB,EAAWT,QACvB,GAAgB,OAAZA,EAAItC,KAAe,CAC5B8C,EAAa1L,OAAO2L,GACXnH,IAAImH,EAAWT,QACnB,GAAgB,aAAZA,EAAItC,KAAqB,CAClC8C,EAAa1L,OAAO2L,GACXmB,UAAUnB,EAAWT,QACzB,GAAgB,eAAZA,EAAItC,KAAuB,CACpC8C,EAAa1L,OAAO2L,GACpBT,EAAIuB,QAAU5E,SAAS6E,YACdP,WAAWR,EAAWT,GAG7BlH,EAAOkG,SAAS,aAClBlG,EAAOoG,SAASA,SAASlE,UAAU4C,YACnC9E,EAAOoG,SAASA,SAASlE,UAAU,SAAU,SAAUqF,GACvDvH,EAAOoG,SAASA,SAASlE,UAAU,SAAU,SAAUqF,KAEvDvH,EAAOkC,UAAU4C,YACjB9E,EAAOkC,UAAU,SAAU,SAAUqF,GACrCvH,EAAOkC,UAAU,SAAU,SAAUqF,IAGvCE,EAAaL,UAAU5B,YACvBiC,EAAa5M,GAAGwK,YAEZrF,EAAOkG,SAAS,YAOflG,EAAOoG,SAASA,SALVvL,GAAG,YAAa,SAAUoB,GAC/BA,EAAMC,kBACNxB,EAAEqO,UAAUlM,KAAK,mBAAmBjC,YAAY,kBAChDF,EAAEuB,EAAM0G,eAAehI,SAAS,oBAUjCqF,EALMnF,GAAG,YAAa,SAAUoB,GAC/BA,EAAMC,kBACNxB,EAAEqO,UAAUlM,KAAK,mBAAmBjC,YAAY,kBAChDF,EAAEuB,EAAM0G,eAAehI,SAAS,oBAKtC6M,EAAU3M,GAAG,QAAS,SAAUoB,GAC9B,IAAI+M,EAGJ,GAFA/M,EAAMC,kBAEFxB,EAAEuB,EAAM+D,QAAQoG,SAASA,SAASA,SAASF,SAAS,YAAa,CACnE,IAAI1I,EAAK9C,EAAEuB,EAAM0G,eAAeyD,SAASA,SAASA,SAASA,SAAS9L,KAAK,MACzE8D,QAAQC,IAAI,MAAOb,GACnBgH,UAAUG,KAAK,SAAUtK,GACnBA,EAAQ2F,OAAO1F,KAAK,OAASkD,IAC/BwL,EAAU3O,KAGdmK,UAAUrE,OAAO6I,GACjBhJ,EAAOoG,SAASA,SAASjG,aACpB,CAED3C,EAAK9C,EAAEuB,EAAM0G,eAAeyD,SAASA,SAAS9L,KAAK,MACvD8D,QAAQC,IAAI,MAAOb,GACnBgH,UAAUG,KAAK,SAAUtK,GACnBA,EAAQ2F,OAAO1F,KAAK,OAASkD,IAC/BwL,EAAU3O,KAGdmK,UAAUrE,OAAO6I,GACjBhJ,EAAOG,SAGyC,GAA9CzF,EAAE,aAAawF,SAAS,YAAYgF,QACtCxK,EAAE,aAAawF,SAAS,iBAAiBxE,IAAI,SAAU,WAO7D,SAASoL,MAAMmC,GACb,IAAI1E,EAAM9G,KACNN,EAAO8L,EAEX1E,EAAIyC,QAAU,WACZ,OAAO7J,GAGToH,EAAIG,OAAS,WACX,IAAIO,EAAQ,CACVsB,KAAM,IAGR,IAAK,IAAIjL,KAAK6B,EAAKoJ,KAAM,CACvB,IAAIW,EAAM/J,EAAKoJ,KAAKjL,GAChB4N,EAAW,GACfA,EAAStE,KAAOsC,EAAItC,KACpBsE,EAASrB,KAAOX,EAAIW,KACpBqB,EAASnB,MAAQb,EAAIa,MAEL,cAAZb,EAAItC,KACNsE,EAAST,QAAUvB,EAAIuB,QACF,cAAZvB,EAAItC,KACbsE,EAAS9M,WAAa8K,EAAI9K,WACL,YAAZ8K,EAAItC,KACbsE,EAAS9M,WAAa8K,EAAI9K,WACL,WAAZ8K,EAAItC,KACbsE,EAAS9M,WAAa8K,EAAI9K,WACL,WAAZ8K,EAAItC,KACbsE,EAAS9M,WAAa8K,EAAI9K,WACL,aAAZ8K,EAAItC,MACbsE,EAAS9M,WAAa8K,EAAI9K,WAC1B8M,EAAST,QAAUvB,EAAIuB,SACF,YAAZvB,EAAItC,MACbsE,EAAS9M,WAAa8K,EAAI9K,WAC1B8M,EAAST,QAAUvB,EAAIuB,SACF,UAAZvB,EAAItC,KACbsE,EAAS9M,WAAa8K,EAAI9K,WACL,WAAZ8K,EAAItC,KACbsE,EAAS9M,WAAa8K,EAAI9K,WACL,WAAZ8K,EAAItC,KACbsE,EAAS9M,WAAa8K,EAAI9K,WACL,OAAZ8K,EAAItC,KACbsE,EAAS9M,WAAa8K,EAAI9K,WACL,aAAZ8K,EAAItC,KACbsE,EAAS9M,WAAa8K,EAAI9K,WACL,eAAZ8K,EAAItC,OACbsE,EAAS9M,WAAa8K,EAAI9K,YAG5B6I,EAAMsB,KAAK5G,KAAKuJ,GAChBtC,EAASM,EAAKgC,GAGhB,SAAStC,EAASxJ,EAAK8L,GACrB,GAAgBC,MAAZ/L,EAAI4D,KACN,IAAK,IAAI1F,KAAK8B,EAAI4D,MAChB,SAAWC,GACT,IAWaiG,EACLkC,EAZJC,EAAW,CACbpI,IAAKA,EAAIA,KASX,IAAK,IAAIgH,KANLiB,EAASlI,KACXkI,EAASlI,KAAKrB,KAAK0J,GAEnBH,EAASlI,KAAO,CAACqI,GAGLpI,EAAIsF,KACLW,EA0CRjG,EAAIsF,KAAK0B,GAzCNmB,OAAAA,GAAAA,EAAO,IACNxE,KAAOsC,EAAItC,KAChByE,EAASzE,KAAOsC,EAAItC,KAEJ,cAAZsC,EAAItC,KACNwE,EAAKX,QAAUvB,EAAIuB,QACE,cAAZvB,EAAItC,KACbwE,EAAKhN,WAAa8K,EAAI9K,WACD,YAAZ8K,EAAItC,KACbwE,EAAKhN,WAAa8K,EAAI9K,WACD,WAAZ8K,EAAItC,KACbwE,EAAKhN,WAAa8K,EAAI9K,WACD,WAAZ8K,EAAItC,KACbwE,EAAKhN,WAAa8K,EAAI9K,WACD,aAAZ8K,EAAItC,MACbwE,EAAKhN,WAAa8K,EAAI9K,WACtBgN,EAAKX,QAAUvB,EAAIuB,SACE,YAAZvB,EAAItC,MACbwE,EAAKhN,WAAa8K,EAAI9K,WACtBgN,EAAKX,QAAUvB,EAAIuB,SACE,UAAZvB,EAAItC,KACbwE,EAAKhN,WAAa8K,EAAI9K,WACD,WAAZ8K,EAAItC,KACbwE,EAAKhN,WAAa8K,EAAI9K,WACD,WAAZ8K,EAAItC,KACbwE,EAAKhN,WAAa8K,EAAI9K,WACD,OAAZ8K,EAAItC,KACbwE,EAAKhN,WAAa8K,EAAI9K,WACD,aAAZ8K,EAAItC,KACbwE,EAAKhN,WAAa8K,EAAI9K,WACD,eAAZ8K,EAAItC,OACbwE,EAAKhN,WAAa8K,EAAI9K,YAGpBiN,EAAS9C,KACX8C,EAAS9C,KAAK5G,KAAKyJ,GAEnBC,EAAS9C,KAAO,CAAC6C,GAGnBxC,EAASM,EAAKkC,GArDpB,CAwDGhM,EAAI4D,KAAK1F,IAKlB,OAAO2J,GAGTV,EAAII,KAAO,SAAU5J,GACnB,IAAK,IAAIO,KAAK6B,EAAKoJ,KAAM,CACvB,IAAIW,EAAM/J,EAAKoJ,KAAKjL,GACpBsL,EAASM,GACTnM,EAASmM,GAGX,SAASN,EAASM,GAChB,IAAK,IAAI5L,KAAK4L,EAAIlG,KAAM,CACtB,IAAIC,EAAMiG,EAAIlG,KAAK1F,GAGnB,IAAK,IAAI2M,KAFTlN,EAASkG,GAEKA,EAAIsF,KAChBK,EAAS3F,EAAIsF,KAAK0B,IAClBlN,EAASkG,EAAIsF,KAAK0B,OAM1B1D,EAAIpE,OAAS,SAAU6I,GACrB,IAAIxC,EAAO,GAEX,IAAK,IAAIlL,KAAK6B,EAAKoJ,KAAM,CACvB,IAAIW,EAAM/J,EAAKoJ,KAAKjL,GAEhB0N,GAAW9B,IACbV,EAAK7G,KAAKuH,GACVN,EAASM,IAYb,SAASN,EAASM,GAChB,IAAK,IAAI5L,KAAK4L,EAAIlG,KAAM,CACtB,IAAIC,EAAMiG,EAAIlG,KAAK1F,GACfkL,EAAO,GAEX,IAAK,IAAIyB,KAAKhH,EAAIsF,KACZ7L,EAAEsO,EAAQhJ,QAAQ1F,KAAK,OAASI,EAAEuG,EAAIsF,KAAK0B,GAAGjI,QAAQ1F,KAAK,QAC7DkM,EAAK7G,KAAKsB,EAAIsF,KAAK0B,IACnBrB,EAAS3F,EAAIsF,KAAK0B,KAIJ,EAAdzB,EAAK3G,OACPoB,EAAIsF,KAAOC,SAEJvF,EAAIsF,MArBC,GAFlBpJ,EAAKoJ,KAAOC,GAEH3G,OACP1C,EAAKoJ,KAAOC,SAELrJ,EAAKoJ,MAwBhBhC,EAAIyB,QAAU,SAAUjL,GACtB,IAAK,IAAIO,KAAK6B,EAAKoJ,MACNW,EAKR/J,EAAKoJ,KAAKjL,MAHTsL,EAASM,GACTnM,EAASmM,IAHb,IAAWA,EAQb,SAASN,EAASM,GAChB,IAAK,IAAI5L,KAAK4L,EAAIlG,MAChB,SAAWC,GACT,IAAK,IAAIgH,KAAKhH,EAAIsF,MACLW,EAKRjG,EAAIsF,KAAK0B,MAHRrB,EAASM,GACTnM,EAASmM,IAHb,IAAWA,EAFf,CASGA,EAAIlG,KAAK1F,MAKlBiJ,EAAI+B,QAAU,SAAUvL,GAGtB,IAAK,IAAIO,KAFTP,EAASoC,GAEKA,EAAKoJ,KAAM,CAEvBK,EADUzJ,EAAKoJ,KAAKjL,IAItB,SAASsL,EAASM,GAChB,IAAK,IAAI5L,KAAK4L,EAAIlG,KAAM,CACtB,IAAIC,EAAMiG,EAAIlG,KAAK1F,GAGnB,IAAK,IAAI2M,KAFTlN,EAASkG,GAEKA,EAAIsF,KAChBK,EAAS3F,EAAIsF,KAAK0B,OAO5B,SAASE,WAAWnI,EAAQsJ,GAC1B,IAAIX,EAAmBY,EAySvB,OAxSAD,EAAO5P,QAAU,GACjB6P,EAAM7O,EAAE,kCACRiO,EAAWW,EAAOb,QAAQE,SAChB,GACV3I,EAAOhE,OAAOuN,GAEd,SAAWC,GACT,IAAIC,EAAY,GAEhB,IAAK,IAAInO,KAAKqN,EAAU,CACtB,IAAIe,EAAc,GACdC,EAAWpG,EAAEqG,QACjBH,EAAU9J,KAAKgK,EAASE,SACxB,IACIjH,EA6BAkH,EAASC,EAAuBjK,EA9BhCkD,EAAU,GAEVgH,EAAWrB,EAASrN,GAAG0O,SACvBC,EAAWtB,EAASrN,GAAG2O,SACvB5M,EAASsL,EAASrN,GAAG+B,OACrB6M,EAAYvB,EAASrN,GAAG4O,UAE5B,GAAIvB,EAASrN,GAAGsH,OACd,IAAI3B,EAAM0H,EAASrN,GAAGsH,OAAO3B,IACzBiG,EAAMyB,EAASrN,GAAGsH,OAAOsE,QACxB,CACDjG,EAAM,EACNiG,EAAM5L,EACVqN,EAASrN,GAAGsH,OAAS,CACnBjH,MAAO,IACPsF,IAAK,EACLiG,IAAK5L,GAIJ0H,EAAQkE,KACXlE,EAAQkE,GAAO,IAGjBtE,EAASI,EAAQkE,GAAKjG,GAAO,CAC3BhB,KAAM0I,EAASrN,GAAG2E,KAClBH,MAAO6I,EAASrN,GAAGwE,MACnB8C,OAAQ+F,EAASrN,GAAGsH,OACpBvF,OAAQsL,EAASrN,GAAG+B,QAGtBvD,UAAUqQ,YAAYlN,MAAMC,KAAK,SAAUC,GACzC,IAAmB8L,EAGnB,GAFAnJ,EAAQ,CAAC3C,EAAKK,IAEgB,SAA1B8L,EAAOlN,WAAWwI,KAAiB,CACrCwF,EAAgB,CACdJ,SAAUA,EACVK,gBAAgB,EAChBC,WAAwB,QAAZN,EAAqBrB,EAASrN,GAAGiP,SAAW,EACxDC,QAAS1K,EAGT2K,SAAU9B,EAASrN,GAAG2E,KACtByK,UAAW,KACXC,QAAS,KACTC,UAAW,GACXC,cAAe,QACfC,SAAU,IAEZ7B,EAAQ,CAAC,MAAOmB,GAChB,IAAIW,EAAOxH,EAAEqG,QACFrG,EAAEqG,QACbF,EAAY/J,KAAKoL,EAAKlB,SACtB/P,UAAUiE,MAAMC,aAAab,EAAKU,SAASX,KAAK,SAAiBC,GAC/D2M,EAAU3M,EAAKkE,OAAO,SAAUC,EAAMC,GASpC,OARWoH,EAASrN,GAAG2E,KAAKP,KAAK,SAAU+B,GACzC,OAAOA,GAAQF,EAAK/D,OAIpB8D,EAAKC,EAAK/D,IAAM+D,GAGXD,GACN,IACHyJ,EAAKC,QAAQ,YACZ,SAAe7M,GAChBC,QAAQC,IAAIF,MAEd4L,EAAW,IACF5M,EAAKK,IAAML,EACpBoG,EAAE0H,IAAIvB,GAAaxM,KAAK,WACtBsG,eAAe0H,aAAajC,EAAO,SAAUhN,GAC3C,IAAIkP,EAAY,IAAI/G,OAAOnI,EAAMkB,MAE7BiO,EAAa,WACf,IAAInI,EAAS,IAAImB,OAAO,IAExB,IAAK,IAAI9I,KAAKwO,EACZ,IAAK,IAAI7B,KAAK8B,EACZ9G,EAAOtD,KAAK,CACVhC,OAAQsK,EACRoD,QAAStB,EAAS9B,GAClBqD,MAAOhQ,EACPiQ,OAAQzB,EAAQxO,GAChB6P,UAAW,KAKjB,OAAOlI,EAfQ,GAkBD,QAAZ+G,EACFoB,EAAWzG,KAAK,SAAU6G,GACxB,IAAK,IAAIlQ,EAAI,EAAGA,EAAI,EAAGA,IAAK,CAC1B,IAAImQ,EAAO,IAAIC,MAAK,IAAIA,MAAOC,UAAsB,IAAT,EAAIrQ,GAAU,KAAO,KAC7DsQ,EAAOH,EAAKI,UACZC,EAAQL,EAAKM,WACbC,EAAKP,EAAKQ,UACVpP,EAAOsO,EAAUe,SAASrP,KAAK,SAAUxC,GAC3C,OAAO,SAAUuR,EAAME,EAAOL,GAE5B,OADUhO,KACCoO,WAAaD,GADdnO,KAC0BsO,YAAcD,GADxCrO,KACqDwO,WAAaR,GAAQD,EAAGF,OAASjR,EAAQ8R,SACxGzO,KAAK,IAAIgO,KAAKrR,EAAQ+R,YAAYhL,MAAM,KAAK,GAAGiL,QAAQ,KAAM,MAAOT,EAAME,EAAOE,KAEtFR,EAAGL,UAAUxL,KAAK,CAChBwM,QAASX,EAAGF,MACZ3M,MAAO9B,EAAOA,EAAK8B,WAAQwK,EAC3BmD,UAAWb,EAAKE,eAOtBP,EAAWzG,KAAK,SAAU6G,GACxB,IAAIC,EAAO,IAAIC,KACX7O,EAAOsO,EAAUe,SAASrP,KAAK,SAAUxC,GAC3C,OAAOmR,EAAGF,OAASjR,EAAQ8R,UAGzBtP,EACF2O,EAAGL,UAAUxL,KAAK,CAChBwM,QAASX,EAAGF,MACZ3M,MAAO9B,EAAK8B,MACZ2N,UAAWb,EAAKE,YAGlBH,EAAGL,UAAUxL,KAAK,CAChBwM,QAASX,EAAGF,MACZ3M,MAAO,EACP2N,UAAWb,EAAKE,cAMxB,IAGIY,EAAOC,EAHPC,EAAexC,EAASD,SAASA,GACjC0C,EAAU,IAAIC,gBAAgBvB,EAAY,EAAGlB,GAC7C0C,EAAK,IAAIC,QAAQxP,GAGrB,GAAgB,QAAZ2M,EACEyC,EAAaK,SACkB,UAA7BL,EAAaK,OAAOjM,OACtB+L,EAAGG,cACHP,EAASE,EAAQM,YACjBT,EAAQG,EAAQO,iBAChBP,EAAQQ,oBAAoB,SAAU1B,GACpC,IAAI2B,EAAO3B,EAAGH,QAAQ9N,MAAQ,IAAMiO,EAAGD,OAAOhO,MAC1CJ,EAAOqO,EAAG4B,WACdR,EAAGS,WAAWF,EAAMhQ,MAEgB,eAA7BsP,EAAaK,OAAOjM,SACzB4L,EAAaK,OAAOnO,MAAQ,QAAkB8N,EAAaK,OAAOnO,MAAQ,cAG7E,GAAgB,MAAZqL,GACLyC,EAAaK,OACf,GAAiC,UAA7BL,EAAaK,OAAOjM,MAAmB,CACzC,IAAIiM,EAAS,GACbN,EAASE,EAAQM,YACjBT,EAAQ,GACR,IAAIe,EAAQV,EAAGW,cACfb,EAAQQ,oBAAoB,SAAU1B,GACpC,IAAI2B,EAAO3B,EAAGH,QAAQ9N,MAAQ,IAAMiO,EAAGD,OAAOhO,MAC1CJ,EAAOqO,EAAGL,UACd2B,EAAOnN,KAAK,CACVwN,KAAMA,EACNxO,MAAOxB,EAAK,GAAGwB,UAGnB2O,EAAMnQ,KAAO2P,MACyB,eAA7BL,EAAaK,OAAOjM,SACzB4L,EAAaK,OAAOnO,MAAQ,QAAkB8N,EAAaK,OAAOnO,MAAQ,QAKhF8N,EAAaF,OACfK,EAAGY,cAAcjB,GAGfE,EAAaD,QACfI,EAAGa,UAAUjB,GAGf5J,EAAOvF,OAASuP,EAAGlE,YACnBtK,QAAQC,IAAIuE,EAAOvF,QAEfiM,EAAOlN,WAAWZ,QACpBoH,EAAOvF,OAAOyP,OAAO,GAAGY,UAAY,CAClCC,OAAQ,CACNnS,MAAO8N,EAAOlN,WAAWZ,QAG7BoH,EAAOvF,OAAOyP,OAAO,GAAGc,UAAY,CAClCD,OAAQ,CACNnS,MAAO8N,EAAOlN,WAAWZ,QAG7BoH,EAAOvF,OAAOyP,OAAO,GAAGe,UAAY,CAClCF,OAAQ,CACNnS,MAAO8N,EAAOlN,WAAWZ,QAG7BoH,EAAOvF,OAAOyP,OAAO,GAAGgB,UAAY,GACpClL,EAAOvF,OAAOyP,OAAO,GAAGiB,SAAW,IAGrCnL,EAAOvF,OAAO2Q,WAAY,EAC1BrE,EAASqB,QAAQ,mBAGhB,CACL,IAAIZ,EAMJnB,EAAQ,CAAC,QANLmB,EAAgB,CAClBJ,SAAU,KACVK,gBAAgB,EAChBC,WAAY,EACZG,SAAU,CAAC,sBAGbjH,eAAeyK,yBAAyBhF,EAAO,SAAUhN,GACvD,GAAkB,KAAdA,EAAMiS,KAAa,CACrB,IAAIC,EAAKzT,EAAE,+CAEX,GAAIuB,EAAMkB,KAAKiR,sBAAsBC,MAAO,CAC1C,IAAIzB,EAAK,IAAIC,QAAQxP,GACjBF,EAAO,GAGX,IAAK,IAAI7B,KAFTsR,EAAGG,cAEW9Q,EAAMkB,KAAKiR,WAAY,CACnCjR,EAAKwC,KAAK,CACRwN,KAAMlR,EAAMkB,KAAKiR,WAAW9S,GAAG0O,SAC/BrL,MAAO1C,EAAMkB,KAAKiR,WAAW9S,GAAGgT,mBAElC,IAAIC,EAAK7T,EAAE,8DACwBuB,EAAMkB,KAAKiR,WAAW9S,GAAG0O,SAAW,iDAAmD/N,EAAMkB,KAAKiR,WAAW9S,GAAGgT,iBAAmB,qEAEtKH,EAAGnS,OAAOuS,GAGZhF,EAAIiF,MAAML,GACVvB,EAAGS,WAAW,SAAUlQ,GACxByF,EAAOvF,OAASuP,EAAGlE,YACnB9F,EAAOvF,OAAO2Q,WAAY,EAC1BrE,EAASqB,QAAQ,kBAQ7BzH,EAAE0H,IAAIxB,GAAWvM,KAAK,SAAUjB,GAC9BuN,EAAaxG,KAxQjB,CA4QA,SAAsBA,GACpB,IAAK,IAAI1H,KAAK0H,EAAS,CACrB,IAAIkE,EAAMxM,EAAE,8BAGZ,IAAK,IAAIuN,KAFTsB,EAAIvN,OAAOkL,GAEGlE,EAAQ1H,GAAI,CACxB,IAAI2F,EAAMvG,EAAE,8BACRiB,EAAQqH,EAAQ1H,GAAG2M,GAAGrF,OAAOjH,MACjCuL,EAAIlL,OAAOiF,GACXA,EAAIvF,IAAI,QAASC,EAAQ,KACZqE,EAAOrE,QAEpBsF,EAAIvF,IAAI,SAAU,SAClBuF,EAAI4D,OAAO,CACTxH,OAAQ2F,EAAQ1H,GAAG2M,GAAG5K,SAExB2F,EAAQ1H,GAAG2M,GAAGjI,OAASiB,EACvBqI,EAAO5P,QAAQiG,KAAKsB,OAKnBsI,EAGT,SAASnB,WAAWpI,EAAQsJ,GAC1B,GAAIA,EAAOlN,WAAY,CACrB,IACIqS,EAOA9R,EANA2O,EAAQhC,EAAOlN,WAAWmE,IAC1B5C,EAAS2L,EAAOlN,WAAWwB,GAC3B8J,EAAehN,EAAE,yBAA2B4O,EAAOlN,WAAWZ,MAAQ,YACtEkT,EAAQhU,EAAE,uDACViU,EAASjU,EAAE,mFACXqN,EAAQrN,EAAE,sBAIZiC,GAD2C,GAAzC2M,EAAOlN,WAAWO,KAAKiS,QAAQ,MAC1BlU,EAAE,0CAA4C4O,EAAOlN,WAAWO,KAAO,0CAEvEjC,EAAE,+BAAiC4O,EAAOlN,WAAWO,KAAO,0CAGrE+R,EAAM1S,OAAO2S,GACbD,EAAM1S,OAAO+L,GACbL,EAAa1L,OAAO0S,GACpBhH,EAAa1L,OAAOW,GACpBqD,EAAOhE,OAAO0L,GACdtJ,QAAQC,IAAIV,GACZ8F,kBAAkBoL,gBAAgB,CAAClR,GAAS,SAAU1B,GAClC,KAAdA,EAAMiS,OACU,MAAdjS,EAAMkB,KACRrD,UAAUqQ,YAAYlN,MAAMC,KAAK,SAAUC,GAGzC2R,EAFW3R,EACYU,WAKzBiR,EADc7S,EAAMkB,KAAKU,YAK/B/D,UAAUiV,kBAAkBzD,GAAOpO,KAAK,SAAUyB,GAChDgQ,EAAO9R,KAAK,aAAaS,KAAKqB,KAIlC,SAASmQ,EAAiBjR,GACxB/D,UAAUiE,MAAMC,aAAaH,GAASX,KAAK,SAAiBC,GAI1D,IAAI6R,GAHJP,EAAatR,EAAKN,KAAK,SAAU4E,GAC/B,OAAOA,EAAKjE,IAAM8N,KAEE0D,KACtBjH,EAAMzK,KAAKmR,EAAWlR,OACtBmK,EAAa7M,GAAG,QAAS,WACC,SAApB4T,EAAWlR,MACbwG,OAAOD,SAASmL,KAAO,iCACM,SAApBR,EAAWlR,MACpBwG,OAAOD,SAASmL,KAAO,iCACM,UAApBR,EAAWlR,MACpBwG,OAAOD,SAASmL,KAAO,kCACM,UAApBR,EAAWlR,MACpBwG,OAAOD,SAASmL,KAAO,4CACM,YAApBR,EAAWlR,MACpBwG,OAAOD,SAASmL,KAAO,qCACM,UAApBR,EAAWlR,OAES,SAApBkR,EAAWlR,OAEXkR,EAAWlR,MAHpBwG,OAAOD,SAASmL,KAAO,oCAS3BnV,UAAUoV,OAAOjS,MAAMC,KAAK,SAAiBiS,GAC3C,IAAItS,EAAOsS,EAAM7O,OAAO,SAAUmB,GAChC,OAAOA,EAAK2N,UAAYJ,IAGtBnS,EAAK,KACiB,UAApBA,EAAK,GAAGuS,SACW,SAAjBjS,EAAK,GAAGI,MACVoR,EAAO9R,KAAK,aAAaS,KAAK,KAE9BqR,EAAO9R,KAAK,aAAaS,KAAK,KAGhCqR,EAAO9R,KAAK,aAAaS,KAAKT,EAAK,GAAGwS,YAGzC,SAAelR,GAChBwF,MAAM2L,gBAAgBnR,QAM9B,SAASqK,OAAOxI,EAAQsJ,GACtB,GAAIA,EAAOlN,WAAY,CACVkN,EAAOlN,WAAWkB,KAA7B,IACIkL,EAAS9N,EAAE,qCACXqG,EAAWrG,EAAE,qFACjBqG,EAASrF,IAAI,CACXG,OAAU,SAEZ2M,EAAO9M,IAAI,CACTG,OAAU,QAEZmE,EAAOhE,OAAOwM,GAAQxM,OAAO+E,GAEzBuI,EAAOlN,WAAWkB,OACpBkL,EAAOlL,KAAKgM,EAAOlN,WAAWkB,MAC9ByD,EAASlE,KAAK,SAASsE,IAAImI,EAAOlN,WAAWkB,OAG/CyD,EAASlE,KAAK,SAAShC,GAAG,SAAU,SAAUoB,GAC5C,IAAI0C,EAAQjE,EAAEuB,EAAM+D,QAAQmB,MAC5BmI,EAAOlN,WAAWkB,KAAOqB,EACzB6J,EAAOlL,KAAKqB,MAKlB,SAAS4J,QAAQvI,EAAQsJ,GACvB,GAAIA,EAAOlN,WAAY,CACrB,IAAIuE,EAAS2I,EAAOlN,WAAWuE,OAC3BhD,EAAS2L,EAAOlN,WAAWwB,GAC3B8J,EAAehN,EAAE,yBAA2B4O,EAAOlN,WAAWZ,MAAQ,YACtEkT,EAAQhU,EAAE,uDACViU,EAASjU,EAAE,mFACXqN,EAAQrN,EAAE,sBACViC,EAAOjC,EAAE,0CAA4C4O,EAAOlN,WAAWO,KAAO,gBAClF+R,EAAM1S,OAAO2S,GACbD,EAAM1S,OAAO+L,GACbL,EAAa1L,OAAO0S,GACpBhH,EAAa1L,OAAOW,GACpBqD,EAAOhE,OAAO0L,GACd5N,UAAUkD,WAAW+B,gBAAgBpB,GAAQT,KAAK,SAAiBC,GACjE,IAAI8F,EAAS9F,EAAKmD,OAAO,SAAUjG,GACjC,OAAOA,EAAQmD,IAAMmD,IAGH,EAAhBsC,EAAOpD,SACT8O,EAAO9R,KAAK,aAAaS,KAAK2F,EAAO,GAAG1F,OACxCoR,EAAO9R,KAAK,aAAaS,KAAK2F,EAAO,GAAGtE,OACxCoJ,EAAMzK,KAAK2F,EAAO,GAAGkK,QAEtB,SAAehP,OAItB,SAAS2K,UAAU9I,EAAQsJ,GACzB,IAA0BiG,EAE1B,GAAIjG,EAAOlN,YACLkN,EAAO7J,WAGT,IAAK,IAAInE,KAFTgO,EAAOlN,WAAW6D,KAAO,GAEXqJ,EAAO7J,WACnB6J,EAAOlN,WAAW6D,KAAKN,KAAK2J,EAAO7J,WAAWnE,GAAGkC,IAKvD,IAAIgS,EAAQ9U,EAAE,6EACdsF,EAAOhE,OAAOwT,GACd,IAAIC,EAASnG,EAAOlN,WAAW6D,KAC/BnG,UAAUqQ,YAAYlN,MAAMC,KAAK,SAAUC,GAEzC,IAAIU,EADOV,EACYU,QACvB/D,UAAUiE,MAAMC,aAAaH,GAASX,KAAK,SAAiBC,GAC1DoS,EAAUpS,EAAKkE,OAAO,SAAUC,EAAMC,GASpC,OARWkO,EAAO/P,KAAK,SAAU+B,GAC/B,OAAOA,GAAQF,EAAK/D,OAIpB8D,EAAKC,EAAK/D,IAAM+D,GAGXD,GACN,IACHxH,UAAU4V,uBAAuBD,GAAQvS,KAAK,SAAiByS,GAC7D,IAAK,IAAIrU,KAAKiU,EAAS,CACrB,IAAI1S,EAAO8S,EAAMrP,OAAO,SAAUmB,GAChC,OAAOA,EAAK0K,SAAWoD,EAAQjU,GAAGkC,KAEhCkR,EAAQhU,EAAE,gSAGiDmC,EAAKgD,OAAShD,EAAKA,EAAKgD,OAAS,GAAGlB,MAAQ,GAAK,kFAClD4Q,EAAQjU,GAAGiC,MAAQ,6CAE7EqS,EAAW,GAEf,GAAI/S,EAEA+S,EADgB,EAAd/S,EAAKgD,OACIhD,EAAKgT,OAAO,GAAGrP,IAAI,SAAUsP,GACtC,OAAOA,EAAGnR,QAGD9B,EAAKgT,MAAqB,EAAdhT,EAAKgD,QAAYW,IAAI,SAAUsP,GACpD,OAAOA,EAAGnR,aAId,IAASrD,EAAI,EAAGA,EAAI,EAAGA,IACrBsU,EAASjQ,KAAK,GAIlB6P,EAAMxT,OAAO0S,GACbA,EAAM7R,KAAK,aAAaiM,UAAU8G,EAAU,CAC1ChL,KAAM,MACNmL,SAAU,iBAQtB,SAASvP,IAAIR,EAAQsJ,GACnB,IAEI0G,EAFAtB,EAAQhU,EAAE,qDACdsF,EAAOhE,OAAO0S,GAEd,IAAIuB,EAAkB,CACpBC,gBAAiB,UACjBnI,MAAO,CACLzK,KAAM,GACN6S,QAAS,GACTC,QAAS,GACT7T,KAAM,SACN8T,UAAW,CACT7U,MAAO,SAGX8U,QAAS,CACPC,QAAS,OACTC,UAAW,SAAmBpT,GAC5B,OAAOA,EAAIqT,WAAa,IAAMrT,EAAIuB,MAAM,KAG5C+R,KAAM,CACJC,OAAQ,CAAC,WAAY,WACrBC,KAAM,EACNC,MAAM,EACNC,SAAU,CACRC,UAAW,KAGfjE,OAAQ,CAAC,CACPK,KAAM,QACNvI,KAAM,UACNoM,iBAAkB,OAClB7T,KAAM,GACN8T,WAAY,SAAoB9P,GAC9B,IAAIxC,EAQJ,OAAoB,GAAb,IALLA,EADEwC,EACe,GAATA,EAAI,GAEJ,GAGe,GAAK,GAAKxC,GAErCpB,MAAO,CACLoQ,OAAQ,CACN6C,UAAW,MACXU,SAAU,QACVrJ,MAAM,GAERsJ,SAAU,CACRtJ,MAAM,IAGV6F,UAAW,CACTC,OAAQ,CACNnS,MAAO,aAGV,CACD2R,KAAM,QACNvI,KAAM,gBACNoM,iBAAkB,OAClB7T,KAAM,GACN8T,WAAY,SAAoB9P,GAC9B,IAAIxC,EAQJ,OAAoB,GAAb,IALLA,EADEwC,EACe,GAATA,EAAI,GAEJ,GAGe,GAAK,GAAKxC,GAErCyS,aAAc,SACdC,aAAc,CACZC,UAAW,UAEbC,gBAAgB,EAChBhU,MAAO,CACLoQ,OAAQ,CACN6C,UAAW,MACXU,SAAU,QACVrJ,MAAM,IAGV6F,UAAW,CACTC,OAAQ,CACNnS,MAAO,UACPgW,WAAY,GACZC,YAAa,SAGjBC,OAAQ,KAiDD1N,KAAK/G,IADN,8BACe,SAAU0U,GACjC3B,EAAa2B,EACb1B,EAAgBS,KAAKI,SAASC,UAAYf,EAAW4B,eA9CrDnO,kBAAkBoO,4BAA4B,SAAUC,GACtD,IAAIC,EAAQ,CACVC,MAAO,GAGT,GAAsB,GAAlBF,EAAU5D,KAAW,CACvB,IAAK,IAAI+D,KAAQH,EAAU3U,KACzB,GAAI8U,EAAM,CACR,IAAI/Q,EAAM+Q,EAAK7Q,MAAM,MAEM,EAAvBF,EAAI,GAAG0N,QAAQ,KACbmD,EAAM7Q,EAAI,IAAK6Q,EAAM7Q,EAAI,IAAM6Q,EAAM7Q,EAAI,IAAM4Q,EAAU3U,KAAK8U,GAAWF,EAAM7Q,EAAI,IAAM4Q,EAAU3U,KAAK8U,GACtF,EAAb/Q,EAAIrB,SACbkS,EAAM7Q,EAAI,IAAM4Q,EAAU3U,KAAK8U,SAGjCF,EAAM,OAASA,EAAM,OAASD,EAAU3U,KAAK,IAIjD,IAAK,IAAI8U,KAAQF,EAAO,CACtB,IAAI3U,EAAM,GACVA,EAAI+P,KAAO8E,EACX7U,EAAIuB,MAAQqR,EAAWkC,SAASD,GAE5B7U,EAAIuB,OACNvB,EAAIuB,MAAMgB,KAAKoS,EAAME,IAGvBhC,EAAgBnD,OAAO,GAAG3P,KAAKwC,KAAKvC,GAEhC6S,EAAgBnD,OAAO,GAAG3P,KAAK0C,OAAS,GAC1CoQ,EAAgBnD,OAAO,GAAG3P,KAAKwC,KAAKvC,GAIxCsR,EAAM7J,OAAO,CACXxH,OAAQ4S,SAclB,SAAS5H,SAASrI,EAAQsJ,GACxB,GAAIA,EAAOlN,WAAY,CAERkN,EAAOlN,WAAWwB,GAD/B,IAEI0N,EAAQhC,EAAOlN,WAAWmE,IAC1BmH,EAAehN,EAAE,sCACjB4C,EAAO5C,EAAE,kDACTiU,EAASjU,EAAE,yCACXyX,EAAMzX,EAAE,qFACZgN,EAAa1L,OAAOsB,GACpBoK,EAAa1L,OAAO2S,GACpBjH,EAAa1L,OAAOmW,GACpBnS,EAAOhE,OAAO0L,GACd5N,UAAUiE,MAAMqU,YAAY,CAAC9G,IAAQpO,KAAK,SAAiBC,GACzDG,EAAKA,KAAKH,EAAK,GAAGI,SAEpBzD,UAAUqQ,YAAYlN,MAAMC,KAAK,SAAUC,GAEzC,IAAIU,EADOV,EACYU,QACvB/D,UAAUiE,MAAMC,aAAaH,GAASX,KAAK,SAAiBC,GAC7CA,EAAKN,KAAK,SAAU4E,GAC/B,OAAOA,EAAKjE,IAAM8N,IAEpBxR,UAAUiV,kBAAkBzD,GAAOpO,KAAK,SAAUyB,GAGhD,OAFAgQ,EAAO9R,KAAK,aAAaS,KAAKqB,IAEtB,GACN,KAAc,KAATA,EACHwT,EAAItV,KAAK,iBAAiBlC,SAAS,qBACnC,MAEF,KAAa,GAARgE,EACHwT,EAAItV,KAAK,iBAAiBlC,SAAS,sBACnC,MAEF,KAAa,GAARgE,EAIL,KAAa,GAARA,EACHwT,EAAItV,KAAK,iBAAiBlC,SAAS,uBACnC,MAEF,KAAa,GAARgE,EACHwT,EAAItV,KAAK,iBAAiBlC,SAAS,oBACnC,MAEF,QACEwX,EAAItV,KAAK,iBAAiBlC,SAAS,uBAGvCgU,EAAO0D,KAAK,MAAQ1T,EAAQ,SAC5BwT,EAAItV,KAAK,iBAAiBnB,IAAI,QAASiD,EAAQ,YAOzD,SAAS2J,QAAQtI,EAAQsJ,GACvB,GAAIA,EAAOlN,WAAY,CAERkN,EAAOlN,WAAWwB,GAD/B,IAOI6Q,EALAnD,EAAQhC,EAAOlN,WAAWmE,IAC1BmH,EAAehN,EAAE,sDACjB4C,EAAO5C,EAAE,yFACT4X,EAAW5X,EAAE,wCACb6X,EAAO7X,EAAE,0CAEbgN,EAAa1L,OAAOsB,GACpBoK,EAAa1L,OAAOsW,GACpB5K,EAAa1L,OAAOuW,GACpBvS,EAAOhE,OAAO0L,GACd5N,UAAUqQ,YAAYlN,MAAMC,KAAK,SAAUC,GAEzC,IAAIU,EADOV,EACYU,QACvB/D,UAAUiE,MAAMC,aAAaH,GAASX,KAAK,SAAiBC,GAC1DsR,EAAatR,EAAKN,KAAK,SAAU4E,GAC/B,OAAOA,EAAKjE,IAAM8N,IAEpBiH,EAAKjV,KAAKmR,EAAWlR,SAEvBzD,UAAU4V,uBAAuB,CAACpE,IAAQpO,KAAK,SAAUC,GACvD,IAAWqV,EAAKC,EAEE,EAAdtV,EAAK0C,SACPlB,EAAQxB,EAAK,GAAGwB,OAOd8T,EAJc,EAAdtV,EAAK0C,OAGG,GAFV2S,EAAMrV,EAAKA,EAAK0C,OAAS,IAGM,KAArBlB,EAAQ6T,EAAMA,GAEf,IAGF,EAGTlV,EAAKT,KAAK,SAASS,KAAKoV,KAAKC,IAAIF,GAAQ,KAE9B,EAAPA,GACFnV,EAAKT,KAAK,QAAQlC,SAAS,eAC3B2C,EAAK3C,SAAS,aACL8X,EAAO,GAChBnV,EAAKT,KAAK,QAAQlC,SAAS,iBAC3B2C,EAAK3C,SAAS,gBAEd2C,EAAKT,KAAK,QAAQlC,SAAS,iBAC3B2C,EAAK3C,SAAS,aAGhB,IAAIgE,EAAiB,GAATA,EAAaF,SAAyB,IAAhBiU,KAAKE,UAAkBjU,EACzD2T,EAAShV,KAAKqB,QAMtB,SAASiK,QAAQ5I,OAAQsJ,QACvB,GAAIA,OAAOlN,WAAY,CACrB,IAAIyW,IAAMvJ,OAAOlN,WAAWyW,IACxBnL,aAAehN,EAAE,4DACjBoY,MAAQpY,EAAE,uDACdgN,aAAa1L,OAAO8W,OACpB9S,OAAOhE,OAAO0L,cACdqL,KAAKF,IAALE,CAAU,SAAU9W,GAClB,IACE,GAAkB,KAAdA,EAAMiS,KAYR,MAAMjS,EAAM+W,QAXZ,IAAK,IAAI1X,KAAKW,EAAMkB,KAAM,CACxB,IAAI8V,EAAQvY,EAAE,sOAEiEuB,EAAMkB,KAAK7B,GAAGuC,QAAU,IAAM5B,EAAMkB,KAAK7B,GAAGkC,GAAK,6FAA+F0V,EAAOjX,EAAMkB,KAAK7B,GAAG6X,YAAc,UAAYlX,EAAMkB,KAAK7B,GAAGiC,MAAQ,+GAGpSuV,MAAM9W,OAAOiX,GAGfH,MAAM9W,OAAOtB,EAAE,wEAIjB,MAAOyD,GACPC,QAAQC,IAAIF,GAGd,SAAS+U,EAAOE,GACd,IAEI3H,EAFa,sBAEK4H,KAAKD,GACvBE,EAFa,sBAEED,KAAKD,GAExB,OAAY,MAAR3H,GAAqB,MAAL6H,EACX7H,EAAO,IAAM6H,EAEbF,MAOjB,SAASvK,QAAQ7I,OAAQsJ,QACvB,GAAIA,OAAOlN,WAAY,CACrB,IAAIyW,IAAMvJ,OAAOlN,WAAWyW,IACxBnL,aAAehN,EAAE,4DACjB8N,OAAS9N,EAAE,+DACX6Y,MAAQ7Y,EAAE,mBACdgN,aAAa1L,OAAOwM,QAAQxM,OAAOuX,OACnCvT,OAAOhE,OAAO0L,cACd,IAAI8L,OAAS,IACbT,KAAKF,IAALE,CAAUS,OAAQ,SAAUvX,GAC1B,IACE,GAAkB,KAAdA,EAAMiS,KAgCR,MAAMjS,EAAM+W,QA/BZ,IAAK,IAAI1X,EAAI,EAAGA,GAAyB,GAApBW,EAAMkB,KAAK0C,OAAc,GAAK5D,EAAMkB,KAAK0C,QAASvE,IAAK,CAC1E,IAAImN,EAGuB,IADT/J,EAuBZzC,EAAMkB,KAAK7B,IAtBNmY,aACPhL,EAAU/N,EAAE,iJAC6DuB,EAAMkB,KAAK7B,GAAGoY,SAAW,8BAAgCzX,EAAMkB,KAAK7B,GAAGoY,SAAW,+EAC1GzX,EAAMkB,KAAK7B,GAAG0X,QAAU,kOAI3C,KAArBtU,EAAK+U,aACdhL,EAAU/N,EAAE,iJAC6DuB,EAAMkB,KAAK7B,GAAGoY,SAAW,8BAAgCzX,EAAMkB,KAAK7B,GAAGoY,SAAW,+EAC1GzX,EAAMkB,KAAK7B,GAAG0X,QAAU,kOAI3C,KAArBtU,EAAK+U,eACdhL,EAAU/N,EAAE,iJAC6DuB,EAAMkB,KAAK7B,GAAGoY,SAAW,8BAAgCzX,EAAMkB,KAAK7B,GAAGoY,SAAW,+EAC1GzX,EAAMkB,KAAK7B,GAAG0X,QAAU,sOAO7EO,MAAMvX,OAAOyM,IAKjB,MAAOtK,GACPC,QAAQC,IAAIF,GA/BR,IAAkBO,EAkCxB6U,MAAMvX,OAAOtB,EAAE,gIApzCrBmM,KAAKvC,QAyzCL5J,EAAEiZ,GAAGC,OAAO,CACV/O,OAAQ,SAASA,SACf,IAAIN,IAAM9G,KACNuC,OAcJ,SAASyE,UACPzE,OAASuE,IAAIpH,KAAK,YACN6C,OAAOyE,SAGrB,SAASoP,UAAUxW,IACjB2C,OAASuE,IAAIpH,KAAK,YACN6C,OAAO6T,UAAUxW,GAAQ,GAnBf,GAApByW,UAAUjU,QACZG,OAAStG,QAAQmN,KAAKpJ,KAAK,GAAI,YAC/BA,KAAKN,KAAK,SAAU6C,QACpBA,OAAO6T,UAAUC,UAAU,GAAGzW,SACL,UAAhByW,UAAU,KACfA,UAAU,GACZf,KAAKe,UAAU,GAAff,CAAmBe,UAAU,IAE7Bf,KAAKe,UAAU,GAAK,UAiB9B,OAnqDA9Z,UAAUC,SAAW,IACrBD,UAAUE,MAAQ,CAChBC,UAAW,KAGbH,UAAUI,KAAO,SAAUF,EAAOG,EAASC,GACzCT,QAAQ,WACNC,UAAUia,cAAc7W,KAAK,SAAiBjB,GAC5C,IAAI+X,EACAD,EAAgB9X,EAAMkB,KACtB8W,EAAShY,EAAMgY,OAEnBna,UAAUoa,WAAa,SAAU/W,GAC/BzC,EAAEL,GAASwC,KAAK,aAAaqD,WAAWC,SACxC6T,EAAU,IAAI3P,WAAW,CACvB4C,KAAMvM,EAAEL,GAASwC,KAAK,aACtBM,KAAMA,EACNhD,UAAWD,EAAMC,aAIrB6Z,EAAU,IAAI3P,WAAW,CACvB4C,KAAMvM,EAAEL,GAASwC,KAAK,aACtBM,KAAM4W,EACN5Z,UAAWD,EAAMC,YAGnBD,EAAMC,UAAUga,KAAO,WACrB,IAAIlR,EAAQgG,EACRmL,EAAala,EAAMC,UAAUia,WAE7BA,GACFnR,EAAS+Q,EAAQtP,SACjBR,kBAAkBmQ,sBAAsBD,EAAYvR,KAAKE,UAAUE,GAAS,SAAUhH,GAClE,GAAdA,EAAMiS,MACRnK,OAAOuQ,KAAK,qBAAsB,SAClC3Q,MAAM4Q,QAAQ,aAAc,KAE5B5Q,MAAMzF,MAAM,aAAc,QAI9B+E,EAAS+Q,EAAQtP,SACjBuE,EAAQ,CACNuL,UAAW,YACXC,SAAU,YACVC,SAAU,YACVjM,QAAS5F,KAAKE,UAAUE,IAE1BS,gBAAgBiR,oBAAoB1L,EAAO,SAAUhN,GACjC,GAAdA,EAAMiS,MACRnK,OAAOuQ,KAAK,aAAc,SAC1B3Q,MAAM4Q,QAAQ,WAAY,KAE1B5Q,MAAMzF,MAAM,WAAY,QAMhChE,EAAMC,UAAUya,OAAS,WACvBlR,gBAAgBmR,YAAY,CAACZ,GAAS,SAAUhY,GAC9CgY,OAAS9K,EACTpF,OAAOuQ,KAAK,aAAc,aAG7B,SAAenW,GAEhBC,QAAQC,IAAIF,MAEb,MA6lDEnE,UAlhFTP,WAAWqb,cAAc,UAAWlb,mBACpCA,kBAAkBmb,QAAU,CAAC,WAAY,YAAa,UA6CtDtb,WAAWqb,cAAc,gBAAiB5Z,yBAC1CA,wBAAwB6Z,QAAU,CAAC,WAAY,aAwF/Ctb,WAAWqb,cAAc,eAAgBpY,wBACzCA,uBAAuBqY,QAAU,CAAC,WAAY,aAoF9Ctb,WAAWqb,cAAc,eAAgBhY,wBACzCA,uBAAuBiY,QAAU,CAAC,WAAY,aAkD9Ctb,WAAWqb,cAAc,gBAAiBlW,yBAC1CA,wBAAwBmW,QAAU,CAAC,WAAY,aAiD/Ctb,WAAWqb,cAAc,oBAAqB9V,6BAC9CA,4BAA4B+V,QAAU,CAAC,WAAY,aA2FnDtb,WAAWqb,cAAc,qBAAsB/U,8BAC/CA,6BAA6BgV,QAAU,CAAC,WAAY,aA8EpDtb,WAAWqb,cAAc,gBAAiBrU,sBAC1CA,qBAAqBsU,QAAU,CAAC,WAAY,aAkE5Ctb,WAAWqb,cAAc,iBAAkBpU,0BAC3CA,yBAAyBqU,QAAU,CAAC,WAAY,aAkEhDtb,WAAWqb,cAAc,gBAAiBlU,yBAC1CA,wBAAwBmU,QAAU,CAAC,WAAY,aA2D/Ctb,WAAWqb,cAAc,YAAapT,qBACtCA,oBAAoBqT,QAAU,CAAC,WAAY,aA0E3Ctb,WAAWqb,cAAc,OAAQ7S,qBACjCA,oBAAoB8S,QAAU,CAAC,WAAY,aA+G3Ctb,WAAWqb,cAAc,gBAAiBxR,qBAC1CA,oBAAoByR,QAAU,CAAC,KAAM,WAAY,YAAa,iBAAkB,oBAAqB,kBAAmB,QAAS,YAAa,WAAY,YAAa,UAAW,OAAQ,oBAAqB","file":"js/directives/dashboard-dom.js","sourcesContent":["define(['directives/directives', \"echarts\", \"jquery-ui\", \"macarons\", 'bmap'], function (directives, echarts) {\n  'use strict';\n\n  var dragging = false;\n  directives.initDirective('editBtn', editBtn_directive);\n  editBtn_directive.$inject = ['$timeout', 'variables', \"$route\"];\n\n  function editBtn_directive(timeout, variables, route) {\n    var directive = {};\n    directive.restrict = \"A\";\n    directive.scope = {\n      dashboard: \"=\"\n    };\n\n    directive.link = function (scope, element, attr) {\n      timeout(function () {\n        if (route.current.params.mode == 'edit') {\n          $(\"#leftPart\").addClass(\"open\");\n          $(\"#rightPart\").addClass(\"fold\");\n          scope.dashboard.mode = \"editmode\";\n        } else {\n          $(\"#leftPart\").removeClass(\"open\");\n          $(\"#rightPart\").removeClass(\"fold\");\n          scope.dashboard.mode = \"viewmode\";\n        }\n      });\n      $(element).on(\"click\", function () {\n        scope.$apply(function () {\n          var body = $('body');\n\n          if (scope.dashboard.callback) {\n            scope.dashboard.callback();\n          }\n\n          if (scope.dashboard.mode == variables._EDITMODE_) {\n            $(\"#leftPart\").removeClass(\"open\");\n            $(\"#rightPart\").removeClass(\"fold\");\n            scope.dashboard.mode = variables._VIEWMODE_;\n          } else {\n            $(\"#leftPart\").addClass(\"open\");\n            $(\"#rightPart\").addClass(\"fold\");\n            scope.dashboard.mode = variables._EDITMODE_;\n          }\n        });\n      });\n    };\n\n    return directive;\n  }\n\n  directives.initDirective('colorSelector', colorSelector_directive);\n  colorSelector_directive.$inject = ['$timeout', 'variables'];\n\n  function colorSelector_directive(timeout, variables) {\n    /*\n     var kpiQueryModel = {\n     category: 'ci',\n     isRealTimeData: true,\n     timePeriod: 0,\n     kpiCodes: [\"alert_code_count\"]\n     };\n     var p = [\"alert\", kpiQueryModel];\n     */\n    var directive = {};\n    directive.restrict = \"A\";\n    directive.scope = {\n      bgcolor: \"=\"\n    };\n\n    directive.link = function (scope, element, attr) {\n      timeout(function () {\n        var colors = ['bg-red', 'bg-yellow', 'bg-aqua', 'bg-blue', 'bg-light-blue', 'bg-green', 'bg-navy', 'bg-teal', 'bg-olive', 'bg-lime', 'bg-orange', 'bg-fuchsia', 'bg-purple', 'bg-maroon', 'bg-white', 'bg-black'];\n        var wrap = $(\"<div class='selWrap' id='colorSelector'></div>\");\n        $(element).on(\"click.cs\", showBlock);\n\n        for (var i in colors) {\n          (function (color) {\n            var block = $(\"<div class='small-box \" + color + \"'></div>\");\n            block.css({\n              width: 20,\n              height: 20,\n              margin: 5,\n              float: 'left',\n              display: block\n            });\n            wrap.append(block);\n            block.on(\"click.block\", function (event) {\n              event.stopPropagation();\n              wrap.css(\"display\", \"none\");\n              $(\"body\").off(\"click.body\");\n              $(element).off(\"click.cs\");\n              $(element).on(\"click.cs\", showBlock);\n              scope.$apply(function () {\n                if (scope.bgcolor.attributes) {\n                  scope.bgcolor.attributes.color = color;\n                } else {\n                  scope.bgcolor.attributes = {\n                    color: color\n                  };\n                }\n\n                $(element).removeClass().addClass(\"small-box\").addClass(color);\n              });\n            });\n          })(colors[i]);\n\n          scope.bgcolor.attributes.color = colors[0];\n        }\n\n        function showBlock(event) {\n          event.stopPropagation();\n          wrap.css(\"display\", \"block\");\n          wrap.css(\"top\", $(element).offset().top);\n          wrap.css(\"left\", $(element).offset().left + 30);\n          $(element).off(\"click.cs\");\n          $(element).on(\"click.cs\", hideBlock);\n          $(\"body\").on(\"click.body\", hideBlock);\n        }\n\n        ;\n\n        function hideBlock(event) {\n          event.stopPropagation();\n          wrap.css(\"display\", \"none\");\n          $(\"body\").off(\"click.body\");\n          $(element).off(\"click.cs\");\n          $(element).on(\"click.cs\", showBlock);\n        }\n\n        $(\"body\").prepend(wrap);\n        wrap.on(\"click.empty\", function () {\n          event.stopPropagation();\n        });\n      });\n    };\n\n    return directive;\n  }\n\n  directives.initDirective('iconSelector', iconSelector_directive);\n  iconSelector_directive.$inject = ['$timeout', 'variables'];\n\n  function iconSelector_directive(timeout, variables) {\n    var directive = {};\n    directive.restrict = \"A\";\n    directive.scope = {\n      icon: \"=\"\n    };\n\n    directive.link = function (scope, element, attr) {\n      timeout(function () {\n        /* var icons = ['fa fa-connectdevelop',\n         'fa fa-warning', 'fa fa-edit', 'fa fa-birthday-cake', 'fa fa-user', 'fa fa-envelope-o',\n         'fa fa-file-code-o', 'fa fa-icon-file', 'fa fa-clock-o', 'fa fa-warning',\n         'ps-lg-nofix ps-dashboard', 'ps-lg-nofix ps-resource', 'ps-lg-nofix ps-performance']; */\n        var icons = ['ps-edit', ' ps-back', 'ps-mushroom', 'ps-planting', 'ps-current_production', 'ps-estimated_output', 'ps-daily_output', 'ps-duration', 'ps-sandglass', 'ps-task', 'ps-current_production_p', 'ps-pattern', 'ps-number', 'ps-air-humidity', 'ps-air-temperature', 'ps-camera', 'ps-sunshine', 'ps-video-camera', 'ps-water', 'ps-fan', 'ps-electric_motor02', 'ps-electric_motor', 'ps-Co2', 'ps-soil_temperature', 'ps-soil_humidity', 'ps-irrigation', 'ps-spraying', 'ps-chart_brokenline', 'ps-userinfo', 'ps-user', 'ps-group', 'ps-center', 'ps-server', 'ps-app'];\n        var wrap = $(\"<div class='selWrap' id='iconSelector'></div>\");\n        $(element).on(\"click.cs\", showBlock);\n\n        for (var i in icons) {\n          (function (icon) {\n            var block = $(\"<div class='icon'><span class='proudsmart \" + icon + \"' style='font-size : 15px; color : #fff; top : 2px; left : 2px;'></span></div>\");\n            block.css({\n              width: 20,\n              height: 20,\n              margin: 5,\n              float: 'left',\n              display: block\n            });\n            wrap.append(block);\n            block.on(\"click.block\", function (event) {\n              event.stopPropagation();\n              wrap.css(\"display\", \"block\");\n              $(\"body\").off(\"click.body\");\n              wrap.css(\"display\", \"none\");\n              $(element).off(\"click.cs\");\n              $(element).on(\"click.cs\", showBlock);\n              scope.$apply(function () {\n                if (scope.icon.attributes) {\n                  scope.icon.attributes.icon = icon;\n                } else {\n                  scope.icon.attributes = {\n                    icon: icon\n                  };\n                }\n\n                $(element).find(\"i\").removeClass().addClass(\"proudsmart \" + icon);\n              });\n            });\n          })(icons[i]);\n\n          scope.icon.attributes.icon = icons[0];\n        }\n\n        function showBlock(event) {\n          event.stopPropagation();\n          wrap.css(\"top\", $(element).offset().top);\n          wrap.css(\"left\", $(element).offset().left + 30);\n          wrap.css(\"display\", \"block\");\n          $(element).off(\"click.cs\");\n          $(element).on(\"click.cs\", hideBlock);\n          $(\"body\").on(\"click.body\", hideBlock);\n        }\n\n        ;\n\n        function hideBlock(event) {\n          event.stopPropagation();\n          wrap.css(\"display\", \"none\");\n          $(\"body\").off(\"click.body\");\n          $(element).off(\"click.cs\");\n          $(element).on(\"click.cs\", showBlock);\n        }\n\n        $(\"body\").prepend(wrap);\n        wrap.on(\"click.empty\", function () {\n          event.stopPropagation();\n        });\n      });\n    };\n\n    return directive;\n  }\n\n  directives.initDirective('ciSelectmenu', ciSelectmenu_directive);\n  ciSelectmenu_directive.$inject = ['$timeout', 'variables'];\n\n  function ciSelectmenu_directive(timeout, variables) {\n    var directive = {};\n    directive.restrict = \"A\";\n    directive.scope = {\n      tool: \"=\"\n    };\n\n    directive.link = function (scope, element, attr) {\n      timeout(function () {\n        variables.$resources.get().then(function success(data) {\n          for (var i in data) {\n            (function (obj) {\n              var option = $(\"<option></option>\");\n              option.text(obj.label);\n              option.attr(\"value\", obj.id);\n              this.append(option);\n            }).call($(element), data[i]);\n          }\n\n          var nodeId = data[0].id;\n          scope.tool.attributes.ci = nodeId;\n          var modelId = variables.$resources.getModelIdByNodeId(nodeId);\n          variables.$kpis.getBymodelId(modelId).then(function success(data) {\n            scope.tool.onChange(data);\n          }, function error(err) {\n            console.log(error);\n          });\n          $(element).selectmenu({\n            width: 100,\n            change: function change(event, ui) {\n              var nodeId = parseInt(ui.item.value);\n              scope.tool.attributes.ci = nodeId;\n              var modelId = variables.$resources.getModelIdByNodeId(nodeId);\n              variables.$kpis.getBymodelId(modelId).then(function success(data) {\n                scope.tool.onChange(data);\n              }, function error(err) {\n                console.log(error);\n              });\n            }\n          });\n        }, function error(err) {});\n      });\n    };\n\n    return directive;\n  }\n\n  ;\n  directives.initDirective('aciSelectmenu', aciSelectmenu_directive);\n  aciSelectmenu_directive.$inject = ['$timeout', 'variables'];\n\n  function aciSelectmenu_directive(timeout, variables) {\n    var directive = {};\n    directive.restrict = \"A\";\n    directive.scope = {\n      attr: \"=\"\n    };\n\n    directive.link = function (scope, element, attr) {\n      timeout(function () {\n        variables.$resources.getCurrent().then(function success(data) {\n          for (var i in data) {\n            (function (index, obj) {\n              if (index != 0) {\n                var option = $(\"<option></option>\");\n                option.text(obj.label);\n                option.attr(\"value\", obj.id);\n                this.append(option);\n              }\n            }).call($(element), i, data[i]);\n          }\n\n          var nodeId = data[1].id;\n          scope.attr.attributes.ci = nodeId;\n          variables.$resources.getAttrByNodeId(nodeId).then(function success(data) {\n            scope.attr.onChange(data);\n          }, function error(err) {\n            console.log(error);\n          });\n          $(element).selectmenu({\n            width: 100,\n            change: function change(event, ui) {\n              var nodeId = parseInt(ui.item.value);\n              variables.$resources.getAttrByNodeId(nodeId).then(function success(data) {\n                scope.attr.onChange(data);\n              }, function error(err) {\n                console.log(error);\n              });\n            }\n          });\n        }, function error(err) {});\n      });\n    };\n\n    return directive;\n  }\n\n  ;\n  directives.initDirective('ciSelectmenuChart', ciSelectmenuChart_directive);\n  ciSelectmenuChart_directive.$inject = ['$timeout', 'variables'];\n\n  function ciSelectmenuChart_directive(timeout, variables) {\n    var directive = {};\n    var kpiCache;\n    directive.restrict = \"A\";\n    directive.scope = {\n      chart: \"=\"\n    };\n\n    directive.link = function (scope, element, attr) {\n      scope.$watch('chart', function (n, o, s) {\n        if (n) {\n          n.add = function () {\n            var fill;\n\n            for (var i in kpiCache) {\n              var find = scope.chart.kpiObjects.some(function (element) {\n                return kpiCache[i].id == element.id;\n              });\n\n              if (!find) {\n                fill = {\n                  id: kpiCache[i].id\n                };\n                break;\n              }\n            }\n\n            scope.chart.kpiObjects.push(fill);\n            var kpiObj = scope.chart.kpiObjects;\n            timeout(function () {\n              kpiObj[kpiObj.length - 1].onChange(kpiCache);\n            });\n          };\n        }\n      });\n      timeout(function () {\n        variables.$resources.get().then(function success(data) {\n          for (var i in data) {\n            (function (obj) {\n              var option = $(\"<option></option>\");\n              option.text(obj.label);\n              option.attr(\"value\", obj.id);\n              this.append(option);\n            }).call($(element), data[i]);\n          }\n\n          var nodeId = data[0].id;\n          scope.chart.attributes.nodes = [nodeId];\n          var modelId = variables.$resources.getModelIdByNodeId(nodeId);\n          variables.$kpis.getBymodelId(modelId).then(function success(data) {\n            kpiCache = data;\n            scope.chart.kpiObjects = [{\n              id: data[0].id\n            }];\n            timeout(function () {\n              scope.chart.kpiObjects[0].onChange(data);\n            });\n          }, function error(err) {\n            console.log(error);\n          });\n          $(element).selectmenu({\n            width: 100,\n            change: function change(event, ui) {\n              scope.$apply(function () {\n                var nodeId = parseInt(ui.item.value);\n                scope.chart.attributes.nodes = [nodeId];\n                var modelId = variables.$resources.getModelIdByNodeId(nodeId);\n                variables.$kpis.getBymodelId(modelId).then(function success(data) {\n                  kpiCache = data;\n                  scope.chart.kpiObjects = [{\n                    id: data[0].id\n                  }];\n                  timeout(function () {\n                    scope.chart.kpiObjects[0].onChange(data);\n                  });\n                }, function error(err) {\n                  console.log(error);\n                });\n              });\n            }\n          });\n        }, function error(err) {});\n      });\n    };\n\n    return directive;\n  }\n\n  ;\n  directives.initDirective('kpiSelectmenuChart', kpiSelectmenuChart_directive);\n  kpiSelectmenuChart_directive.$inject = ['$timeout', 'variables'];\n\n  function kpiSelectmenuChart_directive(timeout, variables) {\n    var directive = {};\n    directive.restrict = \"A\";\n    directive.scope = {\n      chart: \"=\",\n      target: \"=\"\n    };\n\n    directive.link = function (scope, element, attr) {\n      scope.$watch('chart', function (n, o, s) {\n        if (n) {\n          n.onChange = function (kpis) {\n            var result = kpis.filter(function (kpi) {\n              for (var i in s.filter) {\n                var find = function (attr, value) {\n                  return kpi[attr] == value;\n                }(i, s.filter[i]);\n\n                if (!find) {\n                  return false;\n                }\n              }\n\n              return true;\n            });\n            render(result);\n          };\n        }\n      });\n      scope.$watch('chart.id', function (n, o, s) {\n        if (n) {\n          s.target.attributes.kpis = s.target.kpiObjects.map(function (element) {\n            return element.id;\n          });\n        }\n      });\n\n      function render(data) {\n        $(element).children().remove();\n\n        for (var i in data) {\n          (function (obj) {\n            var option = $(\"<option></option>\");\n            option.text(obj.label);\n            option.attr(\"value\", obj.id);\n\n            if (scope.chart.id == obj.id) {\n              option.prop(\"selected\", \"selected\");\n            }\n\n            this.append(option);\n          }).call($(element), data[i]);\n        }\n\n        var instance = $(element).selectmenu(\"instance\");\n\n        if (instance) {\n          $(element).selectmenu(\"refresh\");\n        } else {\n          $(element).selectmenu({\n            width: 100,\n            change: function change(event, ui) {\n              scope.$apply(function () {\n                scope.chart.id = parseInt(ui.item.value);\n              });\n            }\n          });\n        }\n      }\n\n      ;\n    };\n\n    return directive;\n  }\n\n  directives.initDirective('kpiSelectmenu', selectmenu_directive);\n  selectmenu_directive.$inject = ['$timeout', 'variables'];\n\n  function selectmenu_directive(timeout, variables) {\n    var directive = {};\n    directive.restrict = \"A\";\n    directive.scope = {\n      tool: \"=\",\n      filter: \"=\"\n    };\n\n    directive.link = function (scope, element, attr) {\n      scope.$watch('tool', function (n, o, s) {\n        if (n) {\n          n.onChange = function (kpis) {\n            var result = kpis.filter(function (kpi) {\n              for (var i in s.filter) {\n                var find = function (attr, value) {\n                  return kpi[attr] == value;\n                }(i, s.filter[i]);\n\n                if (!find) {\n                  return false;\n                }\n              }\n\n              return true;\n            });\n            render(result);\n          };\n        }\n      });\n\n      function render(data) {\n        $(element).children().remove();\n\n        for (var i in data) {\n          (function (obj) {\n            var option = $(\"<option></option>\");\n            option.text(obj.label);\n            option.attr(\"value\", obj.id);\n            this.append(option);\n          }).call($(element), data[i]);\n        }\n\n        var instance = $(element).selectmenu(\"instance\");\n\n        if (instance) {\n          $(element).selectmenu(\"refresh\");\n        } else {\n          $(element).selectmenu({\n            width: 100,\n            change: function change(event, ui) {\n              scope.tool.attributes.kpi = parseInt(ui.item.value);\n            }\n          });\n        }\n\n        scope.tool.attributes.kpi = data[0].id;\n      }\n\n      ;\n    };\n\n    return directive;\n  }\n\n  directives.initDirective('attrSelectmenu', attrSelectmenu_directive);\n  attrSelectmenu_directive.$inject = ['$timeout', 'variables'];\n\n  function attrSelectmenu_directive(timeout, variables) {\n    var directive = {};\n    directive.restrict = \"A\";\n    directive.scope = {\n      attr: \"=\",\n      filter: \"=\"\n    };\n\n    directive.link = function (scope, element, attr) {\n      scope.$watch('attr', function (n, o, s) {\n        if (n) {\n          n.onChange = function (kpis) {\n            var result = kpis.filter(function (kpi) {\n              for (var i in s.filter) {\n                var find = function (attr, value) {\n                  return kpi[attr] == value;\n                }(i, s.filter[i]);\n\n                if (!find) {\n                  return false;\n                }\n              }\n\n              return true;\n            });\n            render(result);\n          };\n        }\n      });\n\n      function render(data) {\n        $(element).children().remove();\n\n        for (var i in data) {\n          (function (obj) {\n            var option = $(\"<option></option>\");\n            option.text(obj.label);\n            option.attr(\"value\", obj.id);\n            this.append(option);\n          }).call($(element), data[i]);\n        }\n\n        var instance = $(element).selectmenu(\"instance\");\n\n        if (instance) {\n          $(element).selectmenu(\"refresh\");\n        } else {\n          $(element).selectmenu({\n            width: 100,\n            change: function change(event, ui) {\n              scope.attr.attributes.attrId = parseInt(ui.item.value);\n            }\n          });\n        }\n\n        scope.attr.attributes.attrId = data[0].id;\n      }\n\n      ;\n    };\n\n    return directive;\n  }\n\n  directives.initDirective('bootinputfree', bootinputfree_directive);\n  bootinputfree_directive.$inject = ['$timeout', 'variables'];\n\n  function bootinputfree_directive(timeout, variables) {\n    var directive = {};\n    directive.restrict = \"C\";\n    directive.scope = {\n      model: \"=\"\n    };\n\n    directive.link = function (scope, element, attr) {\n      var oldValue = '';\n      timeout(function () {\n        var value = \"\";\n\n        for (var i in scope.model.cols) {\n          if (i == scope.model.cols.length - 1) {\n            value += scope.model.cols[i].col;\n          } else {\n            value += scope.model.cols[i].col + \"-\";\n          }\n        }\n\n        oldValue = value;\n        render(value);\n      });\n\n      function render(value) {\n        var inputDom = $(\"<input />\");\n        inputDom.on(\"blur\", function (event) {\n          scope.$apply(applied);\n\n          function applied() {\n            var arr = $(event.target).val().split(\"-\");\n            var sum = arr.reduce(function (prev, next) {\n              return parseInt(prev) + parseInt(next);\n            });\n\n            if (sum != 12) {\n              $(event.target).val(oldValue);\n              alert(\"输入列数总和要为12！\");\n            } else {\n              oldValue = $(event.target).val();\n              scope.model.cols = arr.map(function (elem) {\n                return {\n                  col: elem\n                };\n              });\n            }\n          }\n        });\n        inputDom.val(value);\n        $(element).children().remove();\n        $(element).append(inputDom);\n      }\n    };\n\n    return directive;\n  }\n\n  directives.initDirective('bootinput', bootinput_directive);\n  bootinput_directive.$inject = ['$timeout', 'variables'];\n\n  function bootinput_directive(timeout, variables) {\n    var directive = {};\n    directive.restrict = \"C\";\n    directive.scope = {\n      model: \"=\"\n    };\n\n    directive.link = function (scope, element, attr) {\n      timeout(function () {\n        render();\n      });\n\n      function render() {\n        var wrapDiv = $(\"<div class='row bootShow'></div>\");\n\n        for (var i in scope.model.cols) {\n          (function (index, col) {\n            var colDiv = $(\"<div class='cwrap col-md-\" + col.col + \"'><div style='margin : 0 4px 0 0;background-color : white; border : 1px solid #bfbfbf;'><div class='inner'></div></div></div>\");\n            var numberInput = $(\"<input class='colNum' />\");\n            numberInput.val(col.col);\n            numberInput.css(\"margin\", \"0px 5px\");\n            colDiv.append(numberInput);\n\n            for (var i = 0; i < col.col; i++) {\n              var unitDiv = $(\"<div class='bwrap' style='width : \" + 100 / col.col + \"%;'><div class='block'></div></div>\");\n              colDiv.find(\".inner\").append(unitDiv);\n            }\n\n            colDiv.find(\".inner\").append($(\"<div style='height : 1px; clear : both; width : 100%;'></div>\"));\n            wrapDiv.append(colDiv);\n            numberInput.on(\"change\", function (event) {\n              scope.$apply(function () {\n                var value = parseInt($(event.target).val());\n\n                if (value < 2) {\n                  value = 2;\n                } else if (value > 12 - scope.model.cols.length + 1) {\n                  value = 12 - scope.model.cols.length + 1;\n                }\n\n                var sum = 0;\n                var parts = 0;\n\n                for (var i in scope.model.cols) {\n                  if (scope.model.cols[i] != col) {\n                    sum += scope.model.cols[i].col;\n                    parts += scope.model.cols[i].col;\n                  } else {\n                    sum += value;\n                  }\n                }\n\n                if (sum <= 12) {\n                  col.col = value;\n                } else {\n                  col.col = 12 - parts;\n                }\n\n                render();\n              });\n            });\n          })(i, scope.model.cols[i]);\n        }\n\n        $(element).children().remove();\n        $(element).append(wrapDiv);\n      }\n    };\n\n    return directive;\n  }\n\n  directives.initDirective('drag', draggable_directive);\n  draggable_directive.$inject = ['$timeout', 'variables'];\n\n  function draggable_directive(timeout, variables) {\n    var directive = {};\n    directive.restrict = \"A\";\n    directive.scope = {\n      dashboard: \"=\"\n    };\n\n    directive.link = function (scope, element, attr) {\n      $(element).draggable({\n        start: function start(event, ui) {\n          dragging = true;\n        },\n        stop: function stop(event, ui) {\n          dragging = false;\n        },\n        handle: $(element).find(\".handler\"),\n        cursor: 'move',\n        appendTo: \"body\",\n        revert: true,\n        helper: function helper(ui) {\n          if (attr.drag == \"layouts\") {\n            var id = $(ui.currentTarget).attr(\"id\");\n            var layout = JSON.parse(JSON.stringify(variables.layouts.filter(function (layout) {\n              return layout.id == id;\n            })[0]));\n            var result = $(\"<div class='helper row'></div>\");\n\n            for (var i in layout.cols) {\n              var col = layout.cols[i];\n              var divDom = $(\"<div class='inner col-md-\" + col.col + \"'></div>\");\n              result.append(divDom);\n            }\n          } else if (attr.drag == \"designViews\") {\n            var result = $(\"<div class='helper row'></div>\").css({\n              height: \"100px\"\n            });\n          } else if (attr.drag == \"totalItems\") {\n            var result = $(\"<div class='helper row'></div>\").css({\n              width: \"200px\",\n              height: \"100px\"\n            });\n          } else if (attr.drag == \"progress\") {\n            var result = $(\"<div class='helper row'></div>\").css({\n              width: \"200px\",\n              height: \"100px\"\n            });\n          } else if (attr.drag == \"downTab\") {\n            var result = $(\"<div class='helper row'></div>\").css({\n              width: \"200px\",\n              height: \"100px\"\n            });\n          } else if (attr.drag == \"attrTab\") {\n            var result = $(\"<div class='helper row'></div>\").css({\n              width: \"200px\",\n              height: \"100px\"\n            });\n          } else if (attr.drag == \"basicline\") {\n            var result = $(\"<div class='helper row'></div>\").css({\n              width: \"200px\",\n              height: \"100px\"\n            });\n          } else if (attr.drag == \"basicpie\") {\n            var result = $(\"<div class='helper row'></div>\").css({\n              width: \"200px\",\n              height: \"100px\"\n            });\n          } else if (attr.drag == \"header\") {\n            var result = $(\"<div class='helper row'></div>\").css({\n              width: \"200px\",\n              height: \"100px\"\n            });\n          } else if (attr.drag == \"listone\") {\n            var result = $(\"<div class='helper row'></div>\").css({\n              width: \"200px\",\n              height: \"100px\"\n            });\n          } else if (attr.drag == \"listtwo\") {\n            var result = $(\"<div class='helper row'></div>\").css({\n              width: \"200px\",\n              height: \"100px\"\n            });\n          } else if (attr.drag == \"map\") {\n            var result = $(\"<div class='helper row'></div>\").css({\n              width: \"200px\",\n              height: \"100px\"\n            });\n          } else if (attr.drag == \"sparkline\") {\n            var result = $(\"<div class='helper row'></div>\").css({\n              width: \"200px\",\n              height: \"100px\"\n            });\n          } else if (attr.drag == \"alertcommon\") {\n            var result = $(\"<div class='helper row'></div>\").css({\n              width: \"200px\",\n              height: \"100px\"\n            });\n          }\n\n          return result;\n        },\n        revertDuration: 0,\n        zIndex: 9999999,\n        connectToSortable: \"#sortable\"\n      });\n    };\n\n    return directive;\n  }\n\n  directives.initDirective('dashboardDrop', droppable_directive);\n  droppable_directive.$inject = [\"$q\", '$timeout', 'variables', 'kpiDataService', 'resourceUIService', 'viewFlexService', \"growl\", \"basicline\", \"basicpie\", \"$location\", \"$window\", \"Info\", \"ticketTaskService\", \"solutionUIService\"];\n\n  function droppable_directive(q, timeout, variables, kpiDataService, resourceUIService, viewFlexService, growl, basicline, basicpie, location, window, Info, ticketTaskService, solutionUIService) {\n    var templates = new $Array(variables.layouts);\n    var directive = {};\n    directive.restrict = \"A\";\n    directive.scope = {\n      dashboard: \"=\"\n    };\n\n    directive.link = function (scope, element, attr) {\n      timeout(function () {\n        variables.dashboardView.then(function success(event) {\n          var beditor;\n          var dashboardView = event.data;\n          var viewId = event.viewId;\n\n          variables.changeView = function (data) {\n            $(element).find(\"#dropBody\").children().remove();\n            beditor = new bootEditor({\n              root: $(element).find(\"#dropBody\"),\n              data: data,\n              dashboard: scope.dashboard\n            });\n          };\n\n          beditor = new bootEditor({\n            root: $(element).find(\"#dropBody\"),\n            data: dashboardView,\n            dashboard: scope.dashboard\n          });\n\n          scope.dashboard.save = function () {\n            var result, param;\n            var solutionId = scope.dashboard.solutionId;\n\n            if (solutionId) {\n              result = beditor.toJSON();\n              solutionUIService.saveManageViewContent(solutionId, JSON.stringify(result), function (event) {\n                if (event.code == 0) {\n                  window.open(\"index.html#/myView\", \"_self\");\n                  growl.success(\"解决方案视图修改成功\", {});\n                } else {\n                  growl.error(\"解决方案视图修改失败\", {});\n                }\n              });\n            } else {\n              result = beditor.toJSON();\n              param = {\n                viewTitle: 'dashboard',\n                viewName: 'dashboard',\n                viewType: \"dashboard\",\n                content: JSON.stringify(result)\n              };\n              viewFlexService.saveManageDashboard(param, function (event) {\n                if (event.code == 0) {\n                  window.open(\"index.html\", \"_self\");\n                  growl.success(\"视图首页修改成功\", {});\n                } else {\n                  growl.error(\"视图首页修改失败\", {});\n                }\n              });\n            }\n          };\n\n          scope.dashboard.delete = function () {\n            viewFlexService.deleteViews([viewId], function (event) {\n              viewId = undefined;\n              window.open(\"index.html\", \"_self\");\n            });\n          };\n        }, function error(err) {\n          //growl.addErrorMessage(err);\n          console.log(err);\n        });\n      }, 100);\n    };\n\n    function bootEditor(object) {\n      var cur = this;\n      var structure;\n      var dashboard = object.dashboard;\n      dashboard.on(\"switchMode\", function () {\n        timeout(function () {\n          cur.resize();\n        }, 100);\n      });\n      $(window).on(\"resize\", function () {\n        timeout(function () {\n          cur.resize();\n        }, 100);\n      });\n\n      cur.toJSON = function () {\n        return structure.toJSON();\n      };\n\n      cur.resize = function () {\n        structure.each(function (element) {\n          if (element.type == \"designView\" || element.type == \"basicline\" || element.type == \"basicpie\") {\n            for (var i in element.echarts) {\n              element.echarts[i].echart(\"option\", \"resize\");\n            }\n          }\n        });\n      };\n\n      var dragconfig = {\n        cursorAt: {\n          top: 0,\n          left: 450\n        },\n        start: function start(event, ui) {\n          $(event.target).css(\"display\", \"none\");\n          dragging = true;\n        },\n        stop: function stop(event, ui) {\n          $(event.target).css(\"display\", \"block\");\n          dragging = false;\n        },\n        appendTo: \"body\",\n        revertDuration: 0,\n        cursor: 'move',\n        revert: true,\n        zIndex: 9999,\n        opacity: .5,\n        helper: function helper(ui) {\n          var clone = $(ui.currentTarget).clone();\n          var find = clone.find('.box-body');\n          var wrap = $(\"<div class='help_wrap row'></div>\");\n\n          if (find.size() > 0) {\n            find.children(\".innerContent\").children().each(function (index, element) {\n              var cl = $(element).clone();\n              cl.children().remove();\n\n              if (cl.filter(\"[class*=col-]\").size() == 0) {\n                cl.addClass(\"column col-md-12\");\n              }\n\n              wrap.append(cl);\n            });\n          } else {\n            clone.children(\".innerContent\").children().each(function (index, element) {\n              var cl = $(element).clone();\n              cl.children().remove();\n\n              if (cl.filter(\"[class*=col-]\").size() == 0) {\n                cl.addClass(\"column col-md-12\");\n              }\n\n              wrap.append(cl);\n            });\n          }\n\n          wrap.css({\n            'pointer-events': 'none'\n          });\n          return wrap;\n        }\n      };\n      var mouseEvent = {\n        mouseover: function mouseover(event, ui) {\n          if (dragging) {\n            var target = $(event.target);\n            target.addClass(\"drophover\");\n          }\n        },\n        mouseout: function mouseout(event, ui) {\n          if (dragging) {\n            var target = $(event.target);\n            target.removeClass(\"drophover\");\n          }\n        }\n      };\n      var dropconfig = {\n        tolerance: 'pointer',\n        drop: function drop(event, ui) {\n          var rowWrap, rowInput;\n          var variable = {};\n          var draggable = $(ui.draggable);\n          var dragId = draggable.attr(\"id\");\n          var target = $(event.target);\n\n          if (draggable.filter(\"[drag]\").size() > 0) {\n            var type = draggable.attr(\"drag\");\n            rowWrap = $(\"<div id='\" + $randomString(32) + \"' class='row rowWrap'></div>\");\n            variable = JSON.parse(JSON.stringify(variables[type].filter(function (variable) {\n              return variable.id == dragId;\n            })[0]));\n            variable.target = rowWrap;\n          } else {\n            structure.eachRow(function (element) {\n              var domId = $(element.target).attr(\"id\");\n\n              if (dragId == domId) {\n                structure.remove(element);\n                variable = element;\n              }\n            });\n            rowWrap = variable.target;\n          }\n\n          if (target.hasClass(\"insert_before\")) {\n            var add;\n            var colId, rowId;\n\n            if (target.parent().hasClass(\"box-body\")) {\n              colId = target.parent().parent().parent().parent().attr(\"id\");\n              rowId = target.parent().parent().parent().attr(\"id\");\n            } else {\n              colId = target.parent().parent().attr(\"id\");\n              rowId = target.parent().attr(\"id\");\n            }\n\n            structure.eachCol(function (element) {\n              var domId = $(element.target).attr(\"id\");\n\n              if (colId == domId) {\n                add = element;\n              }\n            });\n\n            if (add.rows) {\n              var temp = [];\n\n              for (var i in add.rows) {\n                if (rowId == add.rows[i].target.attr(\"id\")) {\n                  temp.push(variable);\n                }\n\n                temp.push(add.rows[i]);\n              }\n\n              add.rows = temp;\n            }\n\n            if (colId == \"dropBody\") {\n              var box = $(\"<div class='box box-info'>\");\n              var boxHeader = $('<div class=\"box-header with-border\">\\\n                                <h3 class=\"box-title\" id=\"boxTitle\"></h3>\\\n                            </div>');\n              rowInput = $(\"<div class='box-body'></div>\");\n              rowWrap.children().remove();\n              rowWrap.append(box);\n              box.append(boxHeader);\n              box.append(rowInput);\n            } else {\n              var find = rowWrap.find('.box-body');\n\n              if (find.size() > 0) {\n                //var children = find.children();\n                rowWrap.find('.box').remove(); //rowWrap.append(children);\n              }\n\n              rowWrap.children().remove();\n              rowInput = rowWrap;\n            }\n\n            if (target.parent().hasClass(\"box-body\")) {\n              target.parent().parent().parent().before(rowWrap);\n            } else {\n              target.parent().before(rowWrap);\n            }\n          } else if (target.hasClass(\"insert_after\")) {\n            var add, colId;\n\n            if (target.parent().hasClass(\"box-body\")) {\n              colId = target.parent().parent().parent().attr(\"id\");\n            } else {\n              colId = target.parent().attr(\"id\");\n            }\n\n            structure.eachCol(function (element) {\n              var domId = $(element.target).attr(\"id\");\n\n              if (colId == domId) {\n                add = element;\n              }\n            });\n\n            if (add.rows) {\n              add.rows.push(variable);\n            } else {\n              add.rows = [variable];\n            }\n\n            if (colId == \"dropBody\") {\n              var box = $(\"<div class='box'>\");\n              var boxHeader = $('<div class=\"box-header with-border\">\\\n                                <h3 class=\"box-title\" id=\"boxTitle\"></h3>\\\n                            </div>');\n              rowInput = $(\"<div class='box-body'></div>\");\n              rowWrap.append(box);\n              box.append(boxHeader);\n              box.append(rowInput);\n              var find = rowWrap.find('.box-body');\n\n              if (find.size() > 0) {\n                var children = find.children();\n                rowWrap.find('.box').remove();\n                rowWrap.append(children);\n                rowWrap.children().remove();\n                rowWrap.append(box);\n              } else {\n                rowInput.append(rowWrap.children());\n              }\n            } else {\n              var find = rowWrap.find('.box-body');\n\n              if (find.size() > 0) {\n                //var children = find.children();\n                rowWrap.find('.box').remove(); //rowWrap.append(children);\n              }\n\n              rowWrap.children().remove();\n              rowInput = rowWrap;\n            }\n\n            if (target.parent().hasClass(\"box-body\")) {\n              target.parent().parent().before(rowWrap);\n            } else {\n              target.before(rowWrap);\n            }\n          }\n\n          target.removeClass(\"drophover\");\n          traverse(rowInput, variable);\n          timeout(function () {\n            cur.resize();\n          }, 100);\n\n          if ($(\"#dropBody\").children(\".rowWrap\").size() == 0) {\n            $(\"#dropBody\").children(\".insert_after\").css(\"height\", \"500px\");\n          }\n        }\n      };\n      init(object);\n\n      function init(object) {\n        structure = new $tree(JSON.parse(JSON.stringify(object.data)));\n        var insertAfter = $(\"<div class='insert_after'></div>\");\n        structure.getData().target = object.root;\n\n        for (var i in structure.getData().rows) {\n          var row = structure.getData().rows[i];\n          var rowWrap = $(\"<div id='\" + $randomString(32) + \"' class='row rowWrap'></div>\");\n          var box = $(\"<div class='box'></div>\");\n          var boxHeader = $('<div class=\"box-header with-border\">\\\n                        <h3 id=\"boxTitle\" class=\"box-title\"></h3>\\\n                    </div>');\n          var boxBody = $(\"<div class='box-body'></div>\");\n          row.target = rowWrap;\n          rowWrap.append(box);\n          box.append(boxHeader);\n          box.append(boxBody);\n          structure.getData().target.append(rowWrap);\n          traverse(boxBody, row);\n        }\n\n        structure.getData().target.append(insertAfter);\n        insertAfter.droppable(dropconfig);\n        insertAfter.on(mouseEvent);\n      }\n\n      ;\n\n      function traverse(target, row) {\n        var inputTitle = $(\"<div class='titleWrap'><lable>表标题</lable><input id='btitle'/></div>\");\n        var toolbar = $(\"<div class='toolbar'></div>\");\n        var moveBtn = $(\"<div class='moveBtn'><span class='proudsmart ps-move'></span></div>\");\n        var deleteBtn = $(\"<div class='deleteBtn'><span class='proudsmart ps-delete'></span></div>\");\n        var insertBefore = $(\"<div class='insert_before'></div>\");\n        var innerContent = $(\"<div class='row innerContent'></div>\");\n        var innerWrap = $(\"<div class='innerWrap'></div>\");\n\n        if (target.hasClass(\"box-body\")) {\n          var checkbox = $(\"<div class='showOutter'><input type='checkbox'/><label>显示外框</label></div>\");\n          toolbar.append(inputTitle).append(deleteBtn).append(moveBtn).append(checkbox);\n\n          if (row.show != false) {\n            row.show = true;\n            checkbox.find(\"input\").prop(\"checked\", \"checked\");\n            target.parent().parent().removeClass(\"hideWrap\");\n          } else {\n            row.show = false;\n            checkbox.find(\"input\").removeAttr(\"checked\");\n            target.parent().parent().addClass(\"hideWrap\");\n          }\n\n          checkbox.find(\"input\").on(\"click\", function (event) {\n            if ($(this).prop(\"checked\")) {\n              row.show = true;\n              target.parent().parent().removeClass(\"hideWrap\");\n            } else {\n              row.show = false;\n              target.parent().parent().addClass(\"hideWrap\");\n            }\n          });\n\n          if (row.title) {\n            inputTitle.find(\"#btitle\").val(row.title);\n            var boxTitle = target.parent().find('#boxTitle');\n            boxTitle.text(row.title);\n          }\n\n          inputTitle.find(\"#btitle\").on(\"change\", function (event) {\n            var object = $(event.target);\n            var boxTitle = target.parent().find('#boxTitle');\n            boxTitle.text(object.val());\n            row.title = object.val();\n          });\n        } else {\n          delete row.show;\n          toolbar.append(deleteBtn).append(moveBtn);\n        }\n\n        ;\n        target.append(insertBefore).append(toolbar).append(innerContent);\n\n        if (row.type == 'layout') {\n          var cols = row.cols;\n\n          for (var i in cols) {\n            var column = $(\"<div id='col_\" + $randomString(32) + \"' class='column col-md-\" + cols[i].col + \"'></div>\");\n            var insertAfter = $(\"<div class='insert_after'></div>\");\n            var col = cols[i];\n            col.target = column;\n\n            for (var j in col.rows) {\n              var rowWrap = $(\"<div id='\" + $randomString(32) + \"' class='row rowWrap'></div>\");\n              column.append(rowWrap);\n              var inrow = col.rows[j];\n              inrow.target = rowWrap;\n              traverse(rowWrap, inrow);\n            }\n\n            column.append(insertAfter);\n            innerContent.append(column);\n            insertAfter.droppable(dropconfig);\n            insertAfter.on(mouseEvent);\n          }\n        } else if (row.type == 'designView') {\n          innerContent.append(innerWrap);\n          var dv = designView(innerWrap, row);\n        } else if (row.type == 'totalItems') {\n          innerContent.append(innerWrap);\n          var dv = totalItems(innerWrap, row);\n        } else if (row.type == 'progress') {\n          innerContent.append(innerWrap);\n          var dv = progress(innerWrap, row);\n        } else if (row.type == 'downTab') {\n          innerContent.append(innerWrap);\n          var dv = downTab(innerWrap, row);\n        } else if (row.type == 'attrTab') {\n          innerContent.append(innerWrap);\n          var dv = attrTab(innerWrap, row);\n        } else if (row.type == 'header') {\n          innerContent.append(innerWrap);\n          var dv = header(innerWrap, row);\n        } else if (row.type == 'basicline') {\n          innerContent.append(innerWrap);\n          row.content = basicline.getOption();\n          row.content.elements[0].nodes = row.attributes.nodes;\n          row.content.elements[0].kpis = row.attributes.kpis;\n          var dv = designView(innerWrap, row);\n        } else if (row.type == 'basicpie') {\n          innerContent.append(innerWrap);\n          row.content = basicpie.getOption();\n          row.content.elements[0].nodes = row.attributes.nodes;\n          row.content.elements[0].kpis = row.attributes.kpis;\n          var dv = designView(innerWrap, row);\n        } else if (row.type == 'listone') {\n          innerContent.append(innerWrap);\n          var dv = listone(innerWrap, row);\n        } else if (row.type == 'listtwo') {\n          innerContent.append(innerWrap);\n          var dv = listtwo(innerWrap, row);\n        } else if (row.type == 'map') {\n          innerContent.append(innerWrap);\n          var dv = map(innerWrap, row);\n        } else if (row.type == 'sparkline') {\n          innerContent.append(innerWrap);\n          var dv = sparkline(innerWrap, row);\n        } else if (row.type == 'alertcommon') {\n          innerContent.append(innerWrap);\n          row.content = basicpie.getOption();\n          var dv = designView(innerWrap, row);\n        }\n\n        if (target.hasClass(\"box-body\")) {\n          target.parent().parent().draggable(dragconfig);\n          target.parent().parent().draggable(\"option\", \"handle\", moveBtn);\n          target.parent().parent().draggable(\"option\", \"handle\", moveBtn);\n        } else {\n          target.draggable(dragconfig);\n          target.draggable(\"option\", \"handle\", moveBtn);\n          target.draggable(\"option\", \"handle\", moveBtn);\n        }\n\n        insertBefore.droppable(dropconfig);\n        insertBefore.on(mouseEvent);\n\n        if (target.hasClass(\"box-body\")) {\n          (function (target) {\n            target.on(\"mouseover\", function (event) {\n              event.stopPropagation();\n              $(document).find('.boot-mouseOver').removeClass('boot-mouseOver');\n              $(event.currentTarget).addClass('boot-mouseOver');\n            });\n          })(target.parent().parent());\n        } else {\n          (function (target) {\n            target.on(\"mouseover\", function (event) {\n              event.stopPropagation();\n              $(document).find('.boot-mouseOver').removeClass('boot-mouseOver');\n              $(event.currentTarget).addClass('boot-mouseOver');\n            });\n          })(target);\n        }\n\n        deleteBtn.on(\"click\", function (event) {\n          var removed;\n          event.stopPropagation();\n\n          if ($(event.target).parent().parent().parent().hasClass('box-body')) {\n            var id = $(event.currentTarget).parent().parent().parent().parent().attr(\"id\");\n            console.log(\"id1\", id);\n            structure.each(function (element) {\n              if (element.target.attr(\"id\") == id) {\n                removed = element;\n              }\n            });\n            structure.remove(removed);\n            target.parent().parent().remove();\n          } else {\n            //console.log($(event.target).parent().parent());\n            var id = $(event.currentTarget).parent().parent().attr(\"id\");\n            console.log(\"id1\", id);\n            structure.each(function (element) {\n              if (element.target.attr(\"id\") == id) {\n                removed = element;\n              }\n            });\n            structure.remove(removed);\n            target.remove();\n          }\n\n          if ($(\"#dropBody\").children(\".rowWrap\").size() == 0) {\n            $(\"#dropBody\").children(\".insert_after\").css(\"height\", \"500px\");\n          }\n        });\n      }\n\n      ;\n\n      function $tree(param) {\n        var cur = this;\n        var data = param;\n\n        cur.getData = function () {\n          return data;\n        };\n\n        cur.toJSON = function () {\n          var clone = {\n            rows: []\n          };\n\n          for (var i in data.rows) {\n            var row = data.rows[i];\n            var emptyRow = {};\n            emptyRow.type = row.type;\n            emptyRow.show = row.show;\n            emptyRow.title = row.title;\n\n            if (row.type == \"designView\") {\n              emptyRow.content = row.content;\n            } else if (row.type == \"totalItems\") {\n              emptyRow.attributes = row.attributes;\n            } else if (row.type == \"progress\") {\n              emptyRow.attributes = row.attributes;\n            } else if (row.type == \"downTab\") {\n              emptyRow.attributes = row.attributes;\n            } else if (row.type == \"attrTab\") {\n              emptyRow.attributes = row.attributes;\n            } else if (row.type == 'basicline') {\n              emptyRow.attributes = row.attributes;\n              emptyRow.content = row.content;\n            } else if (row.type == 'basicpie') {\n              emptyRow.attributes = row.attributes;\n              emptyRow.content = row.content;\n            } else if (row.type == \"header\") {\n              emptyRow.attributes = row.attributes;\n            } else if (row.type == \"listone\") {\n              emptyRow.attributes = row.attributes;\n            } else if (row.type == \"listtwo\") {\n              emptyRow.attributes = row.attributes;\n            } else if (row.type == 'map') {\n              emptyRow.attributes = row.attributes;\n            } else if (row.type == 'sparkline') {\n              emptyRow.attributes = row.attributes;\n            } else if (row.type == 'alertcommon') {\n              emptyRow.attributes = row.attributes;\n            }\n\n            clone.rows.push(emptyRow);\n            traverse(row, emptyRow);\n          }\n\n          function traverse(obj, emptyRow) {\n            if (obj.cols != undefined) {\n              for (var i in obj.cols) {\n                (function (col) {\n                  var emptyCol = {\n                    col: col.col\n                  };\n\n                  if (emptyRow.cols) {\n                    emptyRow.cols.push(emptyCol);\n                  } else {\n                    emptyRow.cols = [emptyCol];\n                  }\n\n                  for (var j in col.rows) {\n                    (function (row) {\n                      var eRow = {};\n                      eRow.type = row.type;\n                      emptyCol.type = row.type;\n\n                      if (row.type == \"designView\") {\n                        eRow.content = row.content;\n                      } else if (row.type == \"totalItems\") {\n                        eRow.attributes = row.attributes;\n                      } else if (row.type == \"progress\") {\n                        eRow.attributes = row.attributes;\n                      } else if (row.type == \"downTab\") {\n                        eRow.attributes = row.attributes;\n                      } else if (row.type == \"attrTab\") {\n                        eRow.attributes = row.attributes;\n                      } else if (row.type == 'basicline') {\n                        eRow.attributes = row.attributes;\n                        eRow.content = row.content;\n                      } else if (row.type == 'basicpie') {\n                        eRow.attributes = row.attributes;\n                        eRow.content = row.content;\n                      } else if (row.type == \"header\") {\n                        eRow.attributes = row.attributes;\n                      } else if (row.type == \"listone\") {\n                        eRow.attributes = row.attributes;\n                      } else if (row.type == \"listtwo\") {\n                        eRow.attributes = row.attributes;\n                      } else if (row.type == \"map\") {\n                        eRow.attributes = row.attributes;\n                      } else if (row.type == \"sparkline\") {\n                        eRow.attributes = row.attributes;\n                      } else if (row.type == 'alertcommon') {\n                        eRow.attributes = row.attributes;\n                      }\n\n                      if (emptyCol.rows) {\n                        emptyCol.rows.push(eRow);\n                      } else {\n                        emptyCol.rows = [eRow];\n                      }\n\n                      traverse(row, eRow);\n                    })(col.rows[j]);\n                  }\n                })(obj.cols[i]);\n              }\n            }\n          }\n\n          return clone;\n        };\n\n        cur.each = function (callback) {\n          for (var i in data.rows) {\n            var row = data.rows[i];\n            traverse(row);\n            callback(row);\n          }\n\n          function traverse(row) {\n            for (var i in row.cols) {\n              var col = row.cols[i];\n              callback(col);\n\n              for (var j in col.rows) {\n                traverse(col.rows[j]);\n                callback(col.rows[j]);\n              }\n            }\n          }\n        };\n\n        cur.remove = function (removed) {\n          var temp = [];\n\n          for (var i in data.rows) {\n            var row = data.rows[i];\n\n            if (removed != row) {\n              temp.push(row);\n              traverse(row);\n            } else {}\n          }\n\n          data.rows = temp;\n\n          if (temp.length > 0) {\n            data.rows = temp;\n          } else {\n            delete data.rows;\n          }\n\n          function traverse(row) {\n            for (var i in row.cols) {\n              var col = row.cols[i];\n              var temp = [];\n\n              for (var j in col.rows) {\n                if ($(removed.target).attr(\"id\") != $(col.rows[j].target).attr(\"id\")) {\n                  temp.push(col.rows[j]);\n                  traverse(col.rows[j]);\n                } else {}\n              }\n\n              if (temp.length > 0) {\n                col.rows = temp;\n              } else {\n                delete col.rows;\n              }\n            }\n          }\n        };\n\n        cur.eachRow = function (callback) {\n          for (var i in data.rows) {\n            (function (row) {\n              if (row) {\n                traverse(row);\n                callback(row);\n              }\n            })(data.rows[i]);\n          }\n\n          function traverse(row) {\n            for (var i in row.cols) {\n              (function (col) {\n                for (var j in col.rows) {\n                  (function (row) {\n                    if (row) {\n                      traverse(row);\n                      callback(row);\n                    }\n                  })(col.rows[j]);\n                }\n              })(row.cols[i]);\n            }\n          }\n        };\n\n        cur.eachCol = function (callback) {\n          callback(data);\n\n          for (var i in data.rows) {\n            var row = data.rows[i];\n            traverse(row);\n          }\n\n          function traverse(row) {\n            for (var i in row.cols) {\n              var col = row.cols[i];\n              callback(col);\n\n              for (var j in col.rows) {\n                traverse(col.rows[j]);\n              }\n            }\n          }\n        };\n      }\n\n      function designView(target, mydata) {\n        var elements, layouts, dom;\n        mydata.echarts = [];\n        dom = $(\"<div class='designView'></div>\");\n        elements = mydata.content.elements;\n        layouts = [];\n        target.append(dom);\n\n        (function (renderlayout) {\n          var deferreds = [];\n\n          for (var i in elements) {\n            var kpiResDefer = [];\n            var deferred = q.defer();\n            deferreds.push(deferred.promise);\n            var layouts = [],\n                layout;\n            var category = elements[i].category;\n            var dataType = elements[i].dataType;\n            var option = elements[i].option;\n            var formatStr = elements[i].formatStr;\n\n            if (elements[i].layout) {\n              var col = elements[i].layout.col;\n              var row = elements[i].layout.row;\n            } else {\n              var col = 0;\n              var row = i;\n              elements[i].layout = {\n                width: 100,\n                col: 0,\n                row: i\n              };\n            }\n\n            if (!layouts[row]) {\n              layouts[row] = [];\n            }\n\n            layout = layouts[row][col] = {\n              kpis: elements[i].kpis,\n              nodes: elements[i].nodes,\n              layout: elements[i].layout,\n              option: elements[i].option\n            };\n            var kpisDes, nodesDes, minTimespan, nodes;\n            variables.$rootDomain.get().then(function (data) {\n              var kpiQueryModel, param;\n              nodes = [data.id];\n\n              if (mydata.attributes.type != 'alert') {\n                kpiQueryModel = {\n                  category: category,\n                  isRealTimeData: true,\n                  timePeriod: category == \"time\" ? elements[i].timespan : 0,\n                  nodeIds: nodes\n                  /*elements[i].nodes*/\n                  ,\n                  kpiCodes: elements[i].kpis,\n                  startTime: null,\n                  endTime: null,\n                  timeRange: \"\",\n                  statisticType: \"psiot\",\n                  condList: []\n                };\n                param = [\"kpi\", kpiQueryModel];\n                var def1 = q.defer();\n                var def2 = q.defer();\n                kpiResDefer.push(def1.promise);\n                variables.$kpis.getBymodelId(data.modelId).then(function success(data) {\n                  kpisDes = data.reduce(function (prev, next) {\n                    var find = elements[i].kpis.some(function (elem) {\n                      return elem == next.id;\n                    });\n\n                    if (find) {\n                      prev[next.id] = next;\n                    }\n\n                    return prev;\n                  }, {});\n                  def1.resolve(\"success\");\n                }, function error(err) {\n                  console.log(err);\n                });\n                nodesDes = {};\n                nodesDes[data.id] = data;\n                q.all(kpiResDefer).then(function () {\n                  kpiDataService.getValueList(param, function (event) {\n                    var valueList = new $Array(event.data);\n\n                    var vlistGroup = function () {\n                      var result = new $Array([]);\n\n                      for (var i in kpisDes) {\n                        for (var j in nodesDes) {\n                          result.push({\n                            nodeId: j,\n                            nodeDes: nodesDes[j],\n                            kpiId: i,\n                            kpiDes: kpisDes[i],\n                            valueList: []\n                          });\n                        }\n                      }\n\n                      return result;\n                    }(kpisDes, nodesDes);\n\n                    if (category == \"time\") {\n                      vlistGroup.each(function (vg) {\n                        for (var i = 0; i < 7; i++) {\n                          var date = new Date(new Date().getTime() - (7 - i) * 24 * 3600 * 1000);\n                          var year = date.getYear();\n                          var month = date.getMonth();\n                          var dt = date.getDate();\n                          var find = valueList.values().find(function (element) {\n                            return function (year, month, date) {\n                              var cur = this;\n                              return cur.getYear() == year && cur.getMonth() == month && cur.getDate() == date && vg.kpiId == element.kpiCode;\n                            }.call(new Date(element.arisingTime.split(\"T\")[0].replace(/-/g, \"/\")), year, month, dt);\n                          });\n                          vg.valueList.push({\n                            kpiCode: vg.kpiId,\n                            value: find ? find.value : undefined,\n                            timeStamp: date.getTime()\n                          });\n                        }\n\n                        ;\n                      });\n                    } else {\n                      vlistGroup.each(function (vg) {\n                        var date = new Date();\n                        var find = valueList.values().find(function (element) {\n                          return vg.kpiId == element.kpiCode;\n                        });\n\n                        if (find) {\n                          vg.valueList.push({\n                            kpiCode: vg.kpiId,\n                            value: find.value,\n                            timeStamp: date.getTime()\n                          });\n                        } else {\n                          vg.valueList.push({\n                            kpiCode: vg.kpiId,\n                            value: 0,\n                            timeStamp: date.getTime()\n                          });\n                        }\n                      });\n                    }\n\n                    var optionFormat = dataType.category[category];\n                    var vlGroup = new $valueListGroup(vlistGroup, 1, formatStr);\n                    var op = new $option(option);\n                    var xAxis, legend;\n\n                    if (category == \"time\") {\n                      if (optionFormat.series) {\n                        if (optionFormat.series.model == \"linear\") {\n                          op.clearSeries();\n                          legend = vlGroup.getLegend();\n                          xAxis = vlGroup.getxAxisByTime();\n                          vlGroup.eachValueListMerged(function (vg) {\n                            var name = vg.nodeDes.label + \"-\" + vg.kpiDes.label;\n                            var data = vg.$valueList;\n                            op.pushSeries(name, data);\n                          });\n                        } else if (optionFormat.series.model == \"dimensional\") {\n                          if (optionFormat.series.value = \"ci\") {} else if (optionFormat.series.value = \"kpi\") {}\n                        }\n                      }\n                    } else if (category == \"ci\") {\n                      if (optionFormat.series) {\n                        if (optionFormat.series.model == \"linear\") {\n                          var series = [];\n                          legend = vlGroup.getLegend();\n                          xAxis = [];\n                          var first = op.firstSeries();\n                          vlGroup.eachValueListMerged(function (vg) {\n                            var name = vg.nodeDes.label + \"-\" + vg.kpiDes.label;\n                            var data = vg.valueList;\n                            series.push({\n                              name: name,\n                              value: data[0].value\n                            });\n                          });\n                          first.data = series;\n                        } else if (optionFormat.series.model == \"dimensional\") {\n                          if (optionFormat.series.value = \"ci\") {} else if (optionFormat.series.value = \"kpi\") {}\n                        }\n                      }\n                    }\n\n                    if (optionFormat.xAxis) {\n                      op.setFirstxAxis(xAxis);\n                    }\n\n                    if (optionFormat.legend) {\n                      op.setLegend(legend);\n                    }\n\n                    layout.option = op.getOption();\n                    console.log(layout.option);\n\n                    if (mydata.attributes.color) {\n                      layout.option.series[0].itemStyle = {\n                        normal: {\n                          color: mydata.attributes.color\n                        }\n                      };\n                      layout.option.series[0].lineStyle = {\n                        normal: {\n                          color: mydata.attributes.color\n                        }\n                      };\n                      layout.option.series[0].areaStyle = {\n                        normal: {\n                          color: mydata.attributes.color\n                        }\n                      };\n                      layout.option.series[0].markPoint = {};\n                      layout.option.series[0].markLine = {};\n                    }\n\n                    layout.option.animation = true;\n                    deferred.resolve(\"success\");\n                  });\n                });\n              } else {\n                var kpiQueryModel = {\n                  category: 'ci',\n                  isRealTimeData: true,\n                  timePeriod: 0,\n                  kpiCodes: [\"alert_code_count\"]\n                };\n                param = [\"alert\", kpiQueryModel];\n                kpiDataService.getKpiHierarchyValueList(param, function (event) {\n                  if (event.code == '0') {\n                    var ul = $('<ul class=\"nav nav-pills nav-stacked\"></ul>');\n\n                    if (event.data.recordList instanceof Array) {\n                      var op = new $option(option),\n                          data = [];\n                      op.clearSeries();\n\n                      for (var i in event.data.recordList) {\n                        data.push({\n                          name: event.data.recordList[i].category,\n                          value: event.data.recordList[i].alert_code_count\n                        });\n                        var li = $('<li>\\\n                                                    <a>' + event.data.recordList[i].category + ' <span class=\"pull-right text-red ng-binding\">' + event.data.recordList[i].alert_code_count + '条</span></a>\\\n                                                </li>');\n                        ul.append(li);\n                      }\n\n                      dom.after(ul);\n                      op.pushSeries('常见告警类型', data);\n                      layout.option = op.getOption();\n                      layout.option.animation = true;\n                      deferred.resolve(\"success\");\n                    }\n                  }\n                });\n              }\n            });\n          }\n\n          q.all(deferreds).then(function (event) {\n            renderlayout(layouts);\n          });\n        })(renderlayout);\n\n        function renderlayout(layouts) {\n          for (var i in layouts) {\n            var row = $(\"<div class='rowCls'></div>\");\n            dom.append(row);\n\n            for (var j in layouts[i]) {\n              var col = $(\"<div class='colCls'></div>\");\n              var width = layouts[i][j].layout.width;\n              row.append(col);\n              col.css(\"width\", width + \"%\");\n              var height = target.width() * .6; //var height = target.width() * layouts[i][j].layout.widthheightPortion;\n\n              col.css(\"height\", 300 + \"px\");\n              col.echart({\n                option: layouts[i][j].option\n              });\n              layouts[i][j].target = col;\n              mydata.echarts.push(col);\n            }\n          }\n        }\n\n        return dom;\n      }\n\n      function totalItems(target, mydata) {\n        if (mydata.attributes) {\n          var resource;\n          var currentKpi;\n          var kpiId = mydata.attributes.kpi;\n          var nodeId = mydata.attributes.ci;\n          var innerContent = $(\"<div class='small-box \" + mydata.attributes.color + \"'></div>\");\n          var inner = $(\"<div class='inner' style='cursor : pointer;'></div>\");\n          var number = $(\"<h3><span id='text'></span><span id='unit' style='font-size: 20px'></span></h3>\");\n          var title = $(\"<p id='title'></p>\");\n          var icon;\n\n          if (mydata.attributes.icon.indexOf('fa') == -1) {\n            icon = $(\"<div class='icon'><i class='proudsmart \" + mydata.attributes.icon + \"' style='font-size : 70px;'></i></div>\");\n          } else {\n            icon = $(\"<div class='icon'><i class='\" + mydata.attributes.icon + \"' style='font-size : 70px;'></i></div>\");\n          }\n\n          inner.append(number);\n          inner.append(title);\n          innerContent.append(inner);\n          innerContent.append(icon);\n          target.append(innerContent);\n          console.log(nodeId);\n          resourceUIService.getResourceById([nodeId], function (event) {\n            if (event.code == '0') {\n              if (event.data == null) {\n                variables.$rootDomain.get().then(function (data) {\n                  resource = data;\n                  var modelId = resource.modelId;\n                  getDataByModelId(modelId);\n                });\n              } else {\n                var modelId = event.data.modelId;\n                getDataByModelId(modelId);\n              }\n            }\n          });\n          variables.getValueByRootKpi(kpiId).then(function (value) {\n            number.find(\"span#text\").text(value);\n          });\n        }\n\n        function getDataByModelId(modelId) {\n          variables.$kpis.getBymodelId(modelId).then(function success(data) {\n            currentKpi = data.find(function (elem) {\n              return elem.id == kpiId;\n            });\n            var unit = currentKpi.unit;\n            title.text(currentKpi.label);\n            innerContent.on(\"click\", function () {\n              if (currentKpi.label == '管控设备数') {\n                window.location.href = \"../app-oc/index.html#/resource\";\n              } else if (currentKpi.label == '数据采集点') {\n                window.location.href = \"../app-oc/index.html#/emcsView\";\n              } else if (currentKpi.label == '待处理工单数') {\n                window.location.href = \"../app-oc/index.html#/workorder\";\n              } else if (currentKpi.label == '待处理告警数') {\n                window.location.href = \"../app-oc/index.html#/configAlertByStatus\";\n              } else if (currentKpi.label == '待处理紧急告警数') {\n                window.location.href = \"../app-oc/index.html#/configAlert\";\n              } else if (currentKpi.label == '日开机总时长') {\n                window.location.href = \"../app-oc/index.html#/emcsView\";\n              } else if (currentKpi.label == '当日总产量') {\n                window.location.href = \"../app-oc/index.html#/emcsView\";\n              } else if (currentKpi.label == '生产任务') {\n                window.location.href = \"../app-oc/index.html#/emcsView\";\n              } else {\n                window.location.href = \"../app-oc/index.html#/emcsView\";\n              }\n            });\n            variables.$units.get().then(function success(units) {\n              var find = units.filter(function (elem) {\n                return elem.unitCode == unit;\n              });\n\n              if (find[0]) {\n                if (find[0].unitCode == \"Amount\") {\n                  if (data[0].label == '数据采集点') {\n                    number.find(\"span#unit\").text(\"台\");\n                  } else {\n                    number.find(\"span#unit\").text(\"个\");\n                  }\n                } else {\n                  number.find(\"span#unit\").text(find[0].unitName);\n                }\n              }\n            }, function error(err) {\n              growl.addErrorMessage(err);\n            });\n          });\n        }\n      }\n\n      function header(target, mydata) {\n        if (mydata.attributes) {\n          var text = mydata.attributes.text;\n          var header = $(\"<h4 class='visibleWhenView'></h4>\");\n          var inputDom = $(\"<div class='hideWhenView'><label>标题名称：</label><input class='form-control'/></div>\");\n          inputDom.css({\n            \"margin\": \"30px\"\n          });\n          header.css({\n            \"margin\": \"5px\"\n          });\n          target.append(header).append(inputDom);\n\n          if (mydata.attributes.text) {\n            header.text(mydata.attributes.text);\n            inputDom.find(\"input\").val(mydata.attributes.text);\n          }\n\n          inputDom.find(\"input\").on('change', function (event) {\n            var value = $(event.target).val();\n            mydata.attributes.text = value;\n            header.text(value);\n          });\n        }\n      }\n\n      function attrTab(target, mydata) {\n        if (mydata.attributes) {\n          var attrId = mydata.attributes.attrId;\n          var nodeId = mydata.attributes.ci;\n          var innerContent = $(\"<div class='small-box \" + mydata.attributes.color + \"'></div>\");\n          var inner = $(\"<div class='inner' style='cursor : pointer;'></div>\");\n          var number = $(\"<h3><span id='text'></span><span id='unit' style='font-size: 20px'></span></h3>\");\n          var title = $(\"<p id='title'></p>\");\n          var icon = $(\"<div class='icon'><i class='proudsmart \" + mydata.attributes.icon + \"'></i></div>\");\n          inner.append(number);\n          inner.append(title);\n          innerContent.append(inner);\n          innerContent.append(icon);\n          target.append(innerContent);\n          variables.$resources.getAttrByNodeId(nodeId).then(function success(data) {\n            var result = data.filter(function (element) {\n              return element.id == attrId;\n            });\n\n            if (result.length > 0) {\n              number.find(\"span#text\").text(result[0].label);\n              number.find(\"span#unit\").text(result[0].value);\n              title.text(result[0].name);\n            }\n          }, function error(err) {});\n        }\n      }\n\n      function sparkline(target, mydata) {\n        var currentKpi, resource, kpiDefs;\n\n        if (mydata.attributes) {\n          if (mydata.kpiObjects) {\n            mydata.attributes.kpis = [];\n\n            for (var i in mydata.kpiObjects) {\n              mydata.attributes.kpis.push(mydata.kpiObjects[i].id);\n            }\n          }\n        }\n\n        var outer = $('<div class=\"pad box-pane-right bg-green\" style=\"min-height: 280px\"></div>');\n        target.append(outer);\n        var kpiIds = mydata.attributes.kpis;\n        variables.$rootDomain.get().then(function (data) {\n          resource = data;\n          var modelId = resource.modelId;\n          variables.$kpis.getBymodelId(modelId).then(function success(data) {\n            kpiDefs = data.reduce(function (prev, next) {\n              var find = kpiIds.some(function (elem) {\n                return elem == next.id;\n              });\n\n              if (find) {\n                prev[next.id] = next;\n              }\n\n              return prev;\n            }, {});\n            variables.getValueListByRootKpis(kpiIds).then(function success(vlist) {\n              for (var i in kpiDefs) {\n                var find = vlist.filter(function (elem) {\n                  return elem.kpiCode == kpiDefs[i].id;\n                });\n                var inner = $('<div class=\"description-block margin-bottom ng-scope\" ng-repeat=\"item in totalItems4\" on-finish-render-filters=\"\">\\\n                                <div class=\"sparkbar pad\">\\\n                                </div>\\\n                                <h5 class=\"description-header ng-binding\">' + (find.length ? find[find.length - 1].value : 0) + '</h5>\\\n                                <span class=\"description-text ng-binding\">' + kpiDefs[i].label + '</span>\\\n                            </div>');\n                var myvalues = [];\n\n                if (find) {\n                  if (find.length > 7) {\n                    myvalues = find.slice(-7).map(function (el) {\n                      return el.value;\n                    });\n                  } else {\n                    myvalues = find.slice(-find.length + 1).map(function (el) {\n                      return el.value;\n                    });\n                  }\n                } else {\n                  for (var i = 0; i < 7; i++) {\n                    myvalues.push(0);\n                  }\n                }\n\n                outer.append(inner);\n                inner.find('.sparkbar').sparkline(myvalues, {\n                  type: 'bar',\n                  barColor: 'white'\n                });\n              }\n            });\n          });\n        });\n      }\n\n      function map(target, mydata) {\n        var inner = $(\"<div style='width : 100%; height : 340px;'></div>\");\n        target.append(inner);\n        var baseoption;\n        var dashboardOption = {\n          backgroundColor: '#404a59',\n          title: {\n            text: '',\n            subtext: '',\n            sublink: '',\n            left: 'center',\n            textStyle: {\n              color: '#fff'\n            }\n          },\n          tooltip: {\n            trigger: 'item',\n            formatter: function formatter(obj) {\n              return obj.seriesName + ':' + obj.value[2];\n            }\n          },\n          bmap: {\n            center: [104.114129, 37.550339],\n            zoom: 5,\n            roam: true,\n            mapStyle: {\n              styleJson: []\n            }\n          },\n          series: [{\n            name: '运行设备数',\n            type: 'scatter',\n            coordinateSystem: 'bmap',\n            data: [],\n            symbolSize: function symbolSize(val) {\n              var value;\n\n              if (val) {\n                value = val[2] * .2;\n              } else {\n                value = 0;\n              }\n\n              return 10 + value > 20 ? 20 : 10 + value;\n            },\n            label: {\n              normal: {\n                formatter: '{b}',\n                position: 'right',\n                show: false\n              },\n              emphasis: {\n                show: true\n              }\n            },\n            itemStyle: {\n              normal: {\n                color: '#ddb926'\n              }\n            }\n          }, {\n            name: '运行设备数',\n            type: 'effectScatter',\n            coordinateSystem: 'bmap',\n            data: [],\n            symbolSize: function symbolSize(val) {\n              var value;\n\n              if (val) {\n                value = val[2] * .2;\n              } else {\n                value = 0;\n              }\n\n              return 10 + value > 20 ? 20 : 10 + value;\n            },\n            showEffectOn: 'render',\n            rippleEffect: {\n              brushType: 'stroke'\n            },\n            hoverAnimation: true,\n            label: {\n              normal: {\n                formatter: '{b}',\n                position: 'right',\n                show: true\n              }\n            },\n            itemStyle: {\n              normal: {\n                color: '#f4e925',\n                shadowBlur: 10,\n                shadowColor: '#333'\n              }\n            },\n            zlevel: 1\n          }]\n        };\n\n        var init = function init() {\n          resourceUIService.statDeviceByStandardAddress(function (returnObj) {\n            var citys = {\n              \"北京市\": 0\n            };\n\n            if (returnObj.code == 0) {\n              for (var city in returnObj.data) {\n                if (city) {\n                  var arr = city.split(\",\");\n\n                  if (arr[0].indexOf(\"市\") > -1) {\n                    if (citys[arr[0]]) citys[arr[0]] = citys[arr[0]] + returnObj.data[city];else citys[arr[0]] = returnObj.data[city];\n                  } else if (arr.length > 1) {\n                    citys[arr[1]] = returnObj.data[city];\n                  }\n                } else {\n                  citys[\"北京市\"] = citys[\"北京市\"] + returnObj.data[\"\"];\n                }\n              }\n\n              for (var city in citys) {\n                var obj = {};\n                obj.name = city;\n                obj.value = baseoption.geoCoord[city];\n\n                if (obj.value) {\n                  obj.value.push(citys[city]);\n                }\n\n                dashboardOption.series[0].data.push(obj);\n\n                if (dashboardOption.series[0].data.length < 5) {\n                  dashboardOption.series[1].data.push(obj);\n                }\n              }\n\n              inner.echart({\n                option: dashboardOption\n              });\n            }\n          });\n        };\n\n        var par = \"../localdb/echarts-map.json\";\n        var info = Info.get(par, function (info) {\n          baseoption = info;\n          dashboardOption.bmap.mapStyle.styleJson = baseoption.styleJson_dark;\n          init();\n        });\n      }\n\n      function progress(target, mydata) {\n        if (mydata.attributes) {\n          var resource, currentKpi;\n          var nodeId = mydata.attributes.ci;\n          var kpiId = mydata.attributes.kpi;\n          var innerContent = $(\"<div class='progress-group'></div>\");\n          var text = $(\"<span class='progress-text' id='value'></span>\");\n          var number = $(\"<span class='progress-number'></span>\");\n          var prg = $(\"<div class='progress sm'><div class='progress-bar' style='width:80%'></div></div>\");\n          innerContent.append(text);\n          innerContent.append(number);\n          innerContent.append(prg);\n          target.append(innerContent);\n          variables.$kpis.getByKpiIds([kpiId]).then(function success(data) {\n            text.text(data[0].label);\n          });\n          variables.$rootDomain.get().then(function (data) {\n            resource = data;\n            var modelId = resource.modelId;\n            variables.$kpis.getBymodelId(modelId).then(function success(data) {\n              currentKpi = data.find(function (elem) {\n                return elem.id == kpiId;\n              });\n              variables.getValueByRootKpi(kpiId).then(function (value) {\n                number.find(\"span#text\").text(value);\n\n                switch (true) {\n                  case value == 100:\n                    prg.find(\".progress-bar\").addClass(\"progress-bar-aqua\");\n                    break;\n\n                  case value > 90:\n                    prg.find(\".progress-bar\").addClass(\"progress-bar-green\");\n                    break;\n\n                  case value > 80:\n                    prg.find(\".progress-bar\").addClass(\"progress-bar-yellow\");\n                    break;\n\n                  case value > 70:\n                    prg.find(\".progress-bar\").addClass(\"progress-bar-yellow\");\n                    break;\n\n                  case value > 60:\n                    prg.find(\".progress-bar\").addClass(\"progress-bar-red\");\n                    break;\n\n                  default:\n                    prg.find(\".progress-bar\").addClass(\"progress-bar-danger\");\n                }\n\n                number.html(\"<b>\" + value + \"</b>%\");\n                prg.find(\".progress-bar\").css(\"width\", value + \"%\");\n              });\n            });\n          });\n        }\n      }\n\n      function downTab(target, mydata) {\n        if (mydata.attributes) {\n          var resource;\n          var nodeId = mydata.attributes.ci;\n          var kpiId = mydata.attributes.kpi;\n          var innerContent = $(\"<div class='description-block border-right'></div>\");\n          var text = $(\"<span class='description-percentage'><i class='fa'></i><span id='rate'></span></span>\");\n          var valueDom = $(\"<h5 class='description-header'></h5>\");\n          var disc = $(\"<span class='description-text'></span>\");\n          var currentKpi;\n          innerContent.append(text);\n          innerContent.append(valueDom);\n          innerContent.append(disc);\n          target.append(innerContent);\n          variables.$rootDomain.get().then(function (data) {\n            resource = data;\n            var modelId = resource.modelId;\n            variables.$kpis.getBymodelId(modelId).then(function success(data) {\n              currentKpi = data.find(function (elem) {\n                return elem.id == kpiId;\n              });\n              disc.text(currentKpi.label);\n            });\n            variables.getValueListByRootKpis([kpiId]).then(function (data) {\n              var value, old, rate;\n\n              if (data.length > 0) {\n                value = data[0].value;\n              }\n\n              if (data.length > 1) {\n                old = data[data.length - 1];\n\n                if (old > 0) {\n                  rate = (value - old / old) * 100;\n                } else {\n                  rate = 100;\n                }\n              } else {\n                rate = 0;\n              }\n\n              text.find(\"#rate\").text(Math.abs(rate) + '%');\n\n              if (rate > 0) {\n                text.find(\"i.fa\").addClass(\"fa-caret-up\");\n                text.addClass(\"text-red\");\n              } else if (rate < 0) {\n                text.find(\"i.fa\").addClass(\"fa-caret-down\");\n                text.addClass(\"text-green\");\n              } else {\n                text.find(\"i.fa\").addClass(\"fa-caret-left\");\n                text.addClass(\"text-red\");\n              }\n\n              var value = value == 0 ? parseInt(Math.random() * 100) : value;\n              valueDom.text(value);\n            });\n          });\n        }\n      }\n\n      function listone(target, mydata) {\n        if (mydata.attributes) {\n          var fun = mydata.attributes.fun;\n          var innerContent = $(\"<table width='100%' class='table table-hover no-margin'>\");\n          var uldom = $('<ul class=\"products-list product-list-in-box\"></ul>');\n          innerContent.append(uldom);\n          target.append(innerContent);\n          eval(fun)(function (event) {\n            try {\n              if (event.code == '0') {\n                for (var i in event.data) {\n                  var lidom = $('<li class=\"item ng-scope\" ng-repeat=\"device in deviceitems\">\\\n                                                <div class=\"product-info\">\\\n                                                    <a href=\"../app-oc/index.html#/#resource/' + event.data[i].modelId + '/' + event.data[i].id + '\" class=\"product-title ng-binding\"><span class=\"label label-primary pull-left ng-binding\">' + format(event.data[i].createTime) + '</span>' + event.data[i].label + '</a>\\\n                                                </div>\\\n                                            </li>');\n                  uldom.append(lidom);\n                }\n\n                uldom.append($('<a href=\"../app-oc/index.html#/resource\" class=\"uppercase\">查看更多</a>'));\n              } else {\n                throw event.message;\n              }\n            } catch (err) {\n              console.log(err);\n            }\n\n            function format(time) {\n              var dateRegExp = /\\d{4}\\-\\d{2}\\-\\d{2}/;\n              var timeRegExp = /\\d{2}\\:\\d{2}\\:\\d{2}/;\n              var date = dateRegExp.exec(time);\n              var t = timeRegExp.exec(time);\n\n              if (date != null && t != null) {\n                return date + \" \" + t;\n              } else {\n                return time;\n              }\n            }\n          });\n        }\n      }\n\n      function listtwo(target, mydata) {\n        if (mydata.attributes) {\n          var fun = mydata.attributes.fun;\n          var innerContent = $(\"<table width='100%' class='table table-hover no-margin'>\");\n          var header = $(\"<thead><tr><th>工单号</th><th>内容</th><th>紧急度</th></tr></thead>\");\n          var tbody = $(\"<tbody></tbody>\");\n          innerContent.append(header).append(tbody);\n          target.append(innerContent);\n          var status = 100;\n          eval(fun)(status, function (event) {\n            try {\n              if (event.code == '0') {\n                for (var i = 0; i < (event.data.length > 10 ? 10 : event.data.length); i++) {\n                  var content;\n\n                  (function (index, item) {\n                    if (item.priorityCode == 0) {\n                      content = $('<tr ng-repeat=\"item in orderList\" class=\"ng-scope\">\\\n                                            <td><a href=\"../app-oc/index.html#/orderdetail/' + event.data[i].ticketNo + '/order\" class=\"ng-binding\">' + event.data[i].ticketNo + '</a></td>\\\n                                            <td class=\"ng-binding\">' + event.data[i].message + '</td>\\\n                                            <!-- <td>{{item.statuslab}}</td> -->\\\n                                        <td><span class=\"label alerts-minor\">低</span></td>\\\n                                    </tr>');\n                    } else if (item.priorityCode == 100) {\n                      content = $('<tr ng-repeat=\"item in orderList\" class=\"ng-scope\">\\\n                                            <td><a href=\"../app-oc/index.html#/orderdetail/' + event.data[i].ticketNo + '/order\" class=\"ng-binding\">' + event.data[i].ticketNo + '</a></td>\\\n                                            <td class=\"ng-binding\">' + event.data[i].message + '</td>\\\n                                            <!-- <td>{{item.statuslab}}</td> -->\\\n                                        <td><span class=\"label alerts-major\">中</span></td>\\\n                                    </tr>');\n                    } else if (item.priorityCode == 200) {\n                      content = $('<tr ng-repeat=\"item in orderList\" class=\"ng-scope\">\\\n                                            <td><a href=\"../app-oc/index.html#/orderdetail/' + event.data[i].ticketNo + '/order\" class=\"ng-binding\">' + event.data[i].ticketNo + '</a></td>\\\n                                            <td class=\"ng-binding\">' + event.data[i].message + '</td>\\\n                                            <!-- <td>{{item.statuslab}}</td> -->\\\n                                        <td><span class=\"label alerts-critical\">高</span></td>\\\n                                    </tr>');\n                    }\n                  })(i, event.data[i]);\n\n                  tbody.append(content);\n                }\n              } else {\n                throw event.message;\n              }\n            } catch (err) {\n              console.log(err);\n            }\n\n            tbody.append($('<tr><td colspan=\"3\"><a href=\"../app-oc/index.html#/workorder\" class=\"btn btn-sm btn-default btn-flat\">查看更多</a></td></tr>'));\n          });\n        }\n      }\n\n      $.fn.extend({\n        echart: function echart() {\n          var cur = this;\n          var target;\n\n          if (arguments.length == 1) {\n            target = echarts.init(this[0], 'macarons');\n            this.data(\"target\", target);\n            target.setOption(arguments[0].option);\n          } else if (arguments[0] == \"option\") {\n            if (arguments[2]) {\n              eval(arguments[1])(arguments[2]);\n            } else {\n              eval(arguments[1] + \"()\");\n            }\n          }\n\n          function resize() {\n            target = cur.data(\"target\");\n            if (target) target.resize();\n          }\n\n          function setOption(option) {\n            target = cur.data(\"target\");\n            if (target) target.setOption(option, true);\n          }\n        }\n      });\n    }\n\n    return directive;\n  }\n});"],"sourceRoot":"/source/"}