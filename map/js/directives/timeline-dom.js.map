{"version":3,"sources":["js/directives/timeline-dom.js"],"names":["define","directives","initDirective","$timeout","restrict","controller","$scope","$element","$attrs","$on","event","args","eventDate","htmlString","i","length","update_date","substring","addTmLabel","addTmItem","html","string","random","Math","replace","tmItem","eventIcon","resource_type","file_url","author","subject","content"],"mappings":"AAAAA,OAAO,CAAC,yBAA0B,SAAUC,GAC1C,aAEAA,EAAWC,cAAc,kBAAmB,SAAUC,GACpD,MAAO,CACLC,SAAU,IACVC,WAAY,CAAC,SAAU,WAAY,SAAU,SAAUC,EAAQC,EAAUC,GACvEF,EAAOG,IAAI,oBAAqB,SAAUC,EAAOC,GAI/C,IAHA,IAAIC,EAAY,GACZC,EAAa,yBAERC,EAAI,EAAGA,EAAIH,EAAKI,OAAQD,IACtB,GAALA,IACFF,EAAYD,EAAKG,GAAGE,YAAYC,UAAU,EAAG,IAC7CJ,GAAcK,EAAWN,IAGvBA,GAAaD,EAAKG,GAAGE,YAAYC,UAAU,EAAG,MAChDL,EAAYD,EAAKG,GAAGE,YAAYC,UAAU,EAAG,IAC7CJ,GAAcK,EAAWN,IAG3BC,GAAcM,EAAUR,EAAKG,IAG/BD,GAAc,iDACdA,GAAc,QACdN,EAASa,KAAKP,KAGhB,IAAIK,EAAa,SAAoBN,GACnC,IAAIS,EAAS,GACTC,EAASC,KAAKD,SAKlB,OAHAD,GAAU,uCADa,IAATC,EAAgB,SAAoB,GAATA,EAAe,YAAuB,IAATA,EAAgB,YAAc,YACxC,IAC5DD,GAAUT,EAAUY,QAAQ,IAAK,KAAKA,QAAQ,IAAK,KACnDH,GAAU,gBAIRF,EAAY,SAAmBM,GACjC,IAAIJ,EAAS,GACTK,EAAY,GA0ChB,OAxC4B,GAAxBD,EAAOE,gBACTD,EAAY,uBAMc,GAAxBD,EAAOE,gBACTD,EAAY,0BAGc,GAAxBD,EAAOE,gBACTD,EAAY,6BAGVD,EAAOG,SAEXP,GAAU,oBAAsBK,EAAY,SAC5CL,GAAU,8BACVA,GAAU,mDACVA,GAAUI,EAAOT,YAAYC,UAAU,EAAG,IAAIO,QAAQ,IAAK,KAAKA,QAAQ,IAAK,KAAKA,QAAQ,IAAK,KAC/FH,GAAU,UACVA,GAAU,2CAA6CI,EAAOI,OAAS,aAAeJ,EAAOK,QAAU,QAE3E,GAAxBL,EAAOE,gBACTN,GAAU,8BAAgCI,EAAOM,QAAU,UAGjC,GAAxBN,EAAOE,gBACTN,GAAU,2CAA6CI,EAAOG,SAAW,qCAG/C,GAAxBH,EAAOE,gBACTN,GAAU,8BACVA,GAAU,wDACVA,GAAU,kBAAoBI,EAAOG,SAAW,iCAChDP,GAAU,gBAGZA,GAAU","file":"js/directives/timeline-dom.js","sourcesContent":["define(['directives/directives'], function (directives) {\n  'use strict';\n\n  directives.initDirective('historyTimeline', function ($timeout) {\n    return {\n      restrict: 'A',\n      controller: ['$scope', '$element', '$attrs', function ($scope, $element, $attrs) {\n        $scope.$on(\"deviceHistoryInit\", function (event, args) {\n          var eventDate = \"\";\n          var htmlString = '<ul class=\"timeline\" >';\n\n          for (var i = 0; i < args.length; i++) {\n            if (i == 0) {\n              eventDate = args[i].update_date.substring(0, 10);\n              htmlString += addTmLabel(eventDate);\n            }\n\n            if (eventDate != args[i].update_date.substring(0, 10)) {\n              eventDate = args[i].update_date.substring(0, 10);\n              htmlString += addTmLabel(eventDate);\n            }\n\n            htmlString += addTmItem(args[i]);\n          }\n\n          htmlString += '<li><i class=\"fa fa-clock-o bg-gray\"></i></li>';\n          htmlString += \"</ul>\";\n          $element.html(htmlString);\n        });\n\n        var addTmLabel = function addTmLabel(eventDate) {\n          var string = \"\";\n          var random = Math.random();\n          var bgClass = random > 0.75 ? \"bg-red\" : random > 0.5 ? \"bg-orange\" : random > 0.25 ? \"bg-yellow\" : \"bg-green\";\n          string += '<li class=\"time-label\"><span class=' + bgClass + '>';\n          string += eventDate.replace(/-/, \"年\").replace(/-/, \"月\");\n          string += '</span></li>';\n          return string;\n        };\n\n        var addTmItem = function addTmItem(tmItem) {\n          var string = \"\";\n          var eventIcon = \"\";\n\n          if (tmItem.resource_type == 1) {\n            eventIcon = \"fa-envelope bg-blue\";\n          } //if(tmItem.author != \"system\"){\n          //  eventIcon = \"fa-user bg-aqua\";\n          //}\n\n\n          if (tmItem.resource_type == 2) {\n            eventIcon = \"fa-picture-o bg-yellow\";\n          }\n\n          if (tmItem.resource_type == 3) {\n            eventIcon = \"fa-video-camera bg-maroon\";\n          }\n\n          if (tmItem.file_url != null) {}\n\n          string += '<li><i class=\"fa ' + eventIcon + '\"></i>';\n          string += '<div class=\"timeline-item\">';\n          string += '<span class=\"time\"><i class=\"fa fa-clock-o\"></i>';\n          string += tmItem.update_date.substring(0, 19).replace(/-/, \"年\").replace(/-/, \"月\").replace(/T/, \" \");\n          string += '</span>';\n          string += '<h3 class=\"timeline-header\"><a href=\"#\">' + tmItem.author + '</a>&nbsp;' + tmItem.subject + '</h3>';\n\n          if (tmItem.resource_type == 1) {\n            string += '<div class=\"timeline-body\">' + tmItem.content + '</div>';\n          }\n\n          if (tmItem.resource_type == 2) {\n            string += '<div class=\"timeline-body\"><img src=\"../' + tmItem.file_url + '\" alt=\"...\" class=\"margin\"></div>';\n          }\n\n          if (tmItem.resource_type == 3) {\n            string += '<div class=\"timeline-body\">';\n            string += '<div class=\"embed-responsive embed-responsive-16by9\">';\n            string += '<video src=\"../' + tmItem.file_url + '\" controls=\"controls\"></video>';\n            string += '</div></div>';\n          }\n\n          string += '</li>';\n          return string;\n        };\n      }]\n    };\n  });\n});"],"sourceRoot":"/source/"}